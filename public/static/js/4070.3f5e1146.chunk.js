/*! For license information please see 4070.3f5e1146.chunk.js.LICENSE.txt */
(self.webpackChunksashjs=self.webpackChunksashjs||[]).push([[4070],{85854:function(e,t,n){"use strict";n.d(t,{BH:function(){return w},G6:function(){return A},L:function(){return d},LL:function(){return O},Pz:function(){return k},Sg:function(){return b},UG:function(){return x},ZB:function(){return p},ZR:function(){return R},aH:function(){return g},b$:function(){return E},eu:function(){return N},hl:function(){return C},jU:function(){return _},m9:function(){return z},ne:function(){return j},pd:function(){return B},r3:function(){return L},ru:function(){return T},tV:function(){return v},uI:function(){return I},vZ:function(){return F},w1:function(){return S},xO:function(){return U},xb:function(){return M},z$:function(){return Z},zd:function(){return q}});var r=n(37762),i=n(29439),a=n(97326),o=n(60136),u=n(29388),s=n(28664),c=n(15671),l=n(43144),h=function(e){for(var t=[],n=0,r=0;r<e.length;r++){var i=e.charCodeAt(r);i<128?t[n++]=i:i<2048?(t[n++]=i>>6|192,t[n++]=63&i|128):55296===(64512&i)&&r+1<e.length&&56320===(64512&e.charCodeAt(r+1))?(i=65536+((1023&i)<<10)+(1023&e.charCodeAt(++r)),t[n++]=i>>18|240,t[n++]=i>>12&63|128,t[n++]=i>>6&63|128,t[n++]=63&i|128):(t[n++]=i>>12|224,t[n++]=i>>6&63|128,t[n++]=63&i|128)}return t},f={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"===typeof atob,encodeByteArray:function(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();for(var n=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[],i=0;i<e.length;i+=3){var a=e[i],o=i+1<e.length,u=o?e[i+1]:0,s=i+2<e.length,c=s?e[i+2]:0,l=a>>2,h=(3&a)<<4|u>>4,f=(15&u)<<2|c>>6,d=63&c;s||(d=64,o||(f=64)),r.push(n[l],n[h],n[f],n[d])}return r.join("")},encodeString:function(e,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(e):this.encodeByteArray(h(e),t)},decodeString:function(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):function(e){for(var t=[],n=0,r=0;n<e.length;){var i=e[n++];if(i<128)t[r++]=String.fromCharCode(i);else if(i>191&&i<224){var a=e[n++];t[r++]=String.fromCharCode((31&i)<<6|63&a)}else if(i>239&&i<365){var o=((7&i)<<18|(63&e[n++])<<12|(63&e[n++])<<6|63&e[n++])-65536;t[r++]=String.fromCharCode(55296+(o>>10)),t[r++]=String.fromCharCode(56320+(1023&o))}else{var u=e[n++],s=e[n++];t[r++]=String.fromCharCode((15&i)<<12|(63&u)<<6|63&s)}}return t.join("")}(this.decodeStringToByteArray(e,t))},decodeStringToByteArray:function(e,t){this.init_();for(var n=t?this.charToByteMapWebSafe_:this.charToByteMap_,r=[],i=0;i<e.length;){var a=n[e.charAt(i++)],o=i<e.length?n[e.charAt(i)]:0,u=++i<e.length?n[e.charAt(i)]:64,s=++i<e.length?n[e.charAt(i)]:64;if(++i,null==a||null==o||null==u||null==s)throw Error();var c=a<<2|o>>4;if(r.push(c),64!==u){var l=o<<4&240|u>>2;if(r.push(l),64!==s){var h=u<<6&192|s;r.push(h)}}}return r},init_:function(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(var e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}},d=function(e){return function(e){var t=h(e);return f.encodeByteArray(t,!0)}(e).replace(/\./g,"")},v=function(e){try{return f.decodeString(e,!0)}catch(t){console.error("base64Decode failed: ",t)}return null};function p(e,t){if(!(t instanceof Object))return t;switch(t.constructor){case Date:return new Date(t.getTime());case Object:void 0===e&&(e={});break;case Array:e=[];break;default:return t}for(var n in t)t.hasOwnProperty(n)&&"__proto__"!==n&&(e[n]=p(e[n],t[n]));return e}var y=function(){return function(){if("undefined"!==typeof self)return self;if("undefined"!==typeof window)return window;if("undefined"!==typeof n.g)return n.g;throw new Error("Unable to locate global object.")}().__FIREBASE_DEFAULTS__},m=function(){try{return y()||function(){if("undefined"!==typeof process){var e={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_API_URL:"http://localhost:4001/"}.__FIREBASE_DEFAULTS__;return e?JSON.parse(e):void 0}}()||function(){if("undefined"!==typeof document){var e;try{e=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch(n){return}var t=e&&v(e[1]);return t&&JSON.parse(t)}}()}catch(e){return void console.info("Unable to get __FIREBASE_DEFAULTS__ due to: ".concat(e))}},g=function(){var e;return null===(e=m())||void 0===e?void 0:e.config},k=function(e){var t;return null===(t=m())||void 0===t?void 0:t["_".concat(e)]},w=function(){function e(){var t=this;(0,c.Z)(this,e),this.reject=function(){},this.resolve=function(){},this.promise=new Promise((function(e,n){t.resolve=e,t.reject=n}))}return(0,l.Z)(e,[{key:"wrapCallback",value:function(e){var t=this;return function(n,r){n?t.reject(n):t.resolve(r),"function"===typeof e&&(t.promise.catch((function(){})),1===e.length?e(n):e(n,r))}}}]),e}();function b(e,t){if(e.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');var n=t||"demo-project",r=e.iat||0,i=e.sub||e.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");var a=Object.assign({iss:"https://securetoken.google.com/".concat(n),aud:n,iat:r,exp:r+3600,auth_time:r,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}}},e);return[d(JSON.stringify({alg:"none",type:"JWT"})),d(JSON.stringify(a)),""].join(".")}function Z(){return"undefined"!==typeof navigator&&"string"===typeof navigator.userAgent?navigator.userAgent:""}function I(){return"undefined"!==typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Z())}function x(){var e,t=null===(e=m())||void 0===e?void 0:e.forceEnvironment;if("node"===t)return!0;if("browser"===t)return!1;try{return"[object process]"===Object.prototype.toString.call(n.g.process)}catch(r){return!1}}function _(){return"object"===typeof self&&self.self===self}function T(){var e="object"===typeof chrome?chrome.runtime:"object"===typeof browser?browser.runtime:void 0;return"object"===typeof e&&void 0!==e.id}function E(){return"object"===typeof navigator&&"ReactNative"===navigator.product}function S(){var e=Z();return e.indexOf("MSIE ")>=0||e.indexOf("Trident/")>=0}function A(){return!x()&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function C(){try{return"object"===typeof indexedDB}catch(e){return!1}}function N(){return new Promise((function(e,t){try{var n=!0,r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=function(){i.result.close(),n||self.indexedDB.deleteDatabase(r),e(!0)},i.onupgradeneeded=function(){n=!1},i.onerror=function(){var e;t((null===(e=i.error)||void 0===e?void 0:e.message)||"")}}catch(a){t(a)}}))}var D="FirebaseError",R=function(e){(0,o.Z)(n,e);var t=(0,u.Z)(n);function n(e,r,i){var o;return(0,c.Z)(this,n),(o=t.call(this,r)).code=e,o.customData=i,o.name=D,Object.setPrototypeOf((0,a.Z)(o),n.prototype),Error.captureStackTrace&&Error.captureStackTrace((0,a.Z)(o),O.prototype.create),o}return(0,l.Z)(n)}((0,s.Z)(Error)),O=function(){function e(t,n,r){(0,c.Z)(this,e),this.service=t,this.serviceName=n,this.errors=r}return(0,l.Z)(e,[{key:"create",value:function(e){var t=(arguments.length<=1?void 0:arguments[1])||{},n="".concat(this.service,"/").concat(e),r=this.errors[e],i=r?function(e,t){return e.replace(P,(function(e,n){var r=t[n];return null!=r?String(r):"<".concat(n,"?>")}))}(r,t):"Error",a="".concat(this.serviceName,": ").concat(i," (").concat(n,").");return new R(n,a,t)}}]),e}();var P=/\{\$([^}]+)}/g;function L(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function M(e){for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}function F(e,t){if(e===t)return!0;for(var n=Object.keys(e),r=Object.keys(t),i=0,a=n;i<a.length;i++){var o=a[i];if(!r.includes(o))return!1;var u=e[o],s=t[o];if(V(u)&&V(s)){if(!F(u,s))return!1}else if(u!==s)return!1}for(var c=0,l=r;c<l.length;c++){var h=l[c];if(!n.includes(h))return!1}return!0}function V(e){return null!==e&&"object"===typeof e}function U(e){for(var t=[],n=function(){var e=(0,i.Z)(a[r],2),n=e[0],o=e[1];Array.isArray(o)?o.forEach((function(e){t.push(encodeURIComponent(n)+"="+encodeURIComponent(e))})):t.push(encodeURIComponent(n)+"="+encodeURIComponent(o))},r=0,a=Object.entries(e);r<a.length;r++)n();return t.length?"&"+t.join("&"):""}function q(e){var t={};return e.replace(/^\?/,"").split("&").forEach((function(e){if(e){var n=e.split("="),r=(0,i.Z)(n,2),a=r[0],o=r[1];t[decodeURIComponent(a)]=decodeURIComponent(o)}})),t}function B(e){var t=e.indexOf("?");if(!t)return"";var n=e.indexOf("#",t);return e.substring(t,n>0?n:void 0)}function j(e,t){var n=new G(e,t);return n.subscribe.bind(n)}var G=function(){function e(t,n){var r=this;(0,c.Z)(this,e),this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then((function(){t(r)})).catch((function(e){r.error(e)}))}return(0,l.Z)(e,[{key:"next",value:function(e){this.forEachObserver((function(t){t.next(e)}))}},{key:"error",value:function(e){this.forEachObserver((function(t){t.error(e)})),this.close(e)}},{key:"complete",value:function(){this.forEachObserver((function(e){e.complete()})),this.close()}},{key:"subscribe",value:function(e,t,n){var i,a=this;if(void 0===e&&void 0===t&&void 0===n)throw new Error("Missing Observer.");void 0===(i=function(e,t){if("object"!==typeof e||null===e)return!1;var n,i=(0,r.Z)(t);try{for(i.s();!(n=i.n()).done;){var a=n.value;if(a in e&&"function"===typeof e[a])return!0}}catch(o){i.e(o)}finally{i.f()}return!1}(e,["next","error","complete"])?e:{next:e,error:t,complete:n}).next&&(i.next=K),void 0===i.error&&(i.error=K),void 0===i.complete&&(i.complete=K);var o=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then((function(){try{a.finalError?i.error(a.finalError):i.complete()}catch(e){}})),this.observers.push(i),o}},{key:"unsubscribeOne",value:function(e){void 0!==this.observers&&void 0!==this.observers[e]&&(delete this.observers[e],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}},{key:"forEachObserver",value:function(e){if(!this.finalized)for(var t=0;t<this.observers.length;t++)this.sendOne(t,e)}},{key:"sendOne",value:function(e,t){var n=this;this.task.then((function(){if(void 0!==n.observers&&void 0!==n.observers[e])try{t(n.observers[e])}catch(r){"undefined"!==typeof console&&console.error&&console.error(r)}}))}},{key:"close",value:function(e){var t=this;this.finalized||(this.finalized=!0,void 0!==e&&(this.finalError=e),this.task.then((function(){t.observers=void 0,t.onNoObservers=void 0})))}}]),e}();function K(){}function z(e){return e&&e._delegate?e._delegate:e}},80888:function(e,t,n){"use strict";var r=n(79047);function i(){}function a(){}a.resetWarningCache=i,e.exports=function(){function e(e,t,n,i,a,o){if(o!==r){var u=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw u.name="Invariant Violation",u}}function t(){return e}e.isRequired=e;var n={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:a,resetWarningCache:i};return n.PropTypes=n,n}},52007:function(e,t,n){e.exports=n(80888)()},79047:function(e){"use strict";e.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},45736:function(e,t,n){"use strict";var r=n(1413),i=n(45987),a=n(81694),o=n.n(a),u=n(72791),s=n(10162),c=n(80184),l=["bsPrefix","bg","pill","text","className","as"],h=u.forwardRef((function(e,t){var n=e.bsPrefix,a=e.bg,u=e.pill,h=e.text,f=e.className,d=e.as,v=void 0===d?"span":d,p=(0,i.Z)(e,l),y=(0,s.vE)(n,"badge");return(0,c.jsx)(v,(0,r.Z)((0,r.Z)({ref:t},p),{},{className:o()(f,y,u&&"rounded-pill",h&&"text-".concat(h),a&&"bg-".concat(a))}))}));h.displayName="Badge",h.defaultProps={bg:"primary",pill:!1},t.Z=h},70783:function(e,t,n){"use strict";var r=n(1413),i=n(45987),a=n(81694),o=n.n(a),u=n(72791),s=n(52007),c=n.n(s),l=n(80184),h=["as","className","type","tooltip"],f={type:c().string,tooltip:c().bool,as:c().elementType},d=u.forwardRef((function(e,t){var n=e.as,a=void 0===n?"div":n,u=e.className,s=e.type,c=void 0===s?"valid":s,f=e.tooltip,d=void 0!==f&&f,v=(0,i.Z)(e,h);return(0,l.jsx)(a,(0,r.Z)((0,r.Z)({},v),{},{ref:t,className:o()(u,"".concat(c,"-").concat(d?"tooltip":"feedback"))}))}));d.displayName="Feedback",d.propTypes=f,t.Z=d},96882:function(e,t,n){"use strict";var r=n(1413),i=n(45987),a=n(81694),o=n.n(a),u=n(72791),s=n(84934),c=n(10162),l=n(80184),h=["id","bsPrefix","className","type","isValid","isInvalid","as"],f=u.forwardRef((function(e,t){var n=e.id,a=e.bsPrefix,f=e.className,d=e.type,v=void 0===d?"checkbox":d,p=e.isValid,y=void 0!==p&&p,m=e.isInvalid,g=void 0!==m&&m,k=e.as,w=void 0===k?"input":k,b=(0,i.Z)(e,h),Z=(0,u.useContext)(s.Z).controlId;return a=(0,c.vE)(a,"form-check-input"),(0,l.jsx)(w,(0,r.Z)((0,r.Z)({},b),{},{ref:t,type:v,id:n||Z,className:o()(f,a,y&&"is-valid",g&&"is-invalid")}))}));f.displayName="FormCheckInput",t.Z=f},84934:function(e,t,n){"use strict";var r=n(72791).createContext({});t.Z=r},74292:function(e,t,n){"use strict";var r=n(1413),i=n(4942),a=n(45987),o=n(81694),u=n.n(o),s=n(72791),c=(n(42391),n(70783)),l=n(84934),h=n(10162),f=n(80184),d=["bsPrefix","type","size","htmlSize","id","className","isValid","isInvalid","plaintext","readOnly","as"],v=s.forwardRef((function(e,t){var n,o,c=e.bsPrefix,v=e.type,p=e.size,y=e.htmlSize,m=e.id,g=e.className,k=e.isValid,w=void 0!==k&&k,b=e.isInvalid,Z=void 0!==b&&b,I=e.plaintext,x=e.readOnly,_=e.as,T=void 0===_?"input":_,E=(0,a.Z)(e,d),S=(0,s.useContext)(l.Z).controlId;(c=(0,h.vE)(c,"form-control"),I)?n=(0,i.Z)({},"".concat(c,"-plaintext"),!0):(o={},(0,i.Z)(o,c,!0),(0,i.Z)(o,"".concat(c,"-").concat(p),p),n=o);return(0,f.jsx)(T,(0,r.Z)((0,r.Z)({},E),{},{type:v,size:y,ref:t,readOnly:x,id:m||S,className:u()(g,n,w&&"is-valid",Z&&"is-invalid","color"===v&&"".concat(c,"-color"))}))}));v.displayName="FormControl",t.Z=Object.assign(v,{Feedback:c.Z})},99410:function(e,t,n){"use strict";var r=n(45987),i=n(1413),a=n(81694),o=n.n(a),u=n(72791),s=n(66543),c=n(10162),l=n(96882),h=n(91991),f=n(80184),d=["bsPrefix","size","hasValidation","className","as"],v=(0,s.Z)("input-group-text",{Component:"span"}),p=u.forwardRef((function(e,t){var n=e.bsPrefix,a=e.size,s=e.hasValidation,l=e.className,v=e.as,p=void 0===v?"div":v,y=(0,r.Z)(e,d);n=(0,c.vE)(n,"input-group");var m=(0,u.useMemo)((function(){return{}}),[]);return(0,f.jsx)(h.Z.Provider,{value:m,children:(0,f.jsx)(p,(0,i.Z)((0,i.Z)({ref:t},y),{},{className:o()(l,n,a&&"".concat(n,"-").concat(a),s&&"has-validation")}))})}));p.displayName="InputGroup",t.Z=Object.assign(p,{Text:v,Radio:function(e){return(0,f.jsx)(v,{children:(0,f.jsx)(l.Z,(0,i.Z)({type:"radio"},e))})},Checkbox:function(e){return(0,f.jsx)(v,{children:(0,f.jsx)(l.Z,(0,i.Z)({type:"checkbox"},e))})}})},59479:function(e,t,n){"use strict";var r=n(1413),i=n(45987),a=n(81694),o=n.n(a),u=n(72791),s=(n(42391),n(32592)),c=n(41337),l=n(10162),h=n(35247),f=n(80184),d=["className","bsPrefix","variant","horizontal","numbered","as"],v=u.forwardRef((function(e,t){var n,a=(0,s.Ch)(e,{activeKey:"onSelect"}),u=a.className,h=a.bsPrefix,v=a.variant,p=a.horizontal,y=a.numbered,m=a.as,g=void 0===m?"div":m,k=(0,i.Z)(a,d),w=(0,l.vE)(h,"list-group");return p&&(n=!0===p?"horizontal":"horizontal-".concat(p)),(0,f.jsx)(c.Z,(0,r.Z)((0,r.Z)({ref:t},k),{},{as:g,className:o()(u,w,v&&"".concat(w,"-").concat(v),n&&"".concat(w,"-").concat(n),y&&"".concat(w,"-numbered"))}))}));v.displayName="ListGroup",t.Z=Object.assign(v,{Item:h.Z})},35247:function(e,t,n){"use strict";var r=n(1413),i=n(29439),a=n(45987),o=n(81694),u=n.n(o),s=n(72791),c=(n(42391),n(39007)),l=n(24787),h=n(78633),f=n(10162),d=n(80184),v=["bsPrefix","active","disabled","eventKey","className","variant","action","as"],p=s.forwardRef((function(e,t){var n=e.bsPrefix,o=e.active,s=e.disabled,p=e.eventKey,y=e.className,m=e.variant,g=e.action,k=e.as,w=(0,a.Z)(e,v);n=(0,f.vE)(n,"list-group-item");var b=(0,l.v)((0,r.Z)({key:(0,h.h)(p,w.href),active:o},w)),Z=(0,i.Z)(b,2),I=Z[0],x=Z[1],_=(0,c.Z)((function(e){if(s)return e.preventDefault(),void e.stopPropagation();I.onClick(e)}));s&&void 0===w.tabIndex&&(w.tabIndex=-1,w["aria-disabled"]=!0);var T=k||(g?w.href?"a":"button":"div");return(0,d.jsx)(T,(0,r.Z)((0,r.Z)((0,r.Z)({ref:t},w),I),{},{onClick:_,className:u()(y,n,x.isActive&&"active",s&&"disabled",m&&"".concat(n,"-").concat(m),g&&"".concat(n,"-action"))}))}));p.displayName="ListGroupItem",t.Z=p},44089:function(e,t,n){"use strict";n.d(t,{Z:function(){return T}});var r=n(1413),i=n(45987),a=n(81694),o=n.n(a),u=n(72791),s=n(78633),c=n(32592),l=n(66543),h=n(17786),f=n(97585),d=n(39007),v=n(10162),p=n(5715),y=n(80184),m=["bsPrefix","className","children","label","as","onClick"],g=u.forwardRef((function(e,t){var n=e.bsPrefix,a=e.className,s=e.children,c=e.label,l=e.as,h=void 0===l?"button":l,f=e.onClick,g=(0,i.Z)(e,m);n=(0,v.vE)(n,"navbar-toggler");var k=(0,u.useContext)(p.Z)||{},w=k.onToggle,b=k.expanded,Z=(0,d.Z)((function(e){f&&f(e),w&&w()}));return"button"===h&&(g.type="button"),(0,y.jsx)(h,(0,r.Z)((0,r.Z)({},g),{},{ref:t,onClick:Z,"aria-label":c,className:o()(a,n,!b&&"collapsed"),children:s||(0,y.jsx)("span",{className:"".concat(n,"-icon")})}))}));g.displayName="NavbarToggle",g.defaultProps={label:"Toggle navigation"};var k=g,w=n(25167),b=u.forwardRef((function(e,t){var n=(0,u.useContext)(p.Z);return(0,y.jsx)(w.Z,(0,r.Z)((0,r.Z)({ref:t,show:!(null==n||!n.expanded)},e),{},{renderStaticNode:!0}))}));b.displayName="NavbarOffcanvas";var Z=b,I=["bsPrefix","expand","variant","bg","fixed","sticky","className","as","expanded","onToggle","onSelect","collapseOnSelect"],x=(0,l.Z)("navbar-text",{Component:"span"}),_=u.forwardRef((function(e,t){var n=(0,c.Ch)(e,{expanded:"onToggle"}),a=n.bsPrefix,l=n.expand,h=n.variant,f=n.bg,d=n.fixed,m=n.sticky,g=n.className,k=n.as,w=void 0===k?"nav":k,b=n.expanded,Z=n.onToggle,x=n.onSelect,_=n.collapseOnSelect,T=(0,i.Z)(n,I),E=(0,v.vE)(a,"navbar"),S=(0,u.useCallback)((function(){null==x||x.apply(void 0,arguments),_&&b&&(null==Z||Z(!1))}),[x,_,b,Z]);void 0===T.role&&"nav"!==w&&(T.role="navigation");var A="".concat(E,"-expand");"string"===typeof l&&(A="".concat(A,"-").concat(l));var C=(0,u.useMemo)((function(){return{onToggle:function(){return null==Z?void 0:Z(!b)},bsPrefix:E,expanded:!!b,expand:l}}),[E,b,l,Z]);return(0,y.jsx)(p.Z.Provider,{value:C,children:(0,y.jsx)(s.Z.Provider,{value:S,children:(0,y.jsx)(w,(0,r.Z)((0,r.Z)({ref:t},T),{},{className:o()(g,E,l&&A,h&&"".concat(E,"-").concat(h),f&&"bg-".concat(f),m&&"sticky-".concat(m),d&&"fixed-".concat(d))}))})})}));_.defaultProps={expand:!0,variant:"light",collapseOnSelect:!1},_.displayName="Navbar";var T=Object.assign(_,{Brand:h.Z,Collapse:f.Z,Offcanvas:Z,Text:x,Toggle:k})},17786:function(e,t,n){"use strict";var r=n(1413),i=n(45987),a=n(81694),o=n.n(a),u=n(72791),s=n(10162),c=n(80184),l=["bsPrefix","className","as"],h=u.forwardRef((function(e,t){var n=e.bsPrefix,a=e.className,u=e.as,h=(0,i.Z)(e,l);n=(0,s.vE)(n,"navbar-brand");var f=u||(h.href?"a":"span");return(0,c.jsx)(f,(0,r.Z)((0,r.Z)({},h),{},{ref:t,className:o()(a,n)}))}));h.displayName="NavbarBrand",t.Z=h},97585:function(e,t,n){"use strict";var r=n(1413),i=n(45987),a=n(72791),o=n(73193),u=n(10162),s=n(5715),c=n(80184),l=["children","bsPrefix"],h=a.forwardRef((function(e,t){var n=e.children,h=e.bsPrefix,f=(0,i.Z)(e,l);h=(0,u.vE)(h,"navbar-collapse");var d=(0,a.useContext)(s.Z);return(0,c.jsx)(o.Z,(0,r.Z)((0,r.Z)({in:!(!d||!d.expanded)},f),{},{children:(0,c.jsx)("div",{ref:t,className:h,children:n})}))}));h.displayName="NavbarCollapse",t.Z=h},3431:function(e,t,n){"use strict";n.d(t,{CR:function(){return c},Jh:function(){return s},ZT:function(){return i},_T:function(){return o},ev:function(){return h},fl:function(){return l},mG:function(){return u},pi:function(){return a}});var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},r(e,t)};function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var a=function(){return a=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},a.apply(this,arguments)};function o(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n}function u(e,t,n,r){return new(n||(n=Promise))((function(i,a){function o(e){try{s(r.next(e))}catch(t){a(t)}}function u(e){try{s(r.throw(e))}catch(t){a(t)}}function s(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,u)}s((r=r.apply(e,t||[])).next())}))}function s(e,t){var n,r,i,a,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:u(0),throw:u(1),return:u(2)},"function"===typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function u(u){return function(s){return function(u){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,u[0]&&(o=0)),o;)try{if(n=1,r&&(i=2&u[0]?r.return:u[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,u[1])).done)return i;switch(r=0,i&&(u=[2&u[0],i.value]),u[0]){case 0:case 1:i=u;break;case 4:return o.label++,{value:u[1],done:!1};case 5:o.label++,r=u[1],u=[0];continue;case 7:u=o.ops.pop(),o.trys.pop();continue;default:if(!(i=(i=o.trys).length>0&&i[i.length-1])&&(6===u[0]||2===u[0])){o=0;continue}if(3===u[0]&&(!i||u[1]>i[0]&&u[1]<i[3])){o.label=u[1];break}if(6===u[0]&&o.label<i[1]){o.label=i[1],i=u;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(u);break}i[2]&&o.ops.pop(),o.trys.pop();continue}u=t.call(e,o)}catch(s){u=[6,s],r=0}finally{n=i=0}if(5&u[0])throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}([u,s])}}}Object.create;function c(e,t){var n="function"===typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,a=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=a.next()).done;)o.push(r.value)}catch(u){i={error:u}}finally{try{r&&!r.done&&(n=a.return)&&n.call(a)}finally{if(i)throw i.error}}return o}function l(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(c(arguments[t]));return e}function h(e,t,n){if(n||2===arguments.length)for(var r,i=0,a=t.length;i<a;i++)!r&&i in t||(r||(r=Array.prototype.slice.call(t,0,i)),r[i]=t[i]);return e.concat(r||Array.prototype.slice.call(t))}Object.create},30166:function(e,t,n){"use strict";n.d(t,{Z:function(){return w}});var r,i=n(4942),a=n(15671),o=n(43144),u=n(85854),s=n(23258),c=n(67825),l=n(6781),h=function(){function e(t,n){var r=this;(0,a.Z)(this,e),this._delegate=t,this.firebase=n,(0,c._addComponent)(t,new s.wA("app-compat",(function(){return r}),"PUBLIC")),this.container=t.container}return(0,o.Z)(e,[{key:"automaticDataCollectionEnabled",get:function(){return this._delegate.automaticDataCollectionEnabled},set:function(e){this._delegate.automaticDataCollectionEnabled=e}},{key:"name",get:function(){return this._delegate.name}},{key:"options",get:function(){return this._delegate.options}},{key:"delete",value:function(){var e=this;return new Promise((function(t){e._delegate.checkDestroyed(),t()})).then((function(){return e.firebase.INTERNAL.removeApp(e.name),(0,c.deleteApp)(e._delegate)}))}},{key:"_getService",value:function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:c._DEFAULT_ENTRY_NAME;this._delegate.checkDestroyed();var r=this._delegate.container.getProvider(e);return r.isInitialized()||"EXPLICIT"!==(null===(t=r.getComponent())||void 0===t?void 0:t.instantiationMode)||r.initialize(),r.getImmediate({identifier:n})}},{key:"_removeServiceInstance",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:c._DEFAULT_ENTRY_NAME;this._delegate.container.getProvider(e).clearInstance(t)}},{key:"_addComponent",value:function(e){(0,c._addComponent)(this._delegate,e)}},{key:"_addOrOverwriteComponent",value:function(e){(0,c._addOrOverwriteComponent)(this._delegate,e)}},{key:"toJSON",value:function(){return{name:this.name,automaticDataCollectionEnabled:this.automaticDataCollectionEnabled,options:this.options}}}]),e}(),f=(r={},(0,i.Z)(r,"no-app","No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()"),(0,i.Z)(r,"invalid-app-argument","firebase.{$appName}() takes either no argument or a Firebase App instance."),r),d=new u.LL("app-compat","Firebase",f);var v=function e(){var t=function(e){var t={},n={__esModule:!0,initializeApp:function(r){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=c.initializeApp(r,i);if((0,u.r3)(t,a.name))return t[a.name];var o=new e(a,n);return t[a.name]=o,o},app:r,registerVersion:c.registerVersion,setLogLevel:c.setLogLevel,onLog:c.onLog,apps:null,SDK_VERSION:c.SDK_VERSION,INTERNAL:{registerComponent:function(t){var i=t.name,a=i.replace("-compat","");if(c._registerComponent(t)&&"PUBLIC"===t.type){var o=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:r();if("function"!==typeof e[a])throw d.create("invalid-app-argument",{appName:i});return e[a]()};void 0!==t.serviceProps&&(0,u.ZB)(o,t.serviceProps),n[a]=o,e.prototype[a]=function(){for(var e=this._getService.bind(this,i),n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return e.apply(this,t.multipleInstances?r:[])}}return"PUBLIC"===t.type?n[a]:null},removeApp:function(e){delete t[e]},useAsService:function(e,t){return"serverAuth"===t?null:t},modularAPIs:c}};function r(e){if(e=e||c._DEFAULT_ENTRY_NAME,!(0,u.r3)(t,e))throw d.create("no-app",{appName:e});return t[e]}return n.default=n,Object.defineProperty(n,"apps",{get:function(){return Object.keys(t).map((function(e){return t[e]}))}}),r.App=e,n}(h);return t.INTERNAL=Object.assign(Object.assign({},t.INTERNAL),{createFirebaseNamespace:e,extendNamespace:function(e){(0,u.ZB)(t,e)},createSubscribe:u.ne,ErrorFactory:u.LL,deepExtend:u.ZB}),t}(),p=new l.Yd("@firebase/app-compat"),y="@firebase/app-compat",m="0.2.3";if((0,u.jU)()&&void 0!==self.firebase){p.warn("\n    Warning: Firebase is already defined in the global scope. Please make sure\n    Firebase library is only loaded once.\n  ");var g=self.firebase.SDK_VERSION;g&&g.indexOf("LITE")>=0&&p.warn("\n    Warning: You are trying to load Firebase while using Firebase Performance standalone script.\n    You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.\n    ")}var k,w=v;(0,c.registerVersion)(y,m,k)},67825:function(e,t,n){"use strict";n.r(t),n.d(t,{FirebaseError:function(){return v.ZR},SDK_VERSION:function(){return Y},_DEFAULT_ENTRY_NAME:function(){return M},_addComponent:function(){return q},_addOrOverwriteComponent:function(){return B},_apps:function(){return V},_clearComponents:function(){return z},_components:function(){return U},_getProvider:function(){return G},_registerComponent:function(){return j},_removeServiceInstance:function(){return K},deleteApp:function(){return ee},getApp:function(){return X},getApps:function(){return $},initializeApp:function(){return J},onLog:function(){return re},registerVersion:function(){return ne},setLogLevel:function(){return ie}});var r,i,a=n(93433),o=n(74165),u=n(15861),s=n(37762),c=n(4942),l=n(15671),h=n(43144),f=n(23258),d=n(6781),v=n(85854),p=n(1413),y=function(e,t){return t.some((function(t){return e instanceof t}))};var m=new WeakMap,g=new WeakMap,k=new WeakMap,w=new WeakMap,b=new WeakMap;var Z={get:function(e,t,n){if(e instanceof IDBTransaction){if("done"===t)return g.get(e);if("objectStoreNames"===t)return e.objectStoreNames||k.get(e);if("store"===t)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return _(e[t])},set:function(e,t,n){return e[t]=n,!0},has:function(e,t){return e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e}};function I(e){return e!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(i||(i=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(e)?function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return e.apply(T(this),n),_(m.get(this))}:function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return _(e.apply(T(this),n))}:function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];var a=e.call.apply(e,[T(this),t].concat(r));return k.set(a,t.sort?t.sort():[t]),_(a)}}function x(e){return"function"===typeof e?I(e):(e instanceof IDBTransaction&&function(e){if(!g.has(e)){var t=new Promise((function(t,n){var r=function(){e.removeEventListener("complete",i),e.removeEventListener("error",a),e.removeEventListener("abort",a)},i=function(){t(),r()},a=function(){n(e.error||new DOMException("AbortError","AbortError")),r()};e.addEventListener("complete",i),e.addEventListener("error",a),e.addEventListener("abort",a)}));g.set(e,t)}}(e),y(e,r||(r=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction]))?new Proxy(e,Z):e)}function _(e){if(e instanceof IDBRequest)return function(e){var t=new Promise((function(t,n){var r=function(){e.removeEventListener("success",i),e.removeEventListener("error",a)},i=function(){t(_(e.result)),r()},a=function(){n(e.error),r()};e.addEventListener("success",i),e.addEventListener("error",a)}));return t.then((function(t){t instanceof IDBCursor&&m.set(t,e)})).catch((function(){})),b.set(t,e),t}(e);if(w.has(e))return w.get(e);var t=x(e);return t!==e&&(w.set(e,t),b.set(t,e)),t}var T=function(e){return b.get(e)};var E,S,A=["get","getKey","getAll","getAllKeys","count"],C=["put","add","delete","clear"],N=new Map;function D(e,t){if(e instanceof IDBDatabase&&!(t in e)&&"string"===typeof t){if(N.get(t))return N.get(t);var n=t.replace(/FromIndex$/,""),r=t!==n,i=C.includes(n);if(n in(r?IDBIndex:IDBObjectStore).prototype&&(i||A.includes(n))){var a=function(){var e=(0,u.Z)((0,o.Z)().mark((function e(t){var a,u,s,c,l,h,f=arguments;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(u=this.transaction(t,i?"readwrite":"readonly"),s=u.store,c=f.length,l=new Array(c>1?c-1:0),h=1;h<c;h++)l[h-1]=f[h];return r&&(s=s.index(l.shift())),e.next=6,Promise.all([(a=s)[n].apply(a,l),i&&u.done]);case 6:return e.abrupt("return",e.sent[0]);case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}();return N.set(t,a),a}}}Z=function(e){return(0,p.Z)((0,p.Z)({},e),{},{get:function(t,n,r){return D(t,n)||e.get(t,n,r)},has:function(t,n){return!!D(t,n)||e.has(t,n)}})}(Z);var R=function(){function e(t){(0,l.Z)(this,e),this.container=t}return(0,h.Z)(e,[{key:"getPlatformInfoString",value:function(){return this.container.getProviders().map((function(e){if(function(e){var t=e.getComponent();return"VERSION"===(null===t||void 0===t?void 0:t.type)}(e)){var t=e.getImmediate();return"".concat(t.library,"/").concat(t.version)}return null})).filter((function(e){return e})).join(" ")}}]),e}();var O="@firebase/app",P="0.9.3",L=new d.Yd("@firebase/app"),M="[DEFAULT]",F=(E={},(0,c.Z)(E,O,"fire-core"),(0,c.Z)(E,"@firebase/app-compat","fire-core-compat"),(0,c.Z)(E,"@firebase/analytics","fire-analytics"),(0,c.Z)(E,"@firebase/analytics-compat","fire-analytics-compat"),(0,c.Z)(E,"@firebase/app-check","fire-app-check"),(0,c.Z)(E,"@firebase/app-check-compat","fire-app-check-compat"),(0,c.Z)(E,"@firebase/auth","fire-auth"),(0,c.Z)(E,"@firebase/auth-compat","fire-auth-compat"),(0,c.Z)(E,"@firebase/database","fire-rtdb"),(0,c.Z)(E,"@firebase/database-compat","fire-rtdb-compat"),(0,c.Z)(E,"@firebase/functions","fire-fn"),(0,c.Z)(E,"@firebase/functions-compat","fire-fn-compat"),(0,c.Z)(E,"@firebase/installations","fire-iid"),(0,c.Z)(E,"@firebase/installations-compat","fire-iid-compat"),(0,c.Z)(E,"@firebase/messaging","fire-fcm"),(0,c.Z)(E,"@firebase/messaging-compat","fire-fcm-compat"),(0,c.Z)(E,"@firebase/performance","fire-perf"),(0,c.Z)(E,"@firebase/performance-compat","fire-perf-compat"),(0,c.Z)(E,"@firebase/remote-config","fire-rc"),(0,c.Z)(E,"@firebase/remote-config-compat","fire-rc-compat"),(0,c.Z)(E,"@firebase/storage","fire-gcs"),(0,c.Z)(E,"@firebase/storage-compat","fire-gcs-compat"),(0,c.Z)(E,"@firebase/firestore","fire-fst"),(0,c.Z)(E,"@firebase/firestore-compat","fire-fst-compat"),(0,c.Z)(E,"fire-js","fire-js"),(0,c.Z)(E,"firebase","fire-js-all"),E),V=new Map,U=new Map;function q(e,t){try{e.container.addComponent(t)}catch(n){L.debug("Component ".concat(t.name," failed to register with FirebaseApp ").concat(e.name),n)}}function B(e,t){e.container.addOrOverwriteComponent(t)}function j(e){var t=e.name;if(U.has(t))return L.debug("There were multiple attempts to register component ".concat(t,".")),!1;U.set(t,e);var n,r=(0,s.Z)(V.values());try{for(r.s();!(n=r.n()).done;){q(n.value,e)}}catch(i){r.e(i)}finally{r.f()}return!0}function G(e,t){var n=e.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),e.container.getProvider(t)}function K(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:M;G(e,t).clearInstance(n)}function z(){U.clear()}var W=(S={},(0,c.Z)(S,"no-app","No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()"),(0,c.Z)(S,"bad-app-name","Illegal App name: '{$appName}"),(0,c.Z)(S,"duplicate-app","Firebase App named '{$appName}' already exists with different options or config"),(0,c.Z)(S,"app-deleted","Firebase App named '{$appName}' already deleted"),(0,c.Z)(S,"no-options","Need to provide options, when not being deployed to hosting via source."),(0,c.Z)(S,"invalid-app-argument","firebase.{$appName}() takes either no argument or a Firebase App instance."),(0,c.Z)(S,"invalid-log-argument","First argument to `onLog` must be null or a function."),(0,c.Z)(S,"idb-open","Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}."),(0,c.Z)(S,"idb-get","Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}."),(0,c.Z)(S,"idb-set","Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}."),(0,c.Z)(S,"idb-delete","Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}."),S),H=new v.LL("app","Firebase",W),Q=function(){function e(t,n,r){var i=this;(0,l.Z)(this,e),this._isDeleted=!1,this._options=Object.assign({},t),this._config=Object.assign({},n),this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new f.wA("app",(function(){return i}),"PUBLIC"))}return(0,h.Z)(e,[{key:"automaticDataCollectionEnabled",get:function(){return this.checkDestroyed(),this._automaticDataCollectionEnabled},set:function(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}},{key:"name",get:function(){return this.checkDestroyed(),this._name}},{key:"options",get:function(){return this.checkDestroyed(),this._options}},{key:"config",get:function(){return this.checkDestroyed(),this._config}},{key:"container",get:function(){return this._container}},{key:"isDeleted",get:function(){return this._isDeleted},set:function(e){this._isDeleted=e}},{key:"checkDestroyed",value:function(){if(this.isDeleted)throw H.create("app-deleted",{appName:this._name})}}]),e}(),Y="9.17.1";function J(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e;"object"!==typeof t&&(t={name:t});var r=Object.assign({name:M,automaticDataCollectionEnabled:!1},t),i=r.name;if("string"!==typeof i||!i)throw H.create("bad-app-name",{appName:String(i)});if(n||(n=(0,v.aH)()),!n)throw H.create("no-options");var a=V.get(i);if(a){if((0,v.vZ)(n,a.options)&&(0,v.vZ)(r,a.config))return a;throw H.create("duplicate-app",{appName:i})}var o,u=new f.H0(i),c=(0,s.Z)(U.values());try{for(c.s();!(o=c.n()).done;){var l=o.value;u.addComponent(l)}}catch(d){c.e(d)}finally{c.f()}var h=new Q(n,r,u);return V.set(i,h),h}function X(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:M,t=V.get(e);if(!t&&e===M)return J();if(!t)throw H.create("no-app",{appName:e});return t}function $(){return Array.from(V.values())}function ee(e){return te.apply(this,arguments)}function te(){return(te=(0,u.Z)((0,o.Z)().mark((function e(t){var n;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.name,!V.has(n)){e.next=6;break}return V.delete(n),e.next=5,Promise.all(t.container.getProviders().map((function(e){return e.delete()})));case 5:t.isDeleted=!0;case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ne(e,t,n){var r,i=null!==(r=F[e])&&void 0!==r?r:e;n&&(i+="-".concat(n));var a=i.match(/\s|\//),o=t.match(/\s|\//);if(a||o){var u=['Unable to register library "'.concat(i,'" with version "').concat(t,'":')];return a&&u.push('library name "'.concat(i,'" contains illegal characters (whitespace or "/")')),a&&o&&u.push("and"),o&&u.push('version name "'.concat(t,'" contains illegal characters (whitespace or "/")')),void L.warn(u.join(" "))}j(new f.wA("".concat(i,"-version"),(function(){return{library:i,version:t}}),"VERSION"))}function re(e,t){if(null!==e&&"function"!==typeof e)throw H.create("invalid-log-argument");(0,d.Am)(e,t)}function ie(e){(0,d.Ub)(e)}var ae="firebase-heartbeat-database",oe=1,ue="firebase-heartbeat-store",se=null;function ce(){return se||(se=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=n.blocked,i=n.upgrade,a=n.blocking,o=n.terminated,u=indexedDB.open(e,t),s=_(u);return i&&u.addEventListener("upgradeneeded",(function(e){i(_(u.result),e.oldVersion,e.newVersion,_(u.transaction))})),r&&u.addEventListener("blocked",(function(){return r()})),s.then((function(e){o&&e.addEventListener("close",(function(){return o()})),a&&e.addEventListener("versionchange",(function(){return a()}))})).catch((function(){})),s}(ae,oe,{upgrade:function(e,t){if(0===t)e.createObjectStore(ue)}}).catch((function(e){throw H.create("idb-open",{originalErrorMessage:e.message})}))),se}function le(e){return he.apply(this,arguments)}function he(){return(he=(0,u.Z)((0,o.Z)().mark((function e(t){var n,r;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,ce();case 3:return n=e.sent,e.abrupt("return",n.transaction(ue).objectStore(ue).get(ve(t)));case 7:e.prev=7,e.t0=e.catch(0),e.t0 instanceof v.ZR?L.warn(e.t0.message):(r=H.create("idb-get",{originalErrorMessage:null===e.t0||void 0===e.t0?void 0:e.t0.message}),L.warn(r.message));case 10:case"end":return e.stop()}}),e,null,[[0,7]])})))).apply(this,arguments)}function fe(e,t){return de.apply(this,arguments)}function de(){return(de=(0,u.Z)((0,o.Z)().mark((function e(t,n){var r,i,a,u;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,ce();case 3:return r=e.sent,i=r.transaction(ue,"readwrite"),a=i.objectStore(ue),e.next=8,a.put(n,ve(t));case 8:return e.abrupt("return",i.done);case 11:e.prev=11,e.t0=e.catch(0),e.t0 instanceof v.ZR?L.warn(e.t0.message):(u=H.create("idb-set",{originalErrorMessage:null===e.t0||void 0===e.t0?void 0:e.t0.message}),L.warn(u.message));case 14:case"end":return e.stop()}}),e,null,[[0,11]])})))).apply(this,arguments)}function ve(e){return"".concat(e.name,"!").concat(e.options.appId)}var pe=1024,ye=function(){function e(t){var n=this;(0,l.Z)(this,e),this.container=t,this._heartbeatsCache=null;var r=this.container.getProvider("app").getImmediate();this._storage=new we(r),this._heartbeatsCachePromise=this._storage.read().then((function(e){return n._heartbeatsCache=e,e}))}return(0,h.Z)(e,[{key:"triggerHeartbeat",value:function(){var e=(0,u.Z)((0,o.Z)().mark((function e(){var t,n,r;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.container.getProvider("platform-logger").getImmediate(),n=t.getPlatformInfoString(),r=me(),null!==this._heartbeatsCache){e.next=7;break}return e.next=6,this._heartbeatsCachePromise;case 6:this._heartbeatsCache=e.sent;case 7:if(this._heartbeatsCache.lastSentHeartbeatDate!==r&&!this._heartbeatsCache.heartbeats.some((function(e){return e.date===r}))){e.next=11;break}return e.abrupt("return");case 11:this._heartbeatsCache.heartbeats.push({date:r,agent:n});case 12:return this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter((function(e){var t=new Date(e.date).valueOf();return Date.now()-t<=2592e6})),e.abrupt("return",this._storage.overwrite(this._heartbeatsCache));case 14:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getHeartbeatsHeader",value:function(){var e=(0,u.Z)((0,o.Z)().mark((function e(){var t,n,r,i,a;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!==this._heartbeatsCache){e.next=3;break}return e.next=3,this._heartbeatsCachePromise;case 3:if(null!==this._heartbeatsCache&&0!==this._heartbeatsCache.heartbeats.length){e.next=5;break}return e.abrupt("return","");case 5:if(t=me(),n=ge(this._heartbeatsCache.heartbeats),r=n.heartbeatsToSend,i=n.unsentEntries,a=(0,v.L)(JSON.stringify({version:2,heartbeats:r})),this._heartbeatsCache.lastSentHeartbeatDate=t,!(i.length>0)){e.next=15;break}return this._heartbeatsCache.heartbeats=i,e.next=13,this._storage.overwrite(this._heartbeatsCache);case 13:e.next=17;break;case 15:this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache);case 17:return e.abrupt("return",a);case 18:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),e}();function me(){return(new Date).toISOString().substring(0,10)}function ge(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:pe,r=[],i=e.slice(),a=(0,s.Z)(e);try{var o=function(){var e=t.value,a=r.find((function(t){return t.agent===e.agent}));if(a){if(a.dates.push(e.date),be(r)>n)return a.dates.pop(),"break"}else if(r.push({agent:e.agent,dates:[e.date]}),be(r)>n)return r.pop(),"break";i=i.slice(1)};for(a.s();!(t=a.n()).done;){if("break"===o())break}}catch(u){a.e(u)}finally{a.f()}return{heartbeatsToSend:r,unsentEntries:i}}var ke,we=function(){function e(t){(0,l.Z)(this,e),this.app=t,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}return(0,h.Z)(e,[{key:"runIndexedDBEnvironmentCheck",value:function(){var e=(0,u.Z)((0,o.Z)().mark((function e(){return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((0,v.hl)()){e.next=4;break}return e.abrupt("return",!1);case 4:return e.abrupt("return",(0,v.eu)().then((function(){return!0})).catch((function(){return!1})));case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"read",value:function(){var e=(0,u.Z)((0,o.Z)().mark((function e(){var t;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._canUseIndexedDBPromise;case 2:if(e.sent){e.next=7;break}return e.abrupt("return",{heartbeats:[]});case 7:return e.next=9,le(this.app);case 9:return t=e.sent,e.abrupt("return",t||{heartbeats:[]});case 11:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"overwrite",value:function(){var e=(0,u.Z)((0,o.Z)().mark((function e(t){var n,r;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._canUseIndexedDBPromise;case 2:if(e.sent){e.next=7;break}return e.abrupt("return");case 7:return e.next=9,this.read();case 9:return r=e.sent,e.abrupt("return",fe(this.app,{lastSentHeartbeatDate:null!==(n=t.lastSentHeartbeatDate)&&void 0!==n?n:r.lastSentHeartbeatDate,heartbeats:t.heartbeats}));case 11:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"add",value:function(){var e=(0,u.Z)((0,o.Z)().mark((function e(t){var n,r;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._canUseIndexedDBPromise;case 2:if(e.sent){e.next=7;break}return e.abrupt("return");case 7:return e.next=9,this.read();case 9:return r=e.sent,e.abrupt("return",fe(this.app,{lastSentHeartbeatDate:null!==(n=t.lastSentHeartbeatDate)&&void 0!==n?n:r.lastSentHeartbeatDate,heartbeats:[].concat((0,a.Z)(r.heartbeats),(0,a.Z)(t.heartbeats))}));case 11:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),e}();function be(e){return(0,v.L)(JSON.stringify({version:2,heartbeats:e})).length}ke="",j(new f.wA("platform-logger",(function(e){return new R(e)}),"PRIVATE")),j(new f.wA("heartbeat",(function(e){return new ye(e)}),"PRIVATE")),ne(O,P,ke),ne(O,P,"esm2017"),ne("fire-js","")},23258:function(e,t,n){"use strict";n.d(t,{H0:function(){return v},wA:function(){return h}});var r=n(74165),i=n(93433),a=n(15861),o=n(29439),u=n(37762),s=n(15671),c=n(43144),l=n(85854),h=function(){function e(t,n,r){(0,s.Z)(this,e),this.name=t,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}return(0,c.Z)(e,[{key:"setInstantiationMode",value:function(e){return this.instantiationMode=e,this}},{key:"setMultipleInstances",value:function(e){return this.multipleInstances=e,this}},{key:"setServiceProps",value:function(e){return this.serviceProps=e,this}},{key:"setInstanceCreatedCallback",value:function(e){return this.onInstanceCreated=e,this}}]),e}(),f="[DEFAULT]",d=function(){function e(t,n){(0,s.Z)(this,e),this.name=t,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}return(0,c.Z)(e,[{key:"get",value:function(e){var t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){var n=new l.BH;if(this.instancesDeferred.set(t,n),this.isInitialized(t)||this.shouldAutoInitialize())try{var r=this.getOrInitializeService({instanceIdentifier:t});r&&n.resolve(r)}catch(i){}}return this.instancesDeferred.get(t).promise}},{key:"getImmediate",value:function(e){var t,n=this.normalizeInstanceIdentifier(null===e||void 0===e?void 0:e.identifier),r=null!==(t=null===e||void 0===e?void 0:e.optional)&&void 0!==t&&t;if(!this.isInitialized(n)&&!this.shouldAutoInitialize()){if(r)return null;throw Error("Service ".concat(this.name," is not available"))}try{return this.getOrInitializeService({instanceIdentifier:n})}catch(i){if(r)return null;throw i}}},{key:"getComponent",value:function(){return this.component}},{key:"setComponent",value:function(e){if(e.name!==this.name)throw Error("Mismatching Component ".concat(e.name," for Provider ").concat(this.name,"."));if(this.component)throw Error("Component for ".concat(this.name," has already been provided"));if(this.component=e,this.shouldAutoInitialize()){if(function(e){return"EAGER"===e.instantiationMode}(e))try{this.getOrInitializeService({instanceIdentifier:f})}catch(l){}var t,n=(0,u.Z)(this.instancesDeferred.entries());try{for(n.s();!(t=n.n()).done;){var r=(0,o.Z)(t.value,2),i=r[0],a=r[1],s=this.normalizeInstanceIdentifier(i);try{var c=this.getOrInitializeService({instanceIdentifier:s});a.resolve(c)}catch(l){}}}catch(h){n.e(h)}finally{n.f()}}}},{key:"clearInstance",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:f;this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}},{key:"delete",value:function(){var e=(0,a.Z)((0,r.Z)().mark((function e(){var t;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=Array.from(this.instances.values()),e.next=3,Promise.all([].concat((0,i.Z)(t.filter((function(e){return"INTERNAL"in e})).map((function(e){return e.INTERNAL.delete()}))),(0,i.Z)(t.filter((function(e){return"_delete"in e})).map((function(e){return e._delete()})))));case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"isComponentSet",value:function(){return null!=this.component}},{key:"isInitialized",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:f;return this.instances.has(e)}},{key:"getOptions",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:f;return this.instancesOptions.get(e)||{}}},{key:"initialize",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.options,n=void 0===t?{}:t,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error("".concat(this.name,"(").concat(r,") has already been initialized"));if(!this.isComponentSet())throw Error("Component ".concat(this.name," has not been registered yet"));var i,a=this.getOrInitializeService({instanceIdentifier:r,options:n}),s=(0,u.Z)(this.instancesDeferred.entries());try{for(s.s();!(i=s.n()).done;){var c=(0,o.Z)(i.value,2),l=c[0],h=c[1];r===this.normalizeInstanceIdentifier(l)&&h.resolve(a)}}catch(f){s.e(f)}finally{s.f()}return a}},{key:"onInit",value:function(e,t){var n,r=this.normalizeInstanceIdentifier(t),i=null!==(n=this.onInitCallbacks.get(r))&&void 0!==n?n:new Set;i.add(e),this.onInitCallbacks.set(r,i);var a=this.instances.get(r);return a&&e(a,r),function(){i.delete(e)}}},{key:"invokeOnInitCallbacks",value:function(e,t){var n=this.onInitCallbacks.get(t);if(n){var r,i=(0,u.Z)(n);try{for(i.s();!(r=i.n()).done;){var a=r.value;try{a(e,t)}catch(o){}}}catch(s){i.e(s)}finally{i.f()}}}},{key:"getOrInitializeService",value:function(e){var t,n=e.instanceIdentifier,r=e.options,i=void 0===r?{}:r,a=this.instances.get(n);if(!a&&this.component&&(a=this.component.instanceFactory(this.container,{instanceIdentifier:(t=n,t===f?void 0:t),options:i}),this.instances.set(n,a),this.instancesOptions.set(n,i),this.invokeOnInitCallbacks(a,n),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,n,a)}catch(o){}return a||null}},{key:"normalizeInstanceIdentifier",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:f;return this.component?this.component.multipleInstances?e:f:e}},{key:"shouldAutoInitialize",value:function(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}]),e}();var v=function(){function e(t){(0,s.Z)(this,e),this.name=t,this.providers=new Map}return(0,c.Z)(e,[{key:"addComponent",value:function(e){var t=this.getProvider(e.name);if(t.isComponentSet())throw new Error("Component ".concat(e.name," has already been registered with ").concat(this.name));t.setComponent(e)}},{key:"addOrOverwriteComponent",value:function(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}},{key:"getProvider",value:function(e){if(this.providers.has(e))return this.providers.get(e);var t=new d(e,this);return this.providers.set(e,t),t}},{key:"getProviders",value:function(){return Array.from(this.providers.values())}}]),e}()},6781:function(e,t,n){"use strict";n.d(t,{Am:function(){return y},Ub:function(){return p},Yd:function(){return v},in:function(){return i}});var r,i,a=n(37762),o=n(15671),u=n(43144),s=n(4942),c=[];!function(e){e[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT"}(i||(i={}));var l={debug:i.DEBUG,verbose:i.VERBOSE,info:i.INFO,warn:i.WARN,error:i.ERROR,silent:i.SILENT},h=i.INFO,f=(r={},(0,s.Z)(r,i.DEBUG,"log"),(0,s.Z)(r,i.VERBOSE,"log"),(0,s.Z)(r,i.INFO,"info"),(0,s.Z)(r,i.WARN,"warn"),(0,s.Z)(r,i.ERROR,"error"),r),d=function(e,t){if(!(t<e.logLevel)){var n=(new Date).toISOString(),r=f[t];if(!r)throw new Error("Attempted to log a message with an invalid logType (value: ".concat(t,")"));for(var i,a=arguments.length,o=new Array(a>2?a-2:0),u=2;u<a;u++)o[u-2]=arguments[u];(i=console)[r].apply(i,["[".concat(n,"]  ").concat(e.name,":")].concat(o))}},v=function(){function e(t){(0,o.Z)(this,e),this.name=t,this._logLevel=h,this._logHandler=d,this._userLogHandler=null,c.push(this)}return(0,u.Z)(e,[{key:"logLevel",get:function(){return this._logLevel},set:function(e){if(!(e in i))throw new TypeError('Invalid value "'.concat(e,'" assigned to `logLevel`'));this._logLevel=e}},{key:"setLogLevel",value:function(e){this._logLevel="string"===typeof e?l[e]:e}},{key:"logHandler",get:function(){return this._logHandler},set:function(e){if("function"!==typeof e)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}},{key:"userLogHandler",get:function(){return this._userLogHandler},set:function(e){this._userLogHandler=e}},{key:"debug",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler.apply(this,[this,i.DEBUG].concat(t)),this._logHandler.apply(this,[this,i.DEBUG].concat(t))}},{key:"log",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler.apply(this,[this,i.VERBOSE].concat(t)),this._logHandler.apply(this,[this,i.VERBOSE].concat(t))}},{key:"info",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler.apply(this,[this,i.INFO].concat(t)),this._logHandler.apply(this,[this,i.INFO].concat(t))}},{key:"warn",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler.apply(this,[this,i.WARN].concat(t)),this._logHandler.apply(this,[this,i.WARN].concat(t))}},{key:"error",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler.apply(this,[this,i.ERROR].concat(t)),this._logHandler.apply(this,[this,i.ERROR].concat(t))}}]),e}();function p(e){c.forEach((function(t){t.setLogLevel(e)}))}function y(e,t){var n,r=(0,a.Z)(c);try{var o=function(){var r=n.value,a=null;t&&t.level&&(a=l[t.level]),r.userLogHandler=null===e?null:function(t,n){for(var r=arguments.length,o=new Array(r>2?r-2:0),u=2;u<r;u++)o[u-2]=arguments[u];var s=o.map((function(e){if(null==e)return null;if("string"===typeof e)return e;if("number"===typeof e||"boolean"===typeof e)return e.toString();if(e instanceof Error)return e.message;try{return JSON.stringify(e)}catch(t){return null}})).filter((function(e){return e})).join(" ");n>=(null!==a&&void 0!==a?a:t.logLevel)&&e({level:i[n].toLowerCase(),message:s,args:o,type:t.name})}};for(r.s();!(n=r.n()).done;)o()}catch(u){r.e(u)}finally{r.f()}}},10181:function(e,t,n){"use strict";n.d(t,{Z:function(){return r.Z}});var r=n(30166);r.Z.registerVersion("firebase","9.17.1","app-compat")},44812:function(e,t,n){"use strict";var r,i=n(74165),a=n(15671),o=n(43144),u=n(15861),s=n(30166),c=n(84506),l=n(11752),h=n(61120),f=n(60136),d=n(29388),v=n(97326),p=n(37762),y=n(29439),m=n(93433),g=n(4942),k=n(85854),w=n(67825),b=n(6781),Z=n(3431),I=n(23258),x={FACEBOOK:"facebook.com",GITHUB:"github.com",GOOGLE:"google.com",PASSWORD:"password",PHONE:"phone",TWITTER:"twitter.com"},_={EMAIL_SIGNIN:"EMAIL_SIGNIN",PASSWORD_RESET:"PASSWORD_RESET",RECOVER_EMAIL:"RECOVER_EMAIL",REVERT_SECOND_FACTOR_ADDITION:"REVERT_SECOND_FACTOR_ADDITION",VERIFY_AND_CHANGE_EMAIL:"VERIFY_AND_CHANGE_EMAIL",VERIFY_EMAIL:"VERIFY_EMAIL"};function T(){return(0,g.Z)({},"dependent-sdk-initialized-before-auth","Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK.")}var E=function(){var e;return e={},(0,g.Z)(e,"admin-restricted-operation","This operation is restricted to administrators only."),(0,g.Z)(e,"argument-error",""),(0,g.Z)(e,"app-not-authorized","This app, identified by the domain where it's hosted, is not authorized to use Firebase Authentication with the provided API key. Review your key configuration in the Google API console."),(0,g.Z)(e,"app-not-installed","The requested mobile application corresponding to the identifier (Android package name or iOS bundle ID) provided is not installed on this device."),(0,g.Z)(e,"captcha-check-failed","The reCAPTCHA response token provided is either invalid, expired, already used or the domain associated with it does not match the list of whitelisted domains."),(0,g.Z)(e,"code-expired","The SMS code has expired. Please re-send the verification code to try again."),(0,g.Z)(e,"cordova-not-ready","Cordova framework is not ready."),(0,g.Z)(e,"cors-unsupported","This browser is not supported."),(0,g.Z)(e,"credential-already-in-use","This credential is already associated with a different user account."),(0,g.Z)(e,"custom-token-mismatch","The custom token corresponds to a different audience."),(0,g.Z)(e,"requires-recent-login","This operation is sensitive and requires recent authentication. Log in again before retrying this request."),(0,g.Z)(e,"dependent-sdk-initialized-before-auth","Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."),(0,g.Z)(e,"dynamic-link-not-activated","Please activate Dynamic Links in the Firebase Console and agree to the terms and conditions."),(0,g.Z)(e,"email-change-needs-verification","Multi-factor users must always have a verified email."),(0,g.Z)(e,"email-already-in-use","The email address is already in use by another account."),(0,g.Z)(e,"emulator-config-failed",'Auth instance has already been used to make a network call. Auth can no longer be configured to use the emulator. Try calling "connectAuthEmulator()" sooner.'),(0,g.Z)(e,"expired-action-code","The action code has expired."),(0,g.Z)(e,"cancelled-popup-request","This operation has been cancelled due to another conflicting popup being opened."),(0,g.Z)(e,"internal-error","An internal AuthError has occurred."),(0,g.Z)(e,"invalid-app-credential","The phone verification request contains an invalid application verifier. The reCAPTCHA token response is either invalid or expired."),(0,g.Z)(e,"invalid-app-id","The mobile app identifier is not registed for the current project."),(0,g.Z)(e,"invalid-user-token","This user's credential isn't valid for this project. This can happen if the user's token has been tampered with, or if the user isn't for the project associated with this API key."),(0,g.Z)(e,"invalid-auth-event","An internal AuthError has occurred."),(0,g.Z)(e,"invalid-verification-code","The SMS verification code used to create the phone auth credential is invalid. Please resend the verification code sms and be sure to use the verification code provided by the user."),(0,g.Z)(e,"invalid-continue-uri","The continue URL provided in the request is invalid."),(0,g.Z)(e,"invalid-cordova-configuration","The following Cordova plugins must be installed to enable OAuth sign-in: cordova-plugin-buildinfo, cordova-universal-links-plugin, cordova-plugin-browsertab, cordova-plugin-inappbrowser and cordova-plugin-customurlscheme."),(0,g.Z)(e,"invalid-custom-token","The custom token format is incorrect. Please check the documentation."),(0,g.Z)(e,"invalid-dynamic-link-domain","The provided dynamic link domain is not configured or authorized for the current project."),(0,g.Z)(e,"invalid-email","The email address is badly formatted."),(0,g.Z)(e,"invalid-emulator-scheme","Emulator URL must start with a valid scheme (http:// or https://)."),(0,g.Z)(e,"invalid-api-key","Your API key is invalid, please check you have copied it correctly."),(0,g.Z)(e,"invalid-cert-hash","The SHA-1 certificate hash provided is invalid."),(0,g.Z)(e,"invalid-credential","The supplied auth credential is malformed or has expired."),(0,g.Z)(e,"invalid-message-payload","The email template corresponding to this action contains invalid characters in its message. Please fix by going to the Auth email templates section in the Firebase Console."),(0,g.Z)(e,"invalid-multi-factor-session","The request does not contain a valid proof of first factor successful sign-in."),(0,g.Z)(e,"invalid-oauth-provider","EmailAuthProvider is not supported for this operation. This operation only supports OAuth providers."),(0,g.Z)(e,"invalid-oauth-client-id","The OAuth client ID provided is either invalid or does not match the specified API key."),(0,g.Z)(e,"unauthorized-domain","This domain is not authorized for OAuth operations for your Firebase project. Edit the list of authorized domains from the Firebase console."),(0,g.Z)(e,"invalid-action-code","The action code is invalid. This can happen if the code is malformed, expired, or has already been used."),(0,g.Z)(e,"wrong-password","The password is invalid or the user does not have a password."),(0,g.Z)(e,"invalid-persistence-type","The specified persistence type is invalid. It can only be local, session or none."),(0,g.Z)(e,"invalid-phone-number","The format of the phone number provided is incorrect. Please enter the phone number in a format that can be parsed into E.164 format. E.164 phone numbers are written in the format [+][country code][subscriber number including area code]."),(0,g.Z)(e,"invalid-provider-id","The specified provider ID is invalid."),(0,g.Z)(e,"invalid-recipient-email","The email corresponding to this action failed to send as the provided recipient email address is invalid."),(0,g.Z)(e,"invalid-sender","The email template corresponding to this action contains an invalid sender email or name. Please fix by going to the Auth email templates section in the Firebase Console."),(0,g.Z)(e,"invalid-verification-id","The verification ID used to create the phone auth credential is invalid."),(0,g.Z)(e,"invalid-tenant-id","The Auth instance's tenant ID is invalid."),(0,g.Z)(e,"login-blocked","Login blocked by user-provided method: {$originalMessage}"),(0,g.Z)(e,"missing-android-pkg-name","An Android Package Name must be provided if the Android App is required to be installed."),(0,g.Z)(e,"auth-domain-config-required","Be sure to include authDomain when calling firebase.initializeApp(), by following the instructions in the Firebase console."),(0,g.Z)(e,"missing-app-credential","The phone verification request is missing an application verifier assertion. A reCAPTCHA response token needs to be provided."),(0,g.Z)(e,"missing-verification-code","The phone auth credential was created with an empty SMS verification code."),(0,g.Z)(e,"missing-continue-uri","A continue URL must be provided in the request."),(0,g.Z)(e,"missing-iframe-start","An internal AuthError has occurred."),(0,g.Z)(e,"missing-ios-bundle-id","An iOS Bundle ID must be provided if an App Store ID is provided."),(0,g.Z)(e,"missing-or-invalid-nonce","The request does not contain a valid nonce. This can occur if the SHA-256 hash of the provided raw nonce does not match the hashed nonce in the ID token payload."),(0,g.Z)(e,"missing-multi-factor-info","No second factor identifier is provided."),(0,g.Z)(e,"missing-multi-factor-session","The request is missing proof of first factor successful sign-in."),(0,g.Z)(e,"missing-phone-number","To send verification codes, provide a phone number for the recipient."),(0,g.Z)(e,"missing-verification-id","The phone auth credential was created with an empty verification ID."),(0,g.Z)(e,"app-deleted","This instance of FirebaseApp has been deleted."),(0,g.Z)(e,"multi-factor-info-not-found","The user does not have a second factor matching the identifier provided."),(0,g.Z)(e,"multi-factor-auth-required","Proof of ownership of a second factor is required to complete sign-in."),(0,g.Z)(e,"account-exists-with-different-credential","An account already exists with the same email address but different sign-in credentials. Sign in using a provider associated with this email address."),(0,g.Z)(e,"network-request-failed","A network AuthError (such as timeout, interrupted connection or unreachable host) has occurred."),(0,g.Z)(e,"no-auth-event","An internal AuthError has occurred."),(0,g.Z)(e,"no-such-provider","User was not linked to an account with the given provider."),(0,g.Z)(e,"null-user","A null user object was provided as the argument for an operation which requires a non-null user object."),(0,g.Z)(e,"operation-not-allowed","The given sign-in provider is disabled for this Firebase project. Enable it in the Firebase console, under the sign-in method tab of the Auth section."),(0,g.Z)(e,"operation-not-supported-in-this-environment",'This operation is not supported in the environment this application is running on. "location.protocol" must be http, https or chrome-extension and web storage must be enabled.'),(0,g.Z)(e,"popup-blocked","Unable to establish a connection with the popup. It may have been blocked by the browser."),(0,g.Z)(e,"popup-closed-by-user","The popup has been closed by the user before finalizing the operation."),(0,g.Z)(e,"provider-already-linked","User can only be linked to one identity for the given provider."),(0,g.Z)(e,"quota-exceeded","The project's quota for this operation has been exceeded."),(0,g.Z)(e,"redirect-cancelled-by-user","The redirect operation has been cancelled by the user before finalizing."),(0,g.Z)(e,"redirect-operation-pending","A redirect sign-in operation is already pending."),(0,g.Z)(e,"rejected-credential","The request contains malformed or mismatching credentials."),(0,g.Z)(e,"second-factor-already-in-use","The second factor is already enrolled on this account."),(0,g.Z)(e,"maximum-second-factor-count-exceeded","The maximum allowed number of second factors on a user has been exceeded."),(0,g.Z)(e,"tenant-id-mismatch","The provided tenant ID does not match the Auth instance's tenant ID"),(0,g.Z)(e,"timeout","The operation has timed out."),(0,g.Z)(e,"user-token-expired","The user's credential is no longer valid. The user must sign in again."),(0,g.Z)(e,"too-many-requests","We have blocked all requests from this device due to unusual activity. Try again later."),(0,g.Z)(e,"unauthorized-continue-uri","The domain of the continue URL is not whitelisted.  Please whitelist the domain in the Firebase console."),(0,g.Z)(e,"unsupported-first-factor","Enrolling a second factor or signing in with a multi-factor account requires sign-in with a supported first factor."),(0,g.Z)(e,"unsupported-persistence-type","The current environment does not support the specified persistence type."),(0,g.Z)(e,"unsupported-tenant-operation","This operation is not supported in a multi-tenant context."),(0,g.Z)(e,"unverified-email","The operation requires a verified email."),(0,g.Z)(e,"user-cancelled","The user did not grant your application the permissions it requested."),(0,g.Z)(e,"user-not-found","There is no user record corresponding to this identifier. The user may have been deleted."),(0,g.Z)(e,"user-disabled","The user account has been disabled by an administrator."),(0,g.Z)(e,"user-mismatch","The supplied credentials do not correspond to the previously signed in user."),(0,g.Z)(e,"user-signed-out",""),(0,g.Z)(e,"weak-password","The password must be 6 characters long or more."),(0,g.Z)(e,"web-storage-unsupported","This browser is not supported or 3rd party cookies and data may be disabled."),(0,g.Z)(e,"already-initialized","initializeAuth() has already been called with different options. To avoid this error, call initializeAuth() with the same options as when it was originally called, or call getAuth() to return the already initialized instance."),e},S=T,A=new k.LL("auth","Firebase",T()),C=new b.Yd("@firebase/auth");function N(e){if(C.logLevel<=b.in.ERROR){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];C.error.apply(C,["Auth (".concat(w.SDK_VERSION,"): ").concat(e)].concat(n))}}function D(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];throw L.apply(void 0,[e].concat(n))}function R(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return L.apply(void 0,[e].concat(n))}function O(e,t,n){var r=Object.assign(Object.assign({},S()),(0,g.Z)({},t,n));return new k.LL("auth","Firebase",r).create(t,{appName:e.name})}function P(e,t,n){if(!(t instanceof n))throw n.name!==t.constructor.name&&D(e,"argument-error"),O(e,"argument-error","Type of ".concat(t.constructor.name," does not match expected instance.")+"Did you pass a reference from a different Auth SDK?")}function L(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];if("string"!==typeof e){var i,a=n[0],o=(0,m.Z)(n.slice(1));return o[0]&&(o[0].appName=e.name),(i=e._errorFactory).create.apply(i,[a].concat((0,m.Z)(o)))}return A.create.apply(A,[e].concat(n))}function M(e,t){if(!e){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];throw L.apply(void 0,[t].concat(r))}}function F(e){var t="INTERNAL ASSERTION FAILED: "+e;throw N(t),new Error(t)}function V(e,t){e||F(t)}var U=new Map;function q(e){V(e instanceof Function,"Expected a class definition");var t=U.get(e);return t?(V(t instanceof e,"Instance stored in cache mismatched with class"),t):(t=new e,U.set(e,t),t)}function B(){var e;return"undefined"!==typeof self&&(null===(e=self.location)||void 0===e?void 0:e.href)||""}function j(){return"http:"===G()||"https:"===G()}function G(){var e;return"undefined"!==typeof self&&(null===(e=self.location)||void 0===e?void 0:e.protocol)||null}var K=function(){function e(t,n){(0,a.Z)(this,e),this.shortDelay=t,this.longDelay=n,V(n>t,"Short delay should be less than long delay!"),this.isMobile=(0,k.uI)()||(0,k.b$)()}return(0,o.Z)(e,[{key:"get",value:function(){return"undefined"!==typeof navigator&&navigator&&"onLine"in navigator&&"boolean"===typeof navigator.onLine&&(j()||(0,k.ru)()||"connection"in navigator)&&!navigator.onLine?Math.min(5e3,this.shortDelay):this.isMobile?this.longDelay:this.shortDelay}}]),e}();function z(e,t){V(e.emulator,"Emulator should always be set here");var n=e.emulator.url;return t?"".concat(n).concat(t.startsWith("/")?t.slice(1):t):n}var W=function(){function e(){(0,a.Z)(this,e)}return(0,o.Z)(e,null,[{key:"initialize",value:function(e,t,n){this.fetchImpl=e,t&&(this.headersImpl=t),n&&(this.responseImpl=n)}},{key:"fetch",value:function(){return this.fetchImpl?this.fetchImpl:"undefined"!==typeof self&&"fetch"in self?self.fetch:void F("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}},{key:"headers",value:function(){return this.headersImpl?this.headersImpl:"undefined"!==typeof self&&"Headers"in self?self.Headers:void F("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}},{key:"response",value:function(){return this.responseImpl?this.responseImpl:"undefined"!==typeof self&&"Response"in self?self.Response:void F("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}]),e}(),H=(r={},(0,g.Z)(r,"CREDENTIAL_MISMATCH","custom-token-mismatch"),(0,g.Z)(r,"MISSING_CUSTOM_TOKEN","internal-error"),(0,g.Z)(r,"INVALID_IDENTIFIER","invalid-email"),(0,g.Z)(r,"MISSING_CONTINUE_URI","internal-error"),(0,g.Z)(r,"INVALID_PASSWORD","wrong-password"),(0,g.Z)(r,"MISSING_PASSWORD","internal-error"),(0,g.Z)(r,"EMAIL_EXISTS","email-already-in-use"),(0,g.Z)(r,"PASSWORD_LOGIN_DISABLED","operation-not-allowed"),(0,g.Z)(r,"INVALID_IDP_RESPONSE","invalid-credential"),(0,g.Z)(r,"INVALID_PENDING_TOKEN","invalid-credential"),(0,g.Z)(r,"FEDERATED_USER_ID_ALREADY_LINKED","credential-already-in-use"),(0,g.Z)(r,"MISSING_REQ_TYPE","internal-error"),(0,g.Z)(r,"EMAIL_NOT_FOUND","user-not-found"),(0,g.Z)(r,"RESET_PASSWORD_EXCEED_LIMIT","too-many-requests"),(0,g.Z)(r,"EXPIRED_OOB_CODE","expired-action-code"),(0,g.Z)(r,"INVALID_OOB_CODE","invalid-action-code"),(0,g.Z)(r,"MISSING_OOB_CODE","internal-error"),(0,g.Z)(r,"CREDENTIAL_TOO_OLD_LOGIN_AGAIN","requires-recent-login"),(0,g.Z)(r,"INVALID_ID_TOKEN","invalid-user-token"),(0,g.Z)(r,"TOKEN_EXPIRED","user-token-expired"),(0,g.Z)(r,"USER_NOT_FOUND","user-token-expired"),(0,g.Z)(r,"TOO_MANY_ATTEMPTS_TRY_LATER","too-many-requests"),(0,g.Z)(r,"INVALID_CODE","invalid-verification-code"),(0,g.Z)(r,"INVALID_SESSION_INFO","invalid-verification-id"),(0,g.Z)(r,"INVALID_TEMPORARY_PROOF","invalid-credential"),(0,g.Z)(r,"MISSING_SESSION_INFO","missing-verification-id"),(0,g.Z)(r,"SESSION_EXPIRED","code-expired"),(0,g.Z)(r,"MISSING_ANDROID_PACKAGE_NAME","missing-android-pkg-name"),(0,g.Z)(r,"UNAUTHORIZED_DOMAIN","unauthorized-continue-uri"),(0,g.Z)(r,"INVALID_OAUTH_CLIENT_ID","invalid-oauth-client-id"),(0,g.Z)(r,"ADMIN_ONLY_OPERATION","admin-restricted-operation"),(0,g.Z)(r,"INVALID_MFA_PENDING_CREDENTIAL","invalid-multi-factor-session"),(0,g.Z)(r,"MFA_ENROLLMENT_NOT_FOUND","multi-factor-info-not-found"),(0,g.Z)(r,"MISSING_MFA_ENROLLMENT_ID","missing-multi-factor-info"),(0,g.Z)(r,"MISSING_MFA_PENDING_CREDENTIAL","missing-multi-factor-session"),(0,g.Z)(r,"SECOND_FACTOR_EXISTS","second-factor-already-in-use"),(0,g.Z)(r,"SECOND_FACTOR_LIMIT_EXCEEDED","maximum-second-factor-count-exceeded"),(0,g.Z)(r,"BLOCKING_FUNCTION_ERROR_RESPONSE","internal-error"),r),Q=new K(3e4,6e4);function Y(e,t){return e.tenantId&&!t.tenantId?Object.assign(Object.assign({},t),{tenantId:e.tenantId}):t}function J(e,t,n,r){return X.apply(this,arguments)}function X(){return X=(0,u.Z)((0,i.Z)().mark((function e(t,n,r,a){var o,s=arguments;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=s.length>4&&void 0!==s[4]?s[4]:{},e.abrupt("return",$(t,o,(0,u.Z)((0,i.Z)().mark((function e(){var o,u,s,c;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o={},u={},a&&("GET"===n?u=a:o={body:JSON.stringify(a)}),s=(0,k.xO)(Object.assign({key:t.config.apiKey},u)).slice(1),e.next=6,t._getAdditionalHeaders();case 6:return(c=e.sent)["Content-Type"]="application/json",t.languageCode&&(c["X-Firebase-Locale"]=t.languageCode),e.abrupt("return",W.fetch()(re(t,t.config.apiHost,r,s),Object.assign({method:n,headers:c,referrerPolicy:"no-referrer"},o)));case 10:case"end":return e.stop()}}),e)})))));case 2:case"end":return e.stop()}}),e)}))),X.apply(this,arguments)}function $(e,t,n){return ee.apply(this,arguments)}function ee(){return(ee=(0,u.Z)((0,i.Z)().mark((function e(t,n,r){var a,o,u,s,c,l,h,f,d,v;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t._canInitEmulator=!1,a=Object.assign(Object.assign({},H),n),e.prev=2,o=new ie(t),e.next=6,Promise.race([r(),o.promise]);case 6:return u=e.sent,o.clearNetworkTimeout(),e.next=10,u.json();case 10:if(!("needConfirmation"in(s=e.sent))){e.next=13;break}throw ae(t,"account-exists-with-different-credential",s);case 13:if(!u.ok||"errorMessage"in s){e.next=17;break}return e.abrupt("return",s);case 17:if(c=u.ok?s.errorMessage:s.error.message,l=c.split(" : "),h=(0,y.Z)(l,2),f=h[0],d=h[1],"FEDERATED_USER_ID_ALREADY_LINKED"!==f){e.next=23;break}throw ae(t,"credential-already-in-use",s);case 23:if("EMAIL_EXISTS"!==f){e.next=27;break}throw ae(t,"email-already-in-use",s);case 27:if("USER_DISABLED"!==f){e.next=29;break}throw ae(t,"user-disabled",s);case 29:if(v=a[f]||f.toLowerCase().replace(/[_\s]+/g,"-"),!d){e.next=34;break}throw O(t,v,d);case 34:D(t,v);case 35:e.next=42;break;case 37:if(e.prev=37,e.t0=e.catch(2),!(e.t0 instanceof k.ZR)){e.next=41;break}throw e.t0;case 41:D(t,"network-request-failed");case 42:case"end":return e.stop()}}),e,null,[[2,37]])})))).apply(this,arguments)}function te(e,t,n,r){return ne.apply(this,arguments)}function ne(){return ne=(0,u.Z)((0,i.Z)().mark((function e(t,n,r,a){var o,u,s=arguments;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=s.length>4&&void 0!==s[4]?s[4]:{},e.next=3,J(t,n,r,a,o);case 3:return"mfaPendingCredential"in(u=e.sent)&&D(t,"multi-factor-auth-required",{_serverResponse:u}),e.abrupt("return",u);case 6:case"end":return e.stop()}}),e)}))),ne.apply(this,arguments)}function re(e,t,n,r){var i="".concat(t).concat(n,"?").concat(r);return e.config.emulator?z(e.config,i):"".concat(e.config.apiScheme,"://").concat(i)}var ie=function(){function e(t){var n=this;(0,a.Z)(this,e),this.auth=t,this.timer=null,this.promise=new Promise((function(e,t){n.timer=setTimeout((function(){return t(R(n.auth,"network-request-failed"))}),Q.get())}))}return(0,o.Z)(e,[{key:"clearNetworkTimeout",value:function(){clearTimeout(this.timer)}}]),e}();function ae(e,t,n){var r={appName:e.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);var i=R(e,t,r);return i.customData._tokenResponse=n,i}function oe(e,t){return ue.apply(this,arguments)}function ue(){return(ue=(0,u.Z)((0,i.Z)().mark((function e(t,n){return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",J(t,"POST","/v1/accounts:delete",n));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function se(e,t){return ce.apply(this,arguments)}function ce(){return(ce=(0,u.Z)((0,i.Z)().mark((function e(t,n){return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",J(t,"POST","/v1/accounts:update",n));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function le(e,t){return he.apply(this,arguments)}function he(){return(he=(0,u.Z)((0,i.Z)().mark((function e(t,n){return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",J(t,"POST","/v1/accounts:lookup",n));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function fe(e){if(e)try{var t=new Date(Number(e));if(!isNaN(t.getTime()))return t.toUTCString()}catch(n){}}function de(){return de=(0,u.Z)((0,i.Z)().mark((function e(t){var n,r,a,o,u,s,c=arguments;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=c.length>1&&void 0!==c[1]&&c[1],r=(0,k.m9)(t),e.next=4,r.getIdToken(n);case 4:return a=e.sent,M((o=pe(a))&&o.exp&&o.auth_time&&o.iat,r.auth,"internal-error"),u="object"===typeof o.firebase?o.firebase:void 0,s=null===u||void 0===u?void 0:u.sign_in_provider,e.abrupt("return",{claims:o,token:a,authTime:fe(ve(o.auth_time)),issuedAtTime:fe(ve(o.iat)),expirationTime:fe(ve(o.exp)),signInProvider:s||null,signInSecondFactor:(null===u||void 0===u?void 0:u.sign_in_second_factor)||null});case 10:case"end":return e.stop()}}),e)}))),de.apply(this,arguments)}function ve(e){return 1e3*Number(e)}function pe(e){var t=e.split("."),n=(0,y.Z)(t,3),r=n[0],i=n[1],a=n[2];if(void 0===r||void 0===i||void 0===a)return N("JWT malformed, contained fewer than 3 sections"),null;try{var o=(0,k.tV)(i);return o?JSON.parse(o):(N("Failed to decode base64 JWT payload"),null)}catch(u){return N("Caught error parsing JWT payload as JSON",null===u||void 0===u?void 0:u.toString()),null}}function ye(e,t){return me.apply(this,arguments)}function me(){return me=(0,u.Z)((0,i.Z)().mark((function e(t,n){var r=arguments;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(r.length>2&&void 0!==r[2]&&r[2])){e.next=3;break}return e.abrupt("return",n);case 3:return e.prev=3,e.next=6,n;case 6:return e.abrupt("return",e.sent);case 9:if(e.prev=9,e.t0=e.catch(3),!(e.t0 instanceof k.ZR&&ge(e.t0))){e.next=15;break}if(t.auth.currentUser!==t){e.next=15;break}return e.next=15,t.auth.signOut();case 15:throw e.t0;case 16:case"end":return e.stop()}}),e,null,[[3,9]])}))),me.apply(this,arguments)}function ge(e){var t=e.code;return t==="auth/".concat("user-disabled")||t==="auth/".concat("user-token-expired")}var ke=function(){function e(t){(0,a.Z)(this,e),this.user=t,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}return(0,o.Z)(e,[{key:"_start",value:function(){this.isRunning||(this.isRunning=!0,this.schedule())}},{key:"_stop",value:function(){this.isRunning&&(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}},{key:"getInterval",value:function(e){var t;if(e){var n=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),n}this.errorBackoff=3e4;var r=(null!==(t=this.user.stsTokenManager.expirationTime)&&void 0!==t?t:0)-Date.now()-3e5;return Math.max(0,r)}},{key:"schedule",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.isRunning){var n=this.getInterval(t);this.timerId=setTimeout((0,u.Z)((0,i.Z)().mark((function t(){return(0,i.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.iteration();case 2:case"end":return t.stop()}}),t)}))),n)}}},{key:"iteration",value:function(){var e=(0,u.Z)((0,i.Z)().mark((function e(){return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.user.getIdToken(!0);case 3:e.next=9;break;case 5:return e.prev=5,e.t0=e.catch(0),(null===e.t0||void 0===e.t0?void 0:e.t0.code)==="auth/".concat("network-request-failed")&&this.schedule(!0),e.abrupt("return");case 9:this.schedule();case 10:case"end":return e.stop()}}),e,this,[[0,5]])})));return function(){return e.apply(this,arguments)}}()}]),e}(),we=function(){function e(t,n){(0,a.Z)(this,e),this.createdAt=t,this.lastLoginAt=n,this._initializeTime()}return(0,o.Z)(e,[{key:"_initializeTime",value:function(){this.lastSignInTime=fe(this.lastLoginAt),this.creationTime=fe(this.createdAt)}},{key:"_copy",value:function(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}},{key:"toJSON",value:function(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}]),e}();function be(e){return Ze.apply(this,arguments)}function Ze(){return(Ze=(0,u.Z)((0,i.Z)().mark((function e(t){var n,r,a,o,u,s,c,l,h,f,d;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.auth,e.next=3,t.getIdToken();case 3:return a=e.sent,e.next=6,ye(t,le(r,{idToken:a}));case 6:M(null===(o=e.sent)||void 0===o?void 0:o.users.length,r,"internal-error"),u=o.users[0],t._notifyReloadListener(u),s=(null===(n=u.providerUserInfo)||void 0===n?void 0:n.length)?u.providerUserInfo.map((function(e){var t=e.providerId,n=(0,Z._T)(e,["providerId"]);return{providerId:t,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}})):[],c=xe(t.providerData,s),l=t.isAnonymous,h=!(t.email&&u.passwordHash)&&!(null===c||void 0===c?void 0:c.length),f=!!l&&h,d={uid:u.localId,displayName:u.displayName||null,photoURL:u.photoUrl||null,email:u.email||null,emailVerified:u.emailVerified||!1,phoneNumber:u.phoneNumber||null,tenantId:u.tenantId||null,providerData:c,metadata:new we(u.createdAt,u.lastLoginAt),isAnonymous:f},Object.assign(t,d);case 17:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Ie(){return(Ie=(0,u.Z)((0,i.Z)().mark((function e(t){var n;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=(0,k.m9)(t),e.next=3,be(n);case 3:return e.next=5,n.auth._persistUserIfCurrent(n);case 5:n.auth._notifyListenersIfCurrent(n);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function xe(e,t){var n=e.filter((function(e){return!t.some((function(t){return t.providerId===e.providerId}))}));return[].concat((0,m.Z)(n),(0,m.Z)(t))}function _e(e,t){return Te.apply(this,arguments)}function Te(){return(Te=(0,u.Z)((0,i.Z)().mark((function e(t,n){var r;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,$(t,{},(0,u.Z)((0,i.Z)().mark((function e(){var r,a,o,u,s,c;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=(0,k.xO)({grant_type:"refresh_token",refresh_token:n}).slice(1),a=t.config,o=a.tokenApiHost,u=a.apiKey,s=re(t,o,"/v1/token","key=".concat(u)),e.next=5,t._getAdditionalHeaders();case 5:return(c=e.sent)["Content-Type"]="application/x-www-form-urlencoded",e.abrupt("return",W.fetch()(s,{method:"POST",headers:c,body:r}));case 8:case"end":return e.stop()}}),e)}))));case 2:return r=e.sent,e.abrupt("return",{accessToken:r.access_token,expiresIn:r.expires_in,refreshToken:r.refresh_token});case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Ee=function(){function e(){(0,a.Z)(this,e),this.refreshToken=null,this.accessToken=null,this.expirationTime=null}return(0,o.Z)(e,[{key:"isExpired",get:function(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}},{key:"updateFromServerResponse",value:function(e){M(e.idToken,"internal-error"),M("undefined"!==typeof e.idToken,"internal-error"),M("undefined"!==typeof e.refreshToken,"internal-error");var t="expiresIn"in e&&"undefined"!==typeof e.expiresIn?Number(e.expiresIn):function(e){var t=pe(e);return M(t,"internal-error"),M("undefined"!==typeof t.exp,"internal-error"),M("undefined"!==typeof t.iat,"internal-error"),Number(t.exp)-Number(t.iat)}(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}},{key:"getToken",value:function(){var e=(0,u.Z)((0,i.Z)().mark((function e(t){var n,r=arguments;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=r.length>1&&void 0!==r[1]&&r[1],M(!this.accessToken||this.refreshToken,t,"user-token-expired"),n||!this.accessToken||this.isExpired){e.next=4;break}return e.abrupt("return",this.accessToken);case 4:if(!this.refreshToken){e.next=8;break}return e.next=7,this.refresh(t,this.refreshToken);case 7:return e.abrupt("return",this.accessToken);case 8:return e.abrupt("return",null);case 9:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"clearRefreshToken",value:function(){this.refreshToken=null}},{key:"refresh",value:function(){var e=(0,u.Z)((0,i.Z)().mark((function e(t,n){var r,a,o,u;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_e(t,n);case 2:r=e.sent,a=r.accessToken,o=r.refreshToken,u=r.expiresIn,this.updateTokensAndExpiration(a,o,Number(u));case 7:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"updateTokensAndExpiration",value:function(e,t,n){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+1e3*n}},{key:"toJSON",value:function(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}},{key:"_assign",value:function(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}},{key:"_clone",value:function(){return Object.assign(new e,this.toJSON())}},{key:"_performRefresh",value:function(){return F("not implemented")}}],[{key:"fromJSON",value:function(t,n){var r=n.refreshToken,i=n.accessToken,a=n.expirationTime,o=new e;return r&&(M("string"===typeof r,"internal-error",{appName:t}),o.refreshToken=r),i&&(M("string"===typeof i,"internal-error",{appName:t}),o.accessToken=i),a&&(M("number"===typeof a,"internal-error",{appName:t}),o.expirationTime=a),o}}]),e}();function Se(e,t){M("string"===typeof e||"undefined"===typeof e,"internal-error",{appName:t})}var Ae=function(){function e(t){(0,a.Z)(this,e);var n=t.uid,r=t.auth,i=t.stsTokenManager,o=(0,Z._T)(t,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new ke(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=n,this.auth=r,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=o.displayName||null,this.email=o.email||null,this.emailVerified=o.emailVerified||!1,this.phoneNumber=o.phoneNumber||null,this.photoURL=o.photoURL||null,this.isAnonymous=o.isAnonymous||!1,this.tenantId=o.tenantId||null,this.providerData=o.providerData?(0,m.Z)(o.providerData):[],this.metadata=new we(o.createdAt||void 0,o.lastLoginAt||void 0)}return(0,o.Z)(e,[{key:"getIdToken",value:function(){var e=(0,u.Z)((0,i.Z)().mark((function e(t){var n;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ye(this,this.stsTokenManager.getToken(this.auth,t));case 2:if(M(n=e.sent,this.auth,"internal-error"),this.accessToken===n){e.next=9;break}return this.accessToken=n,e.next=8,this.auth._persistUserIfCurrent(this);case 8:this.auth._notifyListenersIfCurrent(this);case 9:return e.abrupt("return",n);case 10:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getIdTokenResult",value:function(e){return function(e){return de.apply(this,arguments)}(this,e)}},{key:"reload",value:function(){return function(e){return Ie.apply(this,arguments)}(this)}},{key:"_assign",value:function(e){this!==e&&(M(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map((function(e){return Object.assign({},e)})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}},{key:"_clone",value:function(t){return new e(Object.assign(Object.assign({},this),{auth:t,stsTokenManager:this.stsTokenManager._clone()}))}},{key:"_onReload",value:function(e){M(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}},{key:"_notifyReloadListener",value:function(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}},{key:"_startProactiveRefresh",value:function(){this.proactiveRefresh._start()}},{key:"_stopProactiveRefresh",value:function(){this.proactiveRefresh._stop()}},{key:"_updateTokensIfNecessary",value:function(){var e=(0,u.Z)((0,i.Z)().mark((function e(t){var n,r,a=arguments;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=a.length>1&&void 0!==a[1]&&a[1],r=!1,t.idToken&&t.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(t),r=!0),!n){e.next=6;break}return e.next=6,be(this);case 6:return e.next=8,this.auth._persistUserIfCurrent(this);case 8:r&&this.auth._notifyListenersIfCurrent(this);case 9:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"delete",value:function(){var e=(0,u.Z)((0,i.Z)().mark((function e(){var t;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getIdToken();case 2:return t=e.sent,e.next=5,ye(this,oe(this.auth,{idToken:t}));case 5:return this.stsTokenManager.clearRefreshToken(),e.abrupt("return",this.auth.signOut());case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"toJSON",value:function(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map((function(e){return Object.assign({},e)})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}},{key:"refreshToken",get:function(){return this.stsTokenManager.refreshToken||""}}],[{key:"_fromJSON",value:function(t,n){var r,i,a,o,u,s,c,l,h=null!==(r=n.displayName)&&void 0!==r?r:void 0,f=null!==(i=n.email)&&void 0!==i?i:void 0,d=null!==(a=n.phoneNumber)&&void 0!==a?a:void 0,v=null!==(o=n.photoURL)&&void 0!==o?o:void 0,p=null!==(u=n.tenantId)&&void 0!==u?u:void 0,y=null!==(s=n._redirectEventId)&&void 0!==s?s:void 0,m=null!==(c=n.createdAt)&&void 0!==c?c:void 0,g=null!==(l=n.lastLoginAt)&&void 0!==l?l:void 0,k=n.uid,w=n.emailVerified,b=n.isAnonymous,Z=n.providerData,I=n.stsTokenManager;M(k&&I,t,"internal-error");var x=Ee.fromJSON(this.name,I);M("string"===typeof k,t,"internal-error"),Se(h,t.name),Se(f,t.name),M("boolean"===typeof w,t,"internal-error"),M("boolean"===typeof b,t,"internal-error"),Se(d,t.name),Se(v,t.name),Se(p,t.name),Se(y,t.name),Se(m,t.name),Se(g,t.name);var _=new e({uid:k,auth:t,email:f,emailVerified:w,displayName:h,isAnonymous:b,photoURL:v,phoneNumber:d,tenantId:p,stsTokenManager:x,createdAt:m,lastLoginAt:g});return Z&&Array.isArray(Z)&&(_.providerData=Z.map((function(e){return Object.assign({},e)}))),y&&(_._redirectEventId=y),_}},{key:"_fromIdTokenResponse",value:function(){var t=(0,u.Z)((0,i.Z)().mark((function t(n,r){var a,o,u,s=arguments;return(0,i.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=s.length>2&&void 0!==s[2]&&s[2],(o=new Ee).updateFromServerResponse(r),u=new e({uid:r.localId,auth:n,stsTokenManager:o,isAnonymous:a}),t.next=6,be(u);case 6:return t.abrupt("return",u);case 7:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()}]),e}(),Ce=function(){function e(){(0,a.Z)(this,e),this.type="NONE",this.storage={}}return(0,o.Z)(e,[{key:"_isAvailable",value:function(){var e=(0,u.Z)((0,i.Z)().mark((function e(){return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",!0);case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"_set",value:function(){var e=(0,u.Z)((0,i.Z)().mark((function e(t,n){return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.storage[t]=n;case 1:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"_get",value:function(){var e=(0,u.Z)((0,i.Z)().mark((function e(t){var n;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.storage[t],e.abrupt("return",void 0===n?null:n);case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_remove",value:function(){var e=(0,u.Z)((0,i.Z)().mark((function e(t){return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:delete this.storage[t];case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_addListener",value:function(e,t){}},{key:"_removeListener",value:function(e,t){}}]),e}();Ce.type="NONE";var Ne=Ce;function De(e,t,n){return"firebase".concat(":",e,":").concat(t,":").concat(n)}var Re=function(){function e(t,n,r){(0,a.Z)(this,e),this.persistence=t,this.auth=n,this.userKey=r;var i=this.auth,o=i.config,u=i.name;this.fullUserKey=De(this.userKey,o.apiKey,u),this.fullPersistenceKey=De("persistence",o.apiKey,u),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}return(0,o.Z)(e,[{key:"setCurrentUser",value:function(e){return this.persistence._set(this.fullUserKey,e.toJSON())}},{key:"getCurrentUser",value:function(){var e=(0,u.Z)((0,i.Z)().mark((function e(){var t;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.persistence._get(this.fullUserKey);case 2:return t=e.sent,e.abrupt("return",t?Ae._fromJSON(this.auth,t):null);case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"removeCurrentUser",value:function(){return this.persistence._remove(this.fullUserKey)}},{key:"savePersistenceForRedirect",value:function(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}},{key:"setPersistence",value:function(){var e=(0,u.Z)((0,i.Z)().mark((function e(t){var n;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.persistence!==t){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,this.getCurrentUser();case 4:return n=e.sent,e.next=7,this.removeCurrentUser();case 7:if(this.persistence=t,!n){e.next=10;break}return e.abrupt("return",this.setCurrentUser(n));case 10:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"delete",value:function(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}}],[{key:"create",value:function(){var t=(0,u.Z)((0,i.Z)().mark((function t(n,r){var a,o,s,c,l,h,f,d,v,y,m,g=arguments;return(0,i.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a=g.length>2&&void 0!==g[2]?g[2]:"authUser",r.length){t.next=3;break}return t.abrupt("return",new e(q(Ne),n,a));case 3:return t.next=5,Promise.all(r.map(function(){var e=(0,u.Z)((0,i.Z)().mark((function e(t){return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t._isAvailable();case 2:if(!e.sent){e.next=4;break}return e.abrupt("return",t);case 4:return e.abrupt("return",void 0);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 5:o=t.sent.filter((function(e){return e})),s=o[0]||q(Ne),c=De(a,n.config.apiKey,n.name),l=null,h=(0,p.Z)(r),t.prev=10,h.s();case 12:if((f=h.n()).done){t.next=29;break}return d=f.value,t.prev=14,t.next=17,d._get(c);case 17:if(!(v=t.sent)){t.next=23;break}return y=Ae._fromJSON(n,v),d!==s&&(l=y),s=d,t.abrupt("break",29);case 23:t.next=27;break;case 25:t.prev=25,t.t0=t.catch(14);case 27:t.next=12;break;case 29:t.next=34;break;case 31:t.prev=31,t.t1=t.catch(10),h.e(t.t1);case 34:return t.prev=34,h.f(),t.finish(34);case 37:if(m=o.filter((function(e){return e._shouldAllowMigration})),s._shouldAllowMigration&&m.length){t.next=40;break}return t.abrupt("return",new e(s,n,a));case 40:if(s=m[0],!l){t.next=44;break}return t.next=44,s._set(c,l.toJSON());case 44:return t.next=46,Promise.all(r.map(function(){var e=(0,u.Z)((0,i.Z)().mark((function e(t){return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t===s){e.next=8;break}return e.prev=1,e.next=4,t._remove(c);case 4:e.next=8;break;case 6:e.prev=6,e.t0=e.catch(1);case 8:case"end":return e.stop()}}),e,null,[[1,6]])})));return function(t){return e.apply(this,arguments)}}()));case 46:return t.abrupt("return",new e(s,n,a));case 47:case"end":return t.stop()}}),t,null,[[10,31,34,37],[14,25]])})));return function(e,n){return t.apply(this,arguments)}}()}]),e}();function Oe(e){var t=e.toLowerCase();if(t.includes("opera/")||t.includes("opr/")||t.includes("opios/"))return"Opera";if(Fe(t))return"IEMobile";if(t.includes("msie")||t.includes("trident/"))return"IE";if(t.includes("edge/"))return"Edge";if(Pe(t))return"Firefox";if(t.includes("silk/"))return"Silk";if(Ue(t))return"Blackberry";if(qe(t))return"Webos";if(Le(t))return"Safari";if((t.includes("chrome/")||Me(t))&&!t.includes("edge/"))return"Chrome";if(Ve(t))return"Android";var n=e.match(/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/);return 2===(null===n||void 0===n?void 0:n.length)?n[1]:"Other"}function Pe(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:(0,k.z$)();return/firefox\//i.test(e)}function Le(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:(0,k.z$)()).toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function Me(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:(0,k.z$)();return/crios\//i.test(e)}function Fe(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:(0,k.z$)();return/iemobile/i.test(e)}function Ve(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:(0,k.z$)();return/android/i.test(e)}function Ue(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:(0,k.z$)();return/blackberry/i.test(e)}function qe(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:(0,k.z$)();return/webos/i.test(e)}function Be(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:(0,k.z$)();return/iphone|ipad|ipod/i.test(e)||/macintosh/i.test(e)&&/mobile/i.test(e)}function je(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:(0,k.z$)();return Be(e)||Ve(e)||qe(e)||Ue(e)||/windows phone/i.test(e)||Fe(e)}function Ge(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];switch(e){case"Browser":t=Oe((0,k.z$)());break;case"Worker":t="".concat(Oe((0,k.z$)()),"-").concat(e);break;default:t=e}var r=n.length?n.join(","):"FirebaseCore-web";return"".concat(t,"/","JsCore","/").concat(w.SDK_VERSION,"/").concat(r)}var Ke=function(){function e(t){(0,a.Z)(this,e),this.auth=t,this.queue=[]}return(0,o.Z)(e,[{key:"pushCallback",value:function(e,t){var n=this,r=function(t){return new Promise((function(n,r){try{n(e(t))}catch(i){r(i)}}))};r.onAbort=t,this.queue.push(r);var i=this.queue.length-1;return function(){n.queue[i]=function(){return Promise.resolve()}}}},{key:"runMiddleware",value:function(){var e=(0,u.Z)((0,i.Z)().mark((function e(t){var n,r,a,o,u,s,c;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.auth.currentUser!==t){e.next=2;break}return e.abrupt("return");case 2:n=[],e.prev=3,r=(0,p.Z)(this.queue),e.prev=5,r.s();case 7:if((a=r.n()).done){e.next=14;break}return o=a.value,e.next=11,o(t);case 11:o.onAbort&&n.push(o.onAbort);case 12:e.next=7;break;case 14:e.next=19;break;case 16:e.prev=16,e.t0=e.catch(5),r.e(e.t0);case 19:return e.prev=19,r.f(),e.finish(19);case 22:e.next=30;break;case 24:e.prev=24,e.t1=e.catch(3),n.reverse(),u=(0,p.Z)(n);try{for(u.s();!(s=u.n()).done;){c=s.value;try{c()}catch(i){}}}catch(l){u.e(l)}finally{u.f()}throw this.auth._errorFactory.create("login-blocked",{originalMessage:null===e.t1||void 0===e.t1?void 0:e.t1.message});case 30:case"end":return e.stop()}}),e,this,[[3,24],[5,16,19,22]])})));return function(t){return e.apply(this,arguments)}}()}]),e}(),ze=function(){function e(t,n,r){(0,a.Z)(this,e),this.app=t,this.heartbeatServiceProvider=n,this.config=r,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new He(this),this.idTokenSubscription=new He(this),this.beforeStateQueue=new Ke(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=A,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=t.name,this.clientVersion=r.sdkClientVersion}return(0,o.Z)(e,[{key:"_initializeWithPersistence",value:function(e,t){var n=this;return t&&(this._popupRedirectResolver=q(t)),this._initializationPromise=this.queue((0,u.Z)((0,i.Z)().mark((function r(){var a,o;return(0,i.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(!n._deleted){r.next=2;break}return r.abrupt("return");case 2:return r.next=4,Re.create(n,e);case 4:if(n.persistenceManager=r.sent,!n._deleted){r.next=7;break}return r.abrupt("return");case 7:if(!(null===(a=n._popupRedirectResolver)||void 0===a?void 0:a._shouldInitProactively)){r.next=15;break}return r.prev=8,r.next=11,n._popupRedirectResolver._initialize(n);case 11:r.next=15;break;case 13:r.prev=13,r.t0=r.catch(8);case 15:return r.next=17,n.initializeCurrentUser(t);case 17:if(n.lastNotifiedUid=(null===(o=n.currentUser)||void 0===o?void 0:o.uid)||null,!n._deleted){r.next=20;break}return r.abrupt("return");case 20:n._isInitialized=!0;case 21:case"end":return r.stop()}}),r,null,[[8,13]])})))),this._initializationPromise}},{key:"_onStorageEvent",value:function(){var e=(0,u.Z)((0,i.Z)().mark((function e(){var t;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._deleted){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,this.assertedPersistence.getCurrentUser();case 4:if(t=e.sent,this.currentUser||t){e.next=7;break}return e.abrupt("return");case 7:if(!this.currentUser||!t||this.currentUser.uid!==t.uid){e.next=12;break}return this._currentUser._assign(t),e.next=11,this.currentUser.getIdToken();case 11:return e.abrupt("return");case 12:return e.next=14,this._updateCurrentUser(t,!0);case 14:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"initializeCurrentUser",value:function(){var e=(0,u.Z)((0,i.Z)().mark((function e(t){var n,r,a,o,u,s,c;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.assertedPersistence.getCurrentUser();case 2:if(r=e.sent,a=r,o=!1,!t||!this.config.authDomain){e.next=14;break}return e.next=8,this.getOrInitRedirectPersistenceManager();case 8:return u=null===(n=this.redirectUser)||void 0===n?void 0:n._redirectEventId,s=null===a||void 0===a?void 0:a._redirectEventId,e.next=12,this.tryRedirectSignIn(t);case 12:c=e.sent,u&&u!==s||!(null===c||void 0===c?void 0:c.user)||(a=c.user,o=!0);case 14:if(a){e.next=16;break}return e.abrupt("return",this.directlySetCurrentUser(null));case 16:if(a._redirectEventId){e.next=32;break}if(!o){e.next=27;break}return e.prev=18,e.next=21,this.beforeStateQueue.runMiddleware(a);case 21:e.next=27;break;case 23:e.prev=23,e.t0=e.catch(18),a=r,this._popupRedirectResolver._overrideRedirectResult(this,(function(){return Promise.reject(e.t0)}));case 27:if(!a){e.next=31;break}return e.abrupt("return",this.reloadAndSetCurrentUserOrClear(a));case 31:return e.abrupt("return",this.directlySetCurrentUser(null));case 32:return M(this._popupRedirectResolver,this,"argument-error"),e.next=35,this.getOrInitRedirectPersistenceManager();case 35:if(!this.redirectUser||this.redirectUser._redirectEventId!==a._redirectEventId){e.next=37;break}return e.abrupt("return",this.directlySetCurrentUser(a));case 37:return e.abrupt("return",this.reloadAndSetCurrentUserOrClear(a));case 38:case"end":return e.stop()}}),e,this,[[18,23]])})));return function(t){return e.apply(this,arguments)}}()},{key:"tryRedirectSignIn",value:function(){var e=(0,u.Z)((0,i.Z)().mark((function e(t){var n;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=null,e.prev=1,e.next=4,this._popupRedirectResolver._completeRedirectFn(this,t,!0);case 4:n=e.sent,e.next=11;break;case 7:return e.prev=7,e.t0=e.catch(1),e.next=11,this._setRedirectUser(null);case 11:return e.abrupt("return",n);case 12:case"end":return e.stop()}}),e,this,[[1,7]])})));return function(t){return e.apply(this,arguments)}}()},{key:"reloadAndSetCurrentUserOrClear",value:function(){var e=(0,u.Z)((0,i.Z)().mark((function e(t){return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,be(t);case 3:e.next=9;break;case 5:if(e.prev=5,e.t0=e.catch(0),(null===e.t0||void 0===e.t0?void 0:e.t0.code)==="auth/".concat("network-request-failed")){e.next=9;break}return e.abrupt("return",this.directlySetCurrentUser(null));case 9:return e.abrupt("return",this.directlySetCurrentUser(t));case 10:case"end":return e.stop()}}),e,this,[[0,5]])})));return function(t){return e.apply(this,arguments)}}()},{key:"useDeviceLanguage",value:function(){this.languageCode=function(){if("undefined"===typeof navigator)return null;var e=navigator;return e.languages&&e.languages[0]||e.language||null}()}},{key:"_delete",value:function(){var e=(0,u.Z)((0,i.Z)().mark((function e(){return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this._deleted=!0;case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"updateCurrentUser",value:function(){var e=(0,u.Z)((0,i.Z)().mark((function e(t){var n;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(n=t?(0,k.m9)(t):null)&&M(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),e.abrupt("return",this._updateCurrentUser(n&&n._clone(this)));case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_updateCurrentUser",value:function(){var e=(0,u.Z)((0,i.Z)().mark((function e(t){var n,r=this,a=arguments;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=a.length>1&&void 0!==a[1]&&a[1],!this._deleted){e.next=3;break}return e.abrupt("return");case 3:if(t&&M(this.tenantId===t.tenantId,this,"tenant-id-mismatch"),n){e.next=7;break}return e.next=7,this.beforeStateQueue.runMiddleware(t);case 7:return e.abrupt("return",this.queue((0,u.Z)((0,i.Z)().mark((function e(){return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.directlySetCurrentUser(t);case 2:r.notifyAuthListeners();case 3:case"end":return e.stop()}}),e)})))));case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"signOut",value:function(){var e=(0,u.Z)((0,i.Z)().mark((function e(){return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.beforeStateQueue.runMiddleware(null);case 2:if(!this.redirectPersistenceManager&&!this._popupRedirectResolver){e.next=5;break}return e.next=5,this._setRedirectUser(null);case 5:return e.abrupt("return",this._updateCurrentUser(null,!0));case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"setPersistence",value:function(e){var t=this;return this.queue((0,u.Z)((0,i.Z)().mark((function n(){return(0,i.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.assertedPersistence.setPersistence(q(e));case 2:case"end":return n.stop()}}),n)}))))}},{key:"_getPersistence",value:function(){return this.assertedPersistence.persistence.type}},{key:"_updateErrorMap",value:function(e){this._errorFactory=new k.LL("auth","Firebase",e())}},{key:"onAuthStateChanged",value:function(e,t,n){return this.registerStateListener(this.authStateSubscription,e,t,n)}},{key:"beforeAuthStateChanged",value:function(e,t){return this.beforeStateQueue.pushCallback(e,t)}},{key:"onIdTokenChanged",value:function(e,t,n){return this.registerStateListener(this.idTokenSubscription,e,t,n)}},{key:"toJSON",value:function(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:null===(e=this._currentUser)||void 0===e?void 0:e.toJSON()}}},{key:"_setRedirectUser",value:function(){var e=(0,u.Z)((0,i.Z)().mark((function e(t,n){var r;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getOrInitRedirectPersistenceManager(n);case 2:return r=e.sent,e.abrupt("return",null===t?r.removeCurrentUser():r.setCurrentUser(t));case 4:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"getOrInitRedirectPersistenceManager",value:function(){var e=(0,u.Z)((0,i.Z)().mark((function e(t){var n;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.redirectPersistenceManager){e.next=9;break}return M(n=t&&q(t)||this._popupRedirectResolver,this,"argument-error"),e.next=5,Re.create(this,[q(n._redirectPersistence)],"redirectUser");case 5:return this.redirectPersistenceManager=e.sent,e.next=8,this.redirectPersistenceManager.getCurrentUser();case 8:this.redirectUser=e.sent;case 9:return e.abrupt("return",this.redirectPersistenceManager);case 10:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_redirectUserForId",value:function(){var e=(0,u.Z)((0,i.Z)().mark((function e(t){var n,r;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._isInitialized){e.next=3;break}return e.next=3,this.queue((0,u.Z)((0,i.Z)().mark((function e(){return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)}))));case 3:if((null===(n=this._currentUser)||void 0===n?void 0:n._redirectEventId)!==t){e.next=5;break}return e.abrupt("return",this._currentUser);case 5:if((null===(r=this.redirectUser)||void 0===r?void 0:r._redirectEventId)!==t){e.next=7;break}return e.abrupt("return",this.redirectUser);case 7:return e.abrupt("return",null);case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_persistUserIfCurrent",value:function(){var e=(0,u.Z)((0,i.Z)().mark((function e(t){var n=this;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t!==this.currentUser){e.next=2;break}return e.abrupt("return",this.queue((0,u.Z)((0,i.Z)().mark((function e(){return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",n.directlySetCurrentUser(t));case 1:case"end":return e.stop()}}),e)})))));case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_notifyListenersIfCurrent",value:function(e){e===this.currentUser&&this.notifyAuthListeners()}},{key:"_key",value:function(){return"".concat(this.config.authDomain,":").concat(this.config.apiKey,":").concat(this.name)}},{key:"_startProactiveRefresh",value:function(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}},{key:"_stopProactiveRefresh",value:function(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}},{key:"_currentUser",get:function(){return this.currentUser}},{key:"notifyAuthListeners",value:function(){var e,t;if(this._isInitialized){this.idTokenSubscription.next(this.currentUser);var n=null!==(t=null===(e=this.currentUser)||void 0===e?void 0:e.uid)&&void 0!==t?t:null;this.lastNotifiedUid!==n&&(this.lastNotifiedUid=n,this.authStateSubscription.next(this.currentUser))}}},{key:"registerStateListener",value:function(e,t,n,r){var i=this;if(this._deleted)return function(){};var a="function"===typeof t?t:t.next.bind(t),o=this._isInitialized?Promise.resolve():this._initializationPromise;return M(o,this,"internal-error"),o.then((function(){return a(i.currentUser)})),"function"===typeof t?e.addObserver(t,n,r):e.addObserver(t)}},{key:"directlySetCurrentUser",value:function(){var e=(0,u.Z)((0,i.Z)().mark((function e(t){return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.currentUser&&this.currentUser!==t&&this._currentUser._stopProactiveRefresh(),t&&this.isProactiveRefreshEnabled&&t._startProactiveRefresh(),this.currentUser=t,!t){e.next=8;break}return e.next=6,this.assertedPersistence.setCurrentUser(t);case 6:e.next=10;break;case 8:return e.next=10,this.assertedPersistence.removeCurrentUser();case 10:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"queue",value:function(e){return this.operations=this.operations.then(e,e),this.operations}},{key:"assertedPersistence",get:function(){return M(this.persistenceManager,this,"internal-error"),this.persistenceManager}},{key:"_logFramework",value:function(e){e&&!this.frameworks.includes(e)&&(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=Ge(this.config.clientPlatform,this._getFrameworks()))}},{key:"_getFrameworks",value:function(){return this.frameworks}},{key:"_getAdditionalHeaders",value:function(){var e=(0,u.Z)((0,i.Z)().mark((function e(){var t,n,r;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=(0,g.Z)({},"X-Client-Version",this.clientVersion),this.app.options.appId&&(n["X-Firebase-gmpid"]=this.app.options.appId),e.next=4,null===(t=this.heartbeatServiceProvider.getImmediate({optional:!0}))||void 0===t?void 0:t.getHeartbeatsHeader();case 4:return(r=e.sent)&&(n["X-Firebase-Client"]=r),e.abrupt("return",n);case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),e}();function We(e){return(0,k.m9)(e)}var He=function(){function e(t){var n=this;(0,a.Z)(this,e),this.auth=t,this.observer=null,this.addObserver=(0,k.ne)((function(e){return n.observer=e}))}return(0,o.Z)(e,[{key:"next",get:function(){return M(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}]),e}();function Qe(e,t,n){var r=We(e);M(r._canInitEmulator,r,"emulator-config-failed"),M(/^https?:\/\//.test(t),r,"invalid-emulator-scheme");var i=!!(null===n||void 0===n?void 0:n.disableWarnings),a=Ye(t),o=function(e){var t=Ye(e),n=/(\/\/)?([^?#/]+)/.exec(e.substr(t.length));if(!n)return{host:"",port:null};var r=n[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){var a=i[1];return{host:a,port:Je(r.substr(a.length+1))}}var o=r.split(":"),u=(0,y.Z)(o,2);return{host:u[0],port:Je(u[1])}}(t),u=o.host,s=o.port,c=null===s?"":":".concat(s);r.config.emulator={url:"".concat(a,"//").concat(u).concat(c,"/")},r.settings.appVerificationDisabledForTesting=!0,r.emulatorConfig=Object.freeze({host:u,port:s,protocol:a.replace(":",""),options:Object.freeze({disableWarnings:i})}),i||function(){function e(){var e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}"undefined"!==typeof console&&"function"===typeof console.info&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials.");"undefined"!==typeof window&&"undefined"!==typeof document&&("loading"===document.readyState?window.addEventListener("DOMContentLoaded",e):e())}()}function Ye(e){var t=e.indexOf(":");return t<0?"":e.substr(0,t+1)}function Je(e){if(!e)return null;var t=Number(e);return isNaN(t)?null:t}var Xe=function(){function e(t,n){(0,a.Z)(this,e),this.providerId=t,this.signInMethod=n}return(0,o.Z)(e,[{key:"toJSON",value:function(){return F("not implemented")}},{key:"_getIdTokenResponse",value:function(e){return F("not implemented")}},{key:"_linkToIdToken",value:function(e,t){return F("not implemented")}},{key:"_getReauthenticationResolver",value:function(e){return F("not implemented")}}]),e}();function $e(e,t){return et.apply(this,arguments)}function et(){return(et=(0,u.Z)((0,i.Z)().mark((function e(t,n){return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",J(t,"POST","/v1/accounts:resetPassword",Y(t,n)));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function tt(e,t){return nt.apply(this,arguments)}function nt(){return(nt=(0,u.Z)((0,i.Z)().mark((function e(t,n){return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",J(t,"POST","/v1/accounts:update",n));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function rt(e,t){return it.apply(this,arguments)}function it(){return(it=(0,u.Z)((0,i.Z)().mark((function e(t,n){return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",J(t,"POST","/v1/accounts:update",Y(t,n)));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function at(e,t){return ot.apply(this,arguments)}function ot(){return(ot=(0,u.Z)((0,i.Z)().mark((function e(t,n){return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",te(t,"POST","/v1/accounts:signInWithPassword",Y(t,n)));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ut(e,t){return st.apply(this,arguments)}function st(){return(st=(0,u.Z)((0,i.Z)().mark((function e(t,n){return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",J(t,"POST","/v1/accounts:sendOobCode",Y(t,n)));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ct(e,t){return lt.apply(this,arguments)}function lt(){return(lt=(0,u.Z)((0,i.Z)().mark((function e(t,n){return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",ut(t,n));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ht(e,t){return ft.apply(this,arguments)}function ft(){return(ft=(0,u.Z)((0,i.Z)().mark((function e(t,n){return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",ut(t,n));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function dt(e,t){return vt.apply(this,arguments)}function vt(){return(vt=(0,u.Z)((0,i.Z)().mark((function e(t,n){return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",ut(t,n));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function pt(e,t){return yt.apply(this,arguments)}function yt(){return(yt=(0,u.Z)((0,i.Z)().mark((function e(t,n){return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",ut(t,n));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function mt(e,t){return gt.apply(this,arguments)}function gt(){return(gt=(0,u.Z)((0,i.Z)().mark((function e(t,n){return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",te(t,"POST","/v1/accounts:signInWithEmailLink",Y(t,n)));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function kt(e,t){return wt.apply(this,arguments)}function wt(){return(wt=(0,u.Z)((0,i.Z)().mark((function e(t,n){return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",te(t,"POST","/v1/accounts:signInWithEmailLink",Y(t,n)));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var bt=function(e){(0,f.Z)(n,e);var t=(0,d.Z)(n);function n(e,r,i){var o,u=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;return(0,a.Z)(this,n),(o=t.call(this,"password",i))._email=e,o._password=r,o._tenantId=u,o}return(0,o.Z)(n,[{key:"toJSON",value:function(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}},{key:"_getIdTokenResponse",value:function(){var e=(0,u.Z)((0,i.Z)().mark((function e(t){return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=this.signInMethod,e.next="password"===e.t0?3:"emailLink"===e.t0?4:5;break;case 3:return e.abrupt("return",at(t,{returnSecureToken:!0,email:this._email,password:this._password}));case 4:return e.abrupt("return",mt(t,{email:this._email,oobCode:this._password}));case 5:D(t,"internal-error");case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_linkToIdToken",value:function(){var e=(0,u.Z)((0,i.Z)().mark((function e(t,n){return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=this.signInMethod,e.next="password"===e.t0?3:"emailLink"===e.t0?4:5;break;case 3:return e.abrupt("return",tt(t,{idToken:n,returnSecureToken:!0,email:this._email,password:this._password}));case 4:return e.abrupt("return",kt(t,{idToken:n,email:this._email,oobCode:this._password}));case 5:D(t,"internal-error");case 6:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"_getReauthenticationResolver",value:function(e){return this._getIdTokenResponse(e)}}],[{key:"_fromEmailAndPassword",value:function(e,t){return new n(e,t,"password")}},{key:"_fromEmailAndCode",value:function(e,t){return new n(e,t,"emailLink",arguments.length>2&&void 0!==arguments[2]?arguments[2]:null)}},{key:"fromJSON",value:function(e){var t="string"===typeof e?JSON.parse(e):e;if((null===t||void 0===t?void 0:t.email)&&(null===t||void 0===t?void 0:t.password)){if("password"===t.signInMethod)return this._fromEmailAndPassword(t.email,t.password);if("emailLink"===t.signInMethod)return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}}]),n}(Xe);function Zt(e,t){return It.apply(this,arguments)}function It(){return(It=(0,u.Z)((0,i.Z)().mark((function e(t,n){return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",te(t,"POST","/v1/accounts:signInWithIdp",Y(t,n)));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var xt=function(e){(0,f.Z)(n,e);var t=(0,d.Z)(n);function n(){var e;return(0,a.Z)(this,n),(e=t.apply(this,arguments)).pendingToken=null,e}return(0,o.Z)(n,[{key:"toJSON",value:function(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}},{key:"_getIdTokenResponse",value:function(e){return Zt(e,this.buildRequest())}},{key:"_linkToIdToken",value:function(e,t){var n=this.buildRequest();return n.idToken=t,Zt(e,n)}},{key:"_getReauthenticationResolver",value:function(e){var t=this.buildRequest();return t.autoCreate=!1,Zt(e,t)}},{key:"buildRequest",value:function(){var e={requestUri:"http://localhost",returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{var t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=(0,k.xO)(t)}return e}}],[{key:"_fromParams",value:function(e){var t=new n(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):D("argument-error"),t}},{key:"fromJSON",value:function(e){var t="string"===typeof e?JSON.parse(e):e,r=t.providerId,i=t.signInMethod,a=(0,Z._T)(t,["providerId","signInMethod"]);if(!r||!i)return null;var o=new n(r,i);return o.idToken=a.idToken||void 0,o.accessToken=a.accessToken||void 0,o.secret=a.secret,o.nonce=a.nonce,o.pendingToken=a.pendingToken||null,o}}]),n}(Xe);function _t(e,t){return Tt.apply(this,arguments)}function Tt(){return(Tt=(0,u.Z)((0,i.Z)().mark((function e(t,n){return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",J(t,"POST","/v1/accounts:sendVerificationCode",Y(t,n)));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Et(){return(Et=(0,u.Z)((0,i.Z)().mark((function e(t,n){return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",te(t,"POST","/v1/accounts:signInWithPhoneNumber",Y(t,n)));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function St(){return(St=(0,u.Z)((0,i.Z)().mark((function e(t,n){var r;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,te(t,"POST","/v1/accounts:signInWithPhoneNumber",Y(t,n));case 2:if(!(r=e.sent).temporaryProof){e.next=5;break}throw ae(t,"account-exists-with-different-credential",r);case 5:return e.abrupt("return",r);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var At=(0,g.Z)({},"USER_NOT_FOUND","user-not-found");function Ct(){return(Ct=(0,u.Z)((0,i.Z)().mark((function e(t,n){var r;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=Object.assign(Object.assign({},n),{operation:"REAUTH"}),e.abrupt("return",te(t,"POST","/v1/accounts:signInWithPhoneNumber",Y(t,r),At));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Nt=function(e){(0,f.Z)(n,e);var t=(0,d.Z)(n);function n(e){var r;return(0,a.Z)(this,n),(r=t.call(this,"phone","phone")).params=e,r}return(0,o.Z)(n,[{key:"_getIdTokenResponse",value:function(e){return function(e,t){return Et.apply(this,arguments)}(e,this._makeVerificationRequest())}},{key:"_linkToIdToken",value:function(e,t){return function(e,t){return St.apply(this,arguments)}(e,Object.assign({idToken:t},this._makeVerificationRequest()))}},{key:"_getReauthenticationResolver",value:function(e){return function(e,t){return Ct.apply(this,arguments)}(e,this._makeVerificationRequest())}},{key:"_makeVerificationRequest",value:function(){var e=this.params,t=e.temporaryProof,n=e.phoneNumber,r=e.verificationId,i=e.verificationCode;return t&&n?{temporaryProof:t,phoneNumber:n}:{sessionInfo:r,code:i}}},{key:"toJSON",value:function(){var e={providerId:this.providerId};return this.params.phoneNumber&&(e.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(e.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(e.verificationCode=this.params.verificationCode),this.params.verificationId&&(e.verificationId=this.params.verificationId),e}}],[{key:"_fromVerification",value:function(e,t){return new n({verificationId:e,verificationCode:t})}},{key:"_fromTokenResponse",value:function(e,t){return new n({phoneNumber:e,temporaryProof:t})}},{key:"fromJSON",value:function(e){"string"===typeof e&&(e=JSON.parse(e));var t=e,r=t.verificationId,i=t.verificationCode,a=t.phoneNumber,o=t.temporaryProof;return i||r||a||o?new n({verificationId:r,verificationCode:i,phoneNumber:a,temporaryProof:o}):null}}]),n}(Xe);var Dt=function(){function e(t){var n,r,i,o,u,s;(0,a.Z)(this,e);var c=(0,k.zd)((0,k.pd)(t)),l=null!==(n=c.apiKey)&&void 0!==n?n:null,h=null!==(r=c.oobCode)&&void 0!==r?r:null,f=function(e){switch(e){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}(null!==(i=c.mode)&&void 0!==i?i:null);M(l&&h&&f,"argument-error"),this.apiKey=l,this.operation=f,this.code=h,this.continueUrl=null!==(o=c.continueUrl)&&void 0!==o?o:null,this.languageCode=null!==(u=c.languageCode)&&void 0!==u?u:null,this.tenantId=null!==(s=c.tenantId)&&void 0!==s?s:null}return(0,o.Z)(e,null,[{key:"parseLink",value:function(t){var n=function(e){var t=(0,k.zd)((0,k.pd)(e)).link,n=t?(0,k.zd)((0,k.pd)(t)).deep_link_id:null,r=(0,k.zd)((0,k.pd)(e)).deep_link_id;return(r?(0,k.zd)((0,k.pd)(r)).link:null)||r||n||t||e}(t);try{return new e(n)}catch(r){return null}}}]),e}();var Rt=function(){function e(){(0,a.Z)(this,e),this.providerId=e.PROVIDER_ID}return(0,o.Z)(e,null,[{key:"credential",value:function(e,t){return bt._fromEmailAndPassword(e,t)}},{key:"credentialWithLink",value:function(e,t){var n=Dt.parseLink(t);return M(n,"argument-error"),bt._fromEmailAndCode(e,n.code,n.tenantId)}}]),e}();Rt.PROVIDER_ID="password",Rt.EMAIL_PASSWORD_SIGN_IN_METHOD="password",Rt.EMAIL_LINK_SIGN_IN_METHOD="emailLink";var Ot=function(){function e(t){(0,a.Z)(this,e),this.providerId=t,this.defaultLanguageCode=null,this.customParameters={}}return(0,o.Z)(e,[{key:"setDefaultLanguage",value:function(e){this.defaultLanguageCode=e}},{key:"setCustomParameters",value:function(e){return this.customParameters=e,this}},{key:"getCustomParameters",value:function(){return this.customParameters}}]),e}(),Pt=function(e){(0,f.Z)(n,e);var t=(0,d.Z)(n);function n(){var e;return(0,a.Z)(this,n),(e=t.apply(this,arguments)).scopes=[],e}return(0,o.Z)(n,[{key:"addScope",value:function(e){return this.scopes.includes(e)||this.scopes.push(e),this}},{key:"getScopes",value:function(){return(0,m.Z)(this.scopes)}}]),n}(Ot),Lt=function(e){(0,f.Z)(n,e);var t=(0,d.Z)(n);function n(){return(0,a.Z)(this,n),t.apply(this,arguments)}return(0,o.Z)(n,[{key:"credential",value:function(e){return this._credential(Object.assign(Object.assign({},e),{nonce:e.rawNonce}))}},{key:"_credential",value:function(e){return M(e.idToken||e.accessToken,"argument-error"),xt._fromParams(Object.assign(Object.assign({},e),{providerId:this.providerId,signInMethod:this.providerId}))}}],[{key:"credentialFromJSON",value:function(e){var t="string"===typeof e?JSON.parse(e):e;return M("providerId"in t&&"signInMethod"in t,"argument-error"),xt._fromParams(t)}},{key:"credentialFromResult",value:function(e){return n.oauthCredentialFromTaggedObject(e)}},{key:"credentialFromError",value:function(e){return n.oauthCredentialFromTaggedObject(e.customData||{})}},{key:"oauthCredentialFromTaggedObject",value:function(e){var t=e._tokenResponse;if(!t)return null;var r=t.oauthIdToken,i=t.oauthAccessToken,a=t.oauthTokenSecret,o=t.pendingToken,u=t.nonce,s=t.providerId;if(!i&&!a&&!r&&!o)return null;if(!s)return null;try{return new n(s)._credential({idToken:r,accessToken:i,nonce:u,pendingToken:o})}catch(c){return null}}}]),n}(Pt),Mt=function(e){(0,f.Z)(n,e);var t=(0,d.Z)(n);function n(){return(0,a.Z)(this,n),t.call(this,"facebook.com")}return(0,o.Z)(n,null,[{key:"credential",value:function(e){return xt._fromParams({providerId:n.PROVIDER_ID,signInMethod:n.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}},{key:"credentialFromResult",value:function(e){return n.credentialFromTaggedObject(e)}},{key:"credentialFromError",value:function(e){return n.credentialFromTaggedObject(e.customData||{})}},{key:"credentialFromTaggedObject",value:function(e){var t=e._tokenResponse;if(!t||!("oauthAccessToken"in t))return null;if(!t.oauthAccessToken)return null;try{return n.credential(t.oauthAccessToken)}catch(r){return null}}}]),n}(Pt);Mt.FACEBOOK_SIGN_IN_METHOD="facebook.com",Mt.PROVIDER_ID="facebook.com";var Ft=function(e){(0,f.Z)(n,e);var t=(0,d.Z)(n);function n(){var e;return(0,a.Z)(this,n),(e=t.call(this,"google.com")).addScope("profile"),e}return(0,o.Z)(n,null,[{key:"credential",value:function(e,t){return xt._fromParams({providerId:n.PROVIDER_ID,signInMethod:n.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}},{key:"credentialFromResult",value:function(e){return n.credentialFromTaggedObject(e)}},{key:"credentialFromError",value:function(e){return n.credentialFromTaggedObject(e.customData||{})}},{key:"credentialFromTaggedObject",value:function(e){var t=e._tokenResponse;if(!t)return null;var r=t.oauthIdToken,i=t.oauthAccessToken;if(!r&&!i)return null;try{return n.credential(r,i)}catch(a){return null}}}]),n}(Pt);Ft.GOOGLE_SIGN_IN_METHOD="google.com",Ft.PROVIDER_ID="google.com";var Vt=function(e){(0,f.Z)(n,e);var t=(0,d.Z)(n);function n(){return(0,a.Z)(this,n),t.call(this,"github.com")}return(0,o.Z)(n,null,[{key:"credential",value:function(e){return xt._fromParams({providerId:n.PROVIDER_ID,signInMethod:n.GITHUB_SIGN_IN_METHOD,accessToken:e})}},{key:"credentialFromResult",value:function(e){return n.credentialFromTaggedObject(e)}},{key:"credentialFromError",value:function(e){return n.credentialFromTaggedObject(e.customData||{})}},{key:"credentialFromTaggedObject",value:function(e){var t=e._tokenResponse;if(!t||!("oauthAccessToken"in t))return null;if(!t.oauthAccessToken)return null;try{return n.credential(t.oauthAccessToken)}catch(r){return null}}}]),n}(Pt);Vt.GITHUB_SIGN_IN_METHOD="github.com",Vt.PROVIDER_ID="github.com";var Ut=function(e){(0,f.Z)(n,e);var t=(0,d.Z)(n);function n(e,r){var i;return(0,a.Z)(this,n),(i=t.call(this,e,e)).pendingToken=r,i}return(0,o.Z)(n,[{key:"_getIdTokenResponse",value:function(e){return Zt(e,this.buildRequest())}},{key:"_linkToIdToken",value:function(e,t){var n=this.buildRequest();return n.idToken=t,Zt(e,n)}},{key:"_getReauthenticationResolver",value:function(e){var t=this.buildRequest();return t.autoCreate=!1,Zt(e,t)}},{key:"toJSON",value:function(){return{signInMethod:this.signInMethod,providerId:this.providerId,pendingToken:this.pendingToken}}},{key:"buildRequest",value:function(){return{requestUri:"http://localhost",returnSecureToken:!0,pendingToken:this.pendingToken}}}],[{key:"fromJSON",value:function(e){var t="string"===typeof e?JSON.parse(e):e,r=t.providerId,i=t.signInMethod,a=t.pendingToken;return r&&i&&a&&r===i?new n(r,a):null}},{key:"_create",value:function(e,t){return new n(e,t)}}]),n}(Xe),qt="saml.",Bt=function(e){(0,f.Z)(n,e);var t=(0,d.Z)(n);function n(e){return(0,a.Z)(this,n),M(e.startsWith(qt),"argument-error"),t.call(this,e)}return(0,o.Z)(n,null,[{key:"credentialFromResult",value:function(e){return n.samlCredentialFromTaggedObject(e)}},{key:"credentialFromError",value:function(e){return n.samlCredentialFromTaggedObject(e.customData||{})}},{key:"credentialFromJSON",value:function(e){var t=Ut.fromJSON(e);return M(t,"argument-error"),t}},{key:"samlCredentialFromTaggedObject",value:function(e){var t=e._tokenResponse;if(!t)return null;var n=t.pendingToken,r=t.providerId;if(!n||!r)return null;try{return Ut._create(r,n)}catch(i){return null}}}]),n}(Ot),jt=function(e){(0,f.Z)(n,e);var t=(0,d.Z)(n);function n(){return(0,a.Z)(this,n),t.call(this,"twitter.com")}return(0,o.Z)(n,null,[{key:"credential",value:function(e,t){return xt._fromParams({providerId:n.PROVIDER_ID,signInMethod:n.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}},{key:"credentialFromResult",value:function(e){return n.credentialFromTaggedObject(e)}},{key:"credentialFromError",value:function(e){return n.credentialFromTaggedObject(e.customData||{})}},{key:"credentialFromTaggedObject",value:function(e){var t=e._tokenResponse;if(!t)return null;var r=t.oauthAccessToken,i=t.oauthTokenSecret;if(!r||!i)return null;try{return n.credential(r,i)}catch(a){return null}}}]),n}(Pt);function Gt(e,t){return Kt.apply(this,arguments)}function Kt(){return(Kt=(0,u.Z)((0,i.Z)().mark((function e(t,n){return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",te(t,"POST","/v1/accounts:signUp",Y(t,n)));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}jt.TWITTER_SIGN_IN_METHOD="twitter.com",jt.PROVIDER_ID="twitter.com";var zt=function(){function e(t){(0,a.Z)(this,e),this.user=t.user,this.providerId=t.providerId,this._tokenResponse=t._tokenResponse,this.operationType=t.operationType}return(0,o.Z)(e,null,[{key:"_fromIdTokenResponse",value:function(){var t=(0,u.Z)((0,i.Z)().mark((function t(n,r,a){var o,u,s,c,l=arguments;return(0,i.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return o=l.length>3&&void 0!==l[3]&&l[3],t.next=3,Ae._fromIdTokenResponse(n,a,o);case 3:return u=t.sent,s=Wt(a),c=new e({user:u,providerId:s,_tokenResponse:a,operationType:r}),t.abrupt("return",c);case 7:case"end":return t.stop()}}),t)})));return function(e,n,r){return t.apply(this,arguments)}}()},{key:"_forOperation",value:function(){var t=(0,u.Z)((0,i.Z)().mark((function t(n,r,a){var o;return(0,i.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n._updateTokensIfNecessary(a,!0);case 2:return o=Wt(a),t.abrupt("return",new e({user:n,providerId:o,_tokenResponse:a,operationType:r}));case 4:case"end":return t.stop()}}),t)})));return function(e,n,r){return t.apply(this,arguments)}}()}]),e}();function Wt(e){return e.providerId?e.providerId:"phoneNumber"in e?"phone":null}function Ht(){return(Ht=(0,u.Z)((0,i.Z)().mark((function e(t){var n,r,a,o;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=We(t),e.next=3,r._initializationPromise;case 3:if(!(null===(n=r.currentUser)||void 0===n?void 0:n.isAnonymous)){e.next=5;break}return e.abrupt("return",new zt({user:r.currentUser,providerId:null,operationType:"signIn"}));case 5:return e.next=7,Gt(r,{returnSecureToken:!0});case 7:return a=e.sent,e.next=10,zt._fromIdTokenResponse(r,"signIn",a,!0);case 10:return o=e.sent,e.next=13,r._updateCurrentUser(o.user);case 13:return e.abrupt("return",o);case 14:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Qt=function(e){(0,f.Z)(n,e);var t=(0,d.Z)(n);function n(e,r,i,o){var u,s;return(0,a.Z)(this,n),(u=t.call(this,r.code,r.message)).operationType=i,u.user=o,Object.setPrototypeOf((0,v.Z)(u),n.prototype),u.customData={appName:e.name,tenantId:null!==(s=e.tenantId)&&void 0!==s?s:void 0,_serverResponse:r.customData._serverResponse,operationType:i},u}return(0,o.Z)(n,null,[{key:"_fromErrorAndOperation",value:function(e,t,r,i){return new n(e,t,r,i)}}]),n}(k.ZR);function Yt(e,t,n,r){return("reauthenticate"===t?n._getReauthenticationResolver(e):n._getIdTokenResponse(e)).catch((function(n){if(n.code==="auth/".concat("multi-factor-auth-required"))throw Qt._fromErrorAndOperation(e,n,t,r);throw n}))}function Jt(e){return new Set(e.map((function(e){return e.providerId})).filter((function(e){return!!e})))}function Xt(e,t){return $t.apply(this,arguments)}function $t(){return($t=(0,u.Z)((0,i.Z)().mark((function e(t,n){var r,a,o,u;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=(0,k.m9)(t),e.next=3,nn(!0,r,n);case 3:return e.t0=se,e.t1=r.auth,e.next=7,r.getIdToken();case 7:return e.t2=e.sent,e.t3=[n],e.t4={idToken:e.t2,deleteProvider:e.t3},e.next=12,(0,e.t0)(e.t1,e.t4);case 12:return a=e.sent,o=a.providerUserInfo,u=Jt(o||[]),r.providerData=r.providerData.filter((function(e){return u.has(e.providerId)})),u.has("phone")||(r.phoneNumber=null),e.next=19,r.auth._persistUserIfCurrent(r);case 19:return e.abrupt("return",r);case 20:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function en(e,t){return tn.apply(this,arguments)}function tn(){return tn=(0,u.Z)((0,i.Z)().mark((function e(t,n){var r,a,o=arguments;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=o.length>2&&void 0!==o[2]&&o[2],e.t0=ye,e.t1=t,e.t2=n,e.t3=t.auth,e.next=7,t.getIdToken();case 7:return e.t4=e.sent,e.t5=e.t2._linkToIdToken.call(e.t2,e.t3,e.t4),e.t6=r,e.next=12,(0,e.t0)(e.t1,e.t5,e.t6);case 12:return a=e.sent,e.abrupt("return",zt._forOperation(t,"link",a));case 14:case"end":return e.stop()}}),e)}))),tn.apply(this,arguments)}function nn(e,t,n){return rn.apply(this,arguments)}function rn(){return(rn=(0,u.Z)((0,i.Z)().mark((function e(t,n,r){var a,o;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,be(n);case 2:a=Jt(n.providerData),o=!1===t?"provider-already-linked":"no-such-provider",M(a.has(r)===t,n.auth,o);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function an(e,t){return on.apply(this,arguments)}function on(){return on=(0,u.Z)((0,i.Z)().mark((function e(t,n){var r,a,o,u,s,c,l=arguments;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=l.length>2&&void 0!==l[2]&&l[2],a=t.auth,o="reauthenticate",e.prev=3,e.next=6,ye(t,Yt(a,o,n,t),r);case 6:return M((u=e.sent).idToken,a,"internal-error"),M(s=pe(u.idToken),a,"internal-error"),c=s.sub,M(t.uid===c,a,"user-mismatch"),e.abrupt("return",zt._forOperation(t,o,u));case 15:throw e.prev=15,e.t0=e.catch(3),(null===e.t0||void 0===e.t0?void 0:e.t0.code)==="auth/".concat("user-not-found")&&D(a,"user-mismatch"),e.t0;case 19:case"end":return e.stop()}}),e,null,[[3,15]])}))),on.apply(this,arguments)}function un(e,t){return sn.apply(this,arguments)}function sn(){return sn=(0,u.Z)((0,i.Z)().mark((function e(t,n){var r,a,o,u,s=arguments;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=s.length>2&&void 0!==s[2]&&s[2],a="signIn",e.next=4,Yt(t,a,n);case 4:return o=e.sent,e.next=7,zt._fromIdTokenResponse(t,a,o);case 7:if(u=e.sent,r){e.next=11;break}return e.next=11,t._updateCurrentUser(u.user);case 11:return e.abrupt("return",u);case 12:case"end":return e.stop()}}),e)}))),sn.apply(this,arguments)}function cn(e,t){return ln.apply(this,arguments)}function ln(){return(ln=(0,u.Z)((0,i.Z)().mark((function e(t,n){return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",un(We(t),n));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function hn(e,t){return fn.apply(this,arguments)}function fn(){return(fn=(0,u.Z)((0,i.Z)().mark((function e(t,n){var r;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=(0,k.m9)(t),e.next=3,nn(!1,r,n.providerId);case 3:return e.abrupt("return",en(r,n));case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function dn(e,t){return vn.apply(this,arguments)}function vn(){return(vn=(0,u.Z)((0,i.Z)().mark((function e(t,n){return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",an((0,k.m9)(t),n));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function pn(e,t){return yn.apply(this,arguments)}function yn(){return(yn=(0,u.Z)((0,i.Z)().mark((function e(t,n){return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",te(t,"POST","/v1/accounts:signInWithCustomToken",Y(t,n)));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function mn(){return(mn=(0,u.Z)((0,i.Z)().mark((function e(t,n){var r,a,o;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=We(t),e.next=3,pn(r,{token:n,returnSecureToken:!0});case 3:return a=e.sent,e.next=6,zt._fromIdTokenResponse(r,"signIn",a);case 6:return o=e.sent,e.next=9,r._updateCurrentUser(o.user);case 9:return e.abrupt("return",o);case 10:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var gn=function(){function e(t,n){(0,a.Z)(this,e),this.factorId=t,this.uid=n.mfaEnrollmentId,this.enrollmentTime=new Date(n.enrolledAt).toUTCString(),this.displayName=n.displayName}return(0,o.Z)(e,null,[{key:"_fromServerResponse",value:function(e,t){return"phoneInfo"in t?kn._fromServerResponse(e,t):D(e,"internal-error")}}]),e}(),kn=function(e){(0,f.Z)(n,e);var t=(0,d.Z)(n);function n(e){var r;return(0,a.Z)(this,n),(r=t.call(this,"phone",e)).phoneNumber=e.phoneInfo,r}return(0,o.Z)(n,null,[{key:"_fromServerResponse",value:function(e,t){return new n(t)}}]),n}(gn);function wn(e,t,n){var r;M((null===(r=n.url)||void 0===r?void 0:r.length)>0,e,"invalid-continue-uri"),M("undefined"===typeof n.dynamicLinkDomain||n.dynamicLinkDomain.length>0,e,"invalid-dynamic-link-domain"),t.continueUrl=n.url,t.dynamicLinkDomain=n.dynamicLinkDomain,t.canHandleCodeInApp=n.handleCodeInApp,n.iOS&&(M(n.iOS.bundleId.length>0,e,"missing-ios-bundle-id"),t.iOSBundleId=n.iOS.bundleId),n.android&&(M(n.android.packageName.length>0,e,"missing-android-pkg-name"),t.androidInstallApp=n.android.installApp,t.androidMinimumVersionCode=n.android.minimumVersion,t.androidPackageName=n.android.packageName)}function bn(){return(bn=(0,u.Z)((0,i.Z)().mark((function e(t,n,r){var a,o;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=(0,k.m9)(t),o={requestType:"PASSWORD_RESET",email:n},r&&wn(a,o,r),e.next=5,ht(a,o);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Zn(){return(Zn=(0,u.Z)((0,i.Z)().mark((function e(t,n,r){return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,$e((0,k.m9)(t),{oobCode:n,newPassword:r});case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function In(){return(In=(0,u.Z)((0,i.Z)().mark((function e(t,n){return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,rt((0,k.m9)(t),{oobCode:n});case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function xn(e,t){return _n.apply(this,arguments)}function _n(){return(_n=(0,u.Z)((0,i.Z)().mark((function e(t,n){var r,a,o,u;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=(0,k.m9)(t),e.next=3,$e(r,{oobCode:n});case 3:a=e.sent,M(o=a.requestType,r,"internal-error"),e.t0=o,e.next="EMAIL_SIGNIN"===e.t0?9:"VERIFY_AND_CHANGE_EMAIL"===e.t0?10:"REVERT_SECOND_FACTOR_ADDITION"===e.t0?12:13;break;case 9:return e.abrupt("break",14);case 10:return M(a.newEmail,r,"internal-error"),e.abrupt("break",14);case 12:M(a.mfaInfo,r,"internal-error");case 13:M(a.email,r,"internal-error");case 14:return u=null,a.mfaInfo&&(u=gn._fromServerResponse(We(r),a.mfaInfo)),e.abrupt("return",{data:{email:("VERIFY_AND_CHANGE_EMAIL"===a.requestType?a.newEmail:a.email)||null,previousEmail:("VERIFY_AND_CHANGE_EMAIL"===a.requestType?a.email:a.newEmail)||null,multiFactorInfo:u},operation:o});case 17:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Tn(){return(Tn=(0,u.Z)((0,i.Z)().mark((function e(t,n){var r,a;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,xn((0,k.m9)(t),n);case 2:return r=e.sent,a=r.data,e.abrupt("return",a.email);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function En(e,t,n){return Sn.apply(this,arguments)}function Sn(){return(Sn=(0,u.Z)((0,i.Z)().mark((function e(t,n,r){var a,o,u;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=We(t),e.next=3,Gt(a,{returnSecureToken:!0,email:n,password:r});case 3:return o=e.sent,e.next=6,zt._fromIdTokenResponse(a,"signIn",o);case 6:return u=e.sent,e.next=9,a._updateCurrentUser(u.user);case 9:return e.abrupt("return",u);case 10:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function An(){return(An=(0,u.Z)((0,i.Z)().mark((function e(t,n,r){var a,o;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=(0,k.m9)(t),o={requestType:"EMAIL_SIGNIN",email:n},M(r.handleCodeInApp,a,"argument-error"),r&&wn(a,o,r),e.next=6,dt(a,o);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Cn(){return(Cn=(0,u.Z)((0,i.Z)().mark((function e(t,n,r){var a,o;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=(0,k.m9)(t),M((o=Rt.credentialWithLink(n,r||B()))._tenantId===(a.tenantId||null),a,"tenant-id-mismatch"),e.abrupt("return",cn(a,o));case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Nn(e,t){return Dn.apply(this,arguments)}function Dn(){return(Dn=(0,u.Z)((0,i.Z)().mark((function e(t,n){return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",J(t,"POST","/v1/accounts:createAuthUri",Y(t,n)));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Rn(){return(Rn=(0,u.Z)((0,i.Z)().mark((function e(t,n){var r,a,o,u;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=j()?B():"http://localhost",a={identifier:n,continueUri:r},e.next=4,Nn((0,k.m9)(t),a);case 4:return o=e.sent,u=o.signinMethods,e.abrupt("return",u||[]);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function On(){return(On=(0,u.Z)((0,i.Z)().mark((function e(t,n){var r,a,o,u;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=(0,k.m9)(t),e.next=3,t.getIdToken();case 3:return a=e.sent,o={requestType:"VERIFY_EMAIL",idToken:a},n&&wn(r.auth,o,n),e.next=8,ct(r.auth,o);case 8:if(u=e.sent,u.email===t.email){e.next=13;break}return e.next=13,t.reload();case 13:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Pn(){return(Pn=(0,u.Z)((0,i.Z)().mark((function e(t,n,r){var a,o,u,s;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=(0,k.m9)(t),e.next=3,t.getIdToken();case 3:return o=e.sent,u={requestType:"VERIFY_AND_CHANGE_EMAIL",idToken:o,newEmail:n},r&&wn(a.auth,u,r),e.next=8,pt(a.auth,u);case 8:if(s=e.sent,s.email===t.email){e.next=13;break}return e.next=13,t.reload();case 13:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Ln(e,t){return Mn.apply(this,arguments)}function Mn(){return(Mn=(0,u.Z)((0,i.Z)().mark((function e(t,n){return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",J(t,"POST","/v1/accounts:update",n));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Fn(){return(Fn=(0,u.Z)((0,i.Z)().mark((function e(t,n){var r,a,o,u,s,c,l;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=n.displayName,a=n.photoURL,void 0!==r||void 0!==a){e.next=3;break}return e.abrupt("return");case 3:return o=(0,k.m9)(t),e.next=6,o.getIdToken();case 6:return u=e.sent,s={idToken:u,displayName:r,photoUrl:a,returnSecureToken:!0},e.next=10,ye(o,Ln(o.auth,s));case 10:return c=e.sent,o.displayName=c.displayName||null,o.photoURL=c.photoUrl||null,(l=o.providerData.find((function(e){return"password"===e.providerId})))&&(l.displayName=o.displayName,l.photoURL=o.photoURL),e.next=17,o._updateTokensIfNecessary(c);case 17:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Vn(e,t,n){return Un.apply(this,arguments)}function Un(){return(Un=(0,u.Z)((0,i.Z)().mark((function e(t,n,r){var a,o,u,s;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.auth,e.next=3,t.getIdToken();case 3:return o=e.sent,u={idToken:o,returnSecureToken:!0},n&&(u.email=n),r&&(u.password=r),e.next=9,ye(t,tt(a,u));case 9:return s=e.sent,e.next=12,t._updateTokensIfNecessary(s,!0);case 12:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var qn=(0,o.Z)((function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};(0,a.Z)(this,e),this.isNewUser=t,this.providerId=n,this.profile=r})),Bn=function(e){(0,f.Z)(n,e);var t=(0,d.Z)(n);function n(e,r,i,o){var u;return(0,a.Z)(this,n),(u=t.call(this,e,r,i)).username=o,u}return(0,o.Z)(n)}(qn),jn=function(e){(0,f.Z)(n,e);var t=(0,d.Z)(n);function n(e,r){return(0,a.Z)(this,n),t.call(this,e,"facebook.com",r)}return(0,o.Z)(n)}(qn),Gn=function(e){(0,f.Z)(n,e);var t=(0,d.Z)(n);function n(e,r){return(0,a.Z)(this,n),t.call(this,e,"github.com",r,"string"===typeof(null===r||void 0===r?void 0:r.login)?null===r||void 0===r?void 0:r.login:null)}return(0,o.Z)(n)}(Bn),Kn=function(e){(0,f.Z)(n,e);var t=(0,d.Z)(n);function n(e,r){return(0,a.Z)(this,n),t.call(this,e,"google.com",r)}return(0,o.Z)(n)}(qn),zn=function(e){(0,f.Z)(n,e);var t=(0,d.Z)(n);function n(e,r,i){return(0,a.Z)(this,n),t.call(this,e,"twitter.com",r,i)}return(0,o.Z)(n)}(Bn);function Wn(e){var t=e.user,n=e._tokenResponse;return t.isAnonymous&&!n?{providerId:null,isNewUser:!1,profile:null}:function(e){var t,n;if(!e)return null;var r=e.providerId,i=e.rawUserInfo?JSON.parse(e.rawUserInfo):{},a=e.isNewUser||"identitytoolkit#SignupNewUserResponse"===e.kind;if(!r&&(null===e||void 0===e?void 0:e.idToken)){var o=null===(n=null===(t=pe(e.idToken))||void 0===t?void 0:t.firebase)||void 0===n?void 0:n.sign_in_provider;if(o)return new qn(a,"anonymous"!==o&&"custom"!==o?o:null)}if(!r)return null;switch(r){case"facebook.com":return new jn(a,i);case"github.com":return new Gn(a,i);case"google.com":return new Kn(a,i);case"twitter.com":return new zn(a,i,e.screenName||null);case"custom":case"anonymous":return new qn(a,null);default:return new qn(a,r,i)}}(n)}var Hn=function(){function e(t,n,r){(0,a.Z)(this,e),this.type=t,this.credential=n,this.auth=r}return(0,o.Z)(e,[{key:"toJSON",value:function(){var e="enroll"===this.type?"idToken":"pendingCredential";return{multiFactorSession:(0,g.Z)({},e,this.credential)}}}],[{key:"_fromIdtoken",value:function(t,n){return new e("enroll",t,n)}},{key:"_fromMfaPendingCredential",value:function(t){return new e("signin",t)}},{key:"fromJSON",value:function(t){var n,r;if(null===t||void 0===t?void 0:t.multiFactorSession){if(null===(n=t.multiFactorSession)||void 0===n?void 0:n.pendingCredential)return e._fromMfaPendingCredential(t.multiFactorSession.pendingCredential);if(null===(r=t.multiFactorSession)||void 0===r?void 0:r.idToken)return e._fromIdtoken(t.multiFactorSession.idToken)}return null}}]),e}(),Qn=function(){function e(t,n,r){(0,a.Z)(this,e),this.session=t,this.hints=n,this.signInResolver=r}return(0,o.Z)(e,[{key:"resolveSignIn",value:function(){var e=(0,u.Z)((0,i.Z)().mark((function e(t){var n;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t,e.abrupt("return",this.signInResolver(n));case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}],[{key:"_fromError",value:function(t,n){var r=We(t),a=n.customData._serverResponse,o=(a.mfaInfo||[]).map((function(e){return gn._fromServerResponse(r,e)}));M(a.mfaPendingCredential,r,"internal-error");var s=Hn._fromMfaPendingCredential(a.mfaPendingCredential);return new e(s,o,function(){var e=(0,u.Z)((0,i.Z)().mark((function e(t){var o,u,c;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t._process(r,s);case 2:o=e.sent,delete a.mfaInfo,delete a.mfaPendingCredential,u=Object.assign(Object.assign({},a),{idToken:o.idToken,refreshToken:o.refreshToken}),e.t0=n.operationType,e.next="signIn"===e.t0?9:"reauthenticate"===e.t0?15:17;break;case 9:return e.next=11,zt._fromIdTokenResponse(r,n.operationType,u);case 11:return c=e.sent,e.next=14,r._updateCurrentUser(c.user);case 14:return e.abrupt("return",c);case 15:return M(n.user,r,"internal-error"),e.abrupt("return",zt._forOperation(n.user,n.operationType,u));case 17:D(r,"internal-error");case 18:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}}]),e}();function Yn(e,t){return J(e,"POST","/v2/accounts/mfaEnrollment:start",Y(e,t))}var Jn=function(){function e(t){var n=this;(0,a.Z)(this,e),this.user=t,this.enrolledFactors=[],t._onReload((function(e){e.mfaInfo&&(n.enrolledFactors=e.mfaInfo.map((function(e){return gn._fromServerResponse(t.auth,e)})))}))}return(0,o.Z)(e,[{key:"getSession",value:function(){var e=(0,u.Z)((0,i.Z)().mark((function e(){return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=Hn,e.next=3,this.user.getIdToken();case 3:return e.t1=e.sent,e.t2=this.user.auth,e.abrupt("return",e.t0._fromIdtoken.call(e.t0,e.t1,e.t2));case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"enroll",value:function(){var e=(0,u.Z)((0,i.Z)().mark((function e(t,n){var r,a,o;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t,e.next=3,this.getSession();case 3:return a=e.sent,e.next=6,ye(this.user,r._process(this.user.auth,a,n));case 6:return o=e.sent,e.next=9,this.user._updateTokensIfNecessary(o);case 9:return e.abrupt("return",this.user.reload());case 10:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"unenroll",value:function(){var e=(0,u.Z)((0,i.Z)().mark((function e(t){var n,r,a;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n="string"===typeof t?t:t.uid,e.next=3,this.user.getIdToken();case 3:return r=e.sent,e.prev=4,e.next=7,ye(this.user,J(i=this.user.auth,"POST","/v2/accounts/mfaEnrollment:withdraw",Y(i,{idToken:r,mfaEnrollmentId:n})));case 7:return a=e.sent,this.enrolledFactors=this.enrolledFactors.filter((function(e){return e.uid!==n})),e.next=11,this.user._updateTokensIfNecessary(a);case 11:return e.next=13,this.user.reload();case 13:e.next=18;break;case 15:throw e.prev=15,e.t0=e.catch(4),e.t0;case 18:case"end":return e.stop()}var i}),e,this,[[4,15]])})));return function(t){return e.apply(this,arguments)}}()}],[{key:"_fromUser",value:function(t){return new e(t)}}]),e}(),Xn=new WeakMap;var $n="__sak",er=function(){function e(t,n){(0,a.Z)(this,e),this.storageRetriever=t,this.type=n}return(0,o.Z)(e,[{key:"_isAvailable",value:function(){try{return this.storage?(this.storage.setItem($n,"1"),this.storage.removeItem($n),Promise.resolve(!0)):Promise.resolve(!1)}catch(e){return Promise.resolve(!1)}}},{key:"_set",value:function(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}},{key:"_get",value:function(e){var t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}},{key:"_remove",value:function(e){return this.storage.removeItem(e),Promise.resolve()}},{key:"storage",get:function(){return this.storageRetriever()}}]),e}();var tr=10,nr=function(e){(0,f.Z)(n,e);var t=(0,d.Z)(n);function n(){var e;return(0,a.Z)(this,n),(e=t.call(this,(function(){return window.localStorage}),"LOCAL")).boundEventHandler=function(t,n){return e.onStorageEvent(t,n)},e.listeners={},e.localCache={},e.pollTimer=null,e.safariLocalStorageNotSynced=function(){var e=(0,k.z$)();return Le(e)||Be(e)}()&&function(){try{return!(!window||window===window.top)}catch(e){return!1}}(),e.fallbackToPolling=je(),e._shouldAllowMigration=!0,e}return(0,o.Z)(n,[{key:"forAllChangedKeys",value:function(e){for(var t=0,n=Object.keys(this.listeners);t<n.length;t++){var r=n[t],i=this.storage.getItem(r),a=this.localCache[r];i!==a&&e(r,a,i)}}},{key:"onStorageEvent",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(e.key){var r=e.key;if(n?this.detachListener():this.stopPolling(),this.safariLocalStorageNotSynced){var i=this.storage.getItem(r);if(e.newValue!==i)null!==e.newValue?this.storage.setItem(r,e.newValue):this.storage.removeItem(r);else if(this.localCache[r]===e.newValue&&!n)return}var a=function(){var e=t.storage.getItem(r);(n||t.localCache[r]!==e)&&t.notifyListeners(r,e)},o=this.storage.getItem(r);(0,k.w1)()&&10===document.documentMode&&o!==e.newValue&&e.newValue!==e.oldValue?setTimeout(a,tr):a()}else this.forAllChangedKeys((function(e,n,r){t.notifyListeners(e,r)}))}},{key:"notifyListeners",value:function(e,t){this.localCache[e]=t;var n=this.listeners[e];if(n)for(var r=0,i=Array.from(n);r<i.length;r++){(0,i[r])(t?JSON.parse(t):t)}}},{key:"startPolling",value:function(){var e=this;this.stopPolling(),this.pollTimer=setInterval((function(){e.forAllChangedKeys((function(t,n,r){e.onStorageEvent(new StorageEvent("storage",{key:t,oldValue:n,newValue:r}),!0)}))}),1e3)}},{key:"stopPolling",value:function(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}},{key:"attachListener",value:function(){window.addEventListener("storage",this.boundEventHandler)}},{key:"detachListener",value:function(){window.removeEventListener("storage",this.boundEventHandler)}},{key:"_addListener",value:function(e,t){0===Object.keys(this.listeners).length&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}},{key:"_removeListener",value:function(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&(this.detachListener(),this.stopPolling())}},{key:"_set",value:function(){var e=(0,u.Z)((0,i.Z)().mark((function e(t,r){return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,l.Z)((0,h.Z)(n.prototype),"_set",this).call(this,t,r);case 2:this.localCache[t]=JSON.stringify(r);case 3:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"_get",value:function(){var e=(0,u.Z)((0,i.Z)().mark((function e(t){var r;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,l.Z)((0,h.Z)(n.prototype),"_get",this).call(this,t);case 2:return r=e.sent,this.localCache[t]=JSON.stringify(r),e.abrupt("return",r);case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_remove",value:function(){var e=(0,u.Z)((0,i.Z)().mark((function e(t){return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,l.Z)((0,h.Z)(n.prototype),"_remove",this).call(this,t);case 2:delete this.localCache[t];case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),n}(er);nr.type="LOCAL";var rr=nr,ir=function(e){(0,f.Z)(n,e);var t=(0,d.Z)(n);function n(){return(0,a.Z)(this,n),t.call(this,(function(){return window.sessionStorage}),"SESSION")}return(0,o.Z)(n,[{key:"_addListener",value:function(e,t){}},{key:"_removeListener",value:function(e,t){}}]),n}(er);ir.type="SESSION";var ar=ir;function or(e){return Promise.all(e.map(function(){var e=(0,u.Z)((0,i.Z)().mark((function e(t){var n;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t;case 3:return n=e.sent,e.abrupt("return",{fulfilled:!0,value:n});case 7:return e.prev=7,e.t0=e.catch(0),e.abrupt("return",{fulfilled:!1,reason:e.t0});case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}()))}var ur=function(){function e(t){(0,a.Z)(this,e),this.eventTarget=t,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}return(0,o.Z)(e,[{key:"isListeningto",value:function(e){return this.eventTarget===e}},{key:"handleEvent",value:function(){var e=(0,u.Z)((0,i.Z)().mark((function e(t){var n,r,a,o,s,c,l,h;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=(n=t).data,a=r.eventId,o=r.eventType,s=r.data,null===(c=this.handlersMap[o])||void 0===c?void 0:c.size){e.next=5;break}return e.abrupt("return");case 5:return n.ports[0].postMessage({status:"ack",eventId:a,eventType:o}),l=Array.from(c).map(function(){var e=(0,u.Z)((0,i.Z)().mark((function e(t){return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",t(n.origin,s));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),e.next=9,or(l);case 9:h=e.sent,n.ports[0].postMessage({status:"done",eventId:a,eventType:o,response:h});case 11:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_subscribe",value:function(e,t){0===Object.keys(this.handlersMap).length&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}},{key:"_unsubscribe",value:function(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),t&&0!==this.handlersMap[e].size||delete this.handlersMap[e],0===Object.keys(this.handlersMap).length&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}],[{key:"_getInstance",value:function(t){var n=this.receivers.find((function(e){return e.isListeningto(t)}));if(n)return n;var r=new e(t);return this.receivers.push(r),r}}]),e}();function sr(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,n="",r=0;r<t;r++)n+=Math.floor(10*Math.random());return e+n}ur.receivers=[];var cr=function(){function e(t){(0,a.Z)(this,e),this.target=t,this.handlers=new Set}return(0,o.Z)(e,[{key:"removeMessageHandler",value:function(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}},{key:"_send",value:function(){var e=(0,u.Z)((0,i.Z)().mark((function e(t,n){var r,a,o,u,s=this,c=arguments;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=c.length>2&&void 0!==c[2]?c[2]:50,a="undefined"!==typeof MessageChannel?new MessageChannel:null){e.next=4;break}throw new Error("connection_unavailable");case 4:return e.abrupt("return",new Promise((function(e,i){var c=sr("",20);a.port1.start();var l=setTimeout((function(){i(new Error("unsupported_event"))}),r);u={messageChannel:a,onMessage:function(t){var n=t;if(n.data.eventId===c)switch(n.data.status){case"ack":clearTimeout(l),o=setTimeout((function(){i(new Error("timeout"))}),3e3);break;case"done":clearTimeout(o),e(n.data.response);break;default:clearTimeout(l),clearTimeout(o),i(new Error("invalid_response"))}}},s.handlers.add(u),a.port1.addEventListener("message",u.onMessage),s.target.postMessage({eventType:t,eventId:c,data:n},[a.port2])})).finally((function(){u&&s.removeMessageHandler(u)})));case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()}]),e}();function lr(){return window}function hr(){return"undefined"!==typeof lr().WorkerGlobalScope&&"function"===typeof lr().importScripts}function fr(){return dr.apply(this,arguments)}function dr(){return(dr=(0,u.Z)((0,i.Z)().mark((function e(){var t;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null===navigator||void 0===navigator?void 0:navigator.serviceWorker){e.next=2;break}return e.abrupt("return",null);case 2:return e.prev=2,e.next=5,navigator.serviceWorker.ready;case 5:return t=e.sent,e.abrupt("return",t.active);case 9:return e.prev=9,e.t0=e.catch(2),e.abrupt("return",null);case 12:case"end":return e.stop()}}),e,null,[[2,9]])})))).apply(this,arguments)}function vr(){var e;return(null===(e=null===navigator||void 0===navigator?void 0:navigator.serviceWorker)||void 0===e?void 0:e.controller)||null}var pr="firebaseLocalStorageDb",yr=1,mr="firebaseLocalStorage",gr="fbase_key",kr=function(){function e(t){(0,a.Z)(this,e),this.request=t}return(0,o.Z)(e,[{key:"toPromise",value:function(){var e=this;return new Promise((function(t,n){e.request.addEventListener("success",(function(){t(e.request.result)})),e.request.addEventListener("error",(function(){n(e.request.error)}))}))}}]),e}();function wr(e,t){return e.transaction([mr],t?"readwrite":"readonly").objectStore(mr)}function br(){var e=indexedDB.deleteDatabase(pr);return new kr(e).toPromise()}function Zr(){var e=indexedDB.open(pr,yr);return new Promise((function(t,n){e.addEventListener("error",(function(){n(e.error)})),e.addEventListener("upgradeneeded",(function(){var t=e.result;try{t.createObjectStore(mr,{keyPath:gr})}catch(r){n(r)}})),e.addEventListener("success",(0,u.Z)((0,i.Z)().mark((function n(){var r;return(0,i.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if((r=e.result).objectStoreNames.contains(mr)){n.next=12;break}return r.close(),n.next=5,br();case 5:return n.t0=t,n.next=8,Zr();case 8:n.t1=n.sent,(0,n.t0)(n.t1),n.next=13;break;case 12:t(r);case 13:case"end":return n.stop()}}),n)}))))}))}function Ir(e,t,n){return xr.apply(this,arguments)}function xr(){return(xr=(0,u.Z)((0,i.Z)().mark((function e(t,n,r){var a,o;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=wr(t,!0).put((a={},(0,g.Z)(a,gr,n),(0,g.Z)(a,"value",r),a)),e.abrupt("return",new kr(o).toPromise());case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function _r(e,t){return Tr.apply(this,arguments)}function Tr(){return(Tr=(0,u.Z)((0,i.Z)().mark((function e(t,n){var r,a;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=wr(t,!1).get(n),e.next=3,new kr(r).toPromise();case 3:return a=e.sent,e.abrupt("return",void 0===a?null:a.value);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Er(e,t){var n=wr(e,!0).delete(t);return new kr(n).toPromise()}var Sr=function(){function e(){(0,a.Z)(this,e),this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then((function(){}),(function(){}))}return(0,o.Z)(e,[{key:"_openDb",value:function(){var e=(0,u.Z)((0,i.Z)().mark((function e(){return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.db){e.next=2;break}return e.abrupt("return",this.db);case 2:return e.next=4,Zr();case 4:return this.db=e.sent,e.abrupt("return",this.db);case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"_withRetries",value:function(){var e=(0,u.Z)((0,i.Z)().mark((function e(t){var n,r;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=0;case 1:return e.prev=2,e.next=5,this._openDb();case 5:return r=e.sent,e.next=8,t(r);case 8:return e.abrupt("return",e.sent);case 11:if(e.prev=11,e.t0=e.catch(2),!(n++>3)){e.next=15;break}throw e.t0;case 15:this.db&&(this.db.close(),this.db=void 0);case 16:e.next=1;break;case 18:case"end":return e.stop()}}),e,this,[[2,11]])})));return function(t){return e.apply(this,arguments)}}()},{key:"initializeServiceWorkerMessaging",value:function(){var e=(0,u.Z)((0,i.Z)().mark((function e(){return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",hr()?this.initializeReceiver():this.initializeSender());case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"initializeReceiver",value:function(){var e=(0,u.Z)((0,i.Z)().mark((function e(){var t=this;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.receiver=ur._getInstance(hr()?self:null),this.receiver._subscribe("keyChanged",function(){var e=(0,u.Z)((0,i.Z)().mark((function e(n,r){var a;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t._poll();case 2:return a=e.sent,e.abrupt("return",{keyProcessed:a.includes(r.key)});case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()),this.receiver._subscribe("ping",function(){var e=(0,u.Z)((0,i.Z)().mark((function e(t,n){return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",["keyChanged"]);case 1:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}());case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"initializeSender",value:function(){var e=(0,u.Z)((0,i.Z)().mark((function e(){var t,n,r;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fr();case 2:if(this.activeServiceWorker=e.sent,this.activeServiceWorker){e.next=5;break}return e.abrupt("return");case 5:return this.sender=new cr(this.activeServiceWorker),e.next=8,this.sender._send("ping",{},800);case 8:if(r=e.sent){e.next=11;break}return e.abrupt("return");case 11:(null===(t=r[0])||void 0===t?void 0:t.fulfilled)&&(null===(n=r[0])||void 0===n?void 0:n.value.includes("keyChanged"))&&(this.serviceWorkerReceiverAvailable=!0);case 12:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"notifyServiceWorker",value:function(){var e=(0,u.Z)((0,i.Z)().mark((function e(t){return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.sender&&this.activeServiceWorker&&vr()===this.activeServiceWorker){e.next=2;break}return e.abrupt("return");case 2:return e.prev=2,e.next=5,this.sender._send("keyChanged",{key:t},this.serviceWorkerReceiverAvailable?800:50);case 5:e.next=9;break;case 7:e.prev=7,e.t0=e.catch(2);case 9:case"end":return e.stop()}}),e,this,[[2,7]])})));return function(t){return e.apply(this,arguments)}}()},{key:"_isAvailable",value:function(){var e=(0,u.Z)((0,i.Z)().mark((function e(){var t;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,indexedDB){e.next=3;break}return e.abrupt("return",!1);case 3:return e.next=5,Zr();case 5:return t=e.sent,e.next=8,Ir(t,$n,"1");case 8:return e.next=10,Er(t,$n);case 10:return e.abrupt("return",!0);case 13:e.prev=13,e.t0=e.catch(0);case 15:return e.abrupt("return",!1);case 16:case"end":return e.stop()}}),e,null,[[0,13]])})));return function(){return e.apply(this,arguments)}}()},{key:"_withPendingWrite",value:function(){var e=(0,u.Z)((0,i.Z)().mark((function e(t){return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.pendingWrites++,e.prev=1,e.next=4,t();case 4:return e.prev=4,this.pendingWrites--,e.finish(4);case 7:case"end":return e.stop()}}),e,this,[[1,,4,7]])})));return function(t){return e.apply(this,arguments)}}()},{key:"_set",value:function(){var e=(0,u.Z)((0,i.Z)().mark((function e(t,n){var r=this;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this._withPendingWrite((0,u.Z)((0,i.Z)().mark((function e(){return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r._withRetries((function(e){return Ir(e,t,n)}));case 2:return r.localCache[t]=n,e.abrupt("return",r.notifyServiceWorker(t));case 4:case"end":return e.stop()}}),e)})))));case 1:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"_get",value:function(){var e=(0,u.Z)((0,i.Z)().mark((function e(t){var n;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._withRetries((function(e){return _r(e,t)}));case 2:return n=e.sent,this.localCache[t]=n,e.abrupt("return",n);case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_remove",value:function(){var e=(0,u.Z)((0,i.Z)().mark((function e(t){var n=this;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this._withPendingWrite((0,u.Z)((0,i.Z)().mark((function e(){return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n._withRetries((function(e){return Er(e,t)}));case 2:return delete n.localCache[t],e.abrupt("return",n.notifyServiceWorker(t));case 4:case"end":return e.stop()}}),e)})))));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_poll",value:function(){var e=(0,u.Z)((0,i.Z)().mark((function e(){var t,n,r,a,o,u,s,c,l,h,f;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._withRetries((function(e){var t=wr(e,!1).getAll();return new kr(t).toPromise()}));case 2:if(t=e.sent){e.next=5;break}return e.abrupt("return",[]);case 5:if(0===this.pendingWrites){e.next=7;break}return e.abrupt("return",[]);case 7:n=[],r=new Set,a=(0,p.Z)(t);try{for(a.s();!(o=a.n()).done;)u=o.value,s=u.fbase_key,c=u.value,r.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(c)&&(this.notifyListeners(s,c),n.push(s))}catch(i){a.e(i)}finally{a.f()}for(l=0,h=Object.keys(this.localCache);l<h.length;l++)f=h[l],this.localCache[f]&&!r.has(f)&&(this.notifyListeners(f,null),n.push(f));return e.abrupt("return",n);case 13:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"notifyListeners",value:function(e,t){this.localCache[e]=t;var n=this.listeners[e];if(n)for(var r=0,i=Array.from(n);r<i.length;r++){(0,i[r])(t)}}},{key:"startPolling",value:function(){var e=this;this.stopPolling(),this.pollTimer=setInterval((0,u.Z)((0,i.Z)().mark((function t(){return(0,i.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e._poll());case 1:case"end":return t.stop()}}),t)}))),800)}},{key:"stopPolling",value:function(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}},{key:"_addListener",value:function(e,t){0===Object.keys(this.listeners).length&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}},{key:"_removeListener",value:function(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&this.stopPolling()}}]),e}();Sr.type="LOCAL";var Ar=Sr;function Cr(e,t){return J(e,"POST","/v2/accounts/mfaSignIn:start",Y(e,t))}function Nr(e){return Dr.apply(this,arguments)}function Dr(){return(Dr=(0,u.Z)((0,i.Z)().mark((function e(t){return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,J(t,"GET","/v1/recaptchaParams");case 2:if(e.t0=e.sent.recaptchaSiteKey,e.t0){e.next=5;break}e.t0="";case 5:return e.abrupt("return",e.t0);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Rr(e){return new Promise((function(t,n){var r=document.createElement("script");r.setAttribute("src",e),r.onload=t,r.onerror=function(e){var t=R("internal-error");t.customData=e,n(t)},r.type="text/javascript",r.charset="UTF-8",function(){var e,t;return null!==(t=null===(e=document.getElementsByTagName("head"))||void 0===e?void 0:e[0])&&void 0!==t?t:document}().appendChild(r)}))}function Or(e){return"__".concat(e).concat(Math.floor(1e6*Math.random()))}var Pr=1e12,Lr=function(){function e(t){(0,a.Z)(this,e),this.auth=t,this.counter=Pr,this._widgets=new Map}return(0,o.Z)(e,[{key:"render",value:function(e,t){var n=this.counter;return this._widgets.set(n,new Mr(e,this.auth.name,t||{})),this.counter++,n}},{key:"reset",value:function(e){var t,n=e||Pr;null===(t=this._widgets.get(n))||void 0===t||t.delete(),this._widgets.delete(n)}},{key:"getResponse",value:function(e){var t,n=e||Pr;return(null===(t=this._widgets.get(n))||void 0===t?void 0:t.getResponse())||""}},{key:"execute",value:function(){var e=(0,u.Z)((0,i.Z)().mark((function e(t){var n,r;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t||Pr,null===(n=this._widgets.get(r))||void 0===n||n.execute(),e.abrupt("return","");case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),e}(),Mr=function(){function e(t,n,r){var i=this;(0,a.Z)(this,e),this.params=r,this.timerId=null,this.deleted=!1,this.responseToken=null,this.clickHandler=function(){i.execute()};var o="string"===typeof t?document.getElementById(t):t;M(o,"argument-error",{appName:n}),this.container=o,this.isVisible="invisible"!==this.params.size,this.isVisible?this.execute():this.container.addEventListener("click",this.clickHandler)}return(0,o.Z)(e,[{key:"getResponse",value:function(){return this.checkIfDeleted(),this.responseToken}},{key:"delete",value:function(){this.checkIfDeleted(),this.deleted=!0,this.timerId&&(clearTimeout(this.timerId),this.timerId=null),this.container.removeEventListener("click",this.clickHandler)}},{key:"execute",value:function(){var e=this;this.checkIfDeleted(),this.timerId||(this.timerId=window.setTimeout((function(){e.responseToken=function(e){for(var t=[],n="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ",r=0;r<e;r++)t.push(n.charAt(Math.floor(Math.random()*n.length)));return t.join("")}(50);var t=e.params,n=t.callback,r=t["expired-callback"];if(n)try{n(e.responseToken)}catch(i){}e.timerId=window.setTimeout((function(){if(e.timerId=null,e.responseToken=null,r)try{r()}catch(i){}e.isVisible&&e.execute()}),6e4)}),500))}},{key:"checkIfDeleted",value:function(){if(this.deleted)throw new Error("reCAPTCHA mock was already deleted!")}}]),e}();var Fr=Or("rcb"),Vr=new K(3e4,6e4),Ur="https://www.google.com/recaptcha/api.js?",qr=function(){function e(){var t;(0,a.Z)(this,e),this.hostLanguage="",this.counter=0,this.librarySeparatelyLoaded=!!(null===(t=lr().grecaptcha)||void 0===t?void 0:t.render)}return(0,o.Z)(e,[{key:"load",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return M(function(e){return e.length<=6&&/^\s*[a-zA-Z0-9\-]*\s*$/.test(e)}(n),e,"argument-error"),this.shouldResolveImmediately(n)?Promise.resolve(lr().grecaptcha):new Promise((function(r,i){var a=lr().setTimeout((function(){i(R(e,"network-request-failed"))}),Vr.get());lr()[Fr]=function(){lr().clearTimeout(a),delete lr()[Fr];var o=lr().grecaptcha;if(o){var u=o.render;o.render=function(e,n){var r=u(e,n);return t.counter++,r},t.hostLanguage=n,r(o)}else i(R(e,"internal-error"))},Rr("".concat(Ur,"?").concat((0,k.xO)({onload:Fr,render:"explicit",hl:n}))).catch((function(){clearTimeout(a),i(R(e,"internal-error"))}))}))}},{key:"clearedOneInstance",value:function(){this.counter--}},{key:"shouldResolveImmediately",value:function(e){var t;return!!(null===(t=lr().grecaptcha)||void 0===t?void 0:t.render)&&(e===this.hostLanguage||this.counter>0||this.librarySeparatelyLoaded)}}]),e}();var Br=function(){function e(){(0,a.Z)(this,e)}return(0,o.Z)(e,[{key:"load",value:function(){var e=(0,u.Z)((0,i.Z)().mark((function e(t){return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Lr(t));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"clearedOneInstance",value:function(){}}]),e}(),jr="recaptcha",Gr={theme:"light",type:"image"},Kr=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Object.assign({},Gr),r=arguments.length>2?arguments[2]:void 0;(0,a.Z)(this,e),this.parameters=n,this.type=jr,this.destroyed=!1,this.widgetId=null,this.tokenChangeListeners=new Set,this.renderPromise=null,this.recaptcha=null,this.auth=We(r),this.isInvisible="invisible"===this.parameters.size,M("undefined"!==typeof document,this.auth,"operation-not-supported-in-this-environment");var i="string"===typeof t?document.getElementById(t):t;M(i,this.auth,"argument-error"),this.container=i,this.parameters.callback=this.makeTokenCallback(this.parameters.callback),this._recaptchaLoader=this.auth.settings.appVerificationDisabledForTesting?new Br:new qr,this.validateStartingState()}return(0,o.Z)(e,[{key:"verify",value:function(){var e=(0,u.Z)((0,i.Z)().mark((function e(){var t,n,r,a=this;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.assertNotDestroyed(),e.next=3,this.render();case 3:if(t=e.sent,n=this.getAssertedRecaptcha(),!(r=n.getResponse(t))){e.next=8;break}return e.abrupt("return",r);case 8:return e.abrupt("return",new Promise((function(e){a.tokenChangeListeners.add((function t(n){n&&(a.tokenChangeListeners.delete(t),e(n))})),a.isInvisible&&n.execute(t)})));case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this;try{this.assertNotDestroyed()}catch(t){return Promise.reject(t)}return this.renderPromise||(this.renderPromise=this.makeRenderPromise().catch((function(t){throw e.renderPromise=null,t}))),this.renderPromise}},{key:"_reset",value:function(){this.assertNotDestroyed(),null!==this.widgetId&&this.getAssertedRecaptcha().reset(this.widgetId)}},{key:"clear",value:function(){var e=this;this.assertNotDestroyed(),this.destroyed=!0,this._recaptchaLoader.clearedOneInstance(),this.isInvisible||this.container.childNodes.forEach((function(t){e.container.removeChild(t)}))}},{key:"validateStartingState",value:function(){M(!this.parameters.sitekey,this.auth,"argument-error"),M(this.isInvisible||!this.container.hasChildNodes(),this.auth,"argument-error"),M("undefined"!==typeof document,this.auth,"operation-not-supported-in-this-environment")}},{key:"makeTokenCallback",value:function(e){var t=this;return function(n){if(t.tokenChangeListeners.forEach((function(e){return e(n)})),"function"===typeof e)e(n);else if("string"===typeof e){var r=lr()[e];"function"===typeof r&&r(n)}}}},{key:"assertNotDestroyed",value:function(){M(!this.destroyed,this.auth,"internal-error")}},{key:"makeRenderPromise",value:function(){var e=(0,u.Z)((0,i.Z)().mark((function e(){var t,n;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.init();case 2:return this.widgetId||(t=this.container,this.isInvisible||(n=document.createElement("div"),t.appendChild(n),t=n),this.widgetId=this.getAssertedRecaptcha().render(t,this.parameters)),e.abrupt("return",this.widgetId);case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"init",value:function(){var e=(0,u.Z)((0,i.Z)().mark((function e(){var t;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return M(j()&&!hr(),this.auth,"internal-error"),e.next=3,zr();case 3:return e.next=5,this._recaptchaLoader.load(this.auth,this.auth.languageCode||void 0);case 5:return this.recaptcha=e.sent,e.next=8,Nr(this.auth);case 8:M(t=e.sent,this.auth,"internal-error"),this.parameters.sitekey=t;case 11:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getAssertedRecaptcha",value:function(){return M(this.recaptcha,this.auth,"internal-error"),this.recaptcha}}]),e}();function zr(){var e=null;return new Promise((function(t){"complete"!==document.readyState?(e=function(){return t()},window.addEventListener("load",e)):t()})).catch((function(t){throw e&&window.removeEventListener("load",e),t}))}var Wr=function(){function e(t,n){(0,a.Z)(this,e),this.verificationId=t,this.onConfirmation=n}return(0,o.Z)(e,[{key:"confirm",value:function(e){var t=Nt._fromVerification(this.verificationId,e);return this.onConfirmation(t)}}]),e}();function Hr(){return(Hr=(0,u.Z)((0,i.Z)().mark((function e(t,n,r){var a,o;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=We(t),e.next=3,Xr(a,n,(0,k.m9)(r));case 3:return o=e.sent,e.abrupt("return",new Wr(o,(function(e){return cn(a,e)})));case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Qr(e,t,n){return Yr.apply(this,arguments)}function Yr(){return(Yr=(0,u.Z)((0,i.Z)().mark((function e(t,n,r){var a,o;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=(0,k.m9)(t),e.next=3,nn(!1,a,"phone");case 3:return e.next=5,Xr(a.auth,n,(0,k.m9)(r));case 5:return o=e.sent,e.abrupt("return",new Wr(o,(function(e){return hn(a,e)})));case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Jr(){return(Jr=(0,u.Z)((0,i.Z)().mark((function e(t,n,r){var a,o;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=(0,k.m9)(t),e.next=3,Xr(a.auth,n,(0,k.m9)(r));case 3:return o=e.sent,e.abrupt("return",new Wr(o,(function(e){return dn(a,e)})));case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Xr(e,t,n){return $r.apply(this,arguments)}function $r(){return($r=(0,u.Z)((0,i.Z)().mark((function e(t,n,r){var a,o,u,s,c,l,h,f,d;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.verify();case 2:if(o=e.sent,e.prev=3,M("string"===typeof o,t,"argument-error"),M(r.type===jr,t,"argument-error"),!("session"in(u="string"===typeof n?{phoneNumber:n}:n))){e.next=26;break}if(s=u.session,!("phoneNumber"in u)){e.next=17;break}return M("enroll"===s.type,t,"internal-error"),e.next=13,Yn(t,{idToken:s.credential,phoneEnrollmentInfo:{phoneNumber:u.phoneNumber,recaptchaToken:o}});case 13:return c=e.sent,e.abrupt("return",c.phoneSessionInfo.sessionInfo);case 17:return M("signin"===s.type,t,"internal-error"),M(l=(null===(a=u.multiFactorHint)||void 0===a?void 0:a.uid)||u.multiFactorUid,t,"missing-multi-factor-info"),e.next=22,Cr(t,{mfaPendingCredential:s.credential,mfaEnrollmentId:l,phoneSignInInfo:{recaptchaToken:o}});case 22:return h=e.sent,e.abrupt("return",h.phoneResponseInfo.sessionInfo);case 24:e.next=31;break;case 26:return e.next=28,_t(t,{phoneNumber:u.phoneNumber,recaptchaToken:o});case 28:return f=e.sent,d=f.sessionInfo,e.abrupt("return",d);case 31:return e.prev=31,r._reset(),e.finish(31);case 34:case"end":return e.stop()}}),e,null,[[3,,31,34]])})))).apply(this,arguments)}function ei(){return(ei=(0,u.Z)((0,i.Z)().mark((function e(t,n){return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,en((0,k.m9)(t),n);case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var ti=function(){function e(t){(0,a.Z)(this,e),this.providerId=e.PROVIDER_ID,this.auth=We(t)}return(0,o.Z)(e,[{key:"verifyPhoneNumber",value:function(e,t){return Xr(this.auth,e,(0,k.m9)(t))}}],[{key:"credential",value:function(e,t){return Nt._fromVerification(e,t)}},{key:"credentialFromResult",value:function(t){var n=t;return e.credentialFromTaggedObject(n)}},{key:"credentialFromError",value:function(t){return e.credentialFromTaggedObject(t.customData||{})}},{key:"credentialFromTaggedObject",value:function(e){var t=e._tokenResponse;if(!t)return null;var n=t.phoneNumber,r=t.temporaryProof;return n&&r?Nt._fromTokenResponse(n,r):null}}]),e}();function ni(e,t){return t?q(t):(M(e._popupRedirectResolver,e,"argument-error"),e._popupRedirectResolver)}ti.PROVIDER_ID="phone",ti.PHONE_SIGN_IN_METHOD="phone";var ri=function(e){(0,f.Z)(n,e);var t=(0,d.Z)(n);function n(e){var r;return(0,a.Z)(this,n),(r=t.call(this,"custom","custom")).params=e,r}return(0,o.Z)(n,[{key:"_getIdTokenResponse",value:function(e){return Zt(e,this._buildIdpRequest())}},{key:"_linkToIdToken",value:function(e,t){return Zt(e,this._buildIdpRequest(t))}},{key:"_getReauthenticationResolver",value:function(e){return Zt(e,this._buildIdpRequest())}},{key:"_buildIdpRequest",value:function(e){var t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}]),n}(Xe);function ii(e){return un(e.auth,new ri(e),e.bypassAuthState)}function ai(e){var t=e.auth,n=e.user;return M(n,t,"internal-error"),an(n,new ri(e),e.bypassAuthState)}function oi(e){return ui.apply(this,arguments)}function ui(){return(ui=(0,u.Z)((0,i.Z)().mark((function e(t){var n,r;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.auth,M(r=t.user,n,"internal-error"),e.abrupt("return",en(r,new ri(t),t.bypassAuthState));case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var si=function(){function e(t,n,r,i){var o=arguments.length>4&&void 0!==arguments[4]&&arguments[4];(0,a.Z)(this,e),this.auth=t,this.resolver=r,this.user=i,this.bypassAuthState=o,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}return(0,o.Z)(e,[{key:"execute",value:function(){var e=this;return new Promise(function(){var t=(0,u.Z)((0,i.Z)().mark((function t(n,r){return(0,i.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.pendingPromise={resolve:n,reject:r},t.prev=1,t.next=4,e.resolver._initialize(e.auth);case 4:return e.eventManager=t.sent,t.next=7,e.onExecution();case 7:e.eventManager.registerConsumer(e),t.next=13;break;case 10:t.prev=10,t.t0=t.catch(1),e.reject(t.t0);case 13:case"end":return t.stop()}}),t,null,[[1,10]])})));return function(e,n){return t.apply(this,arguments)}}())}},{key:"onAuthEvent",value:function(){var e=(0,u.Z)((0,i.Z)().mark((function e(t){var n,r,a,o,u,s,c;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.urlResponse,r=t.sessionId,a=t.postBody,o=t.tenantId,u=t.error,s=t.type,!u){e.next=4;break}return this.reject(u),e.abrupt("return");case 4:return c={auth:this.auth,requestUri:n,sessionId:r,tenantId:o||void 0,postBody:a||void 0,user:this.user,bypassAuthState:this.bypassAuthState},e.prev=5,e.t0=this,e.next=9,this.getIdpTask(s)(c);case 9:e.t1=e.sent,e.t0.resolve.call(e.t0,e.t1),e.next=16;break;case 13:e.prev=13,e.t2=e.catch(5),this.reject(e.t2);case 16:case"end":return e.stop()}}),e,this,[[5,13]])})));return function(t){return e.apply(this,arguments)}}()},{key:"onError",value:function(e){this.reject(e)}},{key:"getIdpTask",value:function(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return ii;case"linkViaPopup":case"linkViaRedirect":return oi;case"reauthViaPopup":case"reauthViaRedirect":return ai;default:D(this.auth,"internal-error")}}},{key:"resolve",value:function(e){V(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}},{key:"reject",value:function(e){V(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}},{key:"unregisterAndCleanUp",value:function(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}]),e}(),ci=new K(2e3,1e4);function li(e,t,n){return hi.apply(this,arguments)}function hi(){return(hi=(0,u.Z)((0,i.Z)().mark((function e(t,n,r){var a,o,u;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=We(t),P(t,n,Ot),o=ni(a,r),u=new pi(a,"signInViaPopup",n,o),e.abrupt("return",u.executeNotNull());case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function fi(){return(fi=(0,u.Z)((0,i.Z)().mark((function e(t,n,r){var a,o,u;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return P((a=(0,k.m9)(t)).auth,n,Ot),o=ni(a.auth,r),u=new pi(a.auth,"reauthViaPopup",n,o,a),e.abrupt("return",u.executeNotNull());case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function di(e,t,n){return vi.apply(this,arguments)}function vi(){return(vi=(0,u.Z)((0,i.Z)().mark((function e(t,n,r){var a,o,u;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return P((a=(0,k.m9)(t)).auth,n,Ot),o=ni(a.auth,r),u=new pi(a.auth,"linkViaPopup",n,o,a),e.abrupt("return",u.executeNotNull());case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var pi=function(e){(0,f.Z)(n,e);var t=(0,d.Z)(n);function n(e,r,i,o,u){var s;return(0,a.Z)(this,n),(s=t.call(this,e,r,o,u)).provider=i,s.authWindow=null,s.pollId=null,n.currentPopupAction&&n.currentPopupAction.cancel(),n.currentPopupAction=(0,v.Z)(s),s}return(0,o.Z)(n,[{key:"executeNotNull",value:function(){var e=(0,u.Z)((0,i.Z)().mark((function e(){var t;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.execute();case 2:return M(t=e.sent,this.auth,"internal-error"),e.abrupt("return",t);case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"onExecution",value:function(){var e=(0,u.Z)((0,i.Z)().mark((function e(){var t,n=this;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return V(1===this.filter.length,"Popup operations only handle one event"),t=sr(),e.next=4,this.resolver._openPopup(this.auth,this.provider,this.filter[0],t);case 4:this.authWindow=e.sent,this.authWindow.associatedEvent=t,this.resolver._originValidation(this.auth).catch((function(e){n.reject(e)})),this.resolver._isIframeWebStorageSupported(this.auth,(function(e){e||n.reject(R(n.auth,"web-storage-unsupported"))})),this.pollUserCancellation();case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"eventId",get:function(){var e;return(null===(e=this.authWindow)||void 0===e?void 0:e.associatedEvent)||null}},{key:"cancel",value:function(){this.reject(R(this.auth,"cancelled-popup-request"))}},{key:"cleanUp",value:function(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,n.currentPopupAction=null}},{key:"pollUserCancellation",value:function(){var e=this;!function t(){var n,r;(null===(r=null===(n=e.authWindow)||void 0===n?void 0:n.window)||void 0===r?void 0:r.closed)?e.pollId=window.setTimeout((function(){e.pollId=null,e.reject(R(e.auth,"popup-closed-by-user"))}),2e3):e.pollId=window.setTimeout(t,ci.get())}()}}]),n}(si);pi.currentPopupAction=null;var yi="pendingRedirect",mi=new Map,gi=function(e){(0,f.Z)(n,e);var t=(0,d.Z)(n);function n(e,r){var i,o=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return(0,a.Z)(this,n),(i=t.call(this,e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],r,void 0,o)).eventId=null,i}return(0,o.Z)(n,[{key:"execute",value:function(){var e=(0,u.Z)((0,i.Z)().mark((function e(){var t,r;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=mi.get(this.auth._key())){e.next=21;break}return e.prev=2,e.next=5,ki(this.resolver,this.auth);case 5:if(!e.sent){e.next=12;break}return e.next=9,(0,l.Z)((0,h.Z)(n.prototype),"execute",this).call(this);case 9:e.t0=e.sent,e.next=13;break;case 12:e.t0=null;case 13:r=e.t0,t=function(){return Promise.resolve(r)},e.next=20;break;case 17:e.prev=17,e.t1=e.catch(2),t=function(){return Promise.reject(e.t1)};case 20:mi.set(this.auth._key(),t);case 21:return this.bypassAuthState||mi.set(this.auth._key(),(function(){return Promise.resolve(null)})),e.abrupt("return",t());case 23:case"end":return e.stop()}}),e,this,[[2,17]])})));return function(){return e.apply(this,arguments)}}()},{key:"onAuthEvent",value:function(){var e=(0,u.Z)((0,i.Z)().mark((function e(t){var r;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("signInViaRedirect"!==t.type){e.next=4;break}return e.abrupt("return",(0,l.Z)((0,h.Z)(n.prototype),"onAuthEvent",this).call(this,t));case 4:if("unknown"!==t.type){e.next=7;break}return this.resolve(null),e.abrupt("return");case 7:if(!t.eventId){e.next=17;break}return e.next=10,this.auth._redirectUserForId(t.eventId);case 10:if(!(r=e.sent)){e.next=16;break}return this.user=r,e.abrupt("return",(0,l.Z)((0,h.Z)(n.prototype),"onAuthEvent",this).call(this,t));case 16:this.resolve(null);case 17:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"onExecution",value:function(){var e=(0,u.Z)((0,i.Z)().mark((function e(){return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"cleanUp",value:function(){}}]),n}(si);function ki(e,t){return wi.apply(this,arguments)}function wi(){return(wi=(0,u.Z)((0,i.Z)().mark((function e(t,n){var r,a,o;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=_i(n),a=xi(t),e.next=4,a._isAvailable();case 4:if(e.sent){e.next=6;break}return e.abrupt("return",!1);case 6:return e.next=8,a._get(r);case 8:return e.t0=e.sent,o="true"===e.t0,e.next=12,a._remove(r);case 12:return e.abrupt("return",o);case 13:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function bi(e,t){return Zi.apply(this,arguments)}function Zi(){return(Zi=(0,u.Z)((0,i.Z)().mark((function e(t,n){return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",xi(t)._set(_i(n),"true"));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Ii(e,t){mi.set(e._key(),t)}function xi(e){return q(e._redirectPersistence)}function _i(e){return De(yi,e.config.apiKey,e.name)}function Ti(e,t,n){return function(e,t,n){return Ei.apply(this,arguments)}(e,t,n)}function Ei(){return(Ei=(0,u.Z)((0,i.Z)().mark((function e(t,n,r){var a,o;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=We(t),P(t,n,Ot),e.next=4,a._initializationPromise;case 4:return o=ni(a,r),e.next=7,bi(o,a);case 7:return e.abrupt("return",o._openRedirect(a,n,"signInViaRedirect"));case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Si(e,t,n){return function(e,t,n){return Ai.apply(this,arguments)}(e,t,n)}function Ai(){return(Ai=(0,u.Z)((0,i.Z)().mark((function e(t,n,r){var a,o,u;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return P((a=(0,k.m9)(t)).auth,n,Ot),e.next=4,a.auth._initializationPromise;case 4:return o=ni(a.auth,r),e.next=7,bi(o,a.auth);case 7:return e.next=9,Li(a);case 9:return u=e.sent,e.abrupt("return",o._openRedirect(a.auth,n,"reauthViaRedirect",u));case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Ci(e,t,n){return function(e,t,n){return Ni.apply(this,arguments)}(e,t,n)}function Ni(){return(Ni=(0,u.Z)((0,i.Z)().mark((function e(t,n,r){var a,o,u;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return P((a=(0,k.m9)(t)).auth,n,Ot),e.next=4,a.auth._initializationPromise;case 4:return o=ni(a.auth,r),e.next=7,nn(!1,a,n.providerId);case 7:return e.next=9,bi(o,a.auth);case 9:return e.next=11,Li(a);case 11:return u=e.sent,e.abrupt("return",o._openRedirect(a.auth,n,"linkViaRedirect",u));case 13:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Di(e,t){return Ri.apply(this,arguments)}function Ri(){return(Ri=(0,u.Z)((0,i.Z)().mark((function e(t,n){return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,We(t)._initializationPromise;case 2:return e.abrupt("return",Oi(t,n,!1));case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Oi(e,t){return Pi.apply(this,arguments)}function Pi(){return Pi=(0,u.Z)((0,i.Z)().mark((function e(t,n){var r,a,o,u,s,c=arguments;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=c.length>2&&void 0!==c[2]&&c[2],a=We(t),o=ni(a,n),u=new gi(a,o,r),e.next=6,u.execute();case 6:if(!(s=e.sent)||r){e.next=13;break}return delete s.user._redirectEventId,e.next=11,a._persistUserIfCurrent(s.user);case 11:return e.next=13,a._setRedirectUser(null,n);case 13:return e.abrupt("return",s);case 14:case"end":return e.stop()}}),e)}))),Pi.apply(this,arguments)}function Li(e){return Mi.apply(this,arguments)}function Mi(){return(Mi=(0,u.Z)((0,i.Z)().mark((function e(t){var n;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=sr("".concat(t.uid,":::")),t._redirectEventId=n,e.next=4,t.auth._setRedirectUser(t);case 4:return e.next=6,t.auth._persistUserIfCurrent(t);case 6:return e.abrupt("return",n);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Fi=function(){function e(t){(0,a.Z)(this,e),this.auth=t,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}return(0,o.Z)(e,[{key:"registerConsumer",value:function(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}},{key:"unregisterConsumer",value:function(e){this.consumers.delete(e)}},{key:"onEvent",value:function(e){var t=this;if(this.hasEventBeenHandled(e))return!1;var n=!1;return this.consumers.forEach((function(r){t.isEventForConsumer(e,r)&&(n=!0,t.sendToConsumer(e,r),t.saveEventToCache(e))})),this.hasHandledPotentialRedirect||!function(e){switch(e.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return Ui(e);default:return!1}}(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}},{key:"sendToConsumer",value:function(e,t){var n;if(e.error&&!Ui(e)){var r=(null===(n=e.error.code)||void 0===n?void 0:n.split("auth/")[1])||"internal-error";t.onError(R(this.auth,r))}else t.onAuthEvent(e)}},{key:"isEventForConsumer",value:function(e,t){var n=null===t.eventId||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&n}},{key:"hasEventBeenHandled",value:function(e){return Date.now()-this.lastProcessedEventTime>=6e5&&this.cachedEventUids.clear(),this.cachedEventUids.has(Vi(e))}},{key:"saveEventToCache",value:function(e){this.cachedEventUids.add(Vi(e)),this.lastProcessedEventTime=Date.now()}}]),e}();function Vi(e){return[e.type,e.eventId,e.sessionId,e.tenantId].filter((function(e){return e})).join("-")}function Ui(e){var t=e.type,n=e.error;return"unknown"===t&&(null===n||void 0===n?void 0:n.code)==="auth/".concat("no-auth-event")}function qi(e){return Bi.apply(this,arguments)}function Bi(){return Bi=(0,u.Z)((0,i.Z)().mark((function e(t){var n,r=arguments;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=r.length>1&&void 0!==r[1]?r[1]:{},e.abrupt("return",J(t,"GET","/v1/projects",n));case 2:case"end":return e.stop()}}),e)}))),Bi.apply(this,arguments)}var ji=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,Gi=/^https?/;function Ki(){return(Ki=(0,u.Z)((0,i.Z)().mark((function e(t){var n,r,a,o,u;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.config.emulator){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,qi(t);case 4:n=e.sent,r=n.authorizedDomains,a=(0,p.Z)(r),e.prev=7,a.s();case 9:if((o=a.n()).done){e.next=20;break}if(u=o.value,e.prev=11,!zi(u)){e.next=14;break}return e.abrupt("return");case 14:e.next=18;break;case 16:e.prev=16,e.t0=e.catch(11);case 18:e.next=9;break;case 20:e.next=25;break;case 22:e.prev=22,e.t1=e.catch(7),a.e(e.t1);case 25:return e.prev=25,a.f(),e.finish(25);case 28:D(t,"unauthorized-domain");case 29:case"end":return e.stop()}}),e,null,[[7,22,25,28],[11,16]])})))).apply(this,arguments)}function zi(e){var t=B(),n=new URL(t),r=n.protocol,i=n.hostname;if(e.startsWith("chrome-extension://")){var a=new URL(e);return""===a.hostname&&""===i?"chrome-extension:"===r&&e.replace("chrome-extension://","")===t.replace("chrome-extension://",""):"chrome-extension:"===r&&a.hostname===i}if(!Gi.test(r))return!1;if(ji.test(e))return i===e;var o=e.replace(/\./g,"\\.");return new RegExp("^(.+\\."+o+"|"+o+")$","i").test(i)}var Wi=new K(3e4,6e4);function Hi(){var e=lr().___jsl;if(null===e||void 0===e?void 0:e.H)for(var t=0,n=Object.keys(e.H);t<n.length;t++){var r=n[t];if(e.H[r].r=e.H[r].r||[],e.H[r].L=e.H[r].L||[],e.H[r].r=(0,m.Z)(e.H[r].L),e.CP)for(var i=0;i<e.CP.length;i++)e.CP[i]=null}}var Qi=null;function Yi(e){return Qi=Qi||function(e){return new Promise((function(t,n){var r,i,a;function o(){Hi(),gapi.load("gapi.iframes",{callback:function(){t(gapi.iframes.getContext())},ontimeout:function(){Hi(),n(R(e,"network-request-failed"))},timeout:Wi.get()})}if(null===(i=null===(r=lr().gapi)||void 0===r?void 0:r.iframes)||void 0===i?void 0:i.Iframe)t(gapi.iframes.getContext());else{if(!(null===(a=lr().gapi)||void 0===a?void 0:a.load)){var u=Or("iframefcb");return lr()[u]=function(){gapi.load?o():n(R(e,"network-request-failed"))},Rr("https://apis.google.com/js/api.js?onload=".concat(u)).catch((function(e){return n(e)}))}o()}})).catch((function(e){throw Qi=null,e}))}(e),Qi}var Ji=new K(5e3,15e3),Xi="__/auth/iframe",$i="emulator/auth/iframe",ea={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},ta=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function na(e){var t=e.config;M(t.authDomain,e,"auth-domain-config-required");var n=t.emulator?z(t,$i):"https://".concat(e.config.authDomain,"/").concat(Xi),r={apiKey:t.apiKey,appName:e.name,v:w.SDK_VERSION},i=ta.get(e.config.apiHost);i&&(r.eid=i);var a=e._getFrameworks();return a.length&&(r.fw=a.join(",")),"".concat(n,"?").concat((0,k.xO)(r).slice(1))}function ra(e){return ia.apply(this,arguments)}function ia(){return ia=(0,u.Z)((0,i.Z)().mark((function e(t){var n,r;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Yi(t);case 2:return n=e.sent,M(r=lr().gapi,t,"internal-error"),e.abrupt("return",n.open({where:document.body,url:na(t),messageHandlersFilter:r.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:ea,dontclear:!0},(function(e){return new Promise(function(){var n=(0,u.Z)((0,i.Z)().mark((function n(r,a){var o,u,s;return(0,i.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return s=function(){lr().clearTimeout(u),r(e)},n.next=3,e.restyle({setHideOnLeave:!1});case 3:o=R(t,"network-request-failed"),u=lr().setTimeout((function(){a(o)}),Ji.get()),e.ping(s).then(s,(function(){a(o)}));case 6:case"end":return n.stop()}}),n)})));return function(e,t){return n.apply(this,arguments)}}())})));case 6:case"end":return e.stop()}}),e)}))),ia.apply(this,arguments)}var aa={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},oa=500,ua=600,sa="_blank",ca="http://localhost",la=function(){function e(t){(0,a.Z)(this,e),this.window=t,this.associatedEvent=null}return(0,o.Z)(e,[{key:"close",value:function(){if(this.window)try{this.window.close()}catch(e){}}}]),e}();function ha(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:oa,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:ua,a=Math.max((window.screen.availHeight-i)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString(),u="",s=Object.assign(Object.assign({},aa),{width:r.toString(),height:i.toString(),top:a,left:o}),c=(0,k.z$)().toLowerCase();n&&(u=Me(c)?sa:n),Pe(c)&&(t=t||ca,s.scrollbars="yes");var l=Object.entries(s).reduce((function(e,t){var n=(0,y.Z)(t,2),r=n[0],i=n[1];return"".concat(e).concat(r,"=").concat(i,",")}),"");if(function(){var e;return Be(arguments.length>0&&void 0!==arguments[0]?arguments[0]:(0,k.z$)())&&!!(null===(e=window.navigator)||void 0===e?void 0:e.standalone)}(c)&&"_self"!==u)return function(e,t){var n=document.createElement("a");n.href=e,n.target=t;var r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}(t||"",u),new la(null);var h=window.open(t||"",u,l);M(h,e,"popup-blocked");try{h.focus()}catch(f){}return new la(h)}var fa="__/auth/handler",da="emulator/auth/handler";function va(e,t,n,r,i,a){M(e.config.authDomain,e,"auth-domain-config-required"),M(e.config.apiKey,e,"invalid-api-key");var o={apiKey:e.config.apiKey,appName:e.name,authType:n,redirectUrl:r,v:w.SDK_VERSION,eventId:i};if(t instanceof Ot){t.setDefaultLanguage(e.languageCode),o.providerId=t.providerId||"",(0,k.xb)(t.getCustomParameters())||(o.customParameters=JSON.stringify(t.getCustomParameters()));for(var u=0,s=Object.entries(a||{});u<s.length;u++){var c=(0,y.Z)(s[u],2),l=c[0],h=c[1];o[l]=h}}if(t instanceof Pt){var f=t.getScopes().filter((function(e){return""!==e}));f.length>0&&(o.scopes=f.join(","))}e.tenantId&&(o.tid=e.tenantId);for(var d=o,v=0,p=Object.keys(d);v<p.length;v++){var m=p[v];void 0===d[m]&&delete d[m]}return"".concat(function(e){var t=e.config;if(!t.emulator)return"https://".concat(t.authDomain,"/").concat(fa);return z(t,da)}(e),"?").concat((0,k.xO)(d).slice(1))}var pa="webStorageSupport",ya=function(){function e(){(0,a.Z)(this,e),this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=ar,this._completeRedirectFn=Oi,this._overrideRedirectResult=Ii}return(0,o.Z)(e,[{key:"_openPopup",value:function(){var e=(0,u.Z)((0,i.Z)().mark((function e(t,n,r,a){var o,u;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return V(null===(o=this.eventManagers[t._key()])||void 0===o?void 0:o.manager,"_initialize() not called before _openPopup()"),u=va(t,n,r,B(),a),e.abrupt("return",ha(t,u,sr()));case 3:case"end":return e.stop()}}),e,this)})));return function(t,n,r,i){return e.apply(this,arguments)}}()},{key:"_openRedirect",value:function(){var e=(0,u.Z)((0,i.Z)().mark((function e(t,n,r,a){return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._originValidation(t);case 2:return i=va(t,n,r,B(),a),lr().location.href=i,e.abrupt("return",new Promise((function(){})));case 4:case"end":return e.stop()}var i}),e,this)})));return function(t,n,r,i){return e.apply(this,arguments)}}()},{key:"_initialize",value:function(e){var t=this,n=e._key();if(this.eventManagers[n]){var r=this.eventManagers[n],i=r.manager,a=r.promise;return i?Promise.resolve(i):(V(a,"If manager is not set, promise should be"),a)}var o=this.initAndGetManager(e);return this.eventManagers[n]={promise:o},o.catch((function(){delete t.eventManagers[n]})),o}},{key:"initAndGetManager",value:function(){var e=(0,u.Z)((0,i.Z)().mark((function e(t){var n,r;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ra(t);case 2:return n=e.sent,r=new Fi(t),n.register("authEvent",(function(e){return M(null===e||void 0===e?void 0:e.authEvent,t,"invalid-auth-event"),{status:r.onEvent(e.authEvent)?"ACK":"ERROR"}}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[t._key()]={manager:r},this.iframes[t._key()]=n,e.abrupt("return",r);case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_isIframeWebStorageSupported",value:function(e,t){this.iframes[e._key()].send(pa,{type:pa},(function(n){var r,i=null===(r=null===n||void 0===n?void 0:n[0])||void 0===r?void 0:r[pa];void 0!==i&&t(!!i),D(e,"internal-error")}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}},{key:"_originValidation",value:function(e){var t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=function(e){return Ki.apply(this,arguments)}(e)),this.originValidationPromises[t]}},{key:"_shouldInitProactively",get:function(){return je()||Le()||Be()}}]),e}(),ma=ya,ga=function(e){(0,f.Z)(n,e);var t=(0,d.Z)(n);function n(e){var r;return(0,a.Z)(this,n),(r=t.call(this,"phone")).credential=e,r}return(0,o.Z)(n,[{key:"_finalizeEnroll",value:function(e,t,n){return function(e,t){return J(e,"POST","/v2/accounts/mfaEnrollment:finalize",Y(e,t))}(e,{idToken:t,displayName:n,phoneVerificationInfo:this.credential._makeVerificationRequest()})}},{key:"_finalizeSignIn",value:function(e,t){return function(e,t){return J(e,"POST","/v2/accounts/mfaSignIn:finalize",Y(e,t))}(e,{mfaPendingCredential:t,phoneVerificationInfo:this.credential._makeVerificationRequest()})}}],[{key:"_fromCredential",value:function(e){return new n(e)}}]),n}(function(){function e(t){(0,a.Z)(this,e),this.factorId=t}return(0,o.Z)(e,[{key:"_process",value:function(e,t,n){switch(t.type){case"enroll":return this._finalizeEnroll(e,t.credential,n);case"signin":return this._finalizeSignIn(e,t.credential);default:return F("unexpected MultiFactorSessionType")}}}]),e}()),ka=function(){function e(){(0,a.Z)(this,e)}return(0,o.Z)(e,null,[{key:"assertion",value:function(e){return ga._fromCredential(e)}}]),e}();ka.FACTOR_ID="phone";var wa="@firebase/auth",ba="0.21.3",Za=function(){function e(t){(0,a.Z)(this,e),this.auth=t,this.internalListeners=new Map}return(0,o.Z)(e,[{key:"getUid",value:function(){var e;return this.assertAuthConfigured(),(null===(e=this.auth.currentUser)||void 0===e?void 0:e.uid)||null}},{key:"getToken",value:function(){var e=(0,u.Z)((0,i.Z)().mark((function e(t){var n;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.assertAuthConfigured(),e.next=3,this.auth._initializationPromise;case 3:if(this.auth.currentUser){e.next=5;break}return e.abrupt("return",null);case 5:return e.next=7,this.auth.currentUser.getIdToken(t);case 7:return n=e.sent,e.abrupt("return",{accessToken:n});case 9:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"addAuthTokenListener",value:function(e){if(this.assertAuthConfigured(),!this.internalListeners.has(e)){var t=this.auth.onIdTokenChanged((function(t){e((null===t||void 0===t?void 0:t.stsTokenManager.accessToken)||null)}));this.internalListeners.set(e,t),this.updateProactiveRefresh()}}},{key:"removeAuthTokenListener",value:function(e){this.assertAuthConfigured();var t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}},{key:"assertAuthConfigured",value:function(){M(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}},{key:"updateProactiveRefresh",value:function(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}]),e}();var Ia;(0,k.Pz)("authIdTokenMaxAge");function xa(){return window}Ia="Browser",(0,w._registerComponent)(new I.wA("auth",(function(e,t){var n=t.options,r=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),a=r.options,o=a.apiKey,u=a.authDomain;return function(e,t){M(o&&!o.includes(":"),"invalid-api-key",{appName:e.name}),M(!(null===u||void 0===u?void 0:u.includes(":")),"argument-error",{appName:e.name});var r={apiKey:o,authDomain:u,clientPlatform:Ia,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:Ge(Ia)},i=new ze(e,t,r);return function(e,t){var n=(null===t||void 0===t?void 0:t.persistence)||[],r=(Array.isArray(n)?n:[n]).map(q);(null===t||void 0===t?void 0:t.errorMap)&&e._updateErrorMap(t.errorMap),e._initializeWithPersistence(r,null===t||void 0===t?void 0:t.popupRedirectResolver)}(i,n),i}(r,i)}),"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((function(e,t,n){e.getProvider("auth-internal").initialize()}))),(0,w._registerComponent)(new I.wA("auth-internal",(function(e){return function(e){return new Za(e)}(We(e.getProvider("auth").getImmediate()))}),"PRIVATE").setInstantiationMode("EXPLICIT")),(0,w.registerVersion)(wa,ba,function(e){switch(e){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";default:return}}(Ia)),(0,w.registerVersion)(wa,ba,"esm2017");var _a=2e3;function Ta(e,t,n){return Ea.apply(this,arguments)}function Ea(){return(Ea=(0,u.Z)((0,i.Z)().mark((function e(t,n,r){var a,o,u,s,c;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=xa(),u=o.BuildInfo,V(n.sessionId,"AuthEvent did not contain a session ID"),e.next=4,Ra(n.sessionId);case 4:return s=e.sent,c={},Be()?c.ibi=u.packageName:Ve()?c.apn=u.packageName:D(t,"operation-not-supported-in-this-environment"),u.displayName&&(c.appDisplayName=u.displayName),c.sessionId=s,e.abrupt("return",va(t,r,n.type,void 0,null!==(a=n.eventId)&&void 0!==a?a:void 0,c));case 10:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Sa(){return(Sa=(0,u.Z)((0,i.Z)().mark((function e(t){var n,r,a;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=xa(),r=n.BuildInfo,a={},Be()?a.iosBundleId=r.packageName:Ve()?a.androidPackageName=r.packageName:D(t,"operation-not-supported-in-this-environment"),e.next=5,qi(t,a);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Aa(e){var t=xa().cordova;return new Promise((function(n){t.plugins.browsertab.isAvailable((function(r){var i=null;r?t.plugins.browsertab.openUrl(e):i=t.InAppBrowser.open(e,function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:(0,k.z$)();return/(iPad|iPhone|iPod).*OS 7_\d/i.test(e)||/(iPad|iPhone|iPod).*OS 8_\d/i.test(e)}()?"_blank":"_system","location=yes"),n(i)}))}))}function Ca(e,t,n){return Na.apply(this,arguments)}function Na(){return(Na=(0,u.Z)((0,i.Z)().mark((function e(t,n,r){var a,o,u;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=xa(),o=a.cordova,u=function(){},e.prev=2,e.next=5,new Promise((function(e,i){var a=null;function s(){var t;e();var n=null===(t=o.plugins.browsertab)||void 0===t?void 0:t.close;"function"===typeof n&&n(),"function"===typeof(null===r||void 0===r?void 0:r.close)&&r.close()}function c(){a||(a=window.setTimeout((function(){i(R(t,"redirect-cancelled-by-user"))}),_a))}function l(){"visible"===(null===document||void 0===document?void 0:document.visibilityState)&&c()}n.addPassiveListener(s),document.addEventListener("resume",c,!1),Ve()&&document.addEventListener("visibilitychange",l,!1),u=function(){n.removePassiveListener(s),document.removeEventListener("resume",c,!1),document.removeEventListener("visibilitychange",l,!1),a&&window.clearTimeout(a)}}));case 5:return e.prev=5,u(),e.finish(5);case 8:case"end":return e.stop()}}),e,null,[[2,,5,8]])})))).apply(this,arguments)}function Da(e){var t,n,r,i,a,o,u,s,c,l,h=xa();M("function"===typeof(null===(t=null===h||void 0===h?void 0:h.universalLinks)||void 0===t?void 0:t.subscribe),e,"invalid-cordova-configuration",{missingPlugin:"cordova-universal-links-plugin-fix"}),M("undefined"!==typeof(null===(n=null===h||void 0===h?void 0:h.BuildInfo)||void 0===n?void 0:n.packageName),e,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-buildInfo"}),M("function"===typeof(null===(a=null===(i=null===(r=null===h||void 0===h?void 0:h.cordova)||void 0===r?void 0:r.plugins)||void 0===i?void 0:i.browsertab)||void 0===a?void 0:a.openUrl),e,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),M("function"===typeof(null===(s=null===(u=null===(o=null===h||void 0===h?void 0:h.cordova)||void 0===o?void 0:o.plugins)||void 0===u?void 0:u.browsertab)||void 0===s?void 0:s.isAvailable),e,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),M("function"===typeof(null===(l=null===(c=null===h||void 0===h?void 0:h.cordova)||void 0===c?void 0:c.InAppBrowser)||void 0===l?void 0:l.open),e,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-inappbrowser"})}function Ra(e){return Oa.apply(this,arguments)}function Oa(){return(Oa=(0,u.Z)((0,i.Z)().mark((function e(t){var n,r,a;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=Pa(t),e.next=3,crypto.subtle.digest("SHA-256",n);case 3:return r=e.sent,a=Array.from(new Uint8Array(r)),e.abrupt("return",a.map((function(e){return e.toString(16).padStart(2,"0")})).join(""));case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Pa(e){if(V(/[0-9a-zA-Z]+/.test(e),"Can only convert alpha-numeric strings"),"undefined"!==typeof TextEncoder)return(new TextEncoder).encode(e);for(var t=new ArrayBuffer(e.length),n=new Uint8Array(t),r=0;r<e.length;r++)n[r]=e.charCodeAt(r);return n}var La=20,Ma=function(e){(0,f.Z)(n,e);var t=(0,d.Z)(n);function n(){var e;return(0,a.Z)(this,n),(e=t.apply(this,arguments)).passiveListeners=new Set,e.initPromise=new Promise((function(t){e.resolveInialized=t})),e}return(0,o.Z)(n,[{key:"addPassiveListener",value:function(e){this.passiveListeners.add(e)}},{key:"removePassiveListener",value:function(e){this.passiveListeners.delete(e)}},{key:"resetRedirect",value:function(){this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1}},{key:"onEvent",value:function(e){return this.resolveInialized(),this.passiveListeners.forEach((function(t){return t(e)})),(0,l.Z)((0,h.Z)(n.prototype),"onEvent",this).call(this,e)}},{key:"initialized",value:function(){var e=(0,u.Z)((0,i.Z)().mark((function e(){return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.initPromise;case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),n}(Fi);function Fa(e,t){return{type:t,eventId:arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,urlResponse:null,sessionId:ja(),postBody:null,tenantId:e.tenantId,error:R(e,"no-auth-event")}}function Va(e,t){return Ga()._set(Ka(e),t)}function Ua(e){return qa.apply(this,arguments)}function qa(){return(qa=(0,u.Z)((0,i.Z)().mark((function e(t){var n;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ga()._get(Ka(t));case 2:if(!(n=e.sent)){e.next=6;break}return e.next=6,Ga()._remove(Ka(t));case 6:return e.abrupt("return",n);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Ba(e,t){var n,r,i=function(e){var t=za(e),n=t.link?decodeURIComponent(t.link):void 0,r=za(n).link,i=t.deep_link_id?decodeURIComponent(t.deep_link_id):void 0;return za(i).link||i||r||n||e}(t);if(i.includes("/__/auth/callback")){var a=za(i),o=a.firebaseError?function(e){try{return JSON.parse(e)}catch(t){return null}}(decodeURIComponent(a.firebaseError)):null,u=null===(r=null===(n=null===o||void 0===o?void 0:o.code)||void 0===n?void 0:n.split("auth/"))||void 0===r?void 0:r[1],s=u?R(u):null;return s?{type:e.type,eventId:e.eventId,tenantId:e.tenantId,error:s,urlResponse:null,sessionId:null,postBody:null}:{type:e.type,eventId:e.eventId,tenantId:e.tenantId,sessionId:e.sessionId,urlResponse:i,postBody:null}}return null}function ja(){for(var e=[],t="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ",n=0;n<La;n++){var r=Math.floor(Math.random()*t.length);e.push(t.charAt(r))}return e.join("")}function Ga(){return q(rr)}function Ka(e){return De("authEvent",e.config.apiKey,e.name)}function za(e){if(!(null===e||void 0===e?void 0:e.includes("?")))return{};var t=e.split("?"),n=(0,c.Z)(t),r=(n[0],n.slice(1));return(0,k.zd)(r.join("?"))}var Wa=function(){function e(){(0,a.Z)(this,e),this._redirectPersistence=ar,this._shouldInitProactively=!0,this.eventManagers=new Map,this.originValidationPromises={},this._completeRedirectFn=Oi,this._overrideRedirectResult=Ii}return(0,o.Z)(e,[{key:"_initialize",value:function(){var e=(0,u.Z)((0,i.Z)().mark((function e(t){var n,r;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t._key(),(r=this.eventManagers.get(n))||(r=new Ma(t),this.eventManagers.set(n,r),this.attachCallbackListeners(t,r)),e.abrupt("return",r);case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_openPopup",value:function(e){D(e,"operation-not-supported-in-this-environment")}},{key:"_openRedirect",value:function(){var e=(0,u.Z)((0,i.Z)().mark((function e(t,n,r,a){var o,u,s,c;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Da(t),e.next=3,this._initialize(t);case 3:return o=e.sent,e.next=6,o.initialized();case 6:return o.resetRedirect(),mi.clear(),e.next=10,this._originValidation(t);case 10:return u=Fa(t,r,a),e.next=13,Va(t,u);case 13:return e.next=15,Ta(t,u,n);case 15:return s=e.sent,e.next=18,Aa(s);case 18:return c=e.sent,e.abrupt("return",Ca(t,o,c));case 20:case"end":return e.stop()}}),e,this)})));return function(t,n,r,i){return e.apply(this,arguments)}}()},{key:"_isIframeWebStorageSupported",value:function(e,t){throw new Error("Method not implemented.")}},{key:"_originValidation",value:function(e){var t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=function(e){return Sa.apply(this,arguments)}(e)),this.originValidationPromises[t]}},{key:"attachCallbackListeners",value:function(e,t){var n=xa(),r=n.universalLinks,a=n.handleOpenURL,o=n.BuildInfo,s=setTimeout((0,u.Z)((0,i.Z)().mark((function n(){return(0,i.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,Ua(e);case 2:t.onEvent(Qa());case 3:case"end":return n.stop()}}),n)}))),500),c=function(){var n=(0,u.Z)((0,i.Z)().mark((function n(r){var a,o;return(0,i.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return clearTimeout(s),n.next=3,Ua(e);case 3:a=n.sent,o=null,a&&(null===r||void 0===r?void 0:r.url)&&(o=Ba(a,r.url)),t.onEvent(o||Qa());case 7:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}();"undefined"!==typeof r&&"function"===typeof r.subscribe&&r.subscribe(null,c);var l=a,h="".concat(o.packageName.toLowerCase(),"://");xa().handleOpenURL=function(){var e=(0,u.Z)((0,i.Z)().mark((function e(t){return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.toLowerCase().startsWith(h)&&c({url:t}),"function"===typeof l)try{l(t)}catch(n){console.error(n)}case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}}]),e}(),Ha=Wa;function Qa(){return{type:"unknown",eventId:null,sessionId:null,urlResponse:null,postBody:null,tenantId:null,error:R("no-auth-event")}}var Ya="@firebase/auth-compat",Ja="0.3.3",Xa=1e3;function $a(){var e;return(null===(e=null===self||void 0===self?void 0:self.location)||void 0===e?void 0:e.protocol)||null}function eo(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:(0,k.z$)();return!("file:"!==$a()&&"ionic:"!==$a()&&"capacitor:"!==$a()||!e.toLowerCase().match(/iphone|ipad|ipod|android/))}function to(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:(0,k.z$)();return(0,k.w1)()&&11===(null===document||void 0===document?void 0:document.documentMode)||function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:(0,k.z$)();return/Edge\/\d+/.test(e)}(e)}function no(){try{var e=self.localStorage,t=sr();if(e)return e.setItem(t,"1"),e.removeItem(t),!to()||(0,k.hl)()}catch(n){return ro()&&(0,k.hl)()}return!1}function ro(){return"undefined"!==typeof n.g&&"WorkerGlobalScope"in n.g&&"importScripts"in n.g}function io(){return("http:"===$a()||"https:"===$a()||(0,k.ru)()||eo())&&!((0,k.b$)()||(0,k.UG)())&&no()&&!ro()}function ao(){return eo()&&"undefined"!==typeof document}function oo(){return uo.apply(this,arguments)}function uo(){return(uo=(0,u.Z)((0,i.Z)().mark((function e(){return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(ao()){e.next=2;break}return e.abrupt("return",!1);case 2:return e.abrupt("return",new Promise((function(e){var t=setTimeout((function(){e(!1)}),Xa);document.addEventListener("deviceready",(function(){clearTimeout(t),e(!0)}))})));case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var so={LOCAL:"local",NONE:"none",SESSION:"session"},co=M,lo="persistence";function ho(e,t){co(Object.values(so).includes(t),e,"invalid-persistence-type"),(0,k.b$)()?co(t!==so.SESSION,e,"unsupported-persistence-type"):(0,k.UG)()?co(t===so.NONE,e,"unsupported-persistence-type"):ro()?co(t===so.NONE||t===so.LOCAL&&(0,k.hl)(),e,"unsupported-persistence-type"):co(t===so.NONE||no(),e,"unsupported-persistence-type")}function fo(e){return vo.apply(this,arguments)}function vo(){return(vo=(0,u.Z)((0,i.Z)().mark((function e(t){var n,r;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t._initializationPromise;case 2:n=po(),r=De(lo,t.config.apiKey,t.name),n&&n.setItem(r,t._getPersistence());case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function po(){var e;try{return(null===(e="undefined"!==typeof window?window:null)||void 0===e?void 0:e.sessionStorage)||null}catch(t){return null}}var yo=M,mo=function(){function e(){(0,a.Z)(this,e),this.browserResolver=q(ma),this.cordovaResolver=q(Ha),this.underlyingResolver=null,this._redirectPersistence=ar,this._completeRedirectFn=Oi,this._overrideRedirectResult=Ii}return(0,o.Z)(e,[{key:"_initialize",value:function(){var e=(0,u.Z)((0,i.Z)().mark((function e(t){return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.selectUnderlyingResolver();case 2:return e.abrupt("return",this.assertedUnderlyingResolver._initialize(t));case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_openPopup",value:function(){var e=(0,u.Z)((0,i.Z)().mark((function e(t,n,r,a){return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.selectUnderlyingResolver();case 2:return e.abrupt("return",this.assertedUnderlyingResolver._openPopup(t,n,r,a));case 3:case"end":return e.stop()}}),e,this)})));return function(t,n,r,i){return e.apply(this,arguments)}}()},{key:"_openRedirect",value:function(){var e=(0,u.Z)((0,i.Z)().mark((function e(t,n,r,a){return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.selectUnderlyingResolver();case 2:return e.abrupt("return",this.assertedUnderlyingResolver._openRedirect(t,n,r,a));case 3:case"end":return e.stop()}}),e,this)})));return function(t,n,r,i){return e.apply(this,arguments)}}()},{key:"_isIframeWebStorageSupported",value:function(e,t){this.assertedUnderlyingResolver._isIframeWebStorageSupported(e,t)}},{key:"_originValidation",value:function(e){return this.assertedUnderlyingResolver._originValidation(e)}},{key:"_shouldInitProactively",get:function(){return ao()||this.browserResolver._shouldInitProactively}},{key:"assertedUnderlyingResolver",get:function(){return yo(this.underlyingResolver,"internal-error"),this.underlyingResolver}},{key:"selectUnderlyingResolver",value:function(){var e=(0,u.Z)((0,i.Z)().mark((function e(){var t;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.underlyingResolver){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,oo();case 4:t=e.sent,this.underlyingResolver=t?this.cordovaResolver:this.browserResolver;case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),e}();function go(e){return e.unwrap()}function ko(e,t){var n,r=null===(n=t.customData)||void 0===n?void 0:n._tokenResponse;if("auth/multi-factor-auth-required"===(null===t||void 0===t?void 0:t.code))t.resolver=new xo(e,function(e,t){var n,r=(0,k.m9)(e),i=t;return M(t.customData.operationType,r,"argument-error"),M(null===(n=i.customData._serverResponse)||void 0===n?void 0:n.mfaPendingCredential,r,"argument-error"),Qn._fromError(r,i)}(e,t));else if(r){var i=wo(t),a=t;i&&(a.credential=i,a.tenantId=r.tenantId||void 0,a.email=r.email||void 0,a.phoneNumber=r.phoneNumber||void 0)}}function wo(e){var t=(e instanceof k.ZR?e.customData:e)._tokenResponse;if(!t)return null;if(!(e instanceof k.ZR)&&"temporaryProof"in t&&"phoneNumber"in t)return ti.credentialFromResult(e);var n,r=t.providerId;if(!r||r===x.PASSWORD)return null;switch(r){case x.GOOGLE:n=Ft;break;case x.FACEBOOK:n=Mt;break;case x.GITHUB:n=Vt;break;case x.TWITTER:n=jt;break;default:var i=t.oauthIdToken,a=t.oauthAccessToken,o=t.oauthTokenSecret,u=t.pendingToken,s=t.nonce;return a||o||i||u?u?r.startsWith("saml.")?Ut._create(r,u):xt._fromParams({providerId:r,signInMethod:r,pendingToken:u,idToken:i,accessToken:a}):new Lt(r).credential({idToken:i,accessToken:a,rawNonce:s}):null}return e instanceof k.ZR?n.credentialFromError(e):n.credentialFromResult(e)}function bo(e,t){return t.catch((function(t){throw t instanceof k.ZR&&ko(e,t),t})).then((function(e){var t,n=e.operationType,r=e.user;return{operationType:n,credential:(t=e,wo(t)),additionalUserInfo:Wn(e),user:_o.getOrCreate(r)}}))}function Zo(e,t){return Io.apply(this,arguments)}function Io(){return(Io=(0,u.Z)((0,i.Z)().mark((function e(t,n){var r;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n;case 2:return r=e.sent,e.abrupt("return",{verificationId:r.verificationId,confirm:function(e){return bo(t,r.confirm(e))}});case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var xo=function(){function e(t,n){(0,a.Z)(this,e),this.resolver=n,this.auth=t.wrapped()}return(0,o.Z)(e,[{key:"session",get:function(){return this.resolver.session}},{key:"hints",get:function(){return this.resolver.hints}},{key:"resolveSignIn",value:function(e){return bo(go(this.auth),this.resolver.resolveSignIn(e))}}]),e}(),_o=function(){function e(t){(0,a.Z)(this,e),this._delegate=t,this.multiFactor=function(e){var t=(0,k.m9)(e);return Xn.has(t)||Xn.set(t,Jn._fromUser(t)),Xn.get(t)}(t)}return(0,o.Z)(e,[{key:"delete",value:function(){return this._delegate.delete()}},{key:"reload",value:function(){return this._delegate.reload()}},{key:"toJSON",value:function(){return this._delegate.toJSON()}},{key:"getIdTokenResult",value:function(e){return this._delegate.getIdTokenResult(e)}},{key:"getIdToken",value:function(e){return this._delegate.getIdToken(e)}},{key:"linkAndRetrieveDataWithCredential",value:function(e){return this.linkWithCredential(e)}},{key:"linkWithCredential",value:function(){var e=(0,u.Z)((0,i.Z)().mark((function e(t){return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",bo(this.auth,hn(this._delegate,t)));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"linkWithPhoneNumber",value:function(){var e=(0,u.Z)((0,i.Z)().mark((function e(t,n){return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Zo(this.auth,Qr(this._delegate,t,n)));case 1:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"linkWithPopup",value:function(){var e=(0,u.Z)((0,i.Z)().mark((function e(t){return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",bo(this.auth,di(this._delegate,t,mo)));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"linkWithRedirect",value:function(){var e=(0,u.Z)((0,i.Z)().mark((function e(t){return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fo(We(this.auth));case 2:return e.abrupt("return",Ci(this._delegate,t,mo));case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"reauthenticateAndRetrieveDataWithCredential",value:function(e){return this.reauthenticateWithCredential(e)}},{key:"reauthenticateWithCredential",value:function(){var e=(0,u.Z)((0,i.Z)().mark((function e(t){return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",bo(this.auth,dn(this._delegate,t)));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"reauthenticateWithPhoneNumber",value:function(e,t){return Zo(this.auth,function(e,t,n){return Jr.apply(this,arguments)}(this._delegate,e,t))}},{key:"reauthenticateWithPopup",value:function(e){return bo(this.auth,function(e,t,n){return fi.apply(this,arguments)}(this._delegate,e,mo))}},{key:"reauthenticateWithRedirect",value:function(){var e=(0,u.Z)((0,i.Z)().mark((function e(t){return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fo(We(this.auth));case 2:return e.abrupt("return",Si(this._delegate,t,mo));case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"sendEmailVerification",value:function(e){return function(e,t){return On.apply(this,arguments)}(this._delegate,e)}},{key:"unlink",value:function(){var e=(0,u.Z)((0,i.Z)().mark((function e(t){return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Xt(this._delegate,t);case 2:return e.abrupt("return",this);case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"updateEmail",value:function(e){return function(e,t){return Vn((0,k.m9)(e),t,null)}(this._delegate,e)}},{key:"updatePassword",value:function(e){return function(e,t){return Vn((0,k.m9)(e),null,t)}(this._delegate,e)}},{key:"updatePhoneNumber",value:function(e){return function(e,t){return ei.apply(this,arguments)}(this._delegate,e)}},{key:"updateProfile",value:function(e){return function(e,t){return Fn.apply(this,arguments)}(this._delegate,e)}},{key:"verifyBeforeUpdateEmail",value:function(e,t){return function(e,t,n){return Pn.apply(this,arguments)}(this._delegate,e,t)}},{key:"emailVerified",get:function(){return this._delegate.emailVerified}},{key:"isAnonymous",get:function(){return this._delegate.isAnonymous}},{key:"metadata",get:function(){return this._delegate.metadata}},{key:"phoneNumber",get:function(){return this._delegate.phoneNumber}},{key:"providerData",get:function(){return this._delegate.providerData}},{key:"refreshToken",get:function(){return this._delegate.refreshToken}},{key:"tenantId",get:function(){return this._delegate.tenantId}},{key:"displayName",get:function(){return this._delegate.displayName}},{key:"email",get:function(){return this._delegate.email}},{key:"photoURL",get:function(){return this._delegate.photoURL}},{key:"providerId",get:function(){return this._delegate.providerId}},{key:"uid",get:function(){return this._delegate.uid}},{key:"auth",get:function(){return this._delegate.auth}}],[{key:"getOrCreate",value:function(t){return e.USER_MAP.has(t)||e.USER_MAP.set(t,new e(t)),e.USER_MAP.get(t)}}]),e}();_o.USER_MAP=new WeakMap;var To=M,Eo=function(){function e(t,n){if((0,a.Z)(this,e),this.app=t,n.isInitialized())return this._delegate=n.getImmediate(),void this.linkUnderlyingAuth();var r=t.options.apiKey;To(r,"invalid-api-key",{appName:t.name}),To(r,"invalid-api-key",{appName:t.name});var i="undefined"!==typeof window?mo:void 0;this._delegate=n.initialize({options:{persistence:Ao(r,t.name),popupRedirectResolver:i}}),this._delegate._updateErrorMap(E),this.linkUnderlyingAuth()}return(0,o.Z)(e,[{key:"emulatorConfig",get:function(){return this._delegate.emulatorConfig}},{key:"currentUser",get:function(){return this._delegate.currentUser?_o.getOrCreate(this._delegate.currentUser):null}},{key:"languageCode",get:function(){return this._delegate.languageCode},set:function(e){this._delegate.languageCode=e}},{key:"settings",get:function(){return this._delegate.settings}},{key:"tenantId",get:function(){return this._delegate.tenantId},set:function(e){this._delegate.tenantId=e}},{key:"useDeviceLanguage",value:function(){this._delegate.useDeviceLanguage()}},{key:"signOut",value:function(){return this._delegate.signOut()}},{key:"useEmulator",value:function(e,t){Qe(this._delegate,e,t)}},{key:"applyActionCode",value:function(e){return function(e,t){return In.apply(this,arguments)}(this._delegate,e)}},{key:"checkActionCode",value:function(e){return xn(this._delegate,e)}},{key:"confirmPasswordReset",value:function(e,t){return function(e,t,n){return Zn.apply(this,arguments)}(this._delegate,e,t)}},{key:"createUserWithEmailAndPassword",value:function(){var e=(0,u.Z)((0,i.Z)().mark((function e(t,n){return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",bo(this._delegate,En(this._delegate,t,n)));case 1:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"fetchProvidersForEmail",value:function(e){return this.fetchSignInMethodsForEmail(e)}},{key:"fetchSignInMethodsForEmail",value:function(e){return function(e,t){return Rn.apply(this,arguments)}(this._delegate,e)}},{key:"isSignInWithEmailLink",value:function(e){return function(e,t){var n=Dt.parseLink(t);return"EMAIL_SIGNIN"===(null===n||void 0===n?void 0:n.operation)}(this._delegate,e)}},{key:"getRedirectResult",value:function(){var e=(0,u.Z)((0,i.Z)().mark((function e(){var t;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return To(io(),this._delegate,"operation-not-supported-in-this-environment"),e.next=3,Di(this._delegate,mo);case 3:if(t=e.sent){e.next=6;break}return e.abrupt("return",{credential:null,user:null});case 6:return e.abrupt("return",bo(this._delegate,Promise.resolve(t)));case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"addFrameworkForLogging",value:function(e){!function(e,t){We(e)._logFramework(t)}(this._delegate,e)}},{key:"onAuthStateChanged",value:function(e,t,n){var r=So(e,t,n),i=r.next,a=r.error,o=r.complete;return this._delegate.onAuthStateChanged(i,a,o)}},{key:"onIdTokenChanged",value:function(e,t,n){var r=So(e,t,n),i=r.next,a=r.error,o=r.complete;return this._delegate.onIdTokenChanged(i,a,o)}},{key:"sendSignInLinkToEmail",value:function(e,t){return function(e,t,n){return An.apply(this,arguments)}(this._delegate,e,t)}},{key:"sendPasswordResetEmail",value:function(e,t){return function(e,t,n){return bn.apply(this,arguments)}(this._delegate,e,t||void 0)}},{key:"setPersistence",value:function(){var e=(0,u.Z)((0,i.Z)().mark((function e(t){var n,r;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:ho(this._delegate,t),e.t0=t,e.next=e.t0===so.SESSION?4:e.t0===so.LOCAL?6:e.t0===so.NONE?11:13;break;case 4:return n=ar,e.abrupt("break",14);case 6:return e.next=8,q(Ar)._isAvailable();case 8:return r=e.sent,n=r?Ar:rr,e.abrupt("break",14);case 11:return n=Ne,e.abrupt("break",14);case 13:return e.abrupt("return",D("argument-error",{appName:this._delegate.name}));case 14:return e.abrupt("return",this._delegate.setPersistence(n));case 15:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"signInAndRetrieveDataWithCredential",value:function(e){return this.signInWithCredential(e)}},{key:"signInAnonymously",value:function(){return bo(this._delegate,function(e){return Ht.apply(this,arguments)}(this._delegate))}},{key:"signInWithCredential",value:function(e){return bo(this._delegate,cn(this._delegate,e))}},{key:"signInWithCustomToken",value:function(e){return bo(this._delegate,function(e,t){return mn.apply(this,arguments)}(this._delegate,e))}},{key:"signInWithEmailAndPassword",value:function(e,t){return bo(this._delegate,function(e,t,n){return cn((0,k.m9)(e),Rt.credential(t,n))}(this._delegate,e,t))}},{key:"signInWithEmailLink",value:function(e,t){return bo(this._delegate,function(e,t,n){return Cn.apply(this,arguments)}(this._delegate,e,t))}},{key:"signInWithPhoneNumber",value:function(e,t){return Zo(this._delegate,function(e,t,n){return Hr.apply(this,arguments)}(this._delegate,e,t))}},{key:"signInWithPopup",value:function(){var e=(0,u.Z)((0,i.Z)().mark((function e(t){return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return To(io(),this._delegate,"operation-not-supported-in-this-environment"),e.abrupt("return",bo(this._delegate,li(this._delegate,t,mo)));case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"signInWithRedirect",value:function(){var e=(0,u.Z)((0,i.Z)().mark((function e(t){return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return To(io(),this._delegate,"operation-not-supported-in-this-environment"),e.next=3,fo(this._delegate);case 3:return e.abrupt("return",Ti(this._delegate,t,mo));case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"updateCurrentUser",value:function(e){return this._delegate.updateCurrentUser(e)}},{key:"verifyPasswordResetCode",value:function(e){return function(e,t){return Tn.apply(this,arguments)}(this._delegate,e)}},{key:"unwrap",value:function(){return this._delegate}},{key:"_delete",value:function(){return this._delegate._delete()}},{key:"linkUnderlyingAuth",value:function(){var e=this;this._delegate.wrapped=function(){return e}}}]),e}();function So(e,t,n){var r=e;"function"!==typeof e&&(r=e.next,t=e.error,n=e.complete);var i=r;return{next:function(e){return i(e&&_o.getOrCreate(e))},error:t,complete:n}}function Ao(e,t){var n=function(e,t){var n=po();if(!n)return[];var r=De(lo,e,t);switch(n.getItem(r)){case so.NONE:return[Ne];case so.LOCAL:return[Ar,ar];case so.SESSION:return[ar];default:return[]}}(e,t);if("undefined"===typeof self||n.includes(Ar)||n.push(Ar),"undefined"!==typeof window)for(var r=0,i=[rr,ar];r<i.length;r++){var a=i[r];n.includes(a)||n.push(a)}return n.includes(Ne)||n.push(Ne),n}Eo.Persistence=so;var Co=function(){function e(){(0,a.Z)(this,e),this.providerId="phone",this._delegate=new ti(go(s.Z.auth()))}return(0,o.Z)(e,[{key:"verifyPhoneNumber",value:function(e,t){return this._delegate.verifyPhoneNumber(e,t)}},{key:"unwrap",value:function(){return this._delegate}}],[{key:"credential",value:function(e,t){return ti.credential(e,t)}}]),e}();Co.PHONE_SIGN_IN_METHOD=ti.PHONE_SIGN_IN_METHOD,Co.PROVIDER_ID=ti.PROVIDER_ID;var No,Do=M,Ro=function(){function e(t,n){var r,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:s.Z.app();(0,a.Z)(this,e),Do(null===(r=i.options)||void 0===r?void 0:r.apiKey,"invalid-api-key",{appName:i.name}),this._delegate=new Kr(t,n,i.auth()),this.type=this._delegate.type}return(0,o.Z)(e,[{key:"clear",value:function(){this._delegate.clear()}},{key:"render",value:function(){return this._delegate.render()}},{key:"verify",value:function(){return this._delegate.verify()}}]),e}(),Oo="auth-compat";(No=s.Z).INTERNAL.registerComponent(new I.wA(Oo,(function(e){var t=e.getProvider("app-compat").getImmediate(),n=e.getProvider("auth");return new Eo(t,n)}),"PUBLIC").setServiceProps({ActionCodeInfo:{Operation:{EMAIL_SIGNIN:_.EMAIL_SIGNIN,PASSWORD_RESET:_.PASSWORD_RESET,RECOVER_EMAIL:_.RECOVER_EMAIL,REVERT_SECOND_FACTOR_ADDITION:_.REVERT_SECOND_FACTOR_ADDITION,VERIFY_AND_CHANGE_EMAIL:_.VERIFY_AND_CHANGE_EMAIL,VERIFY_EMAIL:_.VERIFY_EMAIL}},EmailAuthProvider:Rt,FacebookAuthProvider:Mt,GithubAuthProvider:Vt,GoogleAuthProvider:Ft,OAuthProvider:Lt,SAMLAuthProvider:Bt,PhoneAuthProvider:Co,PhoneMultiFactorGenerator:ka,RecaptchaVerifier:Ro,TwitterAuthProvider:jt,Auth:Eo,AuthCredential:Xe,Error:k.ZR}).setInstantiationMode("LAZY").setMultipleInstances(!1)),No.registerVersion(Ya,Ja)},13823:function(e,t,n){"use strict";var r,i=n(5647),a=n(60136),o=n(29388),u=n(37762),s=n(15671),c=n(43144),l=n(30166),h=n(11752),f=n(61120),d=n(29439),v=n(74165),p=n(15861),y=n(93433),m=n(67825),g=n(23258),k=n(6781),w=n(85854),b="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof window?window:"undefined"!==typeof n.g?n.g:"undefined"!==typeof self?self:{},Z={},I=I||{},x=b||self;function _(){}function T(e){var t=typeof e;return"array"==(t="object"!=t?t:e?Array.isArray(e)?"array":t:"null")||"object"==t&&"number"==typeof e.length}function E(e){var t=typeof e;return"object"==t&&null!=e||"function"==t}var S="closure_uid_"+(1e9*Math.random()>>>0),A=0;function C(e,t,n){return e.call.apply(e.bind,arguments)}function N(e,t,n){if(!e)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),e.apply(t,n)}}return function(){return e.apply(t,arguments)}}function D(e,t,n){return(D=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?C:N).apply(null,arguments)}function R(e,t){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}function O(e,t){function n(){}n.prototype=t.prototype,e.X=t.prototype,e.prototype=new n,e.prototype.constructor=e,e.Wb=function(e,n,r){for(var i=Array(arguments.length-2),a=2;a<arguments.length;a++)i[a-2]=arguments[a];return t.prototype[n].apply(e,i)}}function P(){this.s=this.s,this.o=this.o}P.prototype.s=!1,P.prototype.na=function(){var e;!this.s&&(this.s=!0,this.M(),0)&&(e=this,Object.prototype.hasOwnProperty.call(e,S)&&e[S]||(e[S]=++A))},P.prototype.M=function(){if(this.o)for(;this.o.length;)this.o.shift()()};var L=Array.prototype.indexOf?function(e,t){return Array.prototype.indexOf.call(e,t,void 0)}:function(e,t){if("string"===typeof e)return"string"!==typeof t||1!=t.length?-1:e.indexOf(t,0);for(var n=0;n<e.length;n++)if(n in e&&e[n]===t)return n;return-1};function M(e){var t=e.length;if(0<t){for(var n=Array(t),r=0;r<t;r++)n[r]=e[r];return n}return[]}function F(e,t){for(var n=1;n<arguments.length;n++){var r=arguments[n];if(T(r)){var i=e.length||0,a=r.length||0;e.length=i+a;for(var o=0;o<a;o++)e[i+o]=r[o]}else e.push(r)}}function V(e,t){this.type=e,this.g=this.target=t,this.defaultPrevented=!1}V.prototype.h=function(){this.defaultPrevented=!0};var U=function(){if(!x.addEventListener||!Object.defineProperty)return!1;var e=!1,t=Object.defineProperty({},"passive",{get:function(){e=!0}});try{x.addEventListener("test",_,t),x.removeEventListener("test",_,t)}catch(n){}return e}();function q(e){return/^[\s\xa0]*$/.test(e)}var B=String.prototype.trim?function(e){return e.trim()}:function(e){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(e)[1]};function j(e,t){return e<t?-1:e>t?1:0}function G(){var e=x.navigator;return e&&(e=e.userAgent)?e:""}function K(e){return-1!=G().indexOf(e)}function z(e){return z[" "](e),e}z[" "]=_;var W,H=K("Opera"),Q=K("Trident")||K("MSIE"),Y=K("Edge"),J=Y||Q,X=K("Gecko")&&!(-1!=G().toLowerCase().indexOf("webkit")&&!K("Edge"))&&!(K("Trident")||K("MSIE"))&&!K("Edge"),$=-1!=G().toLowerCase().indexOf("webkit")&&!K("Edge");function ee(){var e=x.document;return e?e.documentMode:void 0}e:{var te="",ne=function(){var e=G();return X?/rv:([^\);]+)(\)|;)/.exec(e):Y?/Edge\/([\d\.]+)/.exec(e):Q?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(e):$?/WebKit\/(\S+)/.exec(e):H?/(?:Version)[ \/]?(\S+)/.exec(e):void 0}();if(ne&&(te=ne?ne[1]:""),Q){var re=ee();if(null!=re&&re>parseFloat(te)){W=String(re);break e}}W=te}var ie,ae={};function oe(){return function(e){var t=ae;return Object.prototype.hasOwnProperty.call(t,9)?t[9]:t[9]=e(9)}((function(){for(var e=0,t=B(String(W)).split("."),n=B("9").split("."),r=Math.max(t.length,n.length),i=0;0==e&&i<r;i++){var a=t[i]||"",o=n[i]||"";do{if(a=/(\d*)(\D*)(.*)/.exec(a)||["","","",""],o=/(\d*)(\D*)(.*)/.exec(o)||["","","",""],0==a[0].length&&0==o[0].length)break;e=j(0==a[1].length?0:parseInt(a[1],10),0==o[1].length?0:parseInt(o[1],10))||j(0==a[2].length,0==o[2].length)||j(a[2],o[2]),a=a[3],o=o[3]}while(0==e)}return 0<=e}))}if(x.document&&Q){var ue=ee();ie=ue||(parseInt(W,10)||void 0)}else ie=void 0;var se=ie;function ce(e,t){if(V.call(this,e?e.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,e){var n=this.type=e.type,r=e.changedTouches&&e.changedTouches.length?e.changedTouches[0]:null;if(this.target=e.target||e.srcElement,this.g=t,t=e.relatedTarget){if(X){e:{try{z(t.nodeName);var i=!0;break e}catch(a){}i=!1}i||(t=null)}}else"mouseover"==n?t=e.fromElement:"mouseout"==n&&(t=e.toElement);this.relatedTarget=t,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==e.clientX?e.clientX:e.pageX,this.clientY=void 0!==e.clientY?e.clientY:e.pageY,this.screenX=e.screenX||0,this.screenY=e.screenY||0),this.button=e.button,this.key=e.key||"",this.ctrlKey=e.ctrlKey,this.altKey=e.altKey,this.shiftKey=e.shiftKey,this.metaKey=e.metaKey,this.pointerId=e.pointerId||0,this.pointerType="string"===typeof e.pointerType?e.pointerType:le[e.pointerType]||"",this.state=e.state,this.i=e,e.defaultPrevented&&ce.X.h.call(this)}}O(ce,V);var le={2:"touch",3:"pen",4:"mouse"};ce.prototype.h=function(){ce.X.h.call(this);var e=this.i;e.preventDefault?e.preventDefault():e.returnValue=!1};var he="closure_listenable_"+(1e6*Math.random()|0),fe=0;function de(e,t,n,r,i){this.listener=e,this.proxy=null,this.src=t,this.type=n,this.capture=!!r,this.ha=i,this.key=++fe,this.ba=this.ea=!1}function ve(e){e.ba=!0,e.listener=null,e.proxy=null,e.src=null,e.ha=null}function pe(e,t,n){for(var r in e)t.call(n,e[r],r,e)}function ye(e){var t={};for(var n in e)t[n]=e[n];return t}var me="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function ge(e,t){for(var n,r,i=1;i<arguments.length;i++){for(n in r=arguments[i])e[n]=r[n];for(var a=0;a<me.length;a++)n=me[a],Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}}function ke(e){this.src=e,this.g={},this.h=0}function we(e,t){var n=t.type;if(n in e.g){var r,i=e.g[n],a=L(i,t);(r=0<=a)&&Array.prototype.splice.call(i,a,1),r&&(ve(t),0==e.g[n].length&&(delete e.g[n],e.h--))}}function be(e,t,n,r){for(var i=0;i<e.length;++i){var a=e[i];if(!a.ba&&a.listener==t&&a.capture==!!n&&a.ha==r)return i}return-1}ke.prototype.add=function(e,t,n,r,i){var a=e.toString();(e=this.g[a])||(e=this.g[a]=[],this.h++);var o=be(e,t,r,i);return-1<o?(t=e[o],n||(t.ea=!1)):((t=new de(t,this.src,a,!!r,i)).ea=n,e.push(t)),t};var Ze="closure_lm_"+(1e6*Math.random()|0),Ie={};function xe(e,t,n,r,i){if(r&&r.once)return Te(e,t,n,r,i);if(Array.isArray(t)){for(var a=0;a<t.length;a++)xe(e,t[a],n,r,i);return null}return n=Re(n),e&&e[he]?e.N(t,n,E(r)?!!r.capture:!!r,i):_e(e,t,n,!1,r,i)}function _e(e,t,n,r,i,a){if(!t)throw Error("Invalid event type");var o=E(i)?!!i.capture:!!i,u=Ne(e);if(u||(e[Ze]=u=new ke(e)),(n=u.add(t,n,r,o,a)).proxy)return n;if(r=function(){function e(n){return t.call(e.src,e.listener,n)}var t=Ce;return e}(),n.proxy=r,r.src=e,r.listener=n,e.addEventListener)U||(i=o),void 0===i&&(i=!1),e.addEventListener(t.toString(),r,i);else if(e.attachEvent)e.attachEvent(Ae(t.toString()),r);else{if(!e.addListener||!e.removeListener)throw Error("addEventListener and attachEvent are unavailable.");e.addListener(r)}return n}function Te(e,t,n,r,i){if(Array.isArray(t)){for(var a=0;a<t.length;a++)Te(e,t[a],n,r,i);return null}return n=Re(n),e&&e[he]?e.O(t,n,E(r)?!!r.capture:!!r,i):_e(e,t,n,!0,r,i)}function Ee(e,t,n,r,i){if(Array.isArray(t))for(var a=0;a<t.length;a++)Ee(e,t[a],n,r,i);else r=E(r)?!!r.capture:!!r,n=Re(n),e&&e[he]?(e=e.i,(t=String(t).toString())in e.g&&(-1<(n=be(a=e.g[t],n,r,i))&&(ve(a[n]),Array.prototype.splice.call(a,n,1),0==a.length&&(delete e.g[t],e.h--)))):e&&(e=Ne(e))&&(t=e.g[t.toString()],e=-1,t&&(e=be(t,n,r,i)),(n=-1<e?t[e]:null)&&Se(n))}function Se(e){if("number"!==typeof e&&e&&!e.ba){var t=e.src;if(t&&t[he])we(t.i,e);else{var n=e.type,r=e.proxy;t.removeEventListener?t.removeEventListener(n,r,e.capture):t.detachEvent?t.detachEvent(Ae(n),r):t.addListener&&t.removeListener&&t.removeListener(r),(n=Ne(t))?(we(n,e),0==n.h&&(n.src=null,t[Ze]=null)):ve(e)}}}function Ae(e){return e in Ie?Ie[e]:Ie[e]="on"+e}function Ce(e,t){if(e.ba)e=!0;else{t=new ce(t,this);var n=e.listener,r=e.ha||e.src;e.ea&&Se(e),e=n.call(r,t)}return e}function Ne(e){return(e=e[Ze])instanceof ke?e:null}var De="__closure_events_fn_"+(1e9*Math.random()>>>0);function Re(e){return"function"===typeof e?e:(e[De]||(e[De]=function(t){return e.handleEvent(t)}),e[De])}function Oe(){P.call(this),this.i=new ke(this),this.P=this,this.I=null}function Pe(e,t){var n,r=e.I;if(r)for(n=[];r;r=r.I)n.push(r);if(e=e.P,r=t.type||t,"string"===typeof t)t=new V(t,e);else if(t instanceof V)t.target=t.target||e;else{var i=t;ge(t=new V(r,e),i)}if(i=!0,n)for(var a=n.length-1;0<=a;a--){var o=t.g=n[a];i=Le(o,r,!0,t)&&i}if(i=Le(o=t.g=e,r,!0,t)&&i,i=Le(o,r,!1,t)&&i,n)for(a=0;a<n.length;a++)i=Le(o=t.g=n[a],r,!1,t)&&i}function Le(e,t,n,r){if(!(t=e.i.g[String(t)]))return!0;t=t.concat();for(var i=!0,a=0;a<t.length;++a){var o=t[a];if(o&&!o.ba&&o.capture==n){var u=o.listener,s=o.ha||o.src;o.ea&&we(e.i,o),i=!1!==u.call(s,r)&&i}}return i&&!r.defaultPrevented}O(Oe,P),Oe.prototype[he]=!0,Oe.prototype.removeEventListener=function(e,t,n,r){Ee(this,e,t,n,r)},Oe.prototype.M=function(){if(Oe.X.M.call(this),this.i){var e,t=this.i;for(e in t.g){for(var n=t.g[e],r=0;r<n.length;r++)ve(n[r]);delete t.g[e],t.h--}}this.I=null},Oe.prototype.N=function(e,t,n,r){return this.i.add(String(e),t,!1,n,r)},Oe.prototype.O=function(e,t,n,r){return this.i.add(String(e),t,!0,n,r)};var Me=x.JSON.stringify;function Fe(){var e=ze,t=null;return e.g&&(t=e.g,e.g=e.g.next,e.g||(e.h=null),t.next=null),t}var Ve,Ue=function(){function e(){(0,s.Z)(this,e),this.h=this.g=null}return(0,c.Z)(e,[{key:"add",value:function(e,t){var n=qe.get();n.set(e,t),this.h?this.h.next=n:this.g=n,this.h=n}}]),e}(),qe=new(function(){function e(t,n){(0,s.Z)(this,e),this.i=t,this.j=n,this.h=0,this.g=null}return(0,c.Z)(e,[{key:"get",value:function(){var e;return 0<this.h?(this.h--,e=this.g,this.g=e.next,e.next=null):e=this.i(),e}}]),e}())((function(){return new Be}),(function(e){return e.reset()})),Be=function(){function e(){(0,s.Z)(this,e),this.next=this.g=this.h=null}return(0,c.Z)(e,[{key:"set",value:function(e,t){this.h=e,this.g=t,this.next=null}},{key:"reset",value:function(){this.next=this.g=this.h=null}}]),e}();function je(e){x.setTimeout((function(){throw e}),0)}function Ge(e,t){Ve||function(){var e=x.Promise.resolve(void 0);Ve=function(){e.then(We)}}(),Ke||(Ve(),Ke=!0),ze.add(e,t)}var Ke=!1,ze=new Ue;function We(){for(var e;e=Fe();){try{e.h.call(e.g)}catch(n){je(n)}var t=qe;t.j(e),100>t.h&&(t.h++,e.next=t.g,t.g=e)}Ke=!1}function He(e,t){Oe.call(this),this.h=e||1,this.g=t||x,this.j=D(this.lb,this),this.l=Date.now()}function Qe(e){e.ca=!1,e.R&&(e.g.clearTimeout(e.R),e.R=null)}function Ye(e,t,n){if("function"===typeof e)n&&(e=D(e,n));else{if(!e||"function"!=typeof e.handleEvent)throw Error("Invalid listener argument");e=D(e.handleEvent,e)}return 2147483647<Number(t)?-1:x.setTimeout(e,t||0)}function Je(e){e.g=Ye((function(){e.g=null,e.i&&(e.i=!1,Je(e))}),e.j);var t=e.h;e.h=null,e.m.apply(null,t)}O(He,Oe),(r=He.prototype).ca=!1,r.R=null,r.lb=function(){if(this.ca){var e=Date.now()-this.l;0<e&&e<.8*this.h?this.R=this.g.setTimeout(this.j,this.h-e):(this.R&&(this.g.clearTimeout(this.R),this.R=null),Pe(this,"tick"),this.ca&&(Qe(this),this.start()))}},r.start=function(){this.ca=!0,this.R||(this.R=this.g.setTimeout(this.j,this.h),this.l=Date.now())},r.M=function(){He.X.M.call(this),Qe(this),delete this.g};var Xe=function(e){(0,a.Z)(n,e);var t=(0,o.Z)(n);function n(e,r){var i;return(0,s.Z)(this,n),(i=t.call(this)).m=e,i.j=r,i.h=null,i.i=!1,i.g=null,i}return(0,c.Z)(n,[{key:"l",value:function(e){this.h=arguments,this.g?this.i=!0:Je(this)}},{key:"M",value:function(){(0,h.Z)((0,f.Z)(n.prototype),"M",this).call(this),this.g&&(x.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}]),n}(P);function $e(e){P.call(this),this.h=e,this.g={}}O($e,P);var et=[];function tt(e,t,n,r){Array.isArray(n)||(n&&(et[0]=n.toString()),n=et);for(var i=0;i<n.length;i++){var a=xe(t,n[i],r||e.handleEvent,!1,e.h||e);if(!a)break;e.g[a.key]=a}}function nt(e){pe(e.g,(function(e,t){this.g.hasOwnProperty(t)&&Se(e)}),e),e.g={}}function rt(){this.g=!0}function it(e,t,n,r){e.info((function(){return"XMLHTTP TEXT ("+t+"): "+function(e,t){if(!e.g)return t;if(!t)return null;try{var n=JSON.parse(t);if(n)for(e=0;e<n.length;e++)if(Array.isArray(n[e])){var r=n[e];if(!(2>r.length)){var i=r[1];if(Array.isArray(i)&&!(1>i.length)){var a=i[0];if("noop"!=a&&"stop"!=a&&"close"!=a)for(var o=1;o<i.length;o++)i[o]=""}}}return Me(n)}catch(u){return t}}(e,n)+(r?" "+r:"")}))}$e.prototype.M=function(){$e.X.M.call(this),nt(this)},$e.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},rt.prototype.Aa=function(){this.g=!1},rt.prototype.info=function(){};var at={},ot=null;function ut(){return ot=ot||new Oe}function st(e){V.call(this,at.Pa,e)}function ct(e){var t=ut();Pe(t,new st(t))}function lt(e,t){V.call(this,at.STAT_EVENT,e),this.stat=t}function ht(e){var t=ut();Pe(t,new lt(t,e))}function ft(e,t){V.call(this,at.Qa,e),this.size=t}function dt(e,t){if("function"!==typeof e)throw Error("Fn must not be null and must be a function");return x.setTimeout((function(){e()}),t)}at.Pa="serverreachability",O(st,V),at.STAT_EVENT="statevent",O(lt,V),at.Qa="timingevent",O(ft,V);var vt={NO_ERROR:0,mb:1,zb:2,yb:3,tb:4,xb:5,Ab:6,Ma:7,TIMEOUT:8,Db:9},pt={rb:"complete",Nb:"success",Na:"error",Ma:"abort",Fb:"ready",Gb:"readystatechange",TIMEOUT:"timeout",Bb:"incrementaldata",Eb:"progress",ub:"downloadprogress",Vb:"uploadprogress"};function yt(){}function mt(e){return e.h||(e.h=e.i())}function gt(){}yt.prototype.h=null;var kt,wt={OPEN:"a",qb:"b",Na:"c",Cb:"d"};function bt(){V.call(this,"d")}function Zt(){V.call(this,"c")}function It(){}function xt(e,t,n,r){this.l=e,this.j=t,this.m=n,this.U=r||1,this.S=new $e(this),this.O=Tt,e=J?125:void 0,this.T=new He(e),this.H=null,this.i=!1,this.s=this.A=this.v=this.K=this.F=this.V=this.B=null,this.D=[],this.g=null,this.C=0,this.o=this.u=null,this.Y=-1,this.I=!1,this.N=0,this.L=null,this.$=this.J=this.Z=this.P=!1,this.h=new _t}function _t(){this.i=null,this.g="",this.h=!1}O(bt,V),O(Zt,V),O(It,yt),It.prototype.g=function(){return new XMLHttpRequest},It.prototype.i=function(){return{}},kt=new It;var Tt=45e3,Et={},St={};function At(e,t,n){e.K=1,e.v=Ht(jt(t)),e.s=n,e.P=!0,Ct(e,null)}function Ct(e,t){e.F=Date.now(),Ot(e),e.A=jt(e.v);var n=e.A,r=e.U;Array.isArray(r)||(r=[String(r)]),sn(n.i,"t",r),e.C=0,n=e.l.H,e.h=new _t,e.g=cr(e.l,n?t:null,!e.s),0<e.N&&(e.L=new Xe(D(e.La,e,e.g),e.N)),tt(e.S,e.g,"readystatechange",e.ib),t=e.H?ye(e.H):{},e.s?(e.u||(e.u="POST"),t["Content-Type"]="application/x-www-form-urlencoded",e.g.da(e.A,e.u,e.s,t)):(e.u="GET",e.g.da(e.A,e.u,null,t)),ct(),function(e,t,n,r,i,a){e.info((function(){if(e.g)if(a)for(var o="",u=a.split("&"),s=0;s<u.length;s++){var c=u[s].split("=");if(1<c.length){var l=c[0];c=c[1];var h=l.split("_");o=2<=h.length&&"type"==h[1]?o+(l+"=")+c+"&":o+(l+"=redacted&")}}else o=null;else o=a;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+t+"\n"+n+"\n"+o}))}(e.j,e.u,e.A,e.m,e.U,e.s)}function Nt(e){return!!e.g&&("GET"==e.u&&2!=e.K&&e.l.Da)}function Dt(e,t,n){for(var r,i=!0;!e.I&&e.C<n.length;){if((r=Rt(e,n))==St){4==t&&(e.o=4,ht(14),i=!1),it(e.j,e.m,null,"[Incomplete Response]");break}if(r==Et){e.o=4,ht(15),it(e.j,e.m,n,"[Invalid Chunk]"),i=!1;break}it(e.j,e.m,r,null),Vt(e,r)}Nt(e)&&r!=St&&r!=Et&&(e.h.g="",e.C=0),4!=t||0!=n.length||e.h.h||(e.o=1,ht(16),i=!1),e.i=e.i&&i,i?0<n.length&&!e.$&&(e.$=!0,(t=e.l).g==e&&t.$&&!t.K&&(t.j.info("Great, no buffering proxy detected. Bytes received: "+n.length),tr(t),t.K=!0,ht(11))):(it(e.j,e.m,n,"[Invalid Chunked Response]"),Ft(e),Mt(e))}function Rt(e,t){var n=e.C,r=t.indexOf("\n",n);return-1==r?St:(n=Number(t.substring(n,r)),isNaN(n)?Et:(r+=1)+n>t.length?St:(t=t.substr(r,n),e.C=r+n,t))}function Ot(e){e.V=Date.now()+e.O,Pt(e,e.O)}function Pt(e,t){if(null!=e.B)throw Error("WatchDog timer not null");e.B=dt(D(e.gb,e),t)}function Lt(e){e.B&&(x.clearTimeout(e.B),e.B=null)}function Mt(e){0==e.l.G||e.I||ir(e.l,e)}function Ft(e){Lt(e);var t=e.L;t&&"function"==typeof t.na&&t.na(),e.L=null,Qe(e.T),nt(e.S),e.g&&(t=e.g,e.g=null,t.abort(),t.na())}function Vt(e,t){try{var n=e.l;if(0!=n.G&&(n.g==e||yn(n.h,e)))if(!e.J&&yn(n.h,e)&&3==n.G){try{var r=n.Fa.g.parse(t)}catch(a){r=null}if(Array.isArray(r)&&3==r.length){var i=r;if(0==i[0]){e:if(!n.u){if(n.g){if(!(n.g.F+3e3<e.F))break e;rr(n),Wn(n)}er(n),ht(18)}}else n.Ba=i[1],0<n.Ba-n.T&&37500>i[2]&&n.L&&0==n.A&&!n.v&&(n.v=dt(D(n.cb,n),6e3));if(1>=pn(n.h)&&n.ja){try{n.ja()}catch(a){}n.ja=void 0}}else or(n,11)}else if((e.J||n.g==e)&&rr(n),!q(t))for(i=n.Fa.g.parse(t),t=0;t<i.length;t++){var a=i[t];if(n.T=a[0],a=a[1],2==n.G)if("c"==a[0]){n.I=a[1],n.ka=a[2];var o=a[3];null!=o&&(n.ma=o,n.j.info("VER="+n.ma));var u=a[4];null!=u&&(n.Ca=u,n.j.info("SVER="+n.Ca));var s=a[5];null!=s&&"number"===typeof s&&0<s&&(r=1.5*s,n.J=r,n.j.info("backChannelRequestTimeoutMs_="+r)),r=n;var c=e.g;if(c){var l=c.g?c.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(l){var h=r.h;h.g||-1==l.indexOf("spdy")&&-1==l.indexOf("quic")&&-1==l.indexOf("h2")||(h.j=h.l,h.g=new Set,h.h&&(mn(h,h.h),h.h=null))}if(r.D){var f=c.g?c.g.getResponseHeader("X-HTTP-Session-Id"):null;f&&(r.za=f,Wt(r.F,r.D,f))}}n.G=3,n.l&&n.l.xa(),n.$&&(n.P=Date.now()-e.F,n.j.info("Handshake RTT: "+n.P+"ms"));var d=e;if((r=n).sa=sr(r,r.H?r.ka:null,r.V),d.J){gn(r.h,d);var v=d,p=r.J;p&&v.setTimeout(p),v.B&&(Lt(v),Ot(v)),r.g=d}else $n(r);0<n.i.length&&Qn(n)}else"stop"!=a[0]&&"close"!=a[0]||or(n,7);else 3==n.G&&("stop"==a[0]||"close"==a[0]?"stop"==a[0]?or(n,7):zn(n):"noop"!=a[0]&&n.l&&n.l.wa(a),n.A=0)}ct()}catch(a){}}function Ut(e,t){if(e.forEach&&"function"==typeof e.forEach)e.forEach(t,void 0);else if(T(e)||"string"===typeof e)Array.prototype.forEach.call(e,t,void 0);else for(var n=function(e){if(e.oa&&"function"==typeof e.oa)return e.oa();if(!e.W||"function"!=typeof e.W){if("undefined"!==typeof Map&&e instanceof Map)return Array.from(e.keys());if(!("undefined"!==typeof Set&&e instanceof Set)){if(T(e)||"string"===typeof e){var t=[];e=e.length;for(var n=0;n<e;n++)t.push(n);return t}for(var r in t=[],n=0,e)t[n++]=r;return t}}}(e),r=function(e){if(e.W&&"function"==typeof e.W)return e.W();if("undefined"!==typeof Map&&e instanceof Map||"undefined"!==typeof Set&&e instanceof Set)return Array.from(e.values());if("string"===typeof e)return e.split("");if(T(e)){for(var t=[],n=e.length,r=0;r<n;r++)t.push(e[r]);return t}for(r in t=[],n=0,e)t[n++]=e[r];return t}(e),i=r.length,a=0;a<i;a++)t.call(void 0,r[a],n&&n[a],e)}(r=xt.prototype).setTimeout=function(e){this.O=e},r.ib=function(e){e=e.target;var t=this.L;t&&3==Un(e)?t.l():this.La(e)},r.La=function(e){try{if(e==this.g)e:{var t=Un(this.g),n=this.g.Ea();this.g.aa();if(!(3>t)&&(3!=t||J||this.g&&(this.h.h||this.g.fa()||qn(this.g)))){this.I||4!=t||7==n||ct(),Lt(this);var r=this.g.aa();this.Y=r;t:if(Nt(this)){var i=qn(this.g);e="";var a=i.length,o=4==Un(this.g);if(!this.h.i){if("undefined"===typeof TextDecoder){Ft(this),Mt(this);var u="";break t}this.h.i=new x.TextDecoder}for(n=0;n<a;n++)this.h.h=!0,e+=this.h.i.decode(i[n],{stream:o&&n==a-1});i.splice(0,a),this.h.g+=e,this.C=0,u=this.h.g}else u=this.g.fa();if(this.i=200==r,function(e,t,n,r,i,a,o){e.info((function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+t+"\n"+n+"\n"+a+" "+o}))}(this.j,this.u,this.A,this.m,this.U,t,r),this.i){if(this.Z&&!this.J){t:{if(this.g){var s,c=this.g;if((s=c.g?c.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!q(s)){var l=s;break t}}l=null}if(!(r=l)){this.i=!1,this.o=3,ht(12),Ft(this),Mt(this);break e}it(this.j,this.m,r,"Initial handshake response via X-HTTP-Initial-Response"),this.J=!0,Vt(this,r)}this.P?(Dt(this,t,u),J&&this.i&&3==t&&(tt(this.S,this.T,"tick",this.hb),this.T.start())):(it(this.j,this.m,u,null),Vt(this,u)),4==t&&Ft(this),this.i&&!this.I&&(4==t?ir(this.l,this):(this.i=!1,Ot(this)))}else 400==r&&0<u.indexOf("Unknown SID")?(this.o=3,ht(12)):(this.o=0,ht(13)),Ft(this),Mt(this)}}}catch(t){}},r.hb=function(){if(this.g){var e=Un(this.g),t=this.g.fa();this.C<t.length&&(Lt(this),Dt(this,e,t),this.i&&4!=e&&Ot(this))}},r.cancel=function(){this.I=!0,Ft(this)},r.gb=function(){this.B=null;var e=Date.now();0<=e-this.V?(function(e,t){e.info((function(){return"TIMEOUT: "+t}))}(this.j,this.A),2!=this.K&&(ct(),ht(17)),Ft(this),this.o=2,Mt(this)):Pt(this,this.V-e)};var qt=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Bt(e,t){if(this.g=this.s=this.j="",this.m=null,this.o=this.l="",this.h=!1,e instanceof Bt){this.h=void 0!==t?t:e.h,Gt(this,e.j),this.s=e.s,this.g=e.g,Kt(this,e.m),this.l=e.l,t=e.i;var n=new rn;n.i=t.i,t.g&&(n.g=new Map(t.g),n.h=t.h),zt(this,n),this.o=e.o}else e&&(n=String(e).match(qt))?(this.h=!!t,Gt(this,n[1]||"",!0),this.s=Qt(n[2]||""),this.g=Qt(n[3]||"",!0),Kt(this,n[4]),this.l=Qt(n[5]||"",!0),zt(this,n[6]||"",!0),this.o=Qt(n[7]||"")):(this.h=!!t,this.i=new rn(null,this.h))}function jt(e){return new Bt(e)}function Gt(e,t,n){e.j=n?Qt(t,!0):t,e.j&&(e.j=e.j.replace(/:$/,""))}function Kt(e,t){if(t){if(t=Number(t),isNaN(t)||0>t)throw Error("Bad port number "+t);e.m=t}else e.m=null}function zt(e,t,n){t instanceof rn?(e.i=t,function(e,t){t&&!e.j&&(an(e),e.i=null,e.g.forEach((function(e,t){var n=t.toLowerCase();t!=n&&(on(this,t),sn(this,n,e))}),e)),e.j=t}(e.i,e.h)):(n||(t=Yt(t,tn)),e.i=new rn(t,e.h))}function Wt(e,t,n){e.i.set(t,n)}function Ht(e){return Wt(e,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),e}function Qt(e,t){return e?t?decodeURI(e.replace(/%25/g,"%2525")):decodeURIComponent(e):""}function Yt(e,t,n){return"string"===typeof e?(e=encodeURI(e).replace(t,Jt),n&&(e=e.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),e):null}function Jt(e){return"%"+((e=e.charCodeAt(0))>>4&15).toString(16)+(15&e).toString(16)}Bt.prototype.toString=function(){var e=[],t=this.j;t&&e.push(Yt(t,Xt,!0),":");var n=this.g;return(n||"file"==t)&&(e.push("//"),(t=this.s)&&e.push(Yt(t,Xt,!0),"@"),e.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.m)&&e.push(":",String(n))),(n=this.l)&&(this.g&&"/"!=n.charAt(0)&&e.push("/"),e.push(Yt(n,"/"==n.charAt(0)?en:$t,!0))),(n=this.i.toString())&&e.push("?",n),(n=this.o)&&e.push("#",Yt(n,nn)),e.join("")};var Xt=/[#\/\?@]/g,$t=/[#\?:]/g,en=/[#\?]/g,tn=/[#\?@]/g,nn=/#/g;function rn(e,t){this.h=this.g=null,this.i=e||null,this.j=!!t}function an(e){e.g||(e.g=new Map,e.h=0,e.i&&function(e,t){if(e){e=e.split("&");for(var n=0;n<e.length;n++){var r=e[n].indexOf("="),i=null;if(0<=r){var a=e[n].substring(0,r);i=e[n].substring(r+1)}else a=e[n];t(a,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(e.i,(function(t,n){e.add(decodeURIComponent(t.replace(/\+/g," ")),n)})))}function on(e,t){an(e),t=cn(e,t),e.g.has(t)&&(e.i=null,e.h-=e.g.get(t).length,e.g.delete(t))}function un(e,t){return an(e),t=cn(e,t),e.g.has(t)}function sn(e,t,n){on(e,t),0<n.length&&(e.i=null,e.g.set(cn(e,t),M(n)),e.h+=n.length)}function cn(e,t){return t=String(t),e.j&&(t=t.toLowerCase()),t}(r=rn.prototype).add=function(e,t){an(this),this.i=null,e=cn(this,e);var n=this.g.get(e);return n||this.g.set(e,n=[]),n.push(t),this.h+=1,this},r.forEach=function(e,t){an(this),this.g.forEach((function(n,r){n.forEach((function(n){e.call(t,n,r,this)}),this)}),this)},r.oa=function(){an(this);for(var e=Array.from(this.g.values()),t=Array.from(this.g.keys()),n=[],r=0;r<t.length;r++)for(var i=e[r],a=0;a<i.length;a++)n.push(t[r]);return n},r.W=function(e){an(this);var t=[];if("string"===typeof e)un(this,e)&&(t=t.concat(this.g.get(cn(this,e))));else{e=Array.from(this.g.values());for(var n=0;n<e.length;n++)t=t.concat(e[n])}return t},r.set=function(e,t){return an(this),this.i=null,un(this,e=cn(this,e))&&(this.h-=this.g.get(e).length),this.g.set(e,[t]),this.h+=1,this},r.get=function(e,t){return e&&0<(e=this.W(e)).length?String(e[0]):t},r.toString=function(){if(this.i)return this.i;if(!this.g)return"";for(var e=[],t=Array.from(this.g.keys()),n=0;n<t.length;n++){var r=t[n],i=encodeURIComponent(String(r)),a=this.W(r);for(r=0;r<a.length;r++){var o=i;""!==a[r]&&(o+="="+encodeURIComponent(String(a[r]))),e.push(o)}}return this.i=e.join("&")};var ln=(0,c.Z)((function e(t,n){(0,s.Z)(this,e),this.h=t,this.g=n}));function hn(e){this.l=e||dn,x.PerformanceNavigationTiming?e=0<(e=x.performance.getEntriesByType("navigation")).length&&("hq"==e[0].nextHopProtocol||"h2"==e[0].nextHopProtocol):e=!!(x.g&&x.g.Ga&&x.g.Ga()&&x.g.Ga().$b),this.j=e?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}var fn,dn=10;function vn(e){return!!e.h||!!e.g&&e.g.size>=e.j}function pn(e){return e.h?1:e.g?e.g.size:0}function yn(e,t){return e.h?e.h==t:!!e.g&&e.g.has(t)}function mn(e,t){e.g?e.g.add(t):e.h=t}function gn(e,t){e.h&&e.h==t?e.h=null:e.g&&e.g.has(t)&&e.g.delete(t)}function kn(e){if(null!=e.h)return e.i.concat(e.h.D);if(null!=e.g&&0!==e.g.size){var t,n=e.i,r=(0,u.Z)(e.g.values());try{for(r.s();!(t=r.n()).done;){var i=t.value;n=n.concat(i.D)}}catch(a){r.e(a)}finally{r.f()}return n}return M(e.i)}function wn(){}function bn(){this.g=new wn}function Zn(e,t,n){var r=n||"";try{Ut(e,(function(e,n){var i=e;E(e)&&(i=Me(e)),t.push(r+n+"="+encodeURIComponent(i))}))}catch(i){throw t.push(r+"type="+encodeURIComponent("_badmap")),i}}function In(e,t,n,r,i){try{t.onload=null,t.onerror=null,t.onabort=null,t.ontimeout=null,i(r)}catch(a){}}function xn(e){this.l=e.ac||null,this.j=e.jb||!1}function _n(e,t){Oe.call(this),this.D=e,this.u=t,this.m=void 0,this.readyState=Tn,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}hn.prototype.cancel=function(){if(this.i=kn(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){var e,t=(0,u.Z)(this.g.values());try{for(t.s();!(e=t.n()).done;){e.value.cancel()}}catch(n){t.e(n)}finally{t.f()}this.g.clear()}},wn.prototype.stringify=function(e){return x.JSON.stringify(e,void 0)},wn.prototype.parse=function(e){return x.JSON.parse(e,void 0)},O(xn,yt),xn.prototype.g=function(){return new _n(this.l,this.j)},xn.prototype.i=(fn={},function(){return fn}),O(_n,Oe);var Tn=0;function En(e){e.j.read().then(e.Ta.bind(e)).catch(e.ga.bind(e))}function Sn(e){e.readyState=4,e.l=null,e.j=null,e.A=null,An(e)}function An(e){e.onreadystatechange&&e.onreadystatechange.call(e)}(r=_n.prototype).open=function(e,t){if(this.readyState!=Tn)throw this.abort(),Error("Error reopening a connection");this.C=e,this.B=t,this.readyState=1,An(this)},r.send=function(e){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;var t={headers:this.v,method:this.C,credentials:this.m,cache:void 0};e&&(t.body=e),(this.D||x).fetch(new Request(this.B,t)).then(this.Wa.bind(this),this.ga.bind(this))},r.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch((function(){})),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,Sn(this)),this.readyState=Tn},r.Wa=function(e){if(this.g&&(this.l=e,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=e.headers,this.readyState=2,An(this)),this.g&&(this.readyState=3,An(this),this.g)))if("arraybuffer"===this.responseType)e.arrayBuffer().then(this.Ua.bind(this),this.ga.bind(this));else if("undefined"!==typeof x.ReadableStream&&"body"in e){if(this.j=e.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;En(this)}else e.text().then(this.Va.bind(this),this.ga.bind(this))},r.Ta=function(e){if(this.g){if(this.u&&e.value)this.response.push(e.value);else if(!this.u){var t=e.value?e.value:new Uint8Array(0);(t=this.A.decode(t,{stream:!e.done}))&&(this.response=this.responseText+=t)}e.done?Sn(this):An(this),3==this.readyState&&En(this)}},r.Va=function(e){this.g&&(this.response=this.responseText=e,Sn(this))},r.Ua=function(e){this.g&&(this.response=e,Sn(this))},r.ga=function(){this.g&&Sn(this)},r.setRequestHeader=function(e,t){this.v.append(e,t)},r.getResponseHeader=function(e){return this.h&&this.h.get(e.toLowerCase())||""},r.getAllResponseHeaders=function(){if(!this.h)return"";for(var e=[],t=this.h.entries(),n=t.next();!n.done;)n=n.value,e.push(n[0]+": "+n[1]),n=t.next();return e.join("\r\n")},Object.defineProperty(_n.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(e){this.m=e?"include":"same-origin"}});var Cn=x.JSON.parse;function Nn(e){Oe.call(this),this.headers=new Map,this.u=e||null,this.h=!1,this.C=this.g=null,this.H="",this.m=0,this.j="",this.l=this.F=this.v=this.D=!1,this.B=0,this.A=null,this.J=Dn,this.K=this.L=!1}O(Nn,Oe);var Dn="",Rn=/^https?$/i,On=["POST","PUT"];function Pn(e,t){e.h=!1,e.g&&(e.l=!0,e.g.abort(),e.l=!1),e.j=t,e.m=5,Ln(e),Fn(e)}function Ln(e){e.D||(e.D=!0,Pe(e,"complete"),Pe(e,"error"))}function Mn(e){if(e.h&&"undefined"!=typeof I&&(!e.C[1]||4!=Un(e)||2!=e.aa()))if(e.v&&4==Un(e))Ye(e.Ha,0,e);else if(Pe(e,"readystatechange"),4==Un(e)){e.h=!1;try{var t,n=e.aa();e:switch(n){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var r=!0;break e;default:r=!1}if(!(t=r)){var i;if(i=0===n){var a=String(e.H).match(qt)[1]||null;if(!a&&x.self&&x.self.location){var o=x.self.location.protocol;a=o.substr(0,o.length-1)}i=!Rn.test(a?a.toLowerCase():"")}t=i}if(t)Pe(e,"complete"),Pe(e,"success");else{e.m=6;try{var u=2<Un(e)?e.g.statusText:""}catch(s){u=""}e.j=u+" ["+e.aa()+"]",Ln(e)}}finally{Fn(e)}}}function Fn(e,t){if(e.g){Vn(e);var n=e.g,r=e.C[0]?_:null;e.g=null,e.C=null,t||Pe(e,"ready");try{n.onreadystatechange=r}catch(i){}}}function Vn(e){e.g&&e.K&&(e.g.ontimeout=null),e.A&&(x.clearTimeout(e.A),e.A=null)}function Un(e){return e.g?e.g.readyState:0}function qn(e){try{if(!e.g)return null;if("response"in e.g)return e.g.response;switch(e.J){case Dn:case"text":return e.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in e.g)return e.g.mozResponseArrayBuffer}return null}catch(_r){return null}}function Bn(e){var t="";return pe(e,(function(e,n){t+=n,t+=":",t+=e,t+="\r\n"})),t}function jn(e,t,n){e:{for(r in n){var r=!1;break e}r=!0}r||(n=Bn(n),"string"===typeof e?null!=n&&encodeURIComponent(String(n)):Wt(e,t,n))}function Gn(e,t,n){return n&&n.internalChannelParams&&n.internalChannelParams[e]||t}function Kn(e){this.Ca=0,this.i=[],this.j=new rt,this.ka=this.sa=this.F=this.V=this.g=this.za=this.D=this.ia=this.o=this.S=this.s=null,this.ab=this.U=0,this.Za=Gn("failFast",!1,e),this.L=this.v=this.u=this.m=this.l=null,this.Y=!0,this.pa=this.Ba=this.T=-1,this.Z=this.A=this.C=0,this.Xa=Gn("baseRetryDelayMs",5e3,e),this.bb=Gn("retryDelaySeedMs",1e4,e),this.$a=Gn("forwardChannelMaxRetries",2,e),this.ta=Gn("forwardChannelRequestTimeoutMs",2e4,e),this.ra=e&&e.xmlHttpFactory||void 0,this.Da=e&&e.Zb||!1,this.J=void 0,this.H=e&&e.supportsCrossDomainXhr||!1,this.I="",this.h=new hn(e&&e.concurrentRequestLimit),this.Fa=new bn,this.O=e&&e.fastHandshake||!1,this.N=e&&e.encodeInitMessageHeaders||!1,this.O&&this.N&&(this.N=!1),this.Ya=e&&e.Xb||!1,e&&e.Aa&&this.j.Aa(),e&&e.forceLongPolling&&(this.Y=!1),this.$=!this.O&&this.Y&&e&&e.detectBufferingProxy||!1,this.ja=void 0,this.P=0,this.K=!1,this.la=this.B=null}function zn(e){if(Hn(e),3==e.G){var t=e.U++,n=jt(e.F);Wt(n,"SID",e.I),Wt(n,"RID",t),Wt(n,"TYPE","terminate"),Jn(e,n),(t=new xt(e,e.j,t,void 0)).K=2,t.v=Ht(jt(n)),n=!1,x.navigator&&x.navigator.sendBeacon&&(n=x.navigator.sendBeacon(t.v.toString(),"")),!n&&x.Image&&((new Image).src=t.v,n=!0),n||(t.g=cr(t.l,null),t.g.da(t.v)),t.F=Date.now(),Ot(t)}ur(e)}function Wn(e){e.g&&(tr(e),e.g.cancel(),e.g=null)}function Hn(e){Wn(e),e.u&&(x.clearTimeout(e.u),e.u=null),rr(e),e.h.cancel(),e.m&&("number"===typeof e.m&&x.clearTimeout(e.m),e.m=null)}function Qn(e){vn(e.h)||e.m||(e.m=!0,Ge(e.Ja,e),e.C=0)}function Yn(e,t){var n;n=t?t.m:e.U++;var r=jt(e.F);Wt(r,"SID",e.I),Wt(r,"RID",n),Wt(r,"AID",e.T),Jn(e,r),e.o&&e.s&&jn(r,e.o,e.s),n=new xt(e,e.j,n,e.C+1),null===e.o&&(n.H=e.s),t&&(e.i=t.D.concat(e.i)),t=Xn(e,n,1e3),n.setTimeout(Math.round(.5*e.ta)+Math.round(.5*e.ta*Math.random())),mn(e.h,n),At(n,r,t)}function Jn(e,t){e.ia&&pe(e.ia,(function(e,n){Wt(t,n,e)})),e.l&&Ut({},(function(e,n){Wt(t,n,e)}))}function Xn(e,t,n){n=Math.min(e.i.length,n);var r=e.l?D(e.l.Ra,e.l,e):null;e:for(var i=e.i,a=-1;;){var o=["count="+n];-1==a?0<n?(a=i[0].h,o.push("ofs="+a)):a=0:o.push("ofs="+a);for(var u=!0,s=0;s<n;s++){var c=i[s].h,l=i[s].g;if(0>(c-=a))a=Math.max(0,i[s].h-100),u=!1;else try{Zn(l,o,"req"+c+"_")}catch(h){r&&r(l)}}if(u){r=o.join("&");break e}}return e=e.i.splice(0,n),t.D=e,r}function $n(e){e.g||e.u||(e.Z=1,Ge(e.Ia,e),e.A=0)}function er(e){return!(e.g||e.u||3<=e.A)&&(e.Z++,e.u=dt(D(e.Ia,e),ar(e,e.A)),e.A++,!0)}function tr(e){null!=e.B&&(x.clearTimeout(e.B),e.B=null)}function nr(e){e.g=new xt(e,e.j,"rpc",e.Z),null===e.o&&(e.g.H=e.s),e.g.N=0;var t=jt(e.sa);Wt(t,"RID","rpc"),Wt(t,"SID",e.I),Wt(t,"CI",e.L?"0":"1"),Wt(t,"AID",e.T),Wt(t,"TYPE","xmlhttp"),Jn(e,t),e.o&&e.s&&jn(t,e.o,e.s),e.J&&e.g.setTimeout(e.J);var n=e.g;e=e.ka,n.K=1,n.v=Ht(jt(t)),n.s=null,n.P=!0,Ct(n,e)}function rr(e){null!=e.v&&(x.clearTimeout(e.v),e.v=null)}function ir(e,t){var n=null;if(e.g==t){rr(e),tr(e),e.g=null;var r=2}else{if(!yn(e.h,t))return;n=t.D,gn(e.h,t),r=1}if(0!=e.G)if(e.pa=t.Y,t.i)if(1==r){n=t.s?t.s.length:0,t=Date.now()-t.F;var i=e.C;Pe(r=ut(),new ft(r,n)),Qn(e)}else $n(e);else if(3==(i=t.o)||0==i&&0<e.pa||!(1==r&&function(e,t){return!(pn(e.h)>=e.h.j-(e.m?1:0))&&(e.m?(e.i=t.D.concat(e.i),!0):!(1==e.G||2==e.G||e.C>=(e.Za?0:e.$a))&&(e.m=dt(D(e.Ja,e,t),ar(e,e.C)),e.C++,!0))}(e,t)||2==r&&er(e)))switch(n&&0<n.length&&(t=e.h,t.i=t.i.concat(n)),i){case 1:or(e,5);break;case 4:or(e,10);break;case 3:or(e,6);break;default:or(e,2)}}function ar(e,t){var n=e.Xa+Math.floor(Math.random()*e.bb);return e.l||(n*=2),n*t}function or(e,t){if(e.j.info("Error code "+t),2==t){var n=null;e.l&&(n=null);var r=D(e.kb,e);n||(n=new Bt("//www.google.com/images/cleardot.gif"),x.location&&"http"==x.location.protocol||Gt(n,"https"),Ht(n)),function(e,t){var n=new rt;if(x.Image){var r=new Image;r.onload=R(In,n,r,"TestLoadImage: loaded",!0,t),r.onerror=R(In,n,r,"TestLoadImage: error",!1,t),r.onabort=R(In,n,r,"TestLoadImage: abort",!1,t),r.ontimeout=R(In,n,r,"TestLoadImage: timeout",!1,t),x.setTimeout((function(){r.ontimeout&&r.ontimeout()}),1e4),r.src=e}else t(!1)}(n.toString(),r)}else ht(2);e.G=0,e.l&&e.l.va(t),ur(e),Hn(e)}function ur(e){if(e.G=0,e.la=[],e.l){var t=kn(e.h);0==t.length&&0==e.i.length||(F(e.la,t),F(e.la,e.i),e.h.i.length=0,M(e.i),e.i.length=0),e.l.ua()}}function sr(e,t,n){var r=n instanceof Bt?jt(n):new Bt(n,void 0);if(""!=r.g)t&&(r.g=t+"."+r.g),Kt(r,r.m);else{var i=x.location;r=i.protocol,t=t?t+"."+i.hostname:i.hostname,i=+i.port;var a=new Bt(null,void 0);r&&Gt(a,r),t&&(a.g=t),i&&Kt(a,i),n&&(a.l=n),r=a}return n=e.D,t=e.za,n&&t&&Wt(r,n,t),Wt(r,"VER",e.ma),Jn(e,r),r}function cr(e,t,n){if(t&&!e.H)throw Error("Can't create secondary domain capable XhrIo object.");return(t=n&&e.Da&&!e.ra?new Nn(new xn({jb:!0})):new Nn(e.ra)).Ka(e.H),t}function lr(){}function hr(){if(Q&&!(10<=Number(se)))throw Error("Environmental error: no available transport.")}function fr(e,t){Oe.call(this),this.g=new Kn(t),this.l=e,this.h=t&&t.messageUrlParams||null,e=t&&t.messageHeaders||null,t&&t.clientProtocolHeaderRequired&&(e?e["X-Client-Protocol"]="webchannel":e={"X-Client-Protocol":"webchannel"}),this.g.s=e,e=t&&t.initMessageHeaders||null,t&&t.messageContentType&&(e?e["X-WebChannel-Content-Type"]=t.messageContentType:e={"X-WebChannel-Content-Type":t.messageContentType}),t&&t.ya&&(e?e["X-WebChannel-Client-Profile"]=t.ya:e={"X-WebChannel-Client-Profile":t.ya}),this.g.S=e,(e=t&&t.Yb)&&!q(e)&&(this.g.o=e),this.A=t&&t.supportsCrossDomainXhr||!1,this.v=t&&t.sendRawJson||!1,(t=t&&t.httpSessionIdParam)&&!q(t)&&(this.g.D=t,null!==(e=this.h)&&t in e&&(t in(e=this.h)&&delete e[t])),this.j=new pr(this)}function dr(e){bt.call(this);var t=e.__sm__;if(t){e:{for(var n in t){e=n;break e}e=void 0}(this.i=e)&&(e=this.i,t=null!==t&&e in t?t[e]:void 0),this.data=t}else this.data=e}function vr(){Zt.call(this),this.status=1}function pr(e){this.g=e}(r=Nn.prototype).Ka=function(e){this.L=e},r.da=function(e,t,n,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.H+"; newUri="+e);t=t?t.toUpperCase():"GET",this.H=e,this.j="",this.m=0,this.D=!1,this.h=!0,this.g=this.u?this.u.g():kt.g(),this.C=this.u?mt(this.u):mt(kt),this.g.onreadystatechange=D(this.Ha,this);try{this.F=!0,this.g.open(t,String(e),!0),this.F=!1}catch(s){return void Pn(this,s)}if(e=n||"",n=new Map(this.headers),r)if(Object.getPrototypeOf(r)===Object.prototype)for(var i in r)n.set(i,r[i]);else{if("function"!==typeof r.keys||"function"!==typeof r.get)throw Error("Unknown input type for opt_headers: "+String(r));var a,o=(0,u.Z)(r.keys());try{for(o.s();!(a=o.n()).done;){var s=a.value;n.set(s,r.get(s))}}catch(p){o.e(p)}finally{o.f()}}r=Array.from(n.keys()).find((function(e){return"content-type"==e.toLowerCase()})),i=x.FormData&&e instanceof x.FormData,!(0<=L(On,t))||r||i||n.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");var c,l=(0,u.Z)(n);try{for(l.s();!(c=l.n()).done;){var h=(0,d.Z)(c.value,2),f=h[0],v=h[1];this.g.setRequestHeader(f,v)}}catch(p){l.e(p)}finally{l.f()}this.J&&(this.g.responseType=this.J),"withCredentials"in this.g&&this.g.withCredentials!==this.L&&(this.g.withCredentials=this.L);try{Vn(this),0<this.B&&((this.K=function(e){return Q&&oe()&&"number"===typeof e.timeout&&void 0!==e.ontimeout}(this.g))?(this.g.timeout=this.B,this.g.ontimeout=D(this.qa,this)):this.A=Ye(this.qa,this.B,this)),this.v=!0,this.g.send(e),this.v=!1}catch(s){Pn(this,s)}},r.qa=function(){"undefined"!=typeof I&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,Pe(this,"timeout"),this.abort(8))},r.abort=function(e){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=e||7,Pe(this,"complete"),Pe(this,"abort"),Fn(this))},r.M=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),Fn(this,!0)),Nn.X.M.call(this)},r.Ha=function(){this.s||(this.F||this.v||this.l?Mn(this):this.fb())},r.fb=function(){Mn(this)},r.aa=function(){try{return 2<Un(this)?this.g.status:-1}catch(fn){return-1}},r.fa=function(){try{return this.g?this.g.responseText:""}catch(fn){return""}},r.Sa=function(e){if(this.g){var t=this.g.responseText;return e&&0==t.indexOf(e)&&(t=t.substring(e.length)),Cn(t)}},r.Ea=function(){return this.m},r.Oa=function(){return"string"===typeof this.j?this.j:String(this.j)},(r=Kn.prototype).ma=8,r.G=1,r.Ja=function(e){if(this.m)if(this.m=null,1==this.G){if(!e){this.U=Math.floor(1e5*Math.random()),e=this.U++;var t=new xt(this,this.j,e,void 0),n=this.s;if(this.S&&(n?ge(n=ye(n),this.S):n=this.S),null!==this.o||this.N||(t.H=n,n=null),this.O)e:{for(var r=0,i=0;i<this.i.length;i++){var a=this.i[i];if(void 0===(a="__data__"in a.g&&"string"===typeof(a=a.g.__data__)?a.length:void 0))break;if(4096<(r+=a)){r=i;break e}if(4096===r||i===this.i.length-1){r=i+1;break e}}r=1e3}else r=1e3;r=Xn(this,t,r),Wt(i=jt(this.F),"RID",e),Wt(i,"CVER",22),this.D&&Wt(i,"X-HTTP-Session-Id",this.D),Jn(this,i),n&&(this.N?r="headers="+encodeURIComponent(String(Bn(n)))+"&"+r:this.o&&jn(i,this.o,n)),mn(this.h,t),this.Ya&&Wt(i,"TYPE","init"),this.O?(Wt(i,"$req",r),Wt(i,"SID","null"),t.Z=!0,At(t,i,null)):At(t,i,r),this.G=2}}else 3==this.G&&(e?Yn(this,e):0==this.i.length||vn(this.h)||Yn(this))},r.Ia=function(){if(this.u=null,nr(this),this.$&&!(this.K||null==this.g||0>=this.P)){var e=2*this.P;this.j.info("BP detection timer enabled: "+e),this.B=dt(D(this.eb,this),e)}},r.eb=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.L=!1,this.K=!0,ht(10),Wn(this),nr(this))},r.cb=function(){null!=this.v&&(this.v=null,Wn(this),er(this),ht(19))},r.kb=function(e){e?(this.j.info("Successfully pinged google.com"),ht(2)):(this.j.info("Failed to ping google.com"),ht(1))},(r=lr.prototype).xa=function(){},r.wa=function(){},r.va=function(){},r.ua=function(){},r.Ra=function(){},hr.prototype.g=function(e,t){return new fr(e,t)},O(fr,Oe),fr.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.H=!0);var e=this.g,t=this.l,n=this.h||void 0;ht(0),e.V=t,e.ia=n||{},e.L=e.Y,e.F=sr(e,null,e.V),Qn(e)},fr.prototype.close=function(){zn(this.g)},fr.prototype.u=function(e){var t=this.g;if("string"===typeof e){var n={};n.__data__=e,e=n}else this.v&&((n={}).__data__=Me(e),e=n);t.i.push(new ln(t.ab++,e)),3==t.G&&Qn(t)},fr.prototype.M=function(){this.g.l=null,delete this.j,zn(this.g),delete this.g,fr.X.M.call(this)},O(dr,bt),O(vr,Zt),O(pr,lr),pr.prototype.xa=function(){Pe(this.g,"a")},pr.prototype.wa=function(e){Pe(this.g,new dr(e))},pr.prototype.va=function(e){Pe(this.g,new vr)},pr.prototype.ua=function(){Pe(this.g,"b")},hr.prototype.createWebChannel=hr.prototype.g,fr.prototype.send=fr.prototype.u,fr.prototype.open=fr.prototype.m,fr.prototype.close=fr.prototype.close,vt.NO_ERROR=0,vt.TIMEOUT=8,vt.HTTP_ERROR=6,pt.COMPLETE="complete",gt.EventType=wt,wt.OPEN="a",wt.CLOSE="b",wt.ERROR="c",wt.MESSAGE="d",Oe.prototype.listen=Oe.prototype.N,Nn.prototype.listenOnce=Nn.prototype.O,Nn.prototype.getLastError=Nn.prototype.Oa,Nn.prototype.getLastErrorCode=Nn.prototype.Ea,Nn.prototype.getStatus=Nn.prototype.aa,Nn.prototype.getResponseJson=Nn.prototype.Sa,Nn.prototype.getResponseText=Nn.prototype.fa,Nn.prototype.send=Nn.prototype.da,Nn.prototype.setWithCredentials=Nn.prototype.Ka;var yr=Z.createWebChannelTransport=function(){return new hr},mr=Z.getStatEventTarget=function(){return ut()},gr=Z.ErrorCode=vt,kr=Z.EventType=pt,wr=Z.Event=at,br=Z.Stat={sb:0,vb:1,wb:2,Pb:3,Ub:4,Rb:5,Sb:6,Qb:7,Ob:8,Tb:9,PROXY:10,NOPROXY:11,Mb:12,Ib:13,Jb:14,Hb:15,Kb:16,Lb:17,ob:18,nb:19,pb:20},Zr=Z.FetchXmlHttpFactory=xn,Ir=Z.WebChannel=gt,xr=Z.XhrIo=Nn,_r="@firebase/firestore",Tr=function(){function e(t){(0,s.Z)(this,e),this.uid=t}return(0,c.Z)(e,[{key:"isAuthenticated",value:function(){return null!=this.uid}},{key:"toKey",value:function(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}},{key:"isEqual",value:function(e){return e.uid===this.uid}}]),e}();Tr.UNAUTHENTICATED=new Tr(null),Tr.GOOGLE_CREDENTIALS=new Tr("google-credentials-uid"),Tr.FIRST_PARTY=new Tr("first-party-uid"),Tr.MOCK_USER=new Tr("mock-user");var Er="9.17.1",Sr=new k.Yd("@firebase/firestore");function Ar(){return Sr.logLevel}function Cr(e){if(Sr.logLevel<=k.in.DEBUG){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var i=n.map(Rr);Sr.debug.apply(Sr,["Firestore (".concat(Er,"): ").concat(e)].concat((0,y.Z)(i)))}}function Nr(e){if(Sr.logLevel<=k.in.ERROR){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var i=n.map(Rr);Sr.error.apply(Sr,["Firestore (".concat(Er,"): ").concat(e)].concat((0,y.Z)(i)))}}function Dr(e){if(Sr.logLevel<=k.in.WARN){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var i=n.map(Rr);Sr.warn.apply(Sr,["Firestore (".concat(Er,"): ").concat(e)].concat((0,y.Z)(i)))}}function Rr(e){if("string"==typeof e)return e;try{return t=e,JSON.stringify(t)}catch(t){return e}var t}function Or(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Unexpected state",t="FIRESTORE (".concat(Er,") INTERNAL ASSERTION FAILED: ")+e;throw Nr(t),new Error(t)}function Pr(e,t){e||Or()}function Lr(e,t){return e}var Mr={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},Fr=function(e){(0,a.Z)(n,e);var t=(0,o.Z)(n);function n(e,r){var i;return(0,s.Z)(this,n),(i=t.call(this,e,r)).code=e,i.message=r,i.toString=function(){return"".concat(i.name,": [code=").concat(i.code,"]: ").concat(i.message)},i}return(0,c.Z)(n)}(w.ZR),Vr=(0,c.Z)((function e(){var t=this;(0,s.Z)(this,e),this.promise=new Promise((function(e,n){t.resolve=e,t.reject=n}))})),Ur=(0,c.Z)((function e(t,n){(0,s.Z)(this,e),this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization","Bearer ".concat(t))})),qr=function(){function e(){(0,s.Z)(this,e)}return(0,c.Z)(e,[{key:"getToken",value:function(){return Promise.resolve(null)}},{key:"invalidateToken",value:function(){}},{key:"start",value:function(e,t){e.enqueueRetryable((function(){return t(Tr.UNAUTHENTICATED)}))}},{key:"shutdown",value:function(){}}]),e}(),Br=function(){function e(t){(0,s.Z)(this,e),this.token=t,this.changeListener=null}return(0,c.Z)(e,[{key:"getToken",value:function(){return Promise.resolve(this.token)}},{key:"invalidateToken",value:function(){}},{key:"start",value:function(e,t){var n=this;this.changeListener=t,e.enqueueRetryable((function(){return t(n.token.user)}))}},{key:"shutdown",value:function(){this.changeListener=null}}]),e}(),jr=function(){function e(t){(0,s.Z)(this,e),this.t=t,this.currentUser=Tr.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}return(0,c.Z)(e,[{key:"start",value:function(e,t){var n=this,r=this.i,i=function(e){return n.i!==r?(r=n.i,t(e)):Promise.resolve()},a=new Vr;this.o=function(){n.i++,n.currentUser=n.u(),a.resolve(),a=new Vr,e.enqueueRetryable((function(){return i(n.currentUser)}))};var o=function(){var t=a;e.enqueueRetryable((0,p.Z)((0,v.Z)().mark((function e(){return(0,v.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.promise;case 2:return e.next=4,i(n.currentUser);case 4:case"end":return e.stop()}}),e)}))))},u=function(e){Cr("FirebaseAuthCredentialsProvider","Auth detected"),n.auth=e,n.auth.addAuthTokenListener(n.o),o()};this.t.onInit((function(e){return u(e)})),setTimeout((function(){if(!n.auth){var e=n.t.getImmediate({optional:!0});e?u(e):(Cr("FirebaseAuthCredentialsProvider","Auth not yet detected"),a.resolve(),a=new Vr)}}),0),o()}},{key:"getToken",value:function(){var e=this,t=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then((function(n){return e.i!==t?(Cr("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),e.getToken()):n?(Pr("string"==typeof n.accessToken),new Ur(n.accessToken,e.currentUser)):null})):Promise.resolve(null)}},{key:"invalidateToken",value:function(){this.forceRefresh=!0}},{key:"shutdown",value:function(){this.auth&&this.auth.removeAuthTokenListener(this.o)}},{key:"u",value:function(){var e=this.auth&&this.auth.getUid();return Pr(null===e||"string"==typeof e),new Tr(e)}}]),e}(),Gr=function(){function e(t,n,r,i){(0,s.Z)(this,e),this.h=t,this.l=n,this.m=r,this.g=i,this.type="FirstParty",this.user=Tr.FIRST_PARTY,this.p=new Map}return(0,c.Z)(e,[{key:"I",value:function(){return this.g?this.g():(Pr(!("object"!=typeof this.h||null===this.h||!this.h.auth||!this.h.auth.getAuthHeaderValueForFirstParty)),this.h.auth.getAuthHeaderValueForFirstParty([]))}},{key:"headers",get:function(){this.p.set("X-Goog-AuthUser",this.l);var e=this.I();return e&&this.p.set("Authorization",e),this.m&&this.p.set("X-Goog-Iam-Authorization-Token",this.m),this.p}}]),e}(),Kr=function(){function e(t,n,r,i){(0,s.Z)(this,e),this.h=t,this.l=n,this.m=r,this.g=i}return(0,c.Z)(e,[{key:"getToken",value:function(){return Promise.resolve(new Gr(this.h,this.l,this.m,this.g))}},{key:"start",value:function(e,t){e.enqueueRetryable((function(){return t(Tr.FIRST_PARTY)}))}},{key:"shutdown",value:function(){}},{key:"invalidateToken",value:function(){}}]),e}(),zr=(0,c.Z)((function e(t){(0,s.Z)(this,e),this.value=t,this.type="AppCheck",this.headers=new Map,t&&t.length>0&&this.headers.set("x-firebase-appcheck",this.value)})),Wr=function(){function e(t){(0,s.Z)(this,e),this.T=t,this.forceRefresh=!1,this.appCheck=null,this.A=null}return(0,c.Z)(e,[{key:"start",value:function(e,t){var n=this,r=function(e){null!=e.error&&Cr("FirebaseAppCheckTokenProvider","Error getting App Check token; using placeholder token instead. Error: ".concat(e.error.message));var r=e.token!==n.A;return n.A=e.token,Cr("FirebaseAppCheckTokenProvider","Received ".concat(r?"new":"existing"," token.")),r?t(e.token):Promise.resolve()};this.o=function(t){e.enqueueRetryable((function(){return r(t)}))};var i=function(e){Cr("FirebaseAppCheckTokenProvider","AppCheck detected"),n.appCheck=e,n.appCheck.addTokenListener(n.o)};this.T.onInit((function(e){return i(e)})),setTimeout((function(){if(!n.appCheck){var e=n.T.getImmediate({optional:!0});e?i(e):Cr("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}},{key:"getToken",value:function(){var e=this,t=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(t).then((function(t){return t?(Pr("string"==typeof t.token),e.A=t.token,new zr(t.token)):null})):Promise.resolve(null)}},{key:"invalidateToken",value:function(){this.forceRefresh=!0}},{key:"shutdown",value:function(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}]),e}();function Hr(e){var t="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(e);if(t&&"function"==typeof t.getRandomValues)t.getRandomValues(n);else for(var r=0;r<e;r++)n[r]=Math.floor(256*Math.random());return n}var Qr=function(){function e(){(0,s.Z)(this,e)}return(0,c.Z)(e,null,[{key:"R",value:function(){for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=Math.floor(256/e.length)*e.length,n="";n.length<20;)for(var r=Hr(40),i=0;i<r.length;++i)n.length<20&&r[i]<t&&(n+=e.charAt(r[i]%e.length));return n}}]),e}();function Yr(e,t){return e<t?-1:e>t?1:0}function Jr(e,t,n){return e.length===t.length&&e.every((function(e,r){return n(e,t[r])}))}function Xr(e){return e+"\0"}var $r=function(){function e(t,n){if((0,s.Z)(this,e),this.seconds=t,this.nanoseconds=n,n<0)throw new Fr(Mr.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new Fr(Mr.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(t<-62135596800)throw new Fr(Mr.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new Fr(Mr.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}return(0,c.Z)(e,[{key:"toDate",value:function(){return new Date(this.toMillis())}},{key:"toMillis",value:function(){return 1e3*this.seconds+this.nanoseconds/1e6}},{key:"_compareTo",value:function(e){return this.seconds===e.seconds?Yr(this.nanoseconds,e.nanoseconds):Yr(this.seconds,e.seconds)}},{key:"isEqual",value:function(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}},{key:"toString",value:function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}},{key:"toJSON",value:function(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}},{key:"valueOf",value:function(){var e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}],[{key:"now",value:function(){return e.fromMillis(Date.now())}},{key:"fromDate",value:function(t){return e.fromMillis(t.getTime())}},{key:"fromMillis",value:function(t){var n=Math.floor(t/1e3);return new e(n,Math.floor(1e6*(t-1e3*n)))}}]),e}(),ei=function(){function e(t){(0,s.Z)(this,e),this.timestamp=t}return(0,c.Z)(e,[{key:"compareTo",value:function(e){return this.timestamp._compareTo(e.timestamp)}},{key:"isEqual",value:function(e){return this.timestamp.isEqual(e.timestamp)}},{key:"toMicroseconds",value:function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}},{key:"toString",value:function(){return"SnapshotVersion("+this.timestamp.toString()+")"}},{key:"toTimestamp",value:function(){return this.timestamp}}],[{key:"fromTimestamp",value:function(t){return new e(t)}},{key:"min",value:function(){return new e(new $r(0,0))}},{key:"max",value:function(){return new e(new $r(253402300799,999999999))}}]),e}(),ti=function(){function e(t,n,r){(0,s.Z)(this,e),void 0===n?n=0:n>t.length&&Or(),void 0===r?r=t.length-n:r>t.length-n&&Or(),this.segments=t,this.offset=n,this.len=r}return(0,c.Z)(e,[{key:"length",get:function(){return this.len}},{key:"isEqual",value:function(t){return 0===e.comparator(this,t)}},{key:"child",value:function(t){var n=this.segments.slice(this.offset,this.limit());return t instanceof e?t.forEach((function(e){n.push(e)})):n.push(t),this.construct(n)}},{key:"limit",value:function(){return this.offset+this.length}},{key:"popFirst",value:function(e){return e=void 0===e?1:e,this.construct(this.segments,this.offset+e,this.length-e)}},{key:"popLast",value:function(){return this.construct(this.segments,this.offset,this.length-1)}},{key:"firstSegment",value:function(){return this.segments[this.offset]}},{key:"lastSegment",value:function(){return this.get(this.length-1)}},{key:"get",value:function(e){return this.segments[this.offset+e]}},{key:"isEmpty",value:function(){return 0===this.length}},{key:"isPrefixOf",value:function(e){if(e.length<this.length)return!1;for(var t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}},{key:"isImmediateParentOf",value:function(e){if(this.length+1!==e.length)return!1;for(var t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}},{key:"forEach",value:function(e){for(var t=this.offset,n=this.limit();t<n;t++)e(this.segments[t])}},{key:"toArray",value:function(){return this.segments.slice(this.offset,this.limit())}}],[{key:"comparator",value:function(e,t){for(var n=Math.min(e.length,t.length),r=0;r<n;r++){var i=e.get(r),a=t.get(r);if(i<a)return-1;if(i>a)return 1}return e.length<t.length?-1:e.length>t.length?1:0}}]),e}(),ni=function(e){(0,a.Z)(n,e);var t=(0,o.Z)(n);function n(){return(0,s.Z)(this,n),t.apply(this,arguments)}return(0,c.Z)(n,[{key:"construct",value:function(e,t,r){return new n(e,t,r)}},{key:"canonicalString",value:function(){return this.toArray().join("/")}},{key:"toString",value:function(){return this.canonicalString()}}],[{key:"fromString",value:function(){for(var e=[],t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];for(var a=0,o=r;a<o.length;a++){var u=o[a];if(u.indexOf("//")>=0)throw new Fr(Mr.INVALID_ARGUMENT,"Invalid segment (".concat(u,"). Paths must not contain // in them."));e.push.apply(e,(0,y.Z)(u.split("/").filter((function(e){return e.length>0}))))}return new n(e)}},{key:"emptyPath",value:function(){return new n([])}}]),n}(ti),ri=/^[_a-zA-Z][_a-zA-Z0-9]*$/,ii=function(e){(0,a.Z)(n,e);var t=(0,o.Z)(n);function n(){return(0,s.Z)(this,n),t.apply(this,arguments)}return(0,c.Z)(n,[{key:"construct",value:function(e,t,r){return new n(e,t,r)}},{key:"canonicalString",value:function(){return this.toArray().map((function(e){return e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),n.isValidIdentifier(e)||(e="`"+e+"`"),e})).join(".")}},{key:"toString",value:function(){return this.canonicalString()}},{key:"isKeyField",value:function(){return 1===this.length&&"__name__"===this.get(0)}}],[{key:"isValidIdentifier",value:function(e){return ri.test(e)}},{key:"keyField",value:function(){return new n(["__name__"])}},{key:"fromServerFormat",value:function(e){for(var t=[],r="",i=0,a=function(){if(0===r.length)throw new Fr(Mr.INVALID_ARGUMENT,"Invalid field path (".concat(e,"). Paths must not be empty, begin with '.', end with '.', or contain '..'"));t.push(r),r=""},o=!1;i<e.length;){var u=e[i];if("\\"===u){if(i+1===e.length)throw new Fr(Mr.INVALID_ARGUMENT,"Path has trailing escape character: "+e);var s=e[i+1];if("\\"!==s&&"."!==s&&"`"!==s)throw new Fr(Mr.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=s,i+=2}else"`"===u?(o=!o,i++):"."!==u||o?(r+=u,i++):(a(),i++)}if(a(),o)throw new Fr(Mr.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new n(t)}},{key:"emptyPath",value:function(){return new n([])}}]),n}(ti),ai=function(){function e(t){(0,s.Z)(this,e),this.path=t}return(0,c.Z)(e,[{key:"collectionGroup",get:function(){return this.path.popLast().lastSegment()}},{key:"hasCollectionId",value:function(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}},{key:"getCollectionGroup",value:function(){return this.path.get(this.path.length-2)}},{key:"getCollectionPath",value:function(){return this.path.popLast()}},{key:"isEqual",value:function(e){return null!==e&&0===ni.comparator(this.path,e.path)}},{key:"toString",value:function(){return this.path.toString()}}],[{key:"fromPath",value:function(t){return new e(ni.fromString(t))}},{key:"fromName",value:function(t){return new e(ni.fromString(t).popFirst(5))}},{key:"empty",value:function(){return new e(ni.emptyPath())}},{key:"comparator",value:function(e,t){return ni.comparator(e.path,t.path)}},{key:"isDocumentKey",value:function(e){return e.length%2==0}},{key:"fromSegments",value:function(t){return new e(new ni(t.slice()))}}]),e}(),oi=(0,c.Z)((function e(t,n,r,i){(0,s.Z)(this,e),this.indexId=t,this.collectionGroup=n,this.fields=r,this.indexState=i}));function ui(e){return e.fields.find((function(e){return 2===e.kind}))}function si(e){return e.fields.filter((function(e){return 2!==e.kind}))}oi.UNKNOWN_ID=-1;var ci=(0,c.Z)((function e(t,n){(0,s.Z)(this,e),this.fieldPath=t,this.kind=n}));var li=function(){function e(t,n){(0,s.Z)(this,e),this.sequenceNumber=t,this.offset=n}return(0,c.Z)(e,null,[{key:"empty",value:function(){return new e(0,di.min())}}]),e}();function hi(e,t){var n=e.toTimestamp().seconds,r=e.toTimestamp().nanoseconds+1,i=ei.fromTimestamp(1e9===r?new $r(n+1,0):new $r(n,r));return new di(i,ai.empty(),t)}function fi(e){return new di(e.readTime,e.key,-1)}var di=function(){function e(t,n,r){(0,s.Z)(this,e),this.readTime=t,this.documentKey=n,this.largestBatchId=r}return(0,c.Z)(e,null,[{key:"min",value:function(){return new e(ei.min(),ai.empty(),-1)}},{key:"max",value:function(){return new e(ei.max(),ai.empty(),-1)}}]),e}();function vi(e,t){var n=e.readTime.compareTo(t.readTime);return 0!==n?n:0!==(n=ai.comparator(e.documentKey,t.documentKey))?n:Yr(e.largestBatchId,t.largestBatchId)}var pi="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",yi=function(){function e(){(0,s.Z)(this,e),this.onCommittedListeners=[]}return(0,c.Z)(e,[{key:"addOnCommittedListener",value:function(e){this.onCommittedListeners.push(e)}},{key:"raiseOnCommittedEvent",value:function(){this.onCommittedListeners.forEach((function(e){return e()}))}}]),e}();function mi(e){return gi.apply(this,arguments)}function gi(){return gi=(0,p.Z)((0,v.Z)().mark((function e(t){return(0,v.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.code===Mr.FAILED_PRECONDITION&&t.message===pi){e.next=2;break}throw t;case 2:Cr("LocalStore","Unexpectedly lost primary lease");case 3:case"end":return e.stop()}}),e)}))),gi.apply(this,arguments)}var ki=function(){function e(t){var n=this;(0,s.Z)(this,e),this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,t((function(e){n.isDone=!0,n.result=e,n.nextCallback&&n.nextCallback(e)}),(function(e){n.isDone=!0,n.error=e,n.catchCallback&&n.catchCallback(e)}))}return(0,c.Z)(e,[{key:"catch",value:function(e){return this.next(void 0,e)}},{key:"next",value:function(t,n){var r=this;return this.callbackAttached&&Or(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(t,this.result):new e((function(e,i){r.nextCallback=function(n){r.wrapSuccess(t,n).next(e,i)},r.catchCallback=function(t){r.wrapFailure(n,t).next(e,i)}}))}},{key:"toPromise",value:function(){var e=this;return new Promise((function(t,n){e.next(t,n)}))}},{key:"wrapUserFunction",value:function(t){try{var n=t();return n instanceof e?n:e.resolve(n)}catch(t){return e.reject(t)}}},{key:"wrapSuccess",value:function(t,n){return t?this.wrapUserFunction((function(){return t(n)})):e.resolve(n)}},{key:"wrapFailure",value:function(t,n){return t?this.wrapUserFunction((function(){return t(n)})):e.reject(n)}}],[{key:"resolve",value:function(t){return new e((function(e,n){e(t)}))}},{key:"reject",value:function(t){return new e((function(e,n){n(t)}))}},{key:"waitFor",value:function(t){return new e((function(e,n){var r=0,i=0,a=!1;t.forEach((function(t){++r,t.next((function(){++i,a&&i===r&&e()}),(function(e){return n(e)}))})),a=!0,i===r&&e()}))}},{key:"or",value:function(t){var n,r=e.resolve(!1),i=(0,u.Z)(t);try{var a=function(){var t=n.value;r=r.next((function(n){return n?e.resolve(n):t()}))};for(i.s();!(n=i.n()).done;)a()}catch(o){i.e(o)}finally{i.f()}return r}},{key:"forEach",value:function(e,t){var n=this,r=[];return e.forEach((function(e,i){r.push(t.call(n,e,i))})),this.waitFor(r)}},{key:"mapArray",value:function(t,n){return new e((function(e,r){for(var i=t.length,a=new Array(i),o=0,u=function(){var u=s;n(t[u]).next((function(t){a[u]=t,++o===i&&e(a)}),(function(e){return r(e)}))},s=0;s<i;s++)u()}))}},{key:"doWhile",value:function(t,n){return new e((function(e,r){!function i(){!0===t()?n().next((function(){i()}),r):e()}()}))}}]),e}(),wi=function(){function e(t,n){var r=this;(0,s.Z)(this,e),this.action=t,this.transaction=n,this.aborted=!1,this.P=new Vr,this.transaction.oncomplete=function(){r.P.resolve()},this.transaction.onabort=function(){n.error?r.P.reject(new Ii(t,n.error)):r.P.resolve()},this.transaction.onerror=function(e){var n=Si(e.target.error);r.P.reject(new Ii(t,n))}}return(0,c.Z)(e,[{key:"v",get:function(){return this.P.promise}},{key:"abort",value:function(e){e&&this.P.reject(e),this.aborted||(Cr("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}},{key:"V",value:function(){var e=this.transaction;this.aborted||"function"!=typeof e.commit||e.commit()}},{key:"store",value:function(e){var t=this.transaction.objectStore(e);return new _i(t)}}],[{key:"open",value:function(t,n,r,i){try{return new e(n,t.transaction(i,r))}catch(t){throw new Ii(n,t)}}}]),e}(),bi=function(){function e(t,n,r){(0,s.Z)(this,e),this.name=t,this.version=n,this.S=r,12.2===e.D((0,w.z$)())&&Nr("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}return(0,c.Z)(e,[{key:"F",value:function(){var e=(0,p.Z)((0,v.Z)().mark((function e(t){var n=this;return(0,v.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=this.db,e.t0){e.next=6;break}return Cr("SimpleDb","Opening database:",this.name),e.next=5,new Promise((function(e,r){var i=indexedDB.open(n.name,n.version);i.onsuccess=function(t){var n=t.target.result;e(n)},i.onblocked=function(){r(new Ii(t,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=function(e){var n=e.target.error;"VersionError"===n.name?r(new Fr(Mr.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):"InvalidStateError"===n.name?r(new Fr(Mr.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+n)):r(new Ii(t,n))},i.onupgradeneeded=function(e){Cr("SimpleDb",'Database "'+n.name+'" requires upgrade from version:',e.oldVersion);var t=e.target.result;n.S.$(t,i.transaction,e.oldVersion,n.version).next((function(){Cr("SimpleDb","Database upgrade to version "+n.version+" complete")}))}}));case 5:this.db=e.sent;case 6:return this.B&&(this.db.onversionchange=function(e){return n.B(e)}),e.abrupt("return",this.db);case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"L",value:function(e){this.B=e,this.db&&(this.db.onversionchange=function(t){return e(t)})}},{key:"runTransaction",value:function(){var e=(0,p.Z)((0,v.Z)().mark((function e(t,n,r,i){var a,o,u,s,c=this;return(0,v.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a="readonly"===n,o=0,u=(0,v.Z)().mark((function e(){var n,u,s,l;return(0,v.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return++o,e.prev=1,e.next=4,c.F(t);case 4:return c.db=e.sent,n=wi.open(c.db,t,a?"readonly":"readwrite",r),u=i(n).next((function(e){return n.V(),e})).catch((function(e){return n.abort(e),ki.reject(e)})).toPromise(),u.catch((function(){})),e.next=9,n.v;case 9:return e.t0=u,e.abrupt("return",{v:e.t0});case 13:if(e.prev=13,e.t1=e.catch(1),s=e.t1,l="FirebaseError"!==s.name&&o<3,Cr("SimpleDb","Transaction failed with error:",s.message,"Retrying:",l),c.close(),l){e.next=18;break}return e.abrupt("return",{v:Promise.reject(s)});case 18:case"end":return e.stop()}}),e,null,[[1,13]])}));case 3:return e.delegateYield(u(),"t0",4);case 4:if("object"!==typeof(s=e.t0)){e.next=7;break}return e.abrupt("return",s.v);case 7:e.next=3;break;case 9:case"end":return e.stop()}}),e)})));return function(t,n,r,i){return e.apply(this,arguments)}}()},{key:"close",value:function(){this.db&&this.db.close(),this.db=void 0}}],[{key:"delete",value:function(e){return Cr("SimpleDb","Removing database:",e),Ti(window.indexedDB.deleteDatabase(e)).toPromise()}},{key:"C",value:function(){if(!(0,w.hl)())return!1;if(e.N())return!0;var t=(0,w.z$)(),n=e.D(t),r=0<n&&n<10,i=e.k(t),a=0<i&&i<4.5;return!(t.indexOf("MSIE ")>0||t.indexOf("Trident/")>0||t.indexOf("Edge/")>0||r||a)}},{key:"N",value:function(){var e;return"undefined"!=typeof process&&"YES"===(null===(e={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_API_URL:"http://localhost:4001/"})||void 0===e?void 0:e.O)}},{key:"M",value:function(e,t){return e.store(t)}},{key:"D",value:function(e){var t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),n=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(n)}},{key:"k",value:function(e){var t=e.match(/Android ([\d.]+)/i),n=t?t[1].split(".").slice(0,2).join("."):"-1";return Number(n)}}]),e}(),Zi=function(){function e(t){(0,s.Z)(this,e),this.q=t,this.U=!1,this.K=null}return(0,c.Z)(e,[{key:"isDone",get:function(){return this.U}},{key:"G",get:function(){return this.K}},{key:"cursor",set:function(e){this.q=e}},{key:"done",value:function(){this.U=!0}},{key:"j",value:function(e){this.K=e}},{key:"delete",value:function(){return Ti(this.q.delete())}}]),e}(),Ii=function(e){(0,a.Z)(n,e);var t=(0,o.Z)(n);function n(e,r){var i;return(0,s.Z)(this,n),(i=t.call(this,Mr.UNAVAILABLE,"IndexedDB transaction '".concat(e,"' failed: ").concat(r))).name="IndexedDbTransactionError",i}return(0,c.Z)(n)}(Fr);function xi(e){return"IndexedDbTransactionError"===e.name}var _i=function(){function e(t){(0,s.Z)(this,e),this.store=t}return(0,c.Z)(e,[{key:"put",value:function(e,t){var n;return void 0!==t?(Cr("SimpleDb","PUT",this.store.name,e,t),n=this.store.put(t,e)):(Cr("SimpleDb","PUT",this.store.name,"<auto-key>",e),n=this.store.put(e)),Ti(n)}},{key:"add",value:function(e){return Cr("SimpleDb","ADD",this.store.name,e,e),Ti(this.store.add(e))}},{key:"get",value:function(e){var t=this;return Ti(this.store.get(e)).next((function(n){return void 0===n&&(n=null),Cr("SimpleDb","GET",t.store.name,e,n),n}))}},{key:"delete",value:function(e){return Cr("SimpleDb","DELETE",this.store.name,e),Ti(this.store.delete(e))}},{key:"count",value:function(){return Cr("SimpleDb","COUNT",this.store.name),Ti(this.store.count())}},{key:"W",value:function(e,t){var n=this.options(e,t);if(n.index||"function"!=typeof this.store.getAll){var r=this.cursor(n),i=[];return this.H(r,(function(e,t){i.push(t)})).next((function(){return i}))}var a=this.store.getAll(n.range);return new ki((function(e,t){a.onerror=function(e){t(e.target.error)},a.onsuccess=function(t){e(t.target.result)}}))}},{key:"J",value:function(e,t){var n=this.store.getAll(e,null===t?void 0:t);return new ki((function(e,t){n.onerror=function(e){t(e.target.error)},n.onsuccess=function(t){e(t.target.result)}}))}},{key:"Y",value:function(e,t){Cr("SimpleDb","DELETE ALL",this.store.name);var n=this.options(e,t);n.X=!1;var r=this.cursor(n);return this.H(r,(function(e,t,n){return n.delete()}))}},{key:"Z",value:function(e,t){var n;t?n=e:(n={},t=e);var r=this.cursor(n);return this.H(r,t)}},{key:"tt",value:function(e){var t=this.cursor({});return new ki((function(n,r){t.onerror=function(e){var t=Si(e.target.error);r(t)},t.onsuccess=function(t){var r=t.target.result;r?e(r.primaryKey,r.value).next((function(e){e?r.continue():n()})):n()}}))}},{key:"H",value:function(e,t){var n=[];return new ki((function(r,i){e.onerror=function(e){i(e.target.error)},e.onsuccess=function(e){var i=e.target.result;if(i){var a=new Zi(i),o=t(i.primaryKey,i.value,a);if(o instanceof ki){var u=o.catch((function(e){return a.done(),ki.reject(e)}));n.push(u)}a.isDone?r():null===a.G?i.continue():i.continue(a.G)}else r()}})).next((function(){return ki.waitFor(n)}))}},{key:"options",value:function(e,t){var n;return void 0!==e&&("string"==typeof e?n=e:t=e),{index:n,range:t}}},{key:"cursor",value:function(e){var t="next";if(e.reverse&&(t="prev"),e.index){var n=this.store.index(e.index);return e.X?n.openKeyCursor(e.range,t):n.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}}]),e}();function Ti(e){return new ki((function(t,n){e.onsuccess=function(e){var n=e.target.result;t(n)},e.onerror=function(e){var t=Si(e.target.error);n(t)}}))}var Ei=!1;function Si(e){var t=bi.D((0,w.z$)());if(t>=12.2&&t<13){var n="An internal error was encountered in the Indexed Database server";if(e.message.indexOf(n)>=0){var r=new Fr("internal","IOS_INDEXEDDB_BUG1: IndexedDb has thrown '".concat(n,"'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround."));return Ei||(Ei=!0,setTimeout((function(){throw r}),0)),r}}return e}var Ai=function(){function e(t,n){(0,s.Z)(this,e),this.asyncQueue=t,this.et=n,this.task=null}return(0,c.Z)(e,[{key:"start",value:function(){this.nt(15e3)}},{key:"stop",value:function(){this.task&&(this.task.cancel(),this.task=null)}},{key:"started",get:function(){return null!==this.task}},{key:"nt",value:function(e){var t=this;Cr("IndexBackiller","Scheduled in ".concat(e,"ms")),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,(0,p.Z)((0,v.Z)().mark((function e(){return(0,v.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.task=null,e.prev=1,e.t0=Cr,e.t1="Documents written: ",e.next=6,t.et.st();case 6:e.t2=e.sent,e.t3=e.t1.concat.call(e.t1,e.t2),(0,e.t0)("IndexBackiller",e.t3),e.next=19;break;case 11:if(e.prev=11,e.t4=e.catch(1),!xi(e.t4)){e.next=17;break}Cr("IndexBackiller","Ignoring IndexedDB error during index backfill: ",e.t4),e.next=19;break;case 17:return e.next=19,mi(e.t4);case 19:return e.next=21,t.nt(6e4);case 21:case"end":return e.stop()}}),e,null,[[1,11]])}))))}}]),e}(),Ci=function(){function e(t,n){(0,s.Z)(this,e),this.localStore=t,this.persistence=n}return(0,c.Z)(e,[{key:"st",value:function(){var e=(0,p.Z)((0,v.Z)().mark((function e(){var t,n=this,r=arguments;return(0,v.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=r.length>0&&void 0!==r[0]?r[0]:50,e.abrupt("return",this.persistence.runTransaction("Backfill Indexes","readwrite-primary",(function(e){return n.it(e,t)})));case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"it",value:function(e,t){var n=this,r=new Set,i=t,a=!0;return ki.doWhile((function(){return!0===a&&i>0}),(function(){return n.localStore.indexManager.getNextCollectionGroupToUpdate(e).next((function(t){if(null!==t&&!r.has(t))return Cr("IndexBackiller","Processing collection: ".concat(t)),n.rt(e,t,i).next((function(e){i-=e,r.add(t)}));a=!1}))})).next((function(){return t-i}))}},{key:"rt",value:function(e,t,n){var r=this;return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next((function(i){return r.localStore.localDocuments.getNextDocuments(e,t,i,n).next((function(n){var a=n.changes;return r.localStore.indexManager.updateIndexEntries(e,a).next((function(){return r.ot(i,n)})).next((function(n){return Cr("IndexBackiller","Updating offset: ".concat(n)),r.localStore.indexManager.updateCollectionGroup(e,t,n)})).next((function(){return a.size}))}))}))}},{key:"ot",value:function(e,t){var n=e;return t.changes.forEach((function(e,t){var r=fi(t);vi(r,n)>0&&(n=r)})),new di(n.readTime,n.documentKey,Math.max(t.batchId,e.largestBatchId))}}]),e}(),Ni=function(){function e(t,n){var r=this;(0,s.Z)(this,e),this.previousValue=t,n&&(n.sequenceNumberHandler=function(e){return r.ut(e)},this.ct=function(e){return n.writeSequenceNumber(e)})}return(0,c.Z)(e,[{key:"ut",value:function(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}},{key:"next",value:function(){var e=++this.previousValue;return this.ct&&this.ct(e),e}}]),e}();Ni.at=-1;var Di=(0,c.Z)((function e(t,n,r,i,a,o,u,c){(0,s.Z)(this,e),this.databaseId=t,this.appId=n,this.persistenceKey=r,this.host=i,this.ssl=a,this.forceLongPolling=o,this.autoDetectLongPolling=u,this.useFetchStreams=c})),Ri=function(){function e(t,n){(0,s.Z)(this,e),this.projectId=t,this.database=n||"(default)"}return(0,c.Z)(e,[{key:"isDefaultDatabase",get:function(){return"(default)"===this.database}},{key:"isEqual",value:function(t){return t instanceof e&&t.projectId===this.projectId&&t.database===this.database}}],[{key:"empty",value:function(){return new e("","")}}]),e}();function Oi(e){var t=0;for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t++;return t}function Pi(e,t){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t(n,e[n])}function Li(e){for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}function Mi(e){return null==e}function Fi(e){return 0===e&&1/e==-1/0}function Vi(e){return"number"==typeof e&&Number.isInteger(e)&&!Fi(e)&&e<=Number.MAX_SAFE_INTEGER&&e>=Number.MIN_SAFE_INTEGER}var Ui=function(e){function t(e){(0,s.Z)(this,t),this.binaryString=e}return(0,c.Z)(t,[{key:e,value:function(){var e=this,t=0;return{next:function(){return t<e.binaryString.length?{value:e.binaryString.charCodeAt(t++),done:!1}:{value:void 0,done:!0}}}}},{key:"toBase64",value:function(){return e=this.binaryString,btoa(e);var e}},{key:"toUint8Array",value:function(){return function(e){for(var t=new Uint8Array(e.length),n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t}(this.binaryString)}},{key:"approximateByteSize",value:function(){return 2*this.binaryString.length}},{key:"compareTo",value:function(e){return Yr(this.binaryString,e.binaryString)}},{key:"isEqual",value:function(e){return this.binaryString===e.binaryString}}],[{key:"fromBase64String",value:function(e){return new t(atob(e))}},{key:"fromUint8Array",value:function(e){var n=function(e){for(var t="",n=0;n<e.length;++n)t+=String.fromCharCode(e[n]);return t}(e);return new t(n)}}]),t}(Symbol.iterator);Ui.EMPTY_BYTE_STRING=new Ui("");var qi=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Bi(e){if(Pr(!!e),"string"==typeof e){var t=0,n=qi.exec(e);if(Pr(!!n),n[1]){var r=n[1];r=(r+"000000000").substr(0,9),t=Number(r)}var i=new Date(e);return{seconds:Math.floor(i.getTime()/1e3),nanos:t}}return{seconds:ji(e.seconds),nanos:ji(e.nanos)}}function ji(e){return"number"==typeof e?e:"string"==typeof e?Number(e):0}function Gi(e){return"string"==typeof e?Ui.fromBase64String(e):Ui.fromUint8Array(e)}function Ki(e){var t,n;return"server_timestamp"===(null===(n=((null===(t=null==e?void 0:e.mapValue)||void 0===t?void 0:t.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function zi(e){var t=e.mapValue.fields.__previous_value__;return Ki(t)?zi(t):t}function Wi(e){var t=Bi(e.mapValue.fields.__local_write_time__.timestampValue);return new $r(t.seconds,t.nanos)}var Hi={mapValue:{fields:{__type__:{stringValue:"__max__"}}}},Qi={nullValue:"NULL_VALUE"};function Yi(e){return"nullValue"in e?0:"booleanValue"in e?1:"integerValue"in e||"doubleValue"in e?2:"timestampValue"in e?3:"stringValue"in e?5:"bytesValue"in e?6:"referenceValue"in e?7:"geoPointValue"in e?8:"arrayValue"in e?9:"mapValue"in e?Ki(e)?4:la(e)?9007199254740991:10:Or()}function Ji(e,t){if(e===t)return!0;var n=Yi(e);if(n!==Yi(t))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return e.booleanValue===t.booleanValue;case 4:return Wi(e).isEqual(Wi(t));case 3:return function(e,t){if("string"==typeof e.timestampValue&&"string"==typeof t.timestampValue&&e.timestampValue.length===t.timestampValue.length)return e.timestampValue===t.timestampValue;var n=Bi(e.timestampValue),r=Bi(t.timestampValue);return n.seconds===r.seconds&&n.nanos===r.nanos}(e,t);case 5:return e.stringValue===t.stringValue;case 6:return function(e,t){return Gi(e.bytesValue).isEqual(Gi(t.bytesValue))}(e,t);case 7:return e.referenceValue===t.referenceValue;case 8:return function(e,t){return ji(e.geoPointValue.latitude)===ji(t.geoPointValue.latitude)&&ji(e.geoPointValue.longitude)===ji(t.geoPointValue.longitude)}(e,t);case 2:return function(e,t){if("integerValue"in e&&"integerValue"in t)return ji(e.integerValue)===ji(t.integerValue);if("doubleValue"in e&&"doubleValue"in t){var n=ji(e.doubleValue),r=ji(t.doubleValue);return n===r?Fi(n)===Fi(r):isNaN(n)&&isNaN(r)}return!1}(e,t);case 9:return Jr(e.arrayValue.values||[],t.arrayValue.values||[],Ji);case 10:return function(e,t){var n=e.mapValue.fields||{},r=t.mapValue.fields||{};if(Oi(n)!==Oi(r))return!1;for(var i in n)if(n.hasOwnProperty(i)&&(void 0===r[i]||!Ji(n[i],r[i])))return!1;return!0}(e,t);default:return Or()}}function Xi(e,t){return void 0!==(e.values||[]).find((function(e){return Ji(e,t)}))}function $i(e,t){if(e===t)return 0;var n=Yi(e),r=Yi(t);if(n!==r)return Yr(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return Yr(e.booleanValue,t.booleanValue);case 2:return function(e,t){var n=ji(e.integerValue||e.doubleValue),r=ji(t.integerValue||t.doubleValue);return n<r?-1:n>r?1:n===r?0:isNaN(n)?isNaN(r)?0:-1:1}(e,t);case 3:return ea(e.timestampValue,t.timestampValue);case 4:return ea(Wi(e),Wi(t));case 5:return Yr(e.stringValue,t.stringValue);case 6:return function(e,t){var n=Gi(e),r=Gi(t);return n.compareTo(r)}(e.bytesValue,t.bytesValue);case 7:return function(e,t){for(var n=e.split("/"),r=t.split("/"),i=0;i<n.length&&i<r.length;i++){var a=Yr(n[i],r[i]);if(0!==a)return a}return Yr(n.length,r.length)}(e.referenceValue,t.referenceValue);case 8:return function(e,t){var n=Yr(ji(e.latitude),ji(t.latitude));return 0!==n?n:Yr(ji(e.longitude),ji(t.longitude))}(e.geoPointValue,t.geoPointValue);case 9:return function(e,t){for(var n=e.values||[],r=t.values||[],i=0;i<n.length&&i<r.length;++i){var a=$i(n[i],r[i]);if(a)return a}return Yr(n.length,r.length)}(e.arrayValue,t.arrayValue);case 10:return function(e,t){if(e===Hi.mapValue&&t===Hi.mapValue)return 0;if(e===Hi.mapValue)return 1;if(t===Hi.mapValue)return-1;var n=e.fields||{},r=Object.keys(n),i=t.fields||{},a=Object.keys(i);r.sort(),a.sort();for(var o=0;o<r.length&&o<a.length;++o){var u=Yr(r[o],a[o]);if(0!==u)return u;var s=$i(n[r[o]],i[a[o]]);if(0!==s)return s}return Yr(r.length,a.length)}(e.mapValue,t.mapValue);default:throw Or()}}function ea(e,t){if("string"==typeof e&&"string"==typeof t&&e.length===t.length)return Yr(e,t);var n=Bi(e),r=Bi(t),i=Yr(n.seconds,r.seconds);return 0!==i?i:Yr(n.nanos,r.nanos)}function ta(e){return na(e)}function na(e){return"nullValue"in e?"null":"booleanValue"in e?""+e.booleanValue:"integerValue"in e?""+e.integerValue:"doubleValue"in e?""+e.doubleValue:"timestampValue"in e?function(e){var t=Bi(e);return"time(".concat(t.seconds,",").concat(t.nanos,")")}(e.timestampValue):"stringValue"in e?e.stringValue:"bytesValue"in e?Gi(e.bytesValue).toBase64():"referenceValue"in e?(n=e.referenceValue,ai.fromName(n).toString()):"geoPointValue"in e?"geo(".concat((t=e.geoPointValue).latitude,",").concat(t.longitude,")"):"arrayValue"in e?function(e){var t,n="[",r=!0,i=(0,u.Z)(e.values||[]);try{for(i.s();!(t=i.n()).done;){var a=t.value;r?r=!1:n+=",",n+=na(a)}}catch(o){i.e(o)}finally{i.f()}return n+"]"}(e.arrayValue):"mapValue"in e?function(e){var t,n=Object.keys(e.fields||{}).sort(),r="{",i=!0,a=(0,u.Z)(n);try{for(a.s();!(t=a.n()).done;){var o=t.value;i?i=!1:r+=",",r+="".concat(o,":").concat(na(e.fields[o]))}}catch(s){a.e(s)}finally{a.f()}return r+"}"}(e.mapValue):Or();var t,n}function ra(e,t){return{referenceValue:"projects/".concat(e.projectId,"/databases/").concat(e.database,"/documents/").concat(t.path.canonicalString())}}function ia(e){return!!e&&"integerValue"in e}function aa(e){return!!e&&"arrayValue"in e}function oa(e){return!!e&&"nullValue"in e}function ua(e){return!!e&&"doubleValue"in e&&isNaN(Number(e.doubleValue))}function sa(e){return!!e&&"mapValue"in e}function ca(e){if(e.geoPointValue)return{geoPointValue:Object.assign({},e.geoPointValue)};if(e.timestampValue&&"object"==typeof e.timestampValue)return{timestampValue:Object.assign({},e.timestampValue)};if(e.mapValue){var t={mapValue:{fields:{}}};return Pi(e.mapValue.fields,(function(e,n){return t.mapValue.fields[e]=ca(n)})),t}if(e.arrayValue){for(var n={arrayValue:{values:[]}},r=0;r<(e.arrayValue.values||[]).length;++r)n.arrayValue.values[r]=ca(e.arrayValue.values[r]);return n}return Object.assign({},e)}function la(e){return"__max__"===(((e.mapValue||{}).fields||{}).__type__||{}).stringValue}function ha(e){return"nullValue"in e?Qi:"booleanValue"in e?{booleanValue:!1}:"integerValue"in e||"doubleValue"in e?{doubleValue:NaN}:"timestampValue"in e?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in e?{stringValue:""}:"bytesValue"in e?{bytesValue:""}:"referenceValue"in e?ra(Ri.empty(),ai.empty()):"geoPointValue"in e?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in e?{arrayValue:{}}:"mapValue"in e?{mapValue:{}}:Or()}function fa(e){return"nullValue"in e?{booleanValue:!1}:"booleanValue"in e?{doubleValue:NaN}:"integerValue"in e||"doubleValue"in e?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in e?{stringValue:""}:"stringValue"in e?{bytesValue:""}:"bytesValue"in e?ra(Ri.empty(),ai.empty()):"referenceValue"in e?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in e?{arrayValue:{}}:"arrayValue"in e?{mapValue:{}}:"mapValue"in e?Hi:Or()}function da(e,t){var n=$i(e.value,t.value);return 0!==n?n:e.inclusive&&!t.inclusive?-1:!e.inclusive&&t.inclusive?1:0}function va(e,t){var n=$i(e.value,t.value);return 0!==n?n:e.inclusive&&!t.inclusive?1:!e.inclusive&&t.inclusive?-1:0}var pa=(0,c.Z)((function e(t,n){(0,s.Z)(this,e),this.position=t,this.inclusive=n}));function ya(e,t,n){for(var r=0,i=0;i<e.position.length;i++){var a=t[i],o=e.position[i];if(r=a.field.isKeyField()?ai.comparator(ai.fromName(o.referenceValue),n.key):$i(o,n.data.field(a.field)),"desc"===a.dir&&(r*=-1),0!==r)break}return r}function ma(e,t){if(null===e)return null===t;if(null===t)return!1;if(e.inclusive!==t.inclusive||e.position.length!==t.position.length)return!1;for(var n=0;n<e.position.length;n++)if(!Ji(e.position[n],t.position[n]))return!1;return!0}var ga=(0,c.Z)((function e(){(0,s.Z)(this,e)})),ka=function(e){(0,a.Z)(n,e);var t=(0,o.Z)(n);function n(e,r,i){var a;return(0,s.Z)(this,n),(a=t.call(this)).field=e,a.op=r,a.value=i,a}return(0,c.Z)(n,[{key:"matches",value:function(e){var t=e.data.field(this.field);return"!="===this.op?null!==t&&this.matchesComparison($i(t,this.value)):null!==t&&Yi(this.value)===Yi(t)&&this.matchesComparison($i(t,this.value))}},{key:"matchesComparison",value:function(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return 0===e;case"!=":return 0!==e;case">":return e>0;case">=":return e>=0;default:return Or()}}},{key:"isInequality",value:function(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}},{key:"getFlattenedFilters",value:function(){return[this]}},{key:"getFilters",value:function(){return[this]}},{key:"getFirstInequalityField",value:function(){return this.isInequality()?this.field:null}}],[{key:"create",value:function(e,t,r){return e.isKeyField()?"in"===t||"not-in"===t?this.createKeyFieldInFilter(e,t,r):new Aa(e,t,r):"array-contains"===t?new Ra(e,r):"in"===t?new Oa(e,r):"not-in"===t?new Pa(e,r):"array-contains-any"===t?new La(e,r):new n(e,t,r)}},{key:"createKeyFieldInFilter",value:function(e,t,n){return"in"===t?new Ca(e,n):new Na(e,n)}}]),n}(ga),wa=function(e){(0,a.Z)(n,e);var t=(0,o.Z)(n);function n(e,r){var i;return(0,s.Z)(this,n),(i=t.call(this)).filters=e,i.op=r,i.ht=null,i}return(0,c.Z)(n,[{key:"matches",value:function(e){return ba(this)?void 0===this.filters.find((function(t){return!t.matches(e)})):void 0!==this.filters.find((function(t){return t.matches(e)}))}},{key:"getFlattenedFilters",value:function(){return null!==this.ht||(this.ht=this.filters.reduce((function(e,t){return e.concat(t.getFlattenedFilters())}),[])),this.ht}},{key:"getFilters",value:function(){return Object.assign([],this.filters)}},{key:"getFirstInequalityField",value:function(){var e=this.lt((function(e){return e.isInequality()}));return null!==e?e.field:null}},{key:"lt",value:function(e){var t,n=(0,u.Z)(this.getFlattenedFilters());try{for(n.s();!(t=n.n()).done;){var r=t.value;if(e(r))return r}}catch(i){n.e(i)}finally{n.f()}return null}}],[{key:"create",value:function(e,t){return new n(e,t)}}]),n}(ga);function ba(e){return"and"===e.op}function Za(e){return"or"===e.op}function Ia(e){return xa(e)&&ba(e)}function xa(e){var t,n=(0,u.Z)(e.filters);try{for(n.s();!(t=n.n()).done;){if(t.value instanceof wa)return!1}}catch(r){n.e(r)}finally{n.f()}return!0}function _a(e){if(e instanceof ka)return e.field.canonicalString()+e.op.toString()+ta(e.value);if(Ia(e))return e.filters.map((function(e){return _a(e)})).join(",");var t=e.filters.map((function(e){return _a(e)})).join(",");return"".concat(e.op,"(").concat(t,")")}function Ta(e,t){return e instanceof ka?function(e,t){return t instanceof ka&&e.op===t.op&&e.field.isEqual(t.field)&&Ji(e.value,t.value)}(e,t):e instanceof wa?function(e,t){return t instanceof wa&&e.op===t.op&&e.filters.length===t.filters.length&&e.filters.reduce((function(e,n,r){return e&&Ta(n,t.filters[r])}),!0)}(e,t):void Or()}function Ea(e,t){var n=e.filters.concat(t);return wa.create(n,e.op)}function Sa(e){return e instanceof ka?function(e){return"".concat(e.field.canonicalString()," ").concat(e.op," ").concat(ta(e.value))}(e):e instanceof wa?function(e){return e.op.toString()+" {"+e.getFilters().map(Sa).join(" ,")+"}"}(e):"Filter"}var Aa=function(e){(0,a.Z)(n,e);var t=(0,o.Z)(n);function n(e,r,i){var a;return(0,s.Z)(this,n),(a=t.call(this,e,r,i)).key=ai.fromName(i.referenceValue),a}return(0,c.Z)(n,[{key:"matches",value:function(e){var t=ai.comparator(e.key,this.key);return this.matchesComparison(t)}}]),n}(ka),Ca=function(e){(0,a.Z)(n,e);var t=(0,o.Z)(n);function n(e,r){var i;return(0,s.Z)(this,n),(i=t.call(this,e,"in",r)).keys=Da("in",r),i}return(0,c.Z)(n,[{key:"matches",value:function(e){return this.keys.some((function(t){return t.isEqual(e.key)}))}}]),n}(ka),Na=function(e){(0,a.Z)(n,e);var t=(0,o.Z)(n);function n(e,r){var i;return(0,s.Z)(this,n),(i=t.call(this,e,"not-in",r)).keys=Da("not-in",r),i}return(0,c.Z)(n,[{key:"matches",value:function(e){return!this.keys.some((function(t){return t.isEqual(e.key)}))}}]),n}(ka);function Da(e,t){var n;return((null===(n=t.arrayValue)||void 0===n?void 0:n.values)||[]).map((function(e){return ai.fromName(e.referenceValue)}))}var Ra=function(e){(0,a.Z)(n,e);var t=(0,o.Z)(n);function n(e,r){return(0,s.Z)(this,n),t.call(this,e,"array-contains",r)}return(0,c.Z)(n,[{key:"matches",value:function(e){var t=e.data.field(this.field);return aa(t)&&Xi(t.arrayValue,this.value)}}]),n}(ka),Oa=function(e){(0,a.Z)(n,e);var t=(0,o.Z)(n);function n(e,r){return(0,s.Z)(this,n),t.call(this,e,"in",r)}return(0,c.Z)(n,[{key:"matches",value:function(e){var t=e.data.field(this.field);return null!==t&&Xi(this.value.arrayValue,t)}}]),n}(ka),Pa=function(e){(0,a.Z)(n,e);var t=(0,o.Z)(n);function n(e,r){return(0,s.Z)(this,n),t.call(this,e,"not-in",r)}return(0,c.Z)(n,[{key:"matches",value:function(e){if(Xi(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;var t=e.data.field(this.field);return null!==t&&!Xi(this.value.arrayValue,t)}}]),n}(ka),La=function(e){(0,a.Z)(n,e);var t=(0,o.Z)(n);function n(e,r){return(0,s.Z)(this,n),t.call(this,e,"array-contains-any",r)}return(0,c.Z)(n,[{key:"matches",value:function(e){var t=this,n=e.data.field(this.field);return!(!aa(n)||!n.arrayValue.values)&&n.arrayValue.values.some((function(e){return Xi(t.value.arrayValue,e)}))}}]),n}(ka),Ma=(0,c.Z)((function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"asc";(0,s.Z)(this,e),this.field=t,this.dir=n}));function Fa(e,t){return e.dir===t.dir&&e.field.isEqual(t.field)}var Va=function(){function e(t,n){(0,s.Z)(this,e),this.comparator=t,this.root=n||qa.EMPTY}return(0,c.Z)(e,[{key:"insert",value:function(t,n){return new e(this.comparator,this.root.insert(t,n,this.comparator).copy(null,null,qa.BLACK,null,null))}},{key:"remove",value:function(t){return new e(this.comparator,this.root.remove(t,this.comparator).copy(null,null,qa.BLACK,null,null))}},{key:"get",value:function(e){for(var t=this.root;!t.isEmpty();){var n=this.comparator(e,t.key);if(0===n)return t.value;n<0?t=t.left:n>0&&(t=t.right)}return null}},{key:"indexOf",value:function(e){for(var t=0,n=this.root;!n.isEmpty();){var r=this.comparator(e,n.key);if(0===r)return t+n.left.size;r<0?n=n.left:(t+=n.left.size+1,n=n.right)}return-1}},{key:"isEmpty",value:function(){return this.root.isEmpty()}},{key:"size",get:function(){return this.root.size}},{key:"minKey",value:function(){return this.root.minKey()}},{key:"maxKey",value:function(){return this.root.maxKey()}},{key:"inorderTraversal",value:function(e){return this.root.inorderTraversal(e)}},{key:"forEach",value:function(e){this.inorderTraversal((function(t,n){return e(t,n),!1}))}},{key:"toString",value:function(){var e=[];return this.inorderTraversal((function(t,n){return e.push("".concat(t,":").concat(n)),!1})),"{".concat(e.join(", "),"}")}},{key:"reverseTraversal",value:function(e){return this.root.reverseTraversal(e)}},{key:"getIterator",value:function(){return new Ua(this.root,null,this.comparator,!1)}},{key:"getIteratorFrom",value:function(e){return new Ua(this.root,e,this.comparator,!1)}},{key:"getReverseIterator",value:function(){return new Ua(this.root,null,this.comparator,!0)}},{key:"getReverseIteratorFrom",value:function(e){return new Ua(this.root,e,this.comparator,!0)}}]),e}(),Ua=function(){function e(t,n,r,i){(0,s.Z)(this,e),this.isReverse=i,this.nodeStack=[];for(var a=1;!t.isEmpty();)if(a=n?r(t.key,n):1,n&&i&&(a*=-1),a<0)t=this.isReverse?t.left:t.right;else{if(0===a){this.nodeStack.push(t);break}this.nodeStack.push(t),t=this.isReverse?t.right:t.left}}return(0,c.Z)(e,[{key:"getNext",value:function(){var e=this.nodeStack.pop(),t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}},{key:"hasNext",value:function(){return this.nodeStack.length>0}},{key:"peek",value:function(){if(0===this.nodeStack.length)return null;var e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}]),e}(),qa=function(){function e(t,n,r,i,a){(0,s.Z)(this,e),this.key=t,this.value=n,this.color=null!=r?r:e.RED,this.left=null!=i?i:e.EMPTY,this.right=null!=a?a:e.EMPTY,this.size=this.left.size+1+this.right.size}return(0,c.Z)(e,[{key:"copy",value:function(t,n,r,i,a){return new e(null!=t?t:this.key,null!=n?n:this.value,null!=r?r:this.color,null!=i?i:this.left,null!=a?a:this.right)}},{key:"isEmpty",value:function(){return!1}},{key:"inorderTraversal",value:function(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}},{key:"reverseTraversal",value:function(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}},{key:"min",value:function(){return this.left.isEmpty()?this:this.left.min()}},{key:"minKey",value:function(){return this.min().key}},{key:"maxKey",value:function(){return this.right.isEmpty()?this.key:this.right.maxKey()}},{key:"insert",value:function(e,t,n){var r=this,i=n(e,r.key);return(r=i<0?r.copy(null,null,null,r.left.insert(e,t,n),null):0===i?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,n))).fixUp()}},{key:"removeMin",value:function(){if(this.left.isEmpty())return e.EMPTY;var t=this;return t.left.isRed()||t.left.left.isRed()||(t=t.moveRedLeft()),(t=t.copy(null,null,null,t.left.removeMin(),null)).fixUp()}},{key:"remove",value:function(t,n){var r,i=this;if(n(t,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(t,n),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),0===n(t,i.key)){if(i.right.isEmpty())return e.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(t,n))}return i.fixUp()}},{key:"isRed",value:function(){return this.color}},{key:"fixUp",value:function(){var e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}},{key:"moveRedLeft",value:function(){var e=this.colorFlip();return e.right.left.isRed()&&(e=(e=(e=e.copy(null,null,null,null,e.right.rotateRight())).rotateLeft()).colorFlip()),e}},{key:"moveRedRight",value:function(){var e=this.colorFlip();return e.left.left.isRed()&&(e=(e=e.rotateRight()).colorFlip()),e}},{key:"rotateLeft",value:function(){var t=this.copy(null,null,e.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}},{key:"rotateRight",value:function(){var t=this.copy(null,null,e.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}},{key:"colorFlip",value:function(){var e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}},{key:"checkMaxDepth",value:function(){var e=this.check();return Math.pow(2,e)<=this.size+1}},{key:"check",value:function(){if(this.isRed()&&this.left.isRed())throw Or();if(this.right.isRed())throw Or();var e=this.left.check();if(e!==this.right.check())throw Or();return e+(this.isRed()?0:1)}}]),e}();qa.EMPTY=null,qa.RED=!0,qa.BLACK=!1,qa.EMPTY=new(function(){function e(){(0,s.Z)(this,e),this.size=0}return(0,c.Z)(e,[{key:"key",get:function(){throw Or()}},{key:"value",get:function(){throw Or()}},{key:"color",get:function(){throw Or()}},{key:"left",get:function(){throw Or()}},{key:"right",get:function(){throw Or()}},{key:"copy",value:function(e,t,n,r,i){return this}},{key:"insert",value:function(e,t,n){return new qa(e,t)}},{key:"remove",value:function(e,t){return this}},{key:"isEmpty",value:function(){return!0}},{key:"inorderTraversal",value:function(e){return!1}},{key:"reverseTraversal",value:function(e){return!1}},{key:"minKey",value:function(){return null}},{key:"maxKey",value:function(){return null}},{key:"isRed",value:function(){return!1}},{key:"checkMaxDepth",value:function(){return!0}},{key:"check",value:function(){return 0}}]),e}());var Ba=function(){function e(t){(0,s.Z)(this,e),this.comparator=t,this.data=new Va(this.comparator)}return(0,c.Z)(e,[{key:"has",value:function(e){return null!==this.data.get(e)}},{key:"first",value:function(){return this.data.minKey()}},{key:"last",value:function(){return this.data.maxKey()}},{key:"size",get:function(){return this.data.size}},{key:"indexOf",value:function(e){return this.data.indexOf(e)}},{key:"forEach",value:function(e){this.data.inorderTraversal((function(t,n){return e(t),!1}))}},{key:"forEachInRange",value:function(e,t){for(var n=this.data.getIteratorFrom(e[0]);n.hasNext();){var r=n.getNext();if(this.comparator(r.key,e[1])>=0)return;t(r.key)}}},{key:"forEachWhile",value:function(e,t){var n;for(n=void 0!==t?this.data.getIteratorFrom(t):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}},{key:"firstAfterOrEqual",value:function(e){var t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}},{key:"getIterator",value:function(){return new ja(this.data.getIterator())}},{key:"getIteratorFrom",value:function(e){return new ja(this.data.getIteratorFrom(e))}},{key:"add",value:function(e){return this.copy(this.data.remove(e).insert(e,!0))}},{key:"delete",value:function(e){return this.has(e)?this.copy(this.data.remove(e)):this}},{key:"isEmpty",value:function(){return this.data.isEmpty()}},{key:"unionWith",value:function(e){var t=this;return t.size<e.size&&(t=e,e=this),e.forEach((function(e){t=t.add(e)})),t}},{key:"isEqual",value:function(t){if(!(t instanceof e))return!1;if(this.size!==t.size)return!1;for(var n=this.data.getIterator(),r=t.data.getIterator();n.hasNext();){var i=n.getNext().key,a=r.getNext().key;if(0!==this.comparator(i,a))return!1}return!0}},{key:"toArray",value:function(){var e=[];return this.forEach((function(t){e.push(t)})),e}},{key:"toString",value:function(){var e=[];return this.forEach((function(t){return e.push(t)})),"SortedSet("+e.toString()+")"}},{key:"copy",value:function(t){var n=new e(this.comparator);return n.data=t,n}}]),e}(),ja=function(){function e(t){(0,s.Z)(this,e),this.iter=t}return(0,c.Z)(e,[{key:"getNext",value:function(){return this.iter.getNext().key}},{key:"hasNext",value:function(){return this.iter.hasNext()}}]),e}();function Ga(e){return e.hasNext()?e.getNext():void 0}var Ka=function(){function e(t){(0,s.Z)(this,e),this.fields=t,t.sort(ii.comparator)}return(0,c.Z)(e,[{key:"unionWith",value:function(t){var n,r=new Ba(ii.comparator),i=(0,u.Z)(this.fields);try{for(i.s();!(n=i.n()).done;){var a=n.value;r=r.add(a)}}catch(l){i.e(l)}finally{i.f()}var o,s=(0,u.Z)(t);try{for(s.s();!(o=s.n()).done;){var c=o.value;r=r.add(c)}}catch(l){s.e(l)}finally{s.f()}return new e(r.toArray())}},{key:"covers",value:function(e){var t,n=(0,u.Z)(this.fields);try{for(n.s();!(t=n.n()).done;){if(t.value.isPrefixOf(e))return!0}}catch(r){n.e(r)}finally{n.f()}return!1}},{key:"isEqual",value:function(e){return Jr(this.fields,e.fields,(function(e,t){return e.isEqual(t)}))}}],[{key:"empty",value:function(){return new e([])}}]),e}(),za=function(){function e(t){(0,s.Z)(this,e),this.value=t}return(0,c.Z)(e,[{key:"field",value:function(e){if(e.isEmpty())return this.value;for(var t=this.value,n=0;n<e.length-1;++n)if(!sa(t=(t.mapValue.fields||{})[e.get(n)]))return null;return(t=(t.mapValue.fields||{})[e.lastSegment()])||null}},{key:"set",value:function(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=ca(t)}},{key:"setAll",value:function(e){var t=this,n=ii.emptyPath(),r={},i=[];e.forEach((function(e,a){if(!n.isImmediateParentOf(a)){var o=t.getFieldsMap(n);t.applyChanges(o,r,i),r={},i=[],n=a.popLast()}e?r[a.lastSegment()]=ca(e):i.push(a.lastSegment())}));var a=this.getFieldsMap(n);this.applyChanges(a,r,i)}},{key:"delete",value:function(e){var t=this.field(e.popLast());sa(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}},{key:"isEqual",value:function(e){return Ji(this.value,e.value)}},{key:"getFieldsMap",value:function(e){var t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(var n=0;n<e.length;++n){var r=t.mapValue.fields[e.get(n)];sa(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},t.mapValue.fields[e.get(n)]=r),t=r}return t.mapValue.fields}},{key:"applyChanges",value:function(e,t,n){Pi(t,(function(t,n){return e[t]=n}));var r,i=(0,u.Z)(n);try{for(i.s();!(r=i.n()).done;){var a=r.value;delete e[a]}}catch(o){i.e(o)}finally{i.f()}}},{key:"clone",value:function(){return new e(ca(this.value))}}],[{key:"empty",value:function(){return new e({mapValue:{}})}}]),e}();function Wa(e){var t=[];return Pi(e.fields,(function(e,n){var r=new ii([e]);if(sa(n)){var i=Wa(n.mapValue).fields;if(0===i.length)t.push(r);else{var a,o=(0,u.Z)(i);try{for(o.s();!(a=o.n()).done;){var s=a.value;t.push(r.child(s))}}catch(c){o.e(c)}finally{o.f()}}}else t.push(r)})),new Ka(t)}var Ha=function(){function e(t,n,r,i,a,o,u){(0,s.Z)(this,e),this.key=t,this.documentType=n,this.version=r,this.readTime=i,this.createTime=a,this.data=o,this.documentState=u}return(0,c.Z)(e,[{key:"convertToFoundDocument",value:function(e,t){return!this.createTime.isEqual(ei.min())||2!==this.documentType&&0!==this.documentType||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}},{key:"convertToNoDocument",value:function(e){return this.version=e,this.documentType=2,this.data=za.empty(),this.documentState=0,this}},{key:"convertToUnknownDocument",value:function(e){return this.version=e,this.documentType=3,this.data=za.empty(),this.documentState=2,this}},{key:"setHasCommittedMutations",value:function(){return this.documentState=2,this}},{key:"setHasLocalMutations",value:function(){return this.documentState=1,this.version=ei.min(),this}},{key:"setReadTime",value:function(e){return this.readTime=e,this}},{key:"hasLocalMutations",get:function(){return 1===this.documentState}},{key:"hasCommittedMutations",get:function(){return 2===this.documentState}},{key:"hasPendingWrites",get:function(){return this.hasLocalMutations||this.hasCommittedMutations}},{key:"isValidDocument",value:function(){return 0!==this.documentType}},{key:"isFoundDocument",value:function(){return 1===this.documentType}},{key:"isNoDocument",value:function(){return 2===this.documentType}},{key:"isUnknownDocument",value:function(){return 3===this.documentType}},{key:"isEqual",value:function(t){return t instanceof e&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.documentType===t.documentType&&this.documentState===t.documentState&&this.data.isEqual(t.data)}},{key:"mutableCopy",value:function(){return new e(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}},{key:"toString",value:function(){return"Document(".concat(this.key,", ").concat(this.version,", ").concat(JSON.stringify(this.data.value),", {createTime: ").concat(this.createTime,"}), {documentType: ").concat(this.documentType,"}), {documentState: ").concat(this.documentState,"})")}}],[{key:"newInvalidDocument",value:function(t){return new e(t,0,ei.min(),ei.min(),ei.min(),za.empty(),0)}},{key:"newFoundDocument",value:function(t,n,r,i){return new e(t,1,n,ei.min(),r,i,0)}},{key:"newNoDocument",value:function(t,n){return new e(t,2,n,ei.min(),ei.min(),za.empty(),0)}},{key:"newUnknownDocument",value:function(t,n){return new e(t,3,n,ei.min(),ei.min(),za.empty(),2)}}]),e}(),Qa=(0,c.Z)((function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,u=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;(0,s.Z)(this,e),this.path=t,this.collectionGroup=n,this.orderBy=r,this.filters=i,this.limit=a,this.startAt=o,this.endAt=u,this.ft=null}));function Ya(e){return new Qa(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,arguments.length>6&&void 0!==arguments[6]?arguments[6]:null)}function Ja(e){var t=Lr(e);if(null===t.ft){var n=t.path.canonicalString();null!==t.collectionGroup&&(n+="|cg:"+t.collectionGroup),n+="|f:",n+=t.filters.map((function(e){return _a(e)})).join(","),n+="|ob:",n+=t.orderBy.map((function(e){return function(e){return e.field.canonicalString()+e.dir}(e)})).join(","),Mi(t.limit)||(n+="|l:",n+=t.limit),t.startAt&&(n+="|lb:",n+=t.startAt.inclusive?"b:":"a:",n+=t.startAt.position.map((function(e){return ta(e)})).join(",")),t.endAt&&(n+="|ub:",n+=t.endAt.inclusive?"a:":"b:",n+=t.endAt.position.map((function(e){return ta(e)})).join(",")),t.ft=n}return t.ft}function Xa(e,t){if(e.limit!==t.limit)return!1;if(e.orderBy.length!==t.orderBy.length)return!1;for(var n=0;n<e.orderBy.length;n++)if(!Fa(e.orderBy[n],t.orderBy[n]))return!1;if(e.filters.length!==t.filters.length)return!1;for(var r=0;r<e.filters.length;r++)if(!Ta(e.filters[r],t.filters[r]))return!1;return e.collectionGroup===t.collectionGroup&&!!e.path.isEqual(t.path)&&!!ma(e.startAt,t.startAt)&&ma(e.endAt,t.endAt)}function $a(e){return ai.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}function eo(e,t){return e.filters.filter((function(e){return e instanceof ka&&e.field.isEqual(t)}))}function to(e,t,n){var r,i=Qi,a=!0,o=(0,u.Z)(eo(e,t));try{for(o.s();!(r=o.n()).done;){var s=r.value,c=Qi,l=!0;switch(s.op){case"<":case"<=":c=ha(s.value);break;case"==":case"in":case">=":c=s.value;break;case">":c=s.value,l=!1;break;case"!=":case"not-in":c=Qi}da({value:i,inclusive:a},{value:c,inclusive:l})<0&&(i=c,a=l)}}catch(d){o.e(d)}finally{o.f()}if(null!==n)for(var h=0;h<e.orderBy.length;++h)if(e.orderBy[h].field.isEqual(t)){var f=n.position[h];da({value:i,inclusive:a},{value:f,inclusive:n.inclusive})<0&&(i=f,a=n.inclusive);break}return{value:i,inclusive:a}}function no(e,t,n){var r,i=Hi,a=!0,o=(0,u.Z)(eo(e,t));try{for(o.s();!(r=o.n()).done;){var s=r.value,c=Hi,l=!0;switch(s.op){case">=":case">":c=fa(s.value),l=!1;break;case"==":case"in":case"<=":c=s.value;break;case"<":c=s.value,l=!1;break;case"!=":case"not-in":c=Hi}va({value:i,inclusive:a},{value:c,inclusive:l})>0&&(i=c,a=l)}}catch(d){o.e(d)}finally{o.f()}if(null!==n)for(var h=0;h<e.orderBy.length;++h)if(e.orderBy[h].field.isEqual(t)){var f=n.position[h];va({value:i,inclusive:a},{value:f,inclusive:n.inclusive})>0&&(i=f,a=n.inclusive);break}return{value:i,inclusive:a}}var ro=(0,c.Z)((function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"F",u=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,c=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null;(0,s.Z)(this,e),this.path=t,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=i,this.limit=a,this.limitType=o,this.startAt=u,this.endAt=c,this.dt=null,this._t=null,this.startAt,this.endAt}));function io(e,t,n,r,i,a,o,u){return new ro(e,t,n,r,i,a,o,u)}function ao(e){return new ro(e)}function oo(e){return 0===e.filters.length&&null===e.limit&&null==e.startAt&&null==e.endAt&&(0===e.explicitOrderBy.length||1===e.explicitOrderBy.length&&e.explicitOrderBy[0].field.isKeyField())}function uo(e){return e.explicitOrderBy.length>0?e.explicitOrderBy[0].field:null}function so(e){var t,n=(0,u.Z)(e.filters);try{for(n.s();!(t=n.n()).done;){var r=t.value.getFirstInequalityField();if(null!==r)return r}}catch(i){n.e(i)}finally{n.f()}return null}function co(e){return null!==e.collectionGroup}function lo(e){var t=Lr(e);if(null===t.dt){t.dt=[];var n=so(t),r=uo(t);if(null!==n&&null===r)n.isKeyField()||t.dt.push(new Ma(n)),t.dt.push(new Ma(ii.keyField(),"asc"));else{var i,a=!1,o=(0,u.Z)(t.explicitOrderBy);try{for(o.s();!(i=o.n()).done;){var s=i.value;t.dt.push(s),s.field.isKeyField()&&(a=!0)}}catch(l){o.e(l)}finally{o.f()}if(!a){var c=t.explicitOrderBy.length>0?t.explicitOrderBy[t.explicitOrderBy.length-1].dir:"asc";t.dt.push(new Ma(ii.keyField(),c))}}}return t.dt}function ho(e){var t=Lr(e);if(!t._t)if("F"===t.limitType)t._t=Ya(t.path,t.collectionGroup,lo(t),t.filters,t.limit,t.startAt,t.endAt);else{var n,r=[],i=(0,u.Z)(lo(t));try{for(i.s();!(n=i.n()).done;){var a=n.value,o="desc"===a.dir?"asc":"desc";r.push(new Ma(a.field,o))}}catch(l){i.e(l)}finally{i.f()}var s=t.endAt?new pa(t.endAt.position,t.endAt.inclusive):null,c=t.startAt?new pa(t.startAt.position,t.startAt.inclusive):null;t._t=Ya(t.path,t.collectionGroup,r,t.filters,t.limit,s,c)}return t._t}function fo(e,t){t.getFirstInequalityField(),so(e);var n=e.filters.concat([t]);return new ro(e.path,e.collectionGroup,e.explicitOrderBy.slice(),n,e.limit,e.limitType,e.startAt,e.endAt)}function vo(e,t,n){return new ro(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),t,n,e.startAt,e.endAt)}function po(e,t){return Xa(ho(e),ho(t))&&e.limitType===t.limitType}function yo(e){return"".concat(Ja(ho(e)),"|lt:").concat(e.limitType)}function mo(e){return"Query(target=".concat(function(e){var t=e.path.canonicalString();return null!==e.collectionGroup&&(t+=" collectionGroup="+e.collectionGroup),e.filters.length>0&&(t+=", filters: [".concat(e.filters.map((function(e){return Sa(e)})).join(", "),"]")),Mi(e.limit)||(t+=", limit: "+e.limit),e.orderBy.length>0&&(t+=", orderBy: [".concat(e.orderBy.map((function(e){return function(e){return"".concat(e.field.canonicalString()," (").concat(e.dir,")")}(e)})).join(", "),"]")),e.startAt&&(t+=", startAt: ",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((function(e){return ta(e)})).join(",")),e.endAt&&(t+=", endAt: ",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((function(e){return ta(e)})).join(",")),"Target(".concat(t,")")}(ho(e)),"; limitType=").concat(e.limitType,")")}function go(e,t){return t.isFoundDocument()&&function(e,t){var n=t.key.path;return null!==e.collectionGroup?t.key.hasCollectionId(e.collectionGroup)&&e.path.isPrefixOf(n):ai.isDocumentKey(e.path)?e.path.isEqual(n):e.path.isImmediateParentOf(n)}(e,t)&&function(e,t){var n,r=(0,u.Z)(lo(e));try{for(r.s();!(n=r.n()).done;){var i=n.value;if(!i.field.isKeyField()&&null===t.data.field(i.field))return!1}}catch(a){r.e(a)}finally{r.f()}return!0}(e,t)&&function(e,t){var n,r=(0,u.Z)(e.filters);try{for(r.s();!(n=r.n()).done;){if(!n.value.matches(t))return!1}}catch(i){r.e(i)}finally{r.f()}return!0}(e,t)&&function(e,t){return!(e.startAt&&!function(e,t,n){var r=ya(e,t,n);return e.inclusive?r<=0:r<0}(e.startAt,lo(e),t))&&!(e.endAt&&!function(e,t,n){var r=ya(e,t,n);return e.inclusive?r>=0:r>0}(e.endAt,lo(e),t))}(e,t)}function ko(e){return e.collectionGroup||(e.path.length%2==1?e.path.lastSegment():e.path.get(e.path.length-2))}function wo(e){return function(t,n){var r,i=!1,a=(0,u.Z)(lo(e));try{for(a.s();!(r=a.n()).done;){var o=r.value,s=bo(o,t,n);if(0!==s)return s;i=i||o.field.isKeyField()}}catch(c){a.e(c)}finally{a.f()}return 0}}function bo(e,t,n){var r=e.field.isKeyField()?ai.comparator(t.key,n.key):function(e,t,n){var r=t.data.field(e),i=n.data.field(e);return null!==r&&null!==i?$i(r,i):Or()}(e.field,t,n);switch(e.dir){case"asc":return r;case"desc":return-1*r;default:return Or()}}function Zo(e,t){if(e.wt){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Fi(t)?"-0":t}}function Io(e){return{integerValue:""+e}}function xo(e,t){return Vi(t)?Io(t):Zo(e,t)}var _o=(0,c.Z)((function e(){(0,s.Z)(this,e),this._=void 0}));function To(e,t,n){return e instanceof Ao?function(e,t){var n={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:e.seconds,nanos:e.nanoseconds}}}};return t&&(n.fields.__previous_value__=t),{mapValue:n}}(n,t):e instanceof Co?No(e,t):e instanceof Do?Ro(e,t):function(e,t){var n=So(e,t),r=Po(n)+Po(e.gt);return ia(n)&&ia(e.gt)?Io(r):Zo(e.yt,r)}(e,t)}function Eo(e,t,n){return e instanceof Co?No(e,t):e instanceof Do?Ro(e,t):n}function So(e,t){return e instanceof Oo?ia(n=t)||function(e){return!!e&&"doubleValue"in e}(n)?t:{integerValue:0}:null;var n}var Ao=function(e){(0,a.Z)(n,e);var t=(0,o.Z)(n);function n(){return(0,s.Z)(this,n),t.apply(this,arguments)}return(0,c.Z)(n)}(_o),Co=function(e){(0,a.Z)(n,e);var t=(0,o.Z)(n);function n(e){var r;return(0,s.Z)(this,n),(r=t.call(this)).elements=e,r}return(0,c.Z)(n)}(_o);function No(e,t){var n,r=Lo(t),i=(0,u.Z)(e.elements);try{var a=function(){var e=n.value;r.some((function(t){return Ji(t,e)}))||r.push(e)};for(i.s();!(n=i.n()).done;)a()}catch(o){i.e(o)}finally{i.f()}return{arrayValue:{values:r}}}var Do=function(e){(0,a.Z)(n,e);var t=(0,o.Z)(n);function n(e){var r;return(0,s.Z)(this,n),(r=t.call(this)).elements=e,r}return(0,c.Z)(n)}(_o);function Ro(e,t){var n,r=Lo(t),i=(0,u.Z)(e.elements);try{var a=function(){var e=n.value;r=r.filter((function(t){return!Ji(t,e)}))};for(i.s();!(n=i.n()).done;)a()}catch(o){i.e(o)}finally{i.f()}return{arrayValue:{values:r}}}var Oo=function(e){(0,a.Z)(n,e);var t=(0,o.Z)(n);function n(e,r){var i;return(0,s.Z)(this,n),(i=t.call(this)).yt=e,i.gt=r,i}return(0,c.Z)(n)}(_o);function Po(e){return ji(e.integerValue||e.doubleValue)}function Lo(e){return aa(e)&&e.arrayValue.values?e.arrayValue.values.slice():[]}var Mo=(0,c.Z)((function e(t,n){(0,s.Z)(this,e),this.field=t,this.transform=n}));var Fo=(0,c.Z)((function e(t,n){(0,s.Z)(this,e),this.version=t,this.transformResults=n})),Vo=function(){function e(t,n){(0,s.Z)(this,e),this.updateTime=t,this.exists=n}return(0,c.Z)(e,[{key:"isNone",get:function(){return void 0===this.updateTime&&void 0===this.exists}},{key:"isEqual",value:function(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}],[{key:"none",value:function(){return new e}},{key:"exists",value:function(t){return new e(void 0,t)}},{key:"updateTime",value:function(t){return new e(t)}}]),e}();function Uo(e,t){return void 0!==e.updateTime?t.isFoundDocument()&&t.version.isEqual(e.updateTime):void 0===e.exists||e.exists===t.isFoundDocument()}var qo=(0,c.Z)((function e(){(0,s.Z)(this,e)}));function Bo(e,t){if(!e.hasLocalMutations||t&&0===t.fields.length)return null;if(null===t)return e.isNoDocument()?new eu(e.key,Vo.none()):new Wo(e.key,e.data,Vo.none());var n,r=e.data,i=za.empty(),a=new Ba(ii.comparator),o=(0,u.Z)(t.fields);try{for(o.s();!(n=o.n()).done;){var s=n.value;if(!a.has(s)){var c=r.field(s);null===c&&s.length>1&&(s=s.popLast(),c=r.field(s)),null===c?i.delete(s):i.set(s,c),a=a.add(s)}}}catch(l){o.e(l)}finally{o.f()}return new Ho(e.key,i,new Ka(a.toArray()),Vo.none())}function jo(e,t,n){e instanceof Wo?function(e,t,n){var r=e.value.clone(),i=Yo(e.fieldTransforms,t,n.transformResults);r.setAll(i),t.convertToFoundDocument(n.version,r).setHasCommittedMutations()}(e,t,n):e instanceof Ho?function(e,t,n){if(Uo(e.precondition,t)){var r=Yo(e.fieldTransforms,t,n.transformResults),i=t.data;i.setAll(Qo(e)),i.setAll(r),t.convertToFoundDocument(n.version,i).setHasCommittedMutations()}else t.convertToUnknownDocument(n.version)}(e,t,n):function(e,t,n){t.convertToNoDocument(n.version).setHasCommittedMutations()}(0,t,n)}function Go(e,t,n,r){return e instanceof Wo?function(e,t,n,r){if(!Uo(e.precondition,t))return n;var i=e.value.clone(),a=Jo(e.fieldTransforms,r,t);return i.setAll(a),t.convertToFoundDocument(t.version,i).setHasLocalMutations(),null}(e,t,n,r):e instanceof Ho?function(e,t,n,r){if(!Uo(e.precondition,t))return n;var i=Jo(e.fieldTransforms,r,t),a=t.data;return a.setAll(Qo(e)),a.setAll(i),t.convertToFoundDocument(t.version,a).setHasLocalMutations(),null===n?null:n.unionWith(e.fieldMask.fields).unionWith(e.fieldTransforms.map((function(e){return e.field})))}(e,t,n,r):function(e,t,n){return Uo(e.precondition,t)?(t.convertToNoDocument(t.version).setHasLocalMutations(),null):n}(e,t,n)}function Ko(e,t){var n,r=null,i=(0,u.Z)(e.fieldTransforms);try{for(i.s();!(n=i.n()).done;){var a=n.value,o=t.data.field(a.field),s=So(a.transform,o||null);null!=s&&(null===r&&(r=za.empty()),r.set(a.field,s))}}catch(c){i.e(c)}finally{i.f()}return r||null}function zo(e,t){return e.type===t.type&&!!e.key.isEqual(t.key)&&!!e.precondition.isEqual(t.precondition)&&!!function(e,t){return void 0===e&&void 0===t||!(!e||!t)&&Jr(e,t,(function(e,t){return function(e,t){return e.field.isEqual(t.field)&&function(e,t){return e instanceof Co&&t instanceof Co||e instanceof Do&&t instanceof Do?Jr(e.elements,t.elements,Ji):e instanceof Oo&&t instanceof Oo?Ji(e.gt,t.gt):e instanceof Ao&&t instanceof Ao}(e.transform,t.transform)}(e,t)}))}(e.fieldTransforms,t.fieldTransforms)&&(0===e.type?e.value.isEqual(t.value):1!==e.type||e.data.isEqual(t.data)&&e.fieldMask.isEqual(t.fieldMask))}var Wo=function(e){(0,a.Z)(n,e);var t=(0,o.Z)(n);function n(e,r,i){var a,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];return(0,s.Z)(this,n),(a=t.call(this)).key=e,a.value=r,a.precondition=i,a.fieldTransforms=o,a.type=0,a}return(0,c.Z)(n,[{key:"getFieldMask",value:function(){return null}}]),n}(qo),Ho=function(e){(0,a.Z)(n,e);var t=(0,o.Z)(n);function n(e,r,i,a){var o,u=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[];return(0,s.Z)(this,n),(o=t.call(this)).key=e,o.data=r,o.fieldMask=i,o.precondition=a,o.fieldTransforms=u,o.type=1,o}return(0,c.Z)(n,[{key:"getFieldMask",value:function(){return this.fieldMask}}]),n}(qo);function Qo(e){var t=new Map;return e.fieldMask.fields.forEach((function(n){if(!n.isEmpty()){var r=e.data.field(n);t.set(n,r)}})),t}function Yo(e,t,n){var r=new Map;Pr(e.length===n.length);for(var i=0;i<n.length;i++){var a=e[i],o=a.transform,u=t.data.field(a.field);r.set(a.field,Eo(o,u,n[i]))}return r}function Jo(e,t,n){var r,i=new Map,a=(0,u.Z)(e);try{for(a.s();!(r=a.n()).done;){var o=r.value,s=o.transform,c=n.data.field(o.field);i.set(o.field,To(s,c,t))}}catch(l){a.e(l)}finally{a.f()}return i}var Xo,$o,eu=function(e){(0,a.Z)(n,e);var t=(0,o.Z)(n);function n(e,r){var i;return(0,s.Z)(this,n),(i=t.call(this)).key=e,i.precondition=r,i.type=2,i.fieldTransforms=[],i}return(0,c.Z)(n,[{key:"getFieldMask",value:function(){return null}}]),n}(qo),tu=function(e){(0,a.Z)(n,e);var t=(0,o.Z)(n);function n(e,r){var i;return(0,s.Z)(this,n),(i=t.call(this)).key=e,i.precondition=r,i.type=3,i.fieldTransforms=[],i}return(0,c.Z)(n,[{key:"getFieldMask",value:function(){return null}}]),n}(qo),nu=(0,c.Z)((function e(t){(0,s.Z)(this,e),this.count=t}));function ru(e){switch(e){default:return Or();case Mr.CANCELLED:case Mr.UNKNOWN:case Mr.DEADLINE_EXCEEDED:case Mr.RESOURCE_EXHAUSTED:case Mr.INTERNAL:case Mr.UNAVAILABLE:case Mr.UNAUTHENTICATED:return!1;case Mr.INVALID_ARGUMENT:case Mr.NOT_FOUND:case Mr.ALREADY_EXISTS:case Mr.PERMISSION_DENIED:case Mr.FAILED_PRECONDITION:case Mr.ABORTED:case Mr.OUT_OF_RANGE:case Mr.UNIMPLEMENTED:case Mr.DATA_LOSS:return!0}}function iu(e){if(void 0===e)return Nr("GRPC error has no .code"),Mr.UNKNOWN;switch(e){case Xo.OK:return Mr.OK;case Xo.CANCELLED:return Mr.CANCELLED;case Xo.UNKNOWN:return Mr.UNKNOWN;case Xo.DEADLINE_EXCEEDED:return Mr.DEADLINE_EXCEEDED;case Xo.RESOURCE_EXHAUSTED:return Mr.RESOURCE_EXHAUSTED;case Xo.INTERNAL:return Mr.INTERNAL;case Xo.UNAVAILABLE:return Mr.UNAVAILABLE;case Xo.UNAUTHENTICATED:return Mr.UNAUTHENTICATED;case Xo.INVALID_ARGUMENT:return Mr.INVALID_ARGUMENT;case Xo.NOT_FOUND:return Mr.NOT_FOUND;case Xo.ALREADY_EXISTS:return Mr.ALREADY_EXISTS;case Xo.PERMISSION_DENIED:return Mr.PERMISSION_DENIED;case Xo.FAILED_PRECONDITION:return Mr.FAILED_PRECONDITION;case Xo.ABORTED:return Mr.ABORTED;case Xo.OUT_OF_RANGE:return Mr.OUT_OF_RANGE;case Xo.UNIMPLEMENTED:return Mr.UNIMPLEMENTED;case Xo.DATA_LOSS:return Mr.DATA_LOSS;default:return Or()}}($o=Xo||(Xo={}))[$o.OK=0]="OK",$o[$o.CANCELLED=1]="CANCELLED",$o[$o.UNKNOWN=2]="UNKNOWN",$o[$o.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",$o[$o.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",$o[$o.NOT_FOUND=5]="NOT_FOUND",$o[$o.ALREADY_EXISTS=6]="ALREADY_EXISTS",$o[$o.PERMISSION_DENIED=7]="PERMISSION_DENIED",$o[$o.UNAUTHENTICATED=16]="UNAUTHENTICATED",$o[$o.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",$o[$o.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",$o[$o.ABORTED=10]="ABORTED",$o[$o.OUT_OF_RANGE=11]="OUT_OF_RANGE",$o[$o.UNIMPLEMENTED=12]="UNIMPLEMENTED",$o[$o.INTERNAL=13]="INTERNAL",$o[$o.UNAVAILABLE=14]="UNAVAILABLE",$o[$o.DATA_LOSS=15]="DATA_LOSS";var au=function(){function e(t,n){(0,s.Z)(this,e),this.mapKeyFn=t,this.equalsFn=n,this.inner={},this.innerSize=0}return(0,c.Z)(e,[{key:"get",value:function(e){var t=this.mapKeyFn(e),n=this.inner[t];if(void 0!==n){var r,i=(0,u.Z)(n);try{for(i.s();!(r=i.n()).done;){var a=(0,d.Z)(r.value,2),o=a[0],s=a[1];if(this.equalsFn(o,e))return s}}catch(c){i.e(c)}finally{i.f()}}}},{key:"has",value:function(e){return void 0!==this.get(e)}},{key:"set",value:function(e,t){var n=this.mapKeyFn(e),r=this.inner[n];if(void 0===r)return this.inner[n]=[[e,t]],void this.innerSize++;for(var i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return void(r[i]=[e,t]);r.push([e,t]),this.innerSize++}},{key:"delete",value:function(e){var t=this.mapKeyFn(e),n=this.inner[t];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(this.equalsFn(n[r][0],e))return 1===n.length?delete this.inner[t]:n.splice(r,1),this.innerSize--,!0;return!1}},{key:"forEach",value:function(e){Pi(this.inner,(function(t,n){var r,i=(0,u.Z)(n);try{for(i.s();!(r=i.n()).done;){var a=(0,d.Z)(r.value,2),o=a[0],s=a[1];e(o,s)}}catch(c){i.e(c)}finally{i.f()}}))}},{key:"isEmpty",value:function(){return Li(this.inner)}},{key:"size",value:function(){return this.innerSize}}]),e}(),ou=new Va(ai.comparator);function uu(){return ou}var su=new Va(ai.comparator);function cu(){for(var e=su,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(var i=0,a=n;i<a.length;i++){var o=a[i];e=e.insert(o.key,o)}return e}function lu(e){var t=su;return e.forEach((function(e,n){return t=t.insert(e,n.overlayedDocument)})),t}function hu(){return du()}function fu(){return du()}function du(){return new au((function(e){return e.toString()}),(function(e,t){return e.isEqual(t)}))}var vu=new Va(ai.comparator),pu=new Ba(ai.comparator);function yu(){for(var e=pu,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(var i=0,a=n;i<a.length;i++){var o=a[i];e=e.add(o)}return e}var mu=new Ba(Yr);function gu(){return mu}var ku=function(){function e(t,n,r,i,a){(0,s.Z)(this,e),this.snapshotVersion=t,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=a}return(0,c.Z)(e,null,[{key:"createSynthesizedRemoteEventForCurrentChange",value:function(t,n,r){var i=new Map;return i.set(t,wu.createSynthesizedTargetChangeForCurrentChange(t,n,r)),new e(ei.min(),i,gu(),uu(),yu())}}]),e}(),wu=function(){function e(t,n,r,i,a){(0,s.Z)(this,e),this.resumeToken=t,this.current=n,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=a}return(0,c.Z)(e,null,[{key:"createSynthesizedTargetChangeForCurrentChange",value:function(t,n,r){return new e(r,n,yu(),yu(),yu())}}]),e}(),bu=(0,c.Z)((function e(t,n,r,i){(0,s.Z)(this,e),this.It=t,this.removedTargetIds=n,this.key=r,this.Tt=i})),Zu=(0,c.Z)((function e(t,n){(0,s.Z)(this,e),this.targetId=t,this.Et=n})),Iu=(0,c.Z)((function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Ui.EMPTY_BYTE_STRING,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;(0,s.Z)(this,e),this.state=t,this.targetIds=n,this.resumeToken=r,this.cause=i})),xu=function(){function e(){(0,s.Z)(this,e),this.At=0,this.Rt=Eu(),this.bt=Ui.EMPTY_BYTE_STRING,this.Pt=!1,this.vt=!0}return(0,c.Z)(e,[{key:"current",get:function(){return this.Pt}},{key:"resumeToken",get:function(){return this.bt}},{key:"Vt",get:function(){return 0!==this.At}},{key:"St",get:function(){return this.vt}},{key:"Dt",value:function(e){e.approximateByteSize()>0&&(this.vt=!0,this.bt=e)}},{key:"Ct",value:function(){var e=yu(),t=yu(),n=yu();return this.Rt.forEach((function(r,i){switch(i){case 0:e=e.add(r);break;case 2:t=t.add(r);break;case 1:n=n.add(r);break;default:Or()}})),new wu(this.bt,this.Pt,e,t,n)}},{key:"xt",value:function(){this.vt=!1,this.Rt=Eu()}},{key:"Nt",value:function(e,t){this.vt=!0,this.Rt=this.Rt.insert(e,t)}},{key:"kt",value:function(e){this.vt=!0,this.Rt=this.Rt.remove(e)}},{key:"Ot",value:function(){this.At+=1}},{key:"Mt",value:function(){this.At-=1}},{key:"Ft",value:function(){this.vt=!0,this.Pt=!0}}]),e}(),_u=function(){function e(t){(0,s.Z)(this,e),this.$t=t,this.Bt=new Map,this.Lt=uu(),this.qt=Tu(),this.Ut=new Ba(Yr)}return(0,c.Z)(e,[{key:"Kt",value:function(e){var t,n=(0,u.Z)(e.It);try{for(n.s();!(t=n.n()).done;){var r=t.value;e.Tt&&e.Tt.isFoundDocument()?this.Gt(r,e.Tt):this.Qt(r,e.key,e.Tt)}}catch(s){n.e(s)}finally{n.f()}var i,a=(0,u.Z)(e.removedTargetIds);try{for(a.s();!(i=a.n()).done;){var o=i.value;this.Qt(o,e.key,e.Tt)}}catch(s){a.e(s)}finally{a.f()}}},{key:"jt",value:function(e){var t=this;this.forEachTarget(e,(function(n){var r=t.Wt(n);switch(e.state){case 0:t.zt(n)&&r.Dt(e.resumeToken);break;case 1:r.Mt(),r.Vt||r.xt(),r.Dt(e.resumeToken);break;case 2:r.Mt(),r.Vt||t.removeTarget(n);break;case 3:t.zt(n)&&(r.Ft(),r.Dt(e.resumeToken));break;case 4:t.zt(n)&&(t.Ht(n),r.Dt(e.resumeToken));break;default:Or()}}))}},{key:"forEachTarget",value:function(e,t){var n=this;e.targetIds.length>0?e.targetIds.forEach(t):this.Bt.forEach((function(e,r){n.zt(r)&&t(r)}))}},{key:"Jt",value:function(e){var t=e.targetId,n=e.Et.count,r=this.Yt(t);if(r){var i=r.target;if($a(i))if(0===n){var a=new ai(i.path);this.Qt(t,a,Ha.newNoDocument(a,ei.min()))}else Pr(1===n);else this.Xt(t)!==n&&(this.Ht(t),this.Ut=this.Ut.add(t))}}},{key:"Zt",value:function(e){var t=this,n=new Map;this.Bt.forEach((function(r,i){var a=t.Yt(i);if(a){if(r.current&&$a(a.target)){var o=new ai(a.target.path);null!==t.Lt.get(o)||t.te(i,o)||t.Qt(i,o,Ha.newNoDocument(o,e))}r.St&&(n.set(i,r.Ct()),r.xt())}}));var r=yu();this.qt.forEach((function(e,n){var i=!0;n.forEachWhile((function(e){var n=t.Yt(e);return!n||2===n.purpose||(i=!1,!1)})),i&&(r=r.add(e))})),this.Lt.forEach((function(t,n){return n.setReadTime(e)}));var i=new ku(e,n,this.Ut,this.Lt,r);return this.Lt=uu(),this.qt=Tu(),this.Ut=new Ba(Yr),i}},{key:"Gt",value:function(e,t){if(this.zt(e)){var n=this.te(e,t.key)?2:0;this.Wt(e).Nt(t.key,n),this.Lt=this.Lt.insert(t.key,t),this.qt=this.qt.insert(t.key,this.ee(t.key).add(e))}}},{key:"Qt",value:function(e,t,n){if(this.zt(e)){var r=this.Wt(e);this.te(e,t)?r.Nt(t,1):r.kt(t),this.qt=this.qt.insert(t,this.ee(t).delete(e)),n&&(this.Lt=this.Lt.insert(t,n))}}},{key:"removeTarget",value:function(e){this.Bt.delete(e)}},{key:"Xt",value:function(e){var t=this.Wt(e).Ct();return this.$t.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}},{key:"Ot",value:function(e){this.Wt(e).Ot()}},{key:"Wt",value:function(e){var t=this.Bt.get(e);return t||(t=new xu,this.Bt.set(e,t)),t}},{key:"ee",value:function(e){var t=this.qt.get(e);return t||(t=new Ba(Yr),this.qt=this.qt.insert(e,t)),t}},{key:"zt",value:function(e){var t=null!==this.Yt(e);return t||Cr("WatchChangeAggregator","Detected inactive target",e),t}},{key:"Yt",value:function(e){var t=this.Bt.get(e);return t&&t.Vt?null:this.$t.ne(e)}},{key:"Ht",value:function(e){var t=this;this.Bt.set(e,new xu),this.$t.getRemoteKeysForTarget(e).forEach((function(n){t.Qt(e,n,null)}))}},{key:"te",value:function(e,t){return this.$t.getRemoteKeysForTarget(e).has(t)}}]),e}();function Tu(){return new Va(ai.comparator)}function Eu(){return new Va(ai.comparator)}var Su={asc:"ASCENDING",desc:"DESCENDING"},Au={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Cu={and:"AND",or:"OR"},Nu=(0,c.Z)((function e(t,n){(0,s.Z)(this,e),this.databaseId=t,this.wt=n}));function Du(e,t){return e.wt?"".concat(new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z",""),".").concat(("000000000"+t.nanoseconds).slice(-9),"Z"):{seconds:""+t.seconds,nanos:t.nanoseconds}}function Ru(e,t){return e.wt?t.toBase64():t.toUint8Array()}function Ou(e,t){return Du(e,t.toTimestamp())}function Pu(e){return Pr(!!e),ei.fromTimestamp(function(e){var t=Bi(e);return new $r(t.seconds,t.nanos)}(e))}function Lu(e,t){return function(e){return new ni(["projects",e.projectId,"databases",e.database])}(e).child("documents").child(t).canonicalString()}function Mu(e){var t=ni.fromString(e);return Pr(os(t)),t}function Fu(e,t){return Lu(e.databaseId,t.path)}function Vu(e,t){var n=Mu(t);if(n.get(1)!==e.databaseId.projectId)throw new Fr(Mr.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+e.databaseId.projectId);if(n.get(3)!==e.databaseId.database)throw new Fr(Mr.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+e.databaseId.database);return new ai(ju(n))}function Uu(e,t){return Lu(e.databaseId,t)}function qu(e){var t=Mu(e);return 4===t.length?ni.emptyPath():ju(t)}function Bu(e){return new ni(["projects",e.databaseId.projectId,"databases",e.databaseId.database]).canonicalString()}function ju(e){return Pr(e.length>4&&"documents"===e.get(4)),e.popFirst(5)}function Gu(e,t,n){return{name:Fu(e,t),fields:n.value.mapValue.fields}}function Ku(e,t,n){var r=Vu(e,t.name),i=Pu(t.updateTime),a=t.createTime?Pu(t.createTime):ei.min(),o=new za({mapValue:{fields:t.fields}}),u=Ha.newFoundDocument(r,i,a,o);return n&&u.setHasCommittedMutations(),n?u.setHasCommittedMutations():u}function zu(e,t){return"found"in t?function(e,t){Pr(!!t.found),t.found.name,t.found.updateTime;var n=Vu(e,t.found.name),r=Pu(t.found.updateTime),i=t.found.createTime?Pu(t.found.createTime):ei.min(),a=new za({mapValue:{fields:t.found.fields}});return Ha.newFoundDocument(n,r,i,a)}(e,t):"missing"in t?function(e,t){Pr(!!t.missing),Pr(!!t.readTime);var n=Vu(e,t.missing),r=Pu(t.readTime);return Ha.newNoDocument(n,r)}(e,t):Or()}function Wu(e,t){var n;if(t instanceof Wo)n={update:Gu(e,t.key,t.value)};else if(t instanceof eu)n={delete:Fu(e,t.key)};else if(t instanceof Ho)n={update:Gu(e,t.key,t.data),updateMask:as(t.fieldMask)};else{if(!(t instanceof tu))return Or();n={verify:Fu(e,t.key)}}return t.fieldTransforms.length>0&&(n.updateTransforms=t.fieldTransforms.map((function(e){return function(e,t){var n=t.transform;if(n instanceof Ao)return{fieldPath:t.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(n instanceof Co)return{fieldPath:t.field.canonicalString(),appendMissingElements:{values:n.elements}};if(n instanceof Do)return{fieldPath:t.field.canonicalString(),removeAllFromArray:{values:n.elements}};if(n instanceof Oo)return{fieldPath:t.field.canonicalString(),increment:n.gt};throw Or()}(0,e)}))),t.precondition.isNone||(n.currentDocument=function(e,t){return void 0!==t.updateTime?{updateTime:Ou(e,t.updateTime)}:void 0!==t.exists?{exists:t.exists}:Or()}(e,t.precondition)),n}function Hu(e,t){var n=t.currentDocument?function(e){return void 0!==e.updateTime?Vo.updateTime(Pu(e.updateTime)):void 0!==e.exists?Vo.exists(e.exists):Vo.none()}(t.currentDocument):Vo.none(),r=t.updateTransforms?t.updateTransforms.map((function(t){return function(e,t){var n=null;if("setToServerValue"in t)Pr("REQUEST_TIME"===t.setToServerValue),n=new Ao;else if("appendMissingElements"in t){var r=t.appendMissingElements.values||[];n=new Co(r)}else if("removeAllFromArray"in t){var i=t.removeAllFromArray.values||[];n=new Do(i)}else"increment"in t?n=new Oo(e,t.increment):Or();var a=ii.fromServerFormat(t.fieldPath);return new Mo(a,n)}(e,t)})):[];if(t.update){t.update.name;var i=Vu(e,t.update.name),a=new za({mapValue:{fields:t.update.fields}});if(t.updateMask){var o=function(e){var t=e.fieldPaths||[];return new Ka(t.map((function(e){return ii.fromServerFormat(e)})))}(t.updateMask);return new Ho(i,a,o,n,r)}return new Wo(i,a,n,r)}if(t.delete){var u=Vu(e,t.delete);return new eu(u,n)}if(t.verify){var s=Vu(e,t.verify);return new tu(s,n)}return Or()}function Qu(e,t){return{documents:[Uu(e,t.path)]}}function Yu(e,t){var n={structuredQuery:{}},r=t.path;null!==t.collectionGroup?(n.parent=Uu(e,r),n.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(n.parent=Uu(e,r.popLast()),n.structuredQuery.from=[{collectionId:r.lastSegment()}]);var i=function(e){if(0!==e.length)return is(wa.create(e,"and"))}(t.filters);i&&(n.structuredQuery.where=i);var a=function(e){if(0!==e.length)return e.map((function(e){return function(e){return{field:ns(e.field),direction:$u(e.dir)}}(e)}))}(t.orderBy);a&&(n.structuredQuery.orderBy=a);var o,u=function(e,t){return e.wt||Mi(t)?t:{value:t}}(e,t.limit);return null!==u&&(n.structuredQuery.limit=u),t.startAt&&(n.structuredQuery.startAt={before:(o=t.startAt).inclusive,values:o.position}),t.endAt&&(n.structuredQuery.endAt=function(e){return{before:!e.inclusive,values:e.position}}(t.endAt)),n}function Ju(e){var t=qu(e.parent),n=e.structuredQuery,r=n.from?n.from.length:0,i=null;if(r>0){Pr(1===r);var a=n.from[0];a.allDescendants?i=a.collectionId:t=t.child(a.collectionId)}var o=[];n.where&&(o=function(e){var t=Xu(e);return t instanceof wa&&Ia(t)?t.getFilters():[t]}(n.where));var u=[];n.orderBy&&(u=n.orderBy.map((function(e){return function(e){return new Ma(rs(e.field),function(e){switch(e){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(e.direction))}(e)})));var s=null;n.limit&&(s=function(e){var t;return Mi(t="object"==typeof e?e.value:e)?null:t}(n.limit));var c=null;n.startAt&&(c=function(e){var t=!!e.before,n=e.values||[];return new pa(n,t)}(n.startAt));var l=null;return n.endAt&&(l=function(e){var t=!e.before,n=e.values||[];return new pa(n,t)}(n.endAt)),io(t,i,u,o,s,"F",c,l)}function Xu(e){return void 0!==e.unaryFilter?function(e){switch(e.unaryFilter.op){case"IS_NAN":var t=rs(e.unaryFilter.field);return ka.create(t,"==",{doubleValue:NaN});case"IS_NULL":var n=rs(e.unaryFilter.field);return ka.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":var r=rs(e.unaryFilter.field);return ka.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":var i=rs(e.unaryFilter.field);return ka.create(i,"!=",{nullValue:"NULL_VALUE"});default:return Or()}}(e):void 0!==e.fieldFilter?function(e){return ka.create(rs(e.fieldFilter.field),function(e){switch(e){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return Or()}}(e.fieldFilter.op),e.fieldFilter.value)}(e):void 0!==e.compositeFilter?function(e){return wa.create(e.compositeFilter.filters.map((function(e){return Xu(e)})),function(e){switch(e){case"AND":return"and";case"OR":return"or";default:return Or()}}(e.compositeFilter.op))}(e):Or()}function $u(e){return Su[e]}function es(e){return Au[e]}function ts(e){return Cu[e]}function ns(e){return{fieldPath:e.canonicalString()}}function rs(e){return ii.fromServerFormat(e.fieldPath)}function is(e){return e instanceof ka?function(e){if("=="===e.op){if(ua(e.value))return{unaryFilter:{field:ns(e.field),op:"IS_NAN"}};if(oa(e.value))return{unaryFilter:{field:ns(e.field),op:"IS_NULL"}}}else if("!="===e.op){if(ua(e.value))return{unaryFilter:{field:ns(e.field),op:"IS_NOT_NAN"}};if(oa(e.value))return{unaryFilter:{field:ns(e.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:ns(e.field),op:es(e.op),value:e.value}}}(e):e instanceof wa?function(e){var t=e.getFilters().map((function(e){return is(e)}));return 1===t.length?t[0]:{compositeFilter:{op:ts(e.op),filters:t}}}(e):Or()}function as(e){var t=[];return e.fields.forEach((function(e){return t.push(e.canonicalString())})),{fieldPaths:t}}function os(e){return e.length>=4&&"projects"===e.get(0)&&"databases"===e.get(2)}function us(e){for(var t="",n=0;n<e.length;n++)t.length>0&&(t=cs(t)),t=ss(e.get(n),t);return cs(t)}function ss(e,t){for(var n=t,r=e.length,i=0;i<r;i++){var a=e.charAt(i);switch(a){case"\0":n+="\x01\x10";break;case"\x01":n+="\x01\x11";break;default:n+=a}}return n}function cs(e){return e+"\x01\x01"}function ls(e){var t=e.length;if(Pr(t>=2),2===t)return Pr("\x01"===e.charAt(0)&&"\x01"===e.charAt(1)),ni.emptyPath();for(var n=t-2,r=[],i="",a=0;a<t;){var o=e.indexOf("\x01",a);switch((o<0||o>n)&&Or(),e.charAt(o+1)){case"\x01":var u=e.substring(a,o),s=void 0;0===i.length?s=u:(s=i+=u,i=""),r.push(s);break;case"\x10":i+=e.substring(a,o),i+="\0";break;case"\x11":i+=e.substring(a,o+1);break;default:Or()}a=o+2}return new ni(r)}var hs=["userId","batchId"];function fs(e,t){return[e,us(t)]}function ds(e,t,n){return[e,us(t),n]}var vs={},ps=["prefixPath","collectionGroup","readTime","documentId"],ys=["prefixPath","collectionGroup","documentId"],ms=["collectionGroup","readTime","prefixPath","documentId"],gs=["canonicalId","targetId"],ks=["targetId","path"],ws=["path","targetId"],bs=["collectionId","parent"],Zs=["indexId","uid"],Is=["uid","sequenceNumber"],xs=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],_s=["indexId","uid","orderedDocumentKey"],Ts=["userId","collectionPath","documentId"],Es=["userId","collectionPath","largestBatchId"],Ss=["userId","collectionGroup","largestBatchId"],As=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments"].concat(["clientMetadata"]).concat(["remoteDocumentGlobal"]).concat(["collectionParents"]).concat(["bundles","namedQueries"]),Cs=[].concat((0,y.Z)(As),["documentOverlays"]),Ns=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],Ds=Ns,Rs=[].concat(Ds,["indexConfiguration","indexState","indexEntries"]),Os=function(e){(0,a.Z)(n,e);var t=(0,o.Z)(n);function n(e,r){var i;return(0,s.Z)(this,n),(i=t.call(this)).se=e,i.currentSequenceNumber=r,i}return(0,c.Z)(n)}(yi);function Ps(e,t){var n=Lr(e);return bi.M(n.se,t)}var Ls=function(){function e(t,n,r,i){(0,s.Z)(this,e),this.batchId=t,this.localWriteTime=n,this.baseMutations=r,this.mutations=i}return(0,c.Z)(e,[{key:"applyToRemoteDocument",value:function(e,t){for(var n=t.mutationResults,r=0;r<this.mutations.length;r++){var i=this.mutations[r];i.key.isEqual(e.key)&&jo(i,e,n[r])}}},{key:"applyToLocalView",value:function(e,t){var n,r=(0,u.Z)(this.baseMutations);try{for(r.s();!(n=r.n()).done;){var i=n.value;i.key.isEqual(e.key)&&(t=Go(i,e,t,this.localWriteTime))}}catch(c){r.e(c)}finally{r.f()}var a,o=(0,u.Z)(this.mutations);try{for(o.s();!(a=o.n()).done;){var s=a.value;s.key.isEqual(e.key)&&(t=Go(s,e,t,this.localWriteTime))}}catch(c){o.e(c)}finally{o.f()}return t}},{key:"applyToLocalDocumentSet",value:function(e,t){var n=this,r=fu();return this.mutations.forEach((function(i){var a=e.get(i.key),o=a.overlayedDocument,u=n.applyToLocalView(o,a.mutatedFields),s=Bo(o,u=t.has(i.key)?null:u);null!==s&&r.set(i.key,s),o.isValidDocument()||o.convertToNoDocument(ei.min())})),r}},{key:"keys",value:function(){return this.mutations.reduce((function(e,t){return e.add(t.key)}),yu())}},{key:"isEqual",value:function(e){return this.batchId===e.batchId&&Jr(this.mutations,e.mutations,(function(e,t){return zo(e,t)}))&&Jr(this.baseMutations,e.baseMutations,(function(e,t){return zo(e,t)}))}}]),e}(),Ms=function(){function e(t,n,r,i){(0,s.Z)(this,e),this.batch=t,this.commitVersion=n,this.mutationResults=r,this.docVersions=i}return(0,c.Z)(e,null,[{key:"from",value:function(t,n,r){Pr(t.mutations.length===r.length);for(var i=vu,a=t.mutations,o=0;o<a.length;o++)i=i.insert(a[o].key,r[o].version);return new e(t,n,r,i)}}]),e}(),Fs=function(){function e(t,n){(0,s.Z)(this,e),this.largestBatchId=t,this.mutation=n}return(0,c.Z)(e,[{key:"getKey",value:function(){return this.mutation.key}},{key:"isEqual",value:function(e){return null!==e&&this.mutation===e.mutation}},{key:"toString",value:function(){return"Overlay{\n      largestBatchId: ".concat(this.largestBatchId,",\n      mutation: ").concat(this.mutation.toString(),"\n    }")}}]),e}(),Vs=function(){function e(t,n,r,i){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:ei.min(),o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:ei.min(),u=arguments.length>6&&void 0!==arguments[6]?arguments[6]:Ui.EMPTY_BYTE_STRING;(0,s.Z)(this,e),this.target=t,this.targetId=n,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=a,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=u}return(0,c.Z)(e,[{key:"withSequenceNumber",value:function(t){return new e(this.target,this.targetId,this.purpose,t,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken)}},{key:"withResumeToken",value:function(t,n){return new e(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,t)}},{key:"withLastLimboFreeSnapshotVersion",value:function(t){return new e(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,t,this.resumeToken)}}]),e}(),Us=(0,c.Z)((function e(t){(0,s.Z)(this,e),this.ie=t}));function qs(e,t){var n=t.key,r={prefixPath:n.getCollectionPath().popLast().toArray(),collectionGroup:n.collectionGroup,documentId:n.path.lastSegment(),readTime:Bs(t.readTime),hasCommittedMutations:t.hasCommittedMutations};if(t.isFoundDocument())r.document=function(e,t){return{name:Fu(e,t.key),fields:t.data.value.mapValue.fields,updateTime:Du(e,t.version.toTimestamp()),createTime:Du(e,t.createTime.toTimestamp())}}(e.ie,t);else if(t.isNoDocument())r.noDocument={path:n.path.toArray(),readTime:js(t.version)};else{if(!t.isUnknownDocument())return Or();r.unknownDocument={path:n.path.toArray(),version:js(t.version)}}return r}function Bs(e){var t=e.toTimestamp();return[t.seconds,t.nanoseconds]}function js(e){var t=e.toTimestamp();return{seconds:t.seconds,nanoseconds:t.nanoseconds}}function Gs(e){var t=new $r(e.seconds,e.nanoseconds);return ei.fromTimestamp(t)}function Ks(e,t){for(var n=(t.baseMutations||[]).map((function(t){return Hu(e.ie,t)})),r=0;r<t.mutations.length-1;++r){var i=t.mutations[r];if(r+1<t.mutations.length&&void 0!==t.mutations[r+1].transform){var a=t.mutations[r+1];i.updateTransforms=a.transform.fieldTransforms,t.mutations.splice(r+1,1),++r}}var o=t.mutations.map((function(t){return Hu(e.ie,t)})),u=$r.fromMillis(t.localWriteTimeMs);return new Ls(t.batchId,u,n,o)}function zs(e){var t,n,r=Gs(e.readTime),i=void 0!==e.lastLimboFreeSnapshotVersion?Gs(e.lastLimboFreeSnapshotVersion):ei.min();return void 0!==e.query.documents?(Pr(1===(n=e.query).documents.length),t=ho(ao(qu(n.documents[0])))):t=function(e){return ho(Ju(e))}(e.query),new Vs(t,e.targetId,0,e.lastListenSequenceNumber,r,i,Ui.fromBase64String(e.resumeToken))}function Ws(e,t){var n,r=js(t.snapshotVersion),i=js(t.lastLimboFreeSnapshotVersion);n=$a(t.target)?Qu(e.ie,t.target):Yu(e.ie,t.target);var a=t.resumeToken.toBase64();return{targetId:t.targetId,canonicalId:Ja(t.target),readTime:r,resumeToken:a,lastListenSequenceNumber:t.sequenceNumber,lastLimboFreeSnapshotVersion:i,query:n}}function Hs(e){var t=Ju({parent:e.parent,structuredQuery:e.structuredQuery});return"LAST"===e.limitType?vo(t,t.limit,"L"):t}function Qs(e,t){return new Fs(t.largestBatchId,Hu(e.ie,t.overlayMutation))}function Ys(e,t){var n=t.path.lastSegment();return[e,us(t.path.popLast()),n]}function Js(e,t,n,r){return{indexId:e,uid:t.uid||"",sequenceNumber:n,readTime:js(r.readTime),documentKey:us(r.documentKey.path),largestBatchId:r.largestBatchId}}var Xs=function(){function e(){(0,s.Z)(this,e)}return(0,c.Z)(e,[{key:"getBundleMetadata",value:function(e,t){return $s(e).get(t).next((function(e){if(e)return{id:(t=e).bundleId,createTime:Gs(t.createTime),version:t.version};var t}))}},{key:"saveBundleMetadata",value:function(e,t){return $s(e).put({bundleId:(n=t).id,createTime:js(Pu(n.createTime)),version:n.version});var n}},{key:"getNamedQuery",value:function(e,t){return ec(e).get(t).next((function(e){if(e)return{name:(t=e).name,query:Hs(t.bundledQuery),readTime:Gs(t.readTime)};var t}))}},{key:"saveNamedQuery",value:function(e,t){return ec(e).put(function(e){return{name:e.name,readTime:js(Pu(e.readTime)),bundledQuery:e.bundledQuery}}(t))}}]),e}();function $s(e){return Ps(e,"bundles")}function ec(e){return Ps(e,"namedQueries")}var tc=function(){function e(t,n){(0,s.Z)(this,e),this.yt=t,this.userId=n}return(0,c.Z)(e,[{key:"getOverlay",value:function(e,t){var n=this;return nc(e).get(Ys(this.userId,t)).next((function(e){return e?Qs(n.yt,e):null}))}},{key:"getOverlays",value:function(e,t){var n=this,r=hu();return ki.forEach(t,(function(t){return n.getOverlay(e,t).next((function(e){null!==e&&r.set(t,e)}))})).next((function(){return r}))}},{key:"saveOverlays",value:function(e,t,n){var r=this,i=[];return n.forEach((function(n,a){var o=new Fs(t,a);i.push(r.oe(e,o))})),ki.waitFor(i)}},{key:"removeOverlaysForBatchId",value:function(e,t,n){var r=this,i=new Set;t.forEach((function(e){return i.add(us(e.getCollectionPath()))}));var a=[];return i.forEach((function(t){var i=IDBKeyRange.bound([r.userId,t,n],[r.userId,t,n+1],!1,!0);a.push(nc(e).Y("collectionPathOverlayIndex",i))})),ki.waitFor(a)}},{key:"getOverlaysForCollection",value:function(e,t,n){var r=this,i=hu(),a=us(t),o=IDBKeyRange.bound([this.userId,a,n],[this.userId,a,Number.POSITIVE_INFINITY],!0);return nc(e).W("collectionPathOverlayIndex",o).next((function(e){var t,n=(0,u.Z)(e);try{for(n.s();!(t=n.n()).done;){var a=t.value,o=Qs(r.yt,a);i.set(o.getKey(),o)}}catch(s){n.e(s)}finally{n.f()}return i}))}},{key:"getOverlaysForCollectionGroup",value:function(e,t,n,r){var i,a=this,o=hu(),u=IDBKeyRange.bound([this.userId,t,n],[this.userId,t,Number.POSITIVE_INFINITY],!0);return nc(e).Z({index:"collectionGroupOverlayIndex",range:u},(function(e,t,n){var u=Qs(a.yt,t);o.size()<r||u.largestBatchId===i?(o.set(u.getKey(),u),i=u.largestBatchId):n.done()})).next((function(){return o}))}},{key:"oe",value:function(e,t){return nc(e).put(function(e,t,n){var r=Ys(t,n.mutation.key),i=(0,d.Z)(r,3);i[0];return{userId:t,collectionPath:i[1],documentId:i[2],collectionGroup:n.mutation.key.getCollectionGroup(),largestBatchId:n.largestBatchId,overlayMutation:Wu(e.ie,n.mutation)}}(this.yt,this.userId,t))}}],[{key:"re",value:function(t,n){return new e(t,n.uid||"")}}]),e}();function nc(e){return Ps(e,"documentOverlays")}var rc=function(){function e(){(0,s.Z)(this,e)}return(0,c.Z)(e,[{key:"ue",value:function(e,t){this.ce(e,t),t.ae()}},{key:"ce",value:function(e,t){if("nullValue"in e)this.he(t,5);else if("booleanValue"in e)this.he(t,10),t.le(e.booleanValue?1:0);else if("integerValue"in e)this.he(t,15),t.le(ji(e.integerValue));else if("doubleValue"in e){var n=ji(e.doubleValue);isNaN(n)?this.he(t,13):(this.he(t,15),Fi(n)?t.le(0):t.le(n))}else if("timestampValue"in e){var r=e.timestampValue;this.he(t,20),"string"==typeof r?t.fe(r):(t.fe("".concat(r.seconds||"")),t.le(r.nanos||0))}else if("stringValue"in e)this.de(e.stringValue,t),this._e(t);else if("bytesValue"in e)this.he(t,30),t.we(Gi(e.bytesValue)),this._e(t);else if("referenceValue"in e)this.me(e.referenceValue,t);else if("geoPointValue"in e){var i=e.geoPointValue;this.he(t,45),t.le(i.latitude||0),t.le(i.longitude||0)}else"mapValue"in e?la(e)?this.he(t,Number.MAX_SAFE_INTEGER):(this.ge(e.mapValue,t),this._e(t)):"arrayValue"in e?(this.ye(e.arrayValue,t),this._e(t)):Or()}},{key:"de",value:function(e,t){this.he(t,25),this.pe(e,t)}},{key:"pe",value:function(e,t){t.fe(e)}},{key:"ge",value:function(e,t){var n=e.fields||{};this.he(t,55);for(var r=0,i=Object.keys(n);r<i.length;r++){var a=i[r];this.de(a,t),this.ce(n[a],t)}}},{key:"ye",value:function(e,t){var n=e.values||[];this.he(t,50);var r,i=(0,u.Z)(n);try{for(i.s();!(r=i.n()).done;){var a=r.value;this.ce(a,t)}}catch(o){i.e(o)}finally{i.f()}}},{key:"me",value:function(e,t){var n=this;this.he(t,37),ai.fromName(e).path.forEach((function(e){n.he(t,60),n.pe(e,t)}))}},{key:"he",value:function(e,t){e.le(t)}},{key:"_e",value:function(e){e.le(2)}}]),e}();function ic(e){if(0===e)return 8;var t=0;return e>>4==0&&(t+=4,e<<=4),e>>6==0&&(t+=2,e<<=2),e>>7==0&&(t+=1),t}function ac(e){var t=64-function(e){for(var t=0,n=0;n<8;++n){var r=ic(255&e[n]);if(t+=r,8!==r)break}return t}(e);return Math.ceil(t/8)}rc.Ie=new rc;var oc=function(){function e(){(0,s.Z)(this,e),this.buffer=new Uint8Array(1024),this.position=0}return(0,c.Z)(e,[{key:"Te",value:function(e){for(var t=e[Symbol.iterator](),n=t.next();!n.done;)this.Ee(n.value),n=t.next();this.Ae()}},{key:"Re",value:function(e){for(var t=e[Symbol.iterator](),n=t.next();!n.done;)this.be(n.value),n=t.next();this.Pe()}},{key:"ve",value:function(e){var t,n=(0,u.Z)(e);try{for(n.s();!(t=n.n()).done;){var r=t.value,i=r.charCodeAt(0);if(i<128)this.Ee(i);else if(i<2048)this.Ee(960|i>>>6),this.Ee(128|63&i);else if(r<"\ud800"||"\udbff"<r)this.Ee(480|i>>>12),this.Ee(128|63&i>>>6),this.Ee(128|63&i);else{var a=r.codePointAt(0);this.Ee(240|a>>>18),this.Ee(128|63&a>>>12),this.Ee(128|63&a>>>6),this.Ee(128|63&a)}}}catch(o){n.e(o)}finally{n.f()}this.Ae()}},{key:"Ve",value:function(e){var t,n=(0,u.Z)(e);try{for(n.s();!(t=n.n()).done;){var r=t.value,i=r.charCodeAt(0);if(i<128)this.be(i);else if(i<2048)this.be(960|i>>>6),this.be(128|63&i);else if(r<"\ud800"||"\udbff"<r)this.be(480|i>>>12),this.be(128|63&i>>>6),this.be(128|63&i);else{var a=r.codePointAt(0);this.be(240|a>>>18),this.be(128|63&a>>>12),this.be(128|63&a>>>6),this.be(128|63&a)}}}catch(o){n.e(o)}finally{n.f()}this.Pe()}},{key:"Se",value:function(e){var t=this.De(e),n=ac(t);this.Ce(1+n),this.buffer[this.position++]=255&n;for(var r=t.length-n;r<t.length;++r)this.buffer[this.position++]=255&t[r]}},{key:"xe",value:function(e){var t=this.De(e),n=ac(t);this.Ce(1+n),this.buffer[this.position++]=~(255&n);for(var r=t.length-n;r<t.length;++r)this.buffer[this.position++]=~(255&t[r])}},{key:"Ne",value:function(){this.ke(255),this.ke(255)}},{key:"Oe",value:function(){this.Me(255),this.Me(255)}},{key:"reset",value:function(){this.position=0}},{key:"seed",value:function(e){this.Ce(e.length),this.buffer.set(e,this.position),this.position+=e.length}},{key:"Fe",value:function(){return this.buffer.slice(0,this.position)}},{key:"De",value:function(e){var t=function(e){var t=new DataView(new ArrayBuffer(8));return t.setFloat64(0,e,!1),new Uint8Array(t.buffer)}(e),n=0!=(128&t[0]);t[0]^=n?255:128;for(var r=1;r<t.length;++r)t[r]^=n?255:0;return t}},{key:"Ee",value:function(e){var t=255&e;0===t?(this.ke(0),this.ke(255)):255===t?(this.ke(255),this.ke(0)):this.ke(t)}},{key:"be",value:function(e){var t=255&e;0===t?(this.Me(0),this.Me(255)):255===t?(this.Me(255),this.Me(0)):this.Me(e)}},{key:"Ae",value:function(){this.ke(0),this.ke(1)}},{key:"Pe",value:function(){this.Me(0),this.Me(1)}},{key:"ke",value:function(e){this.Ce(1),this.buffer[this.position++]=e}},{key:"Me",value:function(e){this.Ce(1),this.buffer[this.position++]=~e}},{key:"Ce",value:function(e){var t=e+this.position;if(!(t<=this.buffer.length)){var n=2*this.buffer.length;n<t&&(n=t);var r=new Uint8Array(n);r.set(this.buffer),this.buffer=r}}}]),e}(),uc=function(){function e(t){(0,s.Z)(this,e),this.$e=t}return(0,c.Z)(e,[{key:"we",value:function(e){this.$e.Te(e)}},{key:"fe",value:function(e){this.$e.ve(e)}},{key:"le",value:function(e){this.$e.Se(e)}},{key:"ae",value:function(){this.$e.Ne()}}]),e}(),sc=function(){function e(t){(0,s.Z)(this,e),this.$e=t}return(0,c.Z)(e,[{key:"we",value:function(e){this.$e.Re(e)}},{key:"fe",value:function(e){this.$e.Ve(e)}},{key:"le",value:function(e){this.$e.xe(e)}},{key:"ae",value:function(){this.$e.Oe()}}]),e}(),cc=function(){function e(){(0,s.Z)(this,e),this.$e=new oc,this.Be=new uc(this.$e),this.Le=new sc(this.$e)}return(0,c.Z)(e,[{key:"seed",value:function(e){this.$e.seed(e)}},{key:"qe",value:function(e){return 0===e?this.Be:this.Le}},{key:"Fe",value:function(){return this.$e.Fe()}},{key:"reset",value:function(){this.$e.reset()}}]),e}(),lc=function(){function e(t,n,r,i){(0,s.Z)(this,e),this.indexId=t,this.documentKey=n,this.arrayValue=r,this.directionalValue=i}return(0,c.Z)(e,[{key:"Ue",value:function(){var t=this.directionalValue.length,n=0===t||255===this.directionalValue[t-1]?t+1:t,r=new Uint8Array(n);return r.set(this.directionalValue,0),n!==t?r.set([0],this.directionalValue.length):++r[r.length-1],new e(this.indexId,this.documentKey,this.arrayValue,r)}}]),e}();function hc(e,t){var n=e.indexId-t.indexId;return 0!==n?n:0!==(n=fc(e.arrayValue,t.arrayValue))?n:0!==(n=fc(e.directionalValue,t.directionalValue))?n:ai.comparator(e.documentKey,t.documentKey)}function fc(e,t){for(var n=0;n<e.length&&n<t.length;++n){var r=e[n]-t[n];if(0!==r)return r}return e.length-t.length}var dc=function(){function e(t){(0,s.Z)(this,e),this.collectionId=null!=t.collectionGroup?t.collectionGroup:t.path.lastSegment(),this.Ke=t.orderBy,this.Ge=[];var n,r=(0,u.Z)(t.filters);try{for(r.s();!(n=r.n()).done;){var i=n.value;i.isInequality()?this.Qe=i:this.Ge.push(i)}}catch(a){r.e(a)}finally{r.f()}}return(0,c.Z)(e,[{key:"je",value:function(e){Pr(e.collectionGroup===this.collectionId);var t=ui(e);if(void 0!==t&&!this.We(t))return!1;for(var n=si(e),r=0,i=0;r<n.length&&this.We(n[r]);++r);if(r===n.length)return!0;if(void 0!==this.Qe){var a=n[r];if(!this.ze(this.Qe,a)||!this.He(this.Ke[i++],a))return!1;++r}for(;r<n.length;++r){var o=n[r];if(i>=this.Ke.length||!this.He(this.Ke[i++],o))return!1}return!0}},{key:"We",value:function(e){var t,n=(0,u.Z)(this.Ge);try{for(n.s();!(t=n.n()).done;){var r=t.value;if(this.ze(r,e))return!0}}catch(i){n.e(i)}finally{n.f()}return!1}},{key:"ze",value:function(e,t){if(void 0===e||!e.field.isEqual(t.fieldPath))return!1;var n="array-contains"===e.op||"array-contains-any"===e.op;return 2===t.kind===n}},{key:"He",value:function(e,t){return!!e.field.isEqual(t.fieldPath)&&(0===t.kind&&"asc"===e.dir||1===t.kind&&"desc"===e.dir)}}]),e}();function vc(e){var t,n;if(Pr(e instanceof ka||e instanceof wa),e instanceof ka){if(e instanceof Oa){var r=(null===(n=null===(t=e.value.arrayValue)||void 0===t?void 0:t.values)||void 0===n?void 0:n.map((function(t){return ka.create(e.field,"==",t)})))||[];return wa.create(r,"or")}return e}var i=e.filters.map((function(e){return vc(e)}));return wa.create(i,e.op)}function pc(e){if(0===e.getFilters().length)return[];var t=kc(vc(e));return Pr(gc(t)),yc(t)||mc(t)?[t]:t.getFilters()}function yc(e){return e instanceof ka}function mc(e){return e instanceof wa&&Ia(e)}function gc(e){return yc(e)||mc(e)||function(e){if(e instanceof wa&&Za(e)){var t,n=(0,u.Z)(e.getFilters());try{for(n.s();!(t=n.n()).done;){var r=t.value;if(!yc(r)&&!mc(r))return!1}}catch(i){n.e(i)}finally{n.f()}return!0}return!1}(e)}function kc(e){if(Pr(e instanceof ka||e instanceof wa),e instanceof ka)return e;if(1===e.filters.length)return kc(e.filters[0]);var t=e.filters.map((function(e){return kc(e)})),n=wa.create(t,e.op);return gc(n=Zc(n))?n:(Pr(n instanceof wa),Pr(ba(n)),Pr(n.filters.length>1),n.filters.reduce((function(e,t){return wc(e,t)})))}function wc(e,t){var n;return Pr(e instanceof ka||e instanceof wa),Pr(t instanceof ka||t instanceof wa),n=e instanceof ka?t instanceof ka?function(e,t){return wa.create([e,t],"and")}(e,t):bc(e,t):t instanceof ka?bc(t,e):function(e,t){if(Pr(e.filters.length>0&&t.filters.length>0),ba(e)&&ba(t))return Ea(e,t.getFilters());var n=Za(e)?e:t,r=Za(e)?t:e,i=n.filters.map((function(e){return wc(e,r)}));return wa.create(i,"or")}(e,t),Zc(n)}function bc(e,t){if(ba(t))return Ea(t,e.getFilters());var n=t.filters.map((function(t){return wc(e,t)}));return wa.create(n,"or")}function Zc(e){if(Pr(e instanceof ka||e instanceof wa),e instanceof ka)return e;var t=e.getFilters();if(1===t.length)return Zc(t[0]);if(xa(e))return e;var n=t.map((function(e){return Zc(e)})),r=[];return n.forEach((function(t){t instanceof ka?r.push(t):t instanceof wa&&(t.op===e.op?r.push.apply(r,(0,y.Z)(t.filters)):r.push(t))})),1===r.length?r[0]:wa.create(r,e.op)}var Ic=function(){function e(){(0,s.Z)(this,e),this.Je=new xc}return(0,c.Z)(e,[{key:"addToCollectionParentIndex",value:function(e,t){return this.Je.add(t),ki.resolve()}},{key:"getCollectionParents",value:function(e,t){return ki.resolve(this.Je.getEntries(t))}},{key:"addFieldIndex",value:function(e,t){return ki.resolve()}},{key:"deleteFieldIndex",value:function(e,t){return ki.resolve()}},{key:"getDocumentsMatchingTarget",value:function(e,t){return ki.resolve(null)}},{key:"getIndexType",value:function(e,t){return ki.resolve(0)}},{key:"getFieldIndexes",value:function(e,t){return ki.resolve([])}},{key:"getNextCollectionGroupToUpdate",value:function(e){return ki.resolve(null)}},{key:"getMinOffset",value:function(e,t){return ki.resolve(di.min())}},{key:"getMinOffsetFromCollectionGroup",value:function(e,t){return ki.resolve(di.min())}},{key:"updateCollectionGroup",value:function(e,t,n){return ki.resolve()}},{key:"updateIndexEntries",value:function(e,t){return ki.resolve()}}]),e}(),xc=function(){function e(){(0,s.Z)(this,e),this.index={}}return(0,c.Z)(e,[{key:"add",value:function(e){var t=e.lastSegment(),n=e.popLast(),r=this.index[t]||new Ba(ni.comparator),i=!r.has(n);return this.index[t]=r.add(n),i}},{key:"has",value:function(e){var t=e.lastSegment(),n=e.popLast(),r=this.index[t];return r&&r.has(n)}},{key:"getEntries",value:function(e){return(this.index[e]||new Ba(ni.comparator)).toArray()}}]),e}(),_c=new Uint8Array(0),Tc=function(){function e(t,n){(0,s.Z)(this,e),this.user=t,this.databaseId=n,this.Ye=new xc,this.Xe=new au((function(e){return Ja(e)}),(function(e,t){return Xa(e,t)})),this.uid=t.uid||""}return(0,c.Z)(e,[{key:"addToCollectionParentIndex",value:function(e,t){var n=this;if(!this.Ye.has(t)){var r=t.lastSegment(),i=t.popLast();e.addOnCommittedListener((function(){n.Ye.add(t)}));var a={collectionId:r,parent:us(i)};return Ec(e).put(a)}return ki.resolve()}},{key:"getCollectionParents",value:function(e,t){var n=[],r=IDBKeyRange.bound([t,""],[Xr(t),""],!1,!0);return Ec(e).W(r).next((function(e){var r,i=(0,u.Z)(e);try{for(i.s();!(r=i.n()).done;){var a=r.value;if(a.collectionId!==t)break;n.push(ls(a.parent))}}catch(o){i.e(o)}finally{i.f()}return n}))}},{key:"addFieldIndex",value:function(e,t){var n=this,r=Ac(e),i=function(e){return{indexId:e.indexId,collectionGroup:e.collectionGroup,fields:e.fields.map((function(e){return[e.fieldPath.canonicalString(),e.kind]}))}}(t);delete i.indexId;var a=r.add(i);if(t.indexState){var o=Cc(e);return a.next((function(e){o.put(Js(e,n.user,t.indexState.sequenceNumber,t.indexState.offset))}))}return a.next()}},{key:"deleteFieldIndex",value:function(e,t){var n=Ac(e),r=Cc(e),i=Sc(e);return n.delete(t.indexId).next((function(){return r.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))})).next((function(){return i.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))}))}},{key:"getDocumentsMatchingTarget",value:function(e,t){var n=this,r=Sc(e),i=!0,a=new Map;return ki.forEach(this.Ze(t),(function(t){return n.tn(e,t).next((function(e){i&&(i=!!e),a.set(t,e)}))})).next((function(){if(i){var e=yu(),o=[];return ki.forEach(a,(function(i,a){var s;Cr("IndexedDbIndexManager","Using index ".concat((s=i,"id=".concat(s.indexId,"|cg=").concat(s.collectionGroup,"|f=").concat(s.fields.map((function(e){return"".concat(e.fieldPath,":").concat(e.kind)})).join(",")))," to execute ").concat(Ja(t)));var c=function(e,t){var n=ui(t);if(void 0===n)return null;var r,i=(0,u.Z)(eo(e,n.fieldPath));try{for(i.s();!(r=i.n()).done;){var a=r.value;switch(a.op){case"array-contains-any":return a.value.arrayValue.values||[];case"array-contains":return[a.value]}}}catch(o){i.e(o)}finally{i.f()}return null}(a,i),l=function(e,t){var n,r=new Map,i=(0,u.Z)(si(t));try{for(i.s();!(n=i.n()).done;){var a,o=n.value,s=(0,u.Z)(eo(e,o.fieldPath));try{for(s.s();!(a=s.n()).done;){var c=a.value;switch(c.op){case"==":case"in":r.set(o.fieldPath.canonicalString(),c.value);break;case"not-in":case"!=":return r.set(o.fieldPath.canonicalString(),c.value),Array.from(r.values())}}}catch(l){s.e(l)}finally{s.f()}}}catch(l){i.e(l)}finally{i.f()}return null}(a,i),h=function(e,t){var n,r=[],i=!0,a=(0,u.Z)(si(t));try{for(a.s();!(n=a.n()).done;){var o=n.value,s=0===o.kind?to(e,o.fieldPath,e.startAt):no(e,o.fieldPath,e.startAt);r.push(s.value),i&&(i=s.inclusive)}}catch(c){a.e(c)}finally{a.f()}return new pa(r,i)}(a,i),f=function(e,t){var n,r=[],i=!0,a=(0,u.Z)(si(t));try{for(a.s();!(n=a.n()).done;){var o=n.value,s=0===o.kind?no(e,o.fieldPath,e.endAt):to(e,o.fieldPath,e.endAt);r.push(s.value),i&&(i=s.inclusive)}}catch(c){a.e(c)}finally{a.f()}return new pa(r,i)}(a,i),d=n.en(i,a,h),v=n.en(i,a,f),p=n.nn(i,a,l),y=n.sn(i.indexId,c,d,h.inclusive,v,f.inclusive,p);return ki.forEach(y,(function(n){return r.J(n,t.limit).next((function(t){t.forEach((function(t){var n=ai.fromSegments(t.documentKey);e.has(n)||(e=e.add(n),o.push(n))}))}))}))})).next((function(){return o}))}return ki.resolve(null)}))}},{key:"Ze",value:function(e){var t=this.Xe.get(e);return t||(t=0===e.filters.length?[e]:pc(wa.create(e.filters,"and")).map((function(t){return Ya(e.path,e.collectionGroup,e.orderBy,t.getFilters(),e.limit,e.startAt,e.endAt)})),this.Xe.set(e,t),t)}},{key:"sn",value:function(e,t,n,r,i,a,o){for(var u=this,s=(null!=t?t.length:1)*Math.max(n.length,i.length),c=s/(null!=t?t.length:1),l=[],h=function(){var s=t?u.rn(t[f/c]):_c,h=u.on(e,s,n[f%c],r),d=u.un(e,s,i[f%c],a),v=o.map((function(t){return u.on(e,s,t,!0)}));l.push.apply(l,(0,y.Z)(u.createRange(h,d,v)))},f=0;f<s;++f)h();return l}},{key:"on",value:function(e,t,n,r){var i=new lc(e,ai.empty(),t,n);return r?i:i.Ue()}},{key:"un",value:function(e,t,n,r){var i=new lc(e,ai.empty(),t,n);return r?i.Ue():i}},{key:"tn",value:function(e,t){var n=new dc(t),r=null!=t.collectionGroup?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,r).next((function(e){var t,r=null,i=(0,u.Z)(e);try{for(i.s();!(t=i.n()).done;){var a=t.value;n.je(a)&&(!r||a.fields.length>r.fields.length)&&(r=a)}}catch(o){i.e(o)}finally{i.f()}return r}))}},{key:"getIndexType",value:function(e,t){var n=this,r=2,i=this.Ze(t);return ki.forEach(i,(function(t){return n.tn(e,t).next((function(e){e?0!==r&&e.fields.length<function(e){var t,n=new Ba(ii.comparator),r=!1,i=(0,u.Z)(e.filters);try{for(i.s();!(t=i.n()).done;){var a,o=t.value,s=(0,u.Z)(o.getFlattenedFilters());try{for(s.s();!(a=s.n()).done;){var c=a.value;c.field.isKeyField()||("array-contains"===c.op||"array-contains-any"===c.op?r=!0:n=n.add(c.field))}}catch(d){s.e(d)}finally{s.f()}}}catch(d){i.e(d)}finally{i.f()}var l,h=(0,u.Z)(e.orderBy);try{for(h.s();!(l=h.n()).done;){var f=l.value;f.field.isKeyField()||(n=n.add(f.field))}}catch(d){h.e(d)}finally{h.f()}return n.size+(r?1:0)}(t)&&(r=1):r=0}))})).next((function(){return function(e){return null!==e.limit}(t)&&i.length>1&&2===r?1:r}))}},{key:"cn",value:function(e,t){var n,r=new cc,i=(0,u.Z)(si(e));try{for(i.s();!(n=i.n()).done;){var a=n.value,o=t.data.field(a.fieldPath);if(null==o)return null;var s=r.qe(a.kind);rc.Ie.ue(o,s)}}catch(c){i.e(c)}finally{i.f()}return r.Fe()}},{key:"rn",value:function(e){var t=new cc;return rc.Ie.ue(e,t.qe(0)),t.Fe()}},{key:"an",value:function(e,t){var n=new cc;return rc.Ie.ue(ra(this.databaseId,t),n.qe(function(e){var t=si(e);return 0===t.length?0:t[t.length-1].kind}(e))),n.Fe()}},{key:"nn",value:function(e,t,n){if(null===n)return[];var r=[];r.push(new cc);var i,a=0,o=(0,u.Z)(si(e));try{for(o.s();!(i=o.n()).done;){var s,c=i.value,l=n[a++],h=(0,u.Z)(r);try{for(h.s();!(s=h.n()).done;){var f=s.value;if(this.hn(t,c.fieldPath)&&aa(l))r=this.ln(r,c,l);else{var d=f.qe(c.kind);rc.Ie.ue(l,d)}}}catch(v){h.e(v)}finally{h.f()}}}catch(v){o.e(v)}finally{o.f()}return this.fn(r)}},{key:"en",value:function(e,t,n){return this.nn(e,t,n.position)}},{key:"fn",value:function(e){for(var t=[],n=0;n<e.length;++n)t[n]=e[n].Fe();return t}},{key:"ln",value:function(e,t,n){var r,i=(0,y.Z)(e),a=[],o=(0,u.Z)(n.arrayValue.values||[]);try{for(o.s();!(r=o.n()).done;){var s,c=r.value,l=(0,u.Z)(i);try{for(l.s();!(s=l.n()).done;){var h=s.value,f=new cc;f.seed(h.Fe()),rc.Ie.ue(c,f.qe(t.kind)),a.push(f)}}catch(d){l.e(d)}finally{l.f()}}}catch(d){o.e(d)}finally{o.f()}return a}},{key:"hn",value:function(e,t){return!!e.filters.find((function(e){return e instanceof ka&&e.field.isEqual(t)&&("in"===e.op||"not-in"===e.op)}))}},{key:"getFieldIndexes",value:function(e,t){var n=this,r=Ac(e),i=Cc(e);return(t?r.W("collectionGroupIndex",IDBKeyRange.bound(t,t)):r.W()).next((function(e){var t=[];return ki.forEach(e,(function(e){return i.get([e.indexId,n.uid]).next((function(n){t.push(function(e,t){var n=t?new li(t.sequenceNumber,new di(Gs(t.readTime),new ai(ls(t.documentKey)),t.largestBatchId)):li.empty(),r=e.fields.map((function(e){var t=(0,d.Z)(e,2),n=t[0],r=t[1];return new ci(ii.fromServerFormat(n),r)}));return new oi(e.indexId,e.collectionGroup,r,n)}(e,n))}))})).next((function(){return t}))}))}},{key:"getNextCollectionGroupToUpdate",value:function(e){return this.getFieldIndexes(e).next((function(e){return 0===e.length?null:(e.sort((function(e,t){var n=e.indexState.sequenceNumber-t.indexState.sequenceNumber;return 0!==n?n:Yr(e.collectionGroup,t.collectionGroup)})),e[0].collectionGroup)}))}},{key:"updateCollectionGroup",value:function(e,t,n){var r=this,i=Ac(e),a=Cc(e);return this.dn(e).next((function(e){return i.W("collectionGroupIndex",IDBKeyRange.bound(t,t)).next((function(t){return ki.forEach(t,(function(t){return a.put(Js(t.indexId,r.user,e,n))}))}))}))}},{key:"updateIndexEntries",value:function(e,t){var n=this,r=new Map;return ki.forEach(t,(function(t,i){var a=r.get(t.collectionGroup);return(a?ki.resolve(a):n.getFieldIndexes(e,t.collectionGroup)).next((function(a){return r.set(t.collectionGroup,a),ki.forEach(a,(function(r){return n._n(e,t,r).next((function(t){var a=n.wn(i,r);return t.isEqual(a)?ki.resolve():n.mn(e,i,r,t,a)}))}))}))}))}},{key:"gn",value:function(e,t,n,r){return Sc(e).put({indexId:r.indexId,uid:this.uid,arrayValue:r.arrayValue,directionalValue:r.directionalValue,orderedDocumentKey:this.an(n,t.key),documentKey:t.key.path.toArray()})}},{key:"yn",value:function(e,t,n,r){return Sc(e).delete([r.indexId,this.uid,r.arrayValue,r.directionalValue,this.an(n,t.key),t.key.path.toArray()])}},{key:"_n",value:function(e,t,n){var r=Sc(e),i=new Ba(hc);return r.Z({index:"documentKeyIndex",range:IDBKeyRange.only([n.indexId,this.uid,this.an(n,t)])},(function(e,r){i=i.add(new lc(n.indexId,t,r.arrayValue,r.directionalValue))})).next((function(){return i}))}},{key:"wn",value:function(e,t){var n=new Ba(hc),r=this.cn(t,e);if(null==r)return n;var i=ui(t);if(null!=i){var a=e.data.field(i.fieldPath);if(aa(a)){var o,s=(0,u.Z)(a.arrayValue.values||[]);try{for(s.s();!(o=s.n()).done;){var c=o.value;n=n.add(new lc(t.indexId,e.key,this.rn(c),r))}}catch(l){s.e(l)}finally{s.f()}}}else n=n.add(new lc(t.indexId,e.key,_c,r));return n}},{key:"mn",value:function(e,t,n,r,i){var a=this;Cr("IndexedDbIndexManager","Updating index entries for document '%s'",t.key);var o=[];return function(e,t,n,r,i){for(var a=e.getIterator(),o=t.getIterator(),u=Ga(a),s=Ga(o);u||s;){var c=!1,l=!1;if(u&&s){var h=n(u,s);h<0?l=!0:h>0&&(c=!0)}else null!=u?l=!0:c=!0;c?(r(s),s=Ga(o)):l?(i(u),u=Ga(a)):(u=Ga(a),s=Ga(o))}}(r,i,hc,(function(r){o.push(a.gn(e,t,n,r))}),(function(r){o.push(a.yn(e,t,n,r))})),ki.waitFor(o)}},{key:"dn",value:function(e){var t=1;return Cc(e).Z({index:"sequenceNumberIndex",reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(function(e,n,r){r.done(),t=n.sequenceNumber+1})).next((function(){return t}))}},{key:"createRange",value:function(e,t,n){n=n.sort((function(e,t){return hc(e,t)})).filter((function(e,t,n){return!t||0!==hc(e,n[t-1])}));var r=[];r.push(e);var i,a=(0,u.Z)(n);try{for(a.s();!(i=a.n()).done;){var o=i.value,s=hc(o,e),c=hc(o,t);if(0===s)r[0]=e.Ue();else if(s>0&&c<0)r.push(o),r.push(o.Ue());else if(c>0)break}}catch(v){a.e(v)}finally{a.f()}r.push(t);for(var l=[],h=0;h<r.length;h+=2){if(this.pn(r[h],r[h+1]))return[];var f=[r[h].indexId,this.uid,r[h].arrayValue,r[h].directionalValue,_c,[]],d=[r[h+1].indexId,this.uid,r[h+1].arrayValue,r[h+1].directionalValue,_c,[]];l.push(IDBKeyRange.bound(f,d))}return l}},{key:"pn",value:function(e,t){return hc(e,t)>0}},{key:"getMinOffsetFromCollectionGroup",value:function(e,t){return this.getFieldIndexes(e,t).next(Nc)}},{key:"getMinOffset",value:function(e,t){var n=this;return ki.mapArray(this.Ze(t),(function(t){return n.tn(e,t).next((function(e){return e||Or()}))})).next(Nc)}}]),e}();function Ec(e){return Ps(e,"collectionParents")}function Sc(e){return Ps(e,"indexEntries")}function Ac(e){return Ps(e,"indexConfiguration")}function Cc(e){return Ps(e,"indexState")}function Nc(e){Pr(0!==e.length);for(var t=e[0].indexState.offset,n=t.largestBatchId,r=1;r<e.length;r++){var i=e[r].indexState.offset;vi(i,t)<0&&(t=i),n<i.largestBatchId&&(n=i.largestBatchId)}return new di(t.readTime,t.documentKey,n)}var Dc={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},Rc=function(){function e(t,n,r){(0,s.Z)(this,e),this.cacheSizeCollectionThreshold=t,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=r}return(0,c.Z)(e,null,[{key:"withCacheSize",value:function(t){return new e(t,e.DEFAULT_COLLECTION_PERCENTILE,e.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}]),e}();function Oc(e,t,n){var r=e.store("mutations"),i=e.store("documentMutations"),a=[],o=IDBKeyRange.only(n.batchId),s=0,c=r.Z({range:o},(function(e,t,n){return s++,n.delete()}));a.push(c.next((function(){Pr(1===s)})));var l,h=[],f=(0,u.Z)(n.mutations);try{for(f.s();!(l=f.n()).done;){var d=l.value,v=ds(t,d.key.path,n.batchId);a.push(i.delete(v)),h.push(d.key)}}catch(p){f.e(p)}finally{f.f()}return ki.waitFor(a).next((function(){return h}))}function Pc(e){if(!e)return 0;var t;if(e.document)t=e.document;else if(e.unknownDocument)t=e.unknownDocument;else{if(!e.noDocument)throw Or();t=e.noDocument}return JSON.stringify(t).length}Rc.DEFAULT_COLLECTION_PERCENTILE=10,Rc.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Rc.DEFAULT=new Rc(41943040,Rc.DEFAULT_COLLECTION_PERCENTILE,Rc.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Rc.DISABLED=new Rc(-1,0,0);var Lc=function(){function e(t,n,r,i){(0,s.Z)(this,e),this.userId=t,this.yt=n,this.indexManager=r,this.referenceDelegate=i,this.In={}}return(0,c.Z)(e,[{key:"checkEmpty",value:function(e){var t=!0,n=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Fc(e).Z({index:"userMutationsIndex",range:n},(function(e,n,r){t=!1,r.done()})).next((function(){return t}))}},{key:"addMutationBatch",value:function(e,t,n,r){var i=this,a=Vc(e),o=Fc(e);return o.add({}).next((function(s){Pr("number"==typeof s);var c,l=new Ls(s,t,n,r),h=function(e,t,n){var r=n.baseMutations.map((function(t){return Wu(e.ie,t)})),i=n.mutations.map((function(t){return Wu(e.ie,t)}));return{userId:t,batchId:n.batchId,localWriteTimeMs:n.localWriteTime.toMillis(),baseMutations:r,mutations:i}}(i.yt,i.userId,l),f=[],d=new Ba((function(e,t){return Yr(e.canonicalString(),t.canonicalString())})),v=(0,u.Z)(r);try{for(v.s();!(c=v.n()).done;){var p=c.value,y=ds(i.userId,p.key.path,s);d=d.add(p.key.path.popLast()),f.push(o.put(h)),f.push(a.put(y,vs))}}catch(m){v.e(m)}finally{v.f()}return d.forEach((function(t){f.push(i.indexManager.addToCollectionParentIndex(e,t))})),e.addOnCommittedListener((function(){i.In[s]=l.keys()})),ki.waitFor(f).next((function(){return l}))}))}},{key:"lookupMutationBatch",value:function(e,t){var n=this;return Fc(e).get(t).next((function(e){return e?(Pr(e.userId===n.userId),Ks(n.yt,e)):null}))}},{key:"Tn",value:function(e,t){var n=this;return this.In[t]?ki.resolve(this.In[t]):this.lookupMutationBatch(e,t).next((function(e){if(e){var r=e.keys();return n.In[t]=r,r}return null}))}},{key:"getNextMutationBatchAfterBatchId",value:function(e,t){var n=this,r=t+1,i=IDBKeyRange.lowerBound([this.userId,r]),a=null;return Fc(e).Z({index:"userMutationsIndex",range:i},(function(e,t,i){t.userId===n.userId&&(Pr(t.batchId>=r),a=Ks(n.yt,t)),i.done()})).next((function(){return a}))}},{key:"getHighestUnacknowledgedBatchId",value:function(e){var t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),n=-1;return Fc(e).Z({index:"userMutationsIndex",range:t,reverse:!0},(function(e,t,r){n=t.batchId,r.done()})).next((function(){return n}))}},{key:"getAllMutationBatches",value:function(e){var t=this,n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return Fc(e).W("userMutationsIndex",n).next((function(e){return e.map((function(e){return Ks(t.yt,e)}))}))}},{key:"getAllMutationBatchesAffectingDocumentKey",value:function(e,t){var n=this,r=fs(this.userId,t.path),i=IDBKeyRange.lowerBound(r),a=[];return Vc(e).Z({range:i},(function(r,i,o){var u=(0,d.Z)(r,3),s=u[0],c=u[1],l=u[2],h=ls(c);if(s===n.userId&&t.path.isEqual(h))return Fc(e).get(l).next((function(e){if(!e)throw Or();Pr(e.userId===n.userId),a.push(Ks(n.yt,e))}));o.done()})).next((function(){return a}))}},{key:"getAllMutationBatchesAffectingDocumentKeys",value:function(e,t){var n=this,r=new Ba(Yr),i=[];return t.forEach((function(t){var a=fs(n.userId,t.path),o=IDBKeyRange.lowerBound(a),u=Vc(e).Z({range:o},(function(e,i,a){var o=(0,d.Z)(e,3),u=o[0],s=o[1],c=o[2],l=ls(s);u===n.userId&&t.path.isEqual(l)?r=r.add(c):a.done()}));i.push(u)})),ki.waitFor(i).next((function(){return n.En(e,r)}))}},{key:"getAllMutationBatchesAffectingQuery",value:function(e,t){var n=this,r=t.path,i=r.length+1,a=fs(this.userId,r),o=IDBKeyRange.lowerBound(a),u=new Ba(Yr);return Vc(e).Z({range:o},(function(e,t,a){var o=(0,d.Z)(e,3),s=o[0],c=o[1],l=o[2],h=ls(c);s===n.userId&&r.isPrefixOf(h)?h.length===i&&(u=u.add(l)):a.done()})).next((function(){return n.En(e,u)}))}},{key:"En",value:function(e,t){var n=this,r=[],i=[];return t.forEach((function(t){i.push(Fc(e).get(t).next((function(e){if(null===e)throw Or();Pr(e.userId===n.userId),r.push(Ks(n.yt,e))})))})),ki.waitFor(i).next((function(){return r}))}},{key:"removeMutationBatch",value:function(e,t){var n=this;return Oc(e.se,this.userId,t).next((function(r){return e.addOnCommittedListener((function(){n.An(t.batchId)})),ki.forEach(r,(function(t){return n.referenceDelegate.markPotentiallyOrphaned(e,t)}))}))}},{key:"An",value:function(e){delete this.In[e]}},{key:"performConsistencyCheck",value:function(e){var t=this;return this.checkEmpty(e).next((function(n){if(!n)return ki.resolve();var r=IDBKeyRange.lowerBound([t.userId]),i=[];return Vc(e).Z({range:r},(function(e,n,r){if(e[0]===t.userId){var a=ls(e[1]);i.push(a)}else r.done()})).next((function(){Pr(0===i.length)}))}))}},{key:"containsKey",value:function(e,t){return Mc(e,this.userId,t)}},{key:"Rn",value:function(e){var t=this;return Uc(e).get(this.userId).next((function(e){return e||{userId:t.userId,lastAcknowledgedBatchId:-1,lastStreamToken:""}}))}}],[{key:"re",value:function(t,n,r,i){return Pr(""!==t.uid),new e(t.isAuthenticated()?t.uid:"",n,r,i)}}]),e}();function Mc(e,t,n){var r=fs(t,n.path),i=r[1],a=IDBKeyRange.lowerBound(r),o=!1;return Vc(e).Z({range:a,X:!0},(function(e,n,r){var a=(0,d.Z)(e,3),u=a[0],s=a[1];a[2];u===t&&s===i&&(o=!0),r.done()})).next((function(){return o}))}function Fc(e){return Ps(e,"mutations")}function Vc(e){return Ps(e,"documentMutations")}function Uc(e){return Ps(e,"mutationQueues")}var qc=function(){function e(t){(0,s.Z)(this,e),this.bn=t}return(0,c.Z)(e,[{key:"next",value:function(){return this.bn+=2,this.bn}}],[{key:"Pn",value:function(){return new e(0)}},{key:"vn",value:function(){return new e(-1)}}]),e}(),Bc=function(){function e(t,n){(0,s.Z)(this,e),this.referenceDelegate=t,this.yt=n}return(0,c.Z)(e,[{key:"allocateTargetId",value:function(e){var t=this;return this.Vn(e).next((function(n){var r=new qc(n.highestTargetId);return n.highestTargetId=r.next(),t.Sn(e,n).next((function(){return n.highestTargetId}))}))}},{key:"getLastRemoteSnapshotVersion",value:function(e){return this.Vn(e).next((function(e){return ei.fromTimestamp(new $r(e.lastRemoteSnapshotVersion.seconds,e.lastRemoteSnapshotVersion.nanoseconds))}))}},{key:"getHighestSequenceNumber",value:function(e){return this.Vn(e).next((function(e){return e.highestListenSequenceNumber}))}},{key:"setTargetsMetadata",value:function(e,t,n){var r=this;return this.Vn(e).next((function(i){return i.highestListenSequenceNumber=t,n&&(i.lastRemoteSnapshotVersion=n.toTimestamp()),t>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=t),r.Sn(e,i)}))}},{key:"addTargetData",value:function(e,t){var n=this;return this.Dn(e,t).next((function(){return n.Vn(e).next((function(r){return r.targetCount+=1,n.Cn(t,r),n.Sn(e,r)}))}))}},{key:"updateTargetData",value:function(e,t){return this.Dn(e,t)}},{key:"removeTargetData",value:function(e,t){var n=this;return this.removeMatchingKeysForTargetId(e,t.targetId).next((function(){return jc(e).delete(t.targetId)})).next((function(){return n.Vn(e)})).next((function(t){return Pr(t.targetCount>0),t.targetCount-=1,n.Sn(e,t)}))}},{key:"removeTargets",value:function(e,t,n){var r=this,i=0,a=[];return jc(e).Z((function(o,u){var s=zs(u);s.sequenceNumber<=t&&null===n.get(s.targetId)&&(i++,a.push(r.removeTargetData(e,s)))})).next((function(){return ki.waitFor(a)})).next((function(){return i}))}},{key:"forEachTarget",value:function(e,t){return jc(e).Z((function(e,n){var r=zs(n);t(r)}))}},{key:"Vn",value:function(e){return Gc(e).get("targetGlobalKey").next((function(e){return Pr(null!==e),e}))}},{key:"Sn",value:function(e,t){return Gc(e).put("targetGlobalKey",t)}},{key:"Dn",value:function(e,t){return jc(e).put(Ws(this.yt,t))}},{key:"Cn",value:function(e,t){var n=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,n=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,n=!0),n}},{key:"getTargetCount",value:function(e){return this.Vn(e).next((function(e){return e.targetCount}))}},{key:"getTargetData",value:function(e,t){var n=Ja(t),r=IDBKeyRange.bound([n,Number.NEGATIVE_INFINITY],[n,Number.POSITIVE_INFINITY]),i=null;return jc(e).Z({range:r,index:"queryTargetsIndex"},(function(e,n,r){var a=zs(n);Xa(t,a.target)&&(i=a,r.done())})).next((function(){return i}))}},{key:"addMatchingKeys",value:function(e,t,n){var r=this,i=[],a=Kc(e);return t.forEach((function(t){var o=us(t.path);i.push(a.put({targetId:n,path:o})),i.push(r.referenceDelegate.addReference(e,n,t))})),ki.waitFor(i)}},{key:"removeMatchingKeys",value:function(e,t,n){var r=this,i=Kc(e);return ki.forEach(t,(function(t){var a=us(t.path);return ki.waitFor([i.delete([n,a]),r.referenceDelegate.removeReference(e,n,t)])}))}},{key:"removeMatchingKeysForTargetId",value:function(e,t){var n=Kc(e),r=IDBKeyRange.bound([t],[t+1],!1,!0);return n.delete(r)}},{key:"getMatchingKeysForTargetId",value:function(e,t){var n=IDBKeyRange.bound([t],[t+1],!1,!0),r=Kc(e),i=yu();return r.Z({range:n,X:!0},(function(e,t,n){var r=ls(e[1]),a=new ai(r);i=i.add(a)})).next((function(){return i}))}},{key:"containsKey",value:function(e,t){var n=us(t.path),r=IDBKeyRange.bound([n],[Xr(n)],!1,!0),i=0;return Kc(e).Z({index:"documentTargetsIndex",X:!0,range:r},(function(e,t,n){var r=(0,d.Z)(e,2),a=r[0];r[1];0!==a&&(i++,n.done())})).next((function(){return i>0}))}},{key:"ne",value:function(e,t){return jc(e).get(t).next((function(e){return e?zs(e):null}))}}]),e}();function jc(e){return Ps(e,"targets")}function Gc(e){return Ps(e,"targetGlobal")}function Kc(e){return Ps(e,"targetDocuments")}function zc(e,t){var n=(0,d.Z)(e,2),r=n[0],i=n[1],a=(0,d.Z)(t,2),o=a[0],u=a[1],s=Yr(r,o);return 0===s?Yr(i,u):s}var Wc=function(){function e(t){(0,s.Z)(this,e),this.xn=t,this.buffer=new Ba(zc),this.Nn=0}return(0,c.Z)(e,[{key:"kn",value:function(){return++this.Nn}},{key:"On",value:function(e){var t=[e,this.kn()];if(this.buffer.size<this.xn)this.buffer=this.buffer.add(t);else{var n=this.buffer.last();zc(t,n)<0&&(this.buffer=this.buffer.delete(n).add(t))}}},{key:"maxValue",get:function(){return this.buffer.last()[0]}}]),e}(),Hc=function(){function e(t,n,r){(0,s.Z)(this,e),this.garbageCollector=t,this.asyncQueue=n,this.localStore=r,this.Mn=null}return(0,c.Z)(e,[{key:"start",value:function(){-1!==this.garbageCollector.params.cacheSizeCollectionThreshold&&this.Fn(6e4)}},{key:"stop",value:function(){this.Mn&&(this.Mn.cancel(),this.Mn=null)}},{key:"started",get:function(){return null!==this.Mn}},{key:"Fn",value:function(e){var t=this;Cr("LruGarbageCollector","Garbage collection scheduled in ".concat(e,"ms")),this.Mn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(0,p.Z)((0,v.Z)().mark((function e(){return(0,v.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.Mn=null,e.prev=1,e.next=4,t.localStore.collectGarbage(t.garbageCollector);case 4:e.next=14;break;case 6:if(e.prev=6,e.t0=e.catch(1),!xi(e.t0)){e.next=12;break}Cr("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",e.t0),e.next=14;break;case 12:return e.next=14,mi(e.t0);case 14:return e.next=16,t.Fn(3e5);case 16:case"end":return e.stop()}}),e,null,[[1,6]])}))))}}]),e}(),Qc=function(){function e(t,n){(0,s.Z)(this,e),this.$n=t,this.params=n}return(0,c.Z)(e,[{key:"calculateTargetCount",value:function(e,t){return this.$n.Bn(e).next((function(e){return Math.floor(t/100*e)}))}},{key:"nthSequenceNumber",value:function(e,t){var n=this;if(0===t)return ki.resolve(Ni.at);var r=new Wc(t);return this.$n.forEachTarget(e,(function(e){return r.On(e.sequenceNumber)})).next((function(){return n.$n.Ln(e,(function(e){return r.On(e)}))})).next((function(){return r.maxValue}))}},{key:"removeTargets",value:function(e,t,n){return this.$n.removeTargets(e,t,n)}},{key:"removeOrphanedDocuments",value:function(e,t){return this.$n.removeOrphanedDocuments(e,t)}},{key:"collect",value:function(e,t){var n=this;return-1===this.params.cacheSizeCollectionThreshold?(Cr("LruGarbageCollector","Garbage collection skipped; disabled"),ki.resolve(Dc)):this.getCacheSize(e).next((function(r){return r<n.params.cacheSizeCollectionThreshold?(Cr("LruGarbageCollector","Garbage collection skipped; Cache size ".concat(r," is lower than threshold ").concat(n.params.cacheSizeCollectionThreshold)),Dc):n.qn(e,t)}))}},{key:"getCacheSize",value:function(e){return this.$n.getCacheSize(e)}},{key:"qn",value:function(e,t){var n,r,i,a,o,u,s,c=this,l=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((function(t){return t>c.params.maximumSequenceNumbersToCollect?(Cr("LruGarbageCollector","Capping sequence numbers to collect down to the maximum of ".concat(c.params.maximumSequenceNumbersToCollect," from ").concat(t)),r=c.params.maximumSequenceNumbersToCollect):r=t,a=Date.now(),c.nthSequenceNumber(e,r)})).next((function(r){return n=r,o=Date.now(),c.removeTargets(e,n,t)})).next((function(t){return i=t,u=Date.now(),c.removeOrphanedDocuments(e,n)})).next((function(e){return s=Date.now(),Ar()<=k.in.DEBUG&&Cr("LruGarbageCollector","LRU Garbage Collection\n\tCounted targets in ".concat(a-l,"ms\n\tDetermined least recently used ").concat(r," in ")+(o-a)+"ms\n"+"\tRemoved ".concat(i," targets in ")+(u-o)+"ms\n"+"\tRemoved ".concat(e," documents in ")+(s-u)+"ms\n"+"Total Duration: ".concat(s-l,"ms")),ki.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:i,documentsRemoved:e})}))}}]),e}(),Yc=function(){function e(t,n){(0,s.Z)(this,e),this.db=t,this.garbageCollector=function(e,t){return new Qc(e,t)}(this,n)}return(0,c.Z)(e,[{key:"Bn",value:function(e){var t=this.Un(e);return this.db.getTargetCache().getTargetCount(e).next((function(e){return t.next((function(t){return e+t}))}))}},{key:"Un",value:function(e){var t=0;return this.Ln(e,(function(e){t++})).next((function(){return t}))}},{key:"forEachTarget",value:function(e,t){return this.db.getTargetCache().forEachTarget(e,t)}},{key:"Ln",value:function(e,t){return this.Kn(e,(function(e,n){return t(n)}))}},{key:"addReference",value:function(e,t,n){return Jc(e,n)}},{key:"removeReference",value:function(e,t,n){return Jc(e,n)}},{key:"removeTargets",value:function(e,t,n){return this.db.getTargetCache().removeTargets(e,t,n)}},{key:"markPotentiallyOrphaned",value:function(e,t){return Jc(e,t)}},{key:"Gn",value:function(e,t){return function(e,t){var n=!1;return Uc(e).tt((function(r){return Mc(e,r,t).next((function(e){return e&&(n=!0),ki.resolve(!e)}))})).next((function(){return n}))}(e,t)}},{key:"removeOrphanedDocuments",value:function(e,t){var n=this,r=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[],a=0;return this.Kn(e,(function(o,u){if(u<=t){var s=n.Gn(e,o).next((function(t){if(!t)return a++,r.getEntry(e,o).next((function(){return r.removeEntry(o,ei.min()),Kc(e).delete([0,us(o.path)])}))}));i.push(s)}})).next((function(){return ki.waitFor(i)})).next((function(){return r.apply(e)})).next((function(){return a}))}},{key:"removeTarget",value:function(e,t){var n=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,n)}},{key:"updateLimboDocument",value:function(e,t){return Jc(e,t)}},{key:"Kn",value:function(e,t){var n,r=Kc(e),i=Ni.at;return r.Z({index:"documentTargetsIndex"},(function(e,r){var a=(0,d.Z)(e,2),o=a[0],u=(a[1],r.path),s=r.sequenceNumber;0===o?(i!==Ni.at&&t(new ai(ls(n)),i),i=s,n=u):i=Ni.at})).next((function(){i!==Ni.at&&t(new ai(ls(n)),i)}))}},{key:"getCacheSize",value:function(e){return this.db.getRemoteDocumentCache().getSize(e)}}]),e}();function Jc(e,t){return Kc(e).put(function(e,t){return{targetId:0,path:us(e.path),sequenceNumber:t}}(t,e.currentSequenceNumber))}var Xc=function(){function e(){(0,s.Z)(this,e),this.changes=new au((function(e){return e.toString()}),(function(e,t){return e.isEqual(t)})),this.changesApplied=!1}return(0,c.Z)(e,[{key:"addEntry",value:function(e){this.assertNotApplied(),this.changes.set(e.key,e)}},{key:"removeEntry",value:function(e,t){this.assertNotApplied(),this.changes.set(e,Ha.newInvalidDocument(e).setReadTime(t))}},{key:"getEntry",value:function(e,t){this.assertNotApplied();var n=this.changes.get(t);return void 0!==n?ki.resolve(n):this.getFromCache(e,t)}},{key:"getEntries",value:function(e,t){return this.getAllFromCache(e,t)}},{key:"apply",value:function(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}},{key:"assertNotApplied",value:function(){}}]),e}(),$c=function(){function e(t){(0,s.Z)(this,e),this.yt=t}return(0,c.Z)(e,[{key:"setIndexManager",value:function(e){this.indexManager=e}},{key:"addEntry",value:function(e,t,n){return rl(e).put(n)}},{key:"removeEntry",value:function(e,t,n){return rl(e).delete(function(e,t){var n=e.path.toArray();return[n.slice(0,n.length-2),n[n.length-2],Bs(t),n[n.length-1]]}(t,n))}},{key:"updateMetadata",value:function(e,t){var n=this;return this.getMetadata(e).next((function(r){return r.byteSize+=t,n.Qn(e,r)}))}},{key:"getEntry",value:function(e,t){var n=this,r=Ha.newInvalidDocument(t);return rl(e).Z({index:"documentKeyIndex",range:IDBKeyRange.only(il(t))},(function(e,i){r=n.jn(t,i)})).next((function(){return r}))}},{key:"Wn",value:function(e,t){var n=this,r={size:0,document:Ha.newInvalidDocument(t)};return rl(e).Z({index:"documentKeyIndex",range:IDBKeyRange.only(il(t))},(function(e,i){r={document:n.jn(t,i),size:Pc(i)}})).next((function(){return r}))}},{key:"getEntries",value:function(e,t){var n=this,r=uu();return this.zn(e,t,(function(e,t){var i=n.jn(e,t);r=r.insert(e,i)})).next((function(){return r}))}},{key:"Hn",value:function(e,t){var n=this,r=uu(),i=new Va(ai.comparator);return this.zn(e,t,(function(e,t){var a=n.jn(e,t);r=r.insert(e,a),i=i.insert(e,Pc(t))})).next((function(){return{documents:r,Jn:i}}))}},{key:"zn",value:function(e,t,n){if(t.isEmpty())return ki.resolve();var r=new Ba(ol);t.forEach((function(e){return r=r.add(e)}));var i=IDBKeyRange.bound(il(r.first()),il(r.last())),a=r.getIterator(),o=a.getNext();return rl(e).Z({index:"documentKeyIndex",range:i},(function(e,t,r){for(var i=ai.fromSegments([].concat((0,y.Z)(t.prefixPath),[t.collectionGroup,t.documentId]));o&&ol(o,i)<0;)n(o,null),o=a.getNext();o&&o.isEqual(i)&&(n(o,t),o=a.hasNext()?a.getNext():null),o?r.j(il(o)):r.done()})).next((function(){for(;o;)n(o,null),o=a.hasNext()?a.getNext():null}))}},{key:"getDocumentsMatchingQuery",value:function(e,t,n,r){var i=this,a=t.path,o=[a.popLast().toArray(),a.lastSegment(),Bs(n.readTime),n.documentKey.path.isEmpty()?"":n.documentKey.path.lastSegment()],s=[a.popLast().toArray(),a.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return rl(e).W(IDBKeyRange.bound(o,s,!0)).next((function(e){var n,a=uu(),o=(0,u.Z)(e);try{for(o.s();!(n=o.n()).done;){var s=n.value,c=i.jn(ai.fromSegments(s.prefixPath.concat(s.collectionGroup,s.documentId)),s);c.isFoundDocument()&&(go(t,c)||r.has(c.key))&&(a=a.insert(c.key,c))}}catch(l){o.e(l)}finally{o.f()}return a}))}},{key:"getAllFromCollectionGroup",value:function(e,t,n,r){var i=this,a=uu(),o=al(t,n),u=al(t,di.max());return rl(e).Z({index:"collectionGroupIndex",range:IDBKeyRange.bound(o,u,!0)},(function(e,t,n){var o=i.jn(ai.fromSegments(t.prefixPath.concat(t.collectionGroup,t.documentId)),t);(a=a.insert(o.key,o)).size===r&&n.done()})).next((function(){return a}))}},{key:"newChangeBuffer",value:function(e){return new tl(this,!!e&&e.trackRemovals)}},{key:"getSize",value:function(e){return this.getMetadata(e).next((function(e){return e.byteSize}))}},{key:"getMetadata",value:function(e){return nl(e).get("remoteDocumentGlobalKey").next((function(e){return Pr(!!e),e}))}},{key:"Qn",value:function(e,t){return nl(e).put("remoteDocumentGlobalKey",t)}},{key:"jn",value:function(e,t){if(t){var n=function(e,t){var n;if(t.document)n=Ku(e.ie,t.document,!!t.hasCommittedMutations);else if(t.noDocument){var r=ai.fromSegments(t.noDocument.path),i=Gs(t.noDocument.readTime);n=Ha.newNoDocument(r,i),t.hasCommittedMutations&&n.setHasCommittedMutations()}else{if(!t.unknownDocument)return Or();var a=ai.fromSegments(t.unknownDocument.path),o=Gs(t.unknownDocument.version);n=Ha.newUnknownDocument(a,o)}return t.readTime&&n.setReadTime(function(e){var t=new $r(e[0],e[1]);return ei.fromTimestamp(t)}(t.readTime)),n}(this.yt,t);if(!n.isNoDocument()||!n.version.isEqual(ei.min()))return n}return Ha.newInvalidDocument(e)}}]),e}();function el(e){return new $c(e)}var tl=function(e){(0,a.Z)(n,e);var t=(0,o.Z)(n);function n(e,r){var i;return(0,s.Z)(this,n),(i=t.call(this)).Yn=e,i.trackRemovals=r,i.Xn=new au((function(e){return e.toString()}),(function(e,t){return e.isEqual(t)})),i}return(0,c.Z)(n,[{key:"applyChanges",value:function(e){var t=this,n=[],r=0,i=new Ba((function(e,t){return Yr(e.canonicalString(),t.canonicalString())}));return this.changes.forEach((function(a,o){var u=t.Xn.get(a);if(n.push(t.Yn.removeEntry(e,a,u.readTime)),o.isValidDocument()){var s=qs(t.Yn.yt,o);i=i.add(a.path.popLast());var c=Pc(s);r+=c-u.size,n.push(t.Yn.addEntry(e,a,s))}else if(r-=u.size,t.trackRemovals){var l=qs(t.Yn.yt,o.convertToNoDocument(ei.min()));n.push(t.Yn.addEntry(e,a,l))}})),i.forEach((function(r){n.push(t.Yn.indexManager.addToCollectionParentIndex(e,r))})),n.push(this.Yn.updateMetadata(e,r)),ki.waitFor(n)}},{key:"getFromCache",value:function(e,t){var n=this;return this.Yn.Wn(e,t).next((function(e){return n.Xn.set(t,{size:e.size,readTime:e.document.readTime}),e.document}))}},{key:"getAllFromCache",value:function(e,t){var n=this;return this.Yn.Hn(e,t).next((function(e){var t=e.documents;return e.Jn.forEach((function(e,r){n.Xn.set(e,{size:r,readTime:t.get(e).readTime})})),t}))}}]),n}(Xc);function nl(e){return Ps(e,"remoteDocumentGlobal")}function rl(e){return Ps(e,"remoteDocumentsV14")}function il(e){var t=e.path.toArray();return[t.slice(0,t.length-2),t[t.length-2],t[t.length-1]]}function al(e,t){var n=t.documentKey.path.toArray();return[e,Bs(t.readTime),n.slice(0,n.length-2),n.length>0?n[n.length-1]:""]}function ol(e,t){for(var n=e.path.toArray(),r=t.path.toArray(),i=0,a=0;a<n.length-2&&a<r.length-2;++a)if(i=Yr(n[a],r[a]))return i;return(i=Yr(n.length,r.length))||((i=Yr(n[n.length-2],r[r.length-2]))||Yr(n[n.length-1],r[r.length-1]))}var ul=(0,c.Z)((function e(t,n){(0,s.Z)(this,e),this.overlayedDocument=t,this.mutatedFields=n})),sl=function(){function e(t,n,r,i){(0,s.Z)(this,e),this.remoteDocumentCache=t,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=i}return(0,c.Z)(e,[{key:"getDocument",value:function(e,t){var n=this,r=null;return this.documentOverlayCache.getOverlay(e,t).next((function(i){return r=i,n.remoteDocumentCache.getEntry(e,t)})).next((function(e){return null!==r&&Go(r.mutation,e,Ka.empty(),$r.now()),e}))}},{key:"getDocuments",value:function(e,t){var n=this;return this.remoteDocumentCache.getEntries(e,t).next((function(t){return n.getLocalViewOfDocuments(e,t,yu()).next((function(){return t}))}))}},{key:"getLocalViewOfDocuments",value:function(e,t){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:yu(),i=hu();return this.populateOverlays(e,i,t).next((function(){return n.computeViews(e,t,i,r).next((function(e){var t=cu();return e.forEach((function(e,n){t=t.insert(e,n.overlayedDocument)})),t}))}))}},{key:"getOverlayedDocuments",value:function(e,t){var n=this,r=hu();return this.populateOverlays(e,r,t).next((function(){return n.computeViews(e,t,r,yu())}))}},{key:"populateOverlays",value:function(e,t,n){var r=[];return n.forEach((function(e){t.has(e)||r.push(e)})),this.documentOverlayCache.getOverlays(e,r).next((function(e){e.forEach((function(e,n){t.set(e,n)}))}))}},{key:"computeViews",value:function(e,t,n,r){var i=uu(),a=du(),o=du();return t.forEach((function(e,t){var o=n.get(t.key);r.has(t.key)&&(void 0===o||o.mutation instanceof Ho)?i=i.insert(t.key,t):void 0!==o?(a.set(t.key,o.mutation.getFieldMask()),Go(o.mutation,t,o.mutation.getFieldMask(),$r.now())):a.set(t.key,Ka.empty())})),this.recalculateAndSaveOverlays(e,i).next((function(e){return e.forEach((function(e,t){return a.set(e,t)})),t.forEach((function(e,t){var n;return o.set(e,new ul(t,null!==(n=a.get(e))&&void 0!==n?n:null))})),o}))}},{key:"recalculateAndSaveOverlays",value:function(e,t){var n=this,r=du(),i=new Va((function(e,t){return e-t})),a=yu();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((function(e){var n,a=(0,u.Z)(e);try{var o=function(){var e=n.value;e.keys().forEach((function(n){var a=t.get(n);if(null!==a){var o=r.get(n)||Ka.empty();o=e.applyToLocalView(a,o),r.set(n,o);var u=(i.get(e.batchId)||yu()).add(n);i=i.insert(e.batchId,u)}}))};for(a.s();!(n=a.n()).done;)o()}catch(s){a.e(s)}finally{a.f()}})).next((function(){for(var o=[],u=i.getReverseIterator(),s=function(){var i=u.getNext(),s=i.key,c=i.value,l=fu();c.forEach((function(e){if(!a.has(e)){var n=Bo(t.get(e),r.get(e));null!==n&&l.set(e,n),a=a.add(e)}})),o.push(n.documentOverlayCache.saveOverlays(e,s,l))};u.hasNext();)s();return ki.waitFor(o)})).next((function(){return r}))}},{key:"recalculateAndSaveOverlaysForDocumentKeys",value:function(e,t){var n=this;return this.remoteDocumentCache.getEntries(e,t).next((function(t){return n.recalculateAndSaveOverlays(e,t)}))}},{key:"getDocumentsMatchingQuery",value:function(e,t,n){return function(e){return ai.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):co(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,n):this.getDocumentsMatchingCollectionQuery(e,t,n)}},{key:"getNextDocuments",value:function(e,t,n,r){var i=this;return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,n,r).next((function(a){var o=r-a.size>0?i.documentOverlayCache.getOverlaysForCollectionGroup(e,t,n.largestBatchId,r-a.size):ki.resolve(hu()),u=-1,s=a;return o.next((function(t){return ki.forEach(t,(function(t,n){return u<n.largestBatchId&&(u=n.largestBatchId),a.get(t)?ki.resolve():i.remoteDocumentCache.getEntry(e,t).next((function(e){s=s.insert(t,e)}))})).next((function(){return i.populateOverlays(e,t,a)})).next((function(){return i.computeViews(e,s,t,yu())})).next((function(e){return{batchId:u,changes:lu(e)}}))}))}))}},{key:"getDocumentsMatchingDocumentQuery",value:function(e,t){return this.getDocument(e,new ai(t)).next((function(e){var t=cu();return e.isFoundDocument()&&(t=t.insert(e.key,e)),t}))}},{key:"getDocumentsMatchingCollectionGroupQuery",value:function(e,t,n){var r=this,i=t.collectionGroup,a=cu();return this.indexManager.getCollectionParents(e,i).next((function(o){return ki.forEach(o,(function(o){var u=function(e,t){return new ro(t,null,e.explicitOrderBy.slice(),e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt)}(t,o.child(i));return r.getDocumentsMatchingCollectionQuery(e,u,n).next((function(e){e.forEach((function(e,t){a=a.insert(e,t)}))}))})).next((function(){return a}))}))}},{key:"getDocumentsMatchingCollectionQuery",value:function(e,t,n){var r,i=this;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,n.largestBatchId).next((function(a){return r=a,i.remoteDocumentCache.getDocumentsMatchingQuery(e,t,n,r)})).next((function(e){r.forEach((function(t,n){var r=n.getKey();null===e.get(r)&&(e=e.insert(r,Ha.newInvalidDocument(r)))}));var n=cu();return e.forEach((function(e,i){var a=r.get(e);void 0!==a&&Go(a.mutation,i,Ka.empty(),$r.now()),go(t,i)&&(n=n.insert(e,i))})),n}))}}]),e}(),cl=function(){function e(t){(0,s.Z)(this,e),this.yt=t,this.Zn=new Map,this.ts=new Map}return(0,c.Z)(e,[{key:"getBundleMetadata",value:function(e,t){return ki.resolve(this.Zn.get(t))}},{key:"saveBundleMetadata",value:function(e,t){var n;return this.Zn.set(t.id,{id:(n=t).id,version:n.version,createTime:Pu(n.createTime)}),ki.resolve()}},{key:"getNamedQuery",value:function(e,t){return ki.resolve(this.ts.get(t))}},{key:"saveNamedQuery",value:function(e,t){return this.ts.set(t.name,function(e){return{name:e.name,query:Hs(e.bundledQuery),readTime:Pu(e.readTime)}}(t)),ki.resolve()}}]),e}(),ll=function(){function e(){(0,s.Z)(this,e),this.overlays=new Va(ai.comparator),this.es=new Map}return(0,c.Z)(e,[{key:"getOverlay",value:function(e,t){return ki.resolve(this.overlays.get(t))}},{key:"getOverlays",value:function(e,t){var n=this,r=hu();return ki.forEach(t,(function(t){return n.getOverlay(e,t).next((function(e){null!==e&&r.set(t,e)}))})).next((function(){return r}))}},{key:"saveOverlays",value:function(e,t,n){var r=this;return n.forEach((function(n,i){r.oe(e,t,i)})),ki.resolve()}},{key:"removeOverlaysForBatchId",value:function(e,t,n){var r=this,i=this.es.get(n);return void 0!==i&&(i.forEach((function(e){return r.overlays=r.overlays.remove(e)})),this.es.delete(n)),ki.resolve()}},{key:"getOverlaysForCollection",value:function(e,t,n){for(var r=hu(),i=t.length+1,a=new ai(t.child("")),o=this.overlays.getIteratorFrom(a);o.hasNext();){var u=o.getNext().value,s=u.getKey();if(!t.isPrefixOf(s.path))break;s.path.length===i&&u.largestBatchId>n&&r.set(u.getKey(),u)}return ki.resolve(r)}},{key:"getOverlaysForCollectionGroup",value:function(e,t,n,r){for(var i=new Va((function(e,t){return e-t})),a=this.overlays.getIterator();a.hasNext();){var o=a.getNext().value;if(o.getKey().getCollectionGroup()===t&&o.largestBatchId>n){var u=i.get(o.largestBatchId);null===u&&(u=hu(),i=i.insert(o.largestBatchId,u)),u.set(o.getKey(),o)}}for(var s=hu(),c=i.getIterator();c.hasNext()&&(c.getNext().value.forEach((function(e,t){return s.set(e,t)})),!(s.size()>=r)););return ki.resolve(s)}},{key:"oe",value:function(e,t,n){var r=this.overlays.get(n.key);if(null!==r){var i=this.es.get(r.largestBatchId).delete(n.key);this.es.set(r.largestBatchId,i)}this.overlays=this.overlays.insert(n.key,new Fs(t,n));var a=this.es.get(t);void 0===a&&(a=yu(),this.es.set(t,a)),this.es.set(t,a.add(n.key))}}]),e}(),hl=function(){function e(){(0,s.Z)(this,e),this.ns=new Ba(fl.ss),this.rs=new Ba(fl.os)}return(0,c.Z)(e,[{key:"isEmpty",value:function(){return this.ns.isEmpty()}},{key:"addReference",value:function(e,t){var n=new fl(e,t);this.ns=this.ns.add(n),this.rs=this.rs.add(n)}},{key:"us",value:function(e,t){var n=this;e.forEach((function(e){return n.addReference(e,t)}))}},{key:"removeReference",value:function(e,t){this.cs(new fl(e,t))}},{key:"hs",value:function(e,t){var n=this;e.forEach((function(e){return n.removeReference(e,t)}))}},{key:"ls",value:function(e){var t=this,n=new ai(new ni([])),r=new fl(n,e),i=new fl(n,e+1),a=[];return this.rs.forEachInRange([r,i],(function(e){t.cs(e),a.push(e.key)})),a}},{key:"fs",value:function(){var e=this;this.ns.forEach((function(t){return e.cs(t)}))}},{key:"cs",value:function(e){this.ns=this.ns.delete(e),this.rs=this.rs.delete(e)}},{key:"ds",value:function(e){var t=new ai(new ni([])),n=new fl(t,e),r=new fl(t,e+1),i=yu();return this.rs.forEachInRange([n,r],(function(e){i=i.add(e.key)})),i}},{key:"containsKey",value:function(e){var t=new fl(e,0),n=this.ns.firstAfterOrEqual(t);return null!==n&&e.isEqual(n.key)}}]),e}(),fl=function(){function e(t,n){(0,s.Z)(this,e),this.key=t,this._s=n}return(0,c.Z)(e,null,[{key:"ss",value:function(e,t){return ai.comparator(e.key,t.key)||Yr(e._s,t._s)}},{key:"os",value:function(e,t){return Yr(e._s,t._s)||ai.comparator(e.key,t.key)}}]),e}(),dl=function(){function e(t,n){(0,s.Z)(this,e),this.indexManager=t,this.referenceDelegate=n,this.mutationQueue=[],this.ws=1,this.gs=new Ba(fl.ss)}return(0,c.Z)(e,[{key:"checkEmpty",value:function(e){return ki.resolve(0===this.mutationQueue.length)}},{key:"addMutationBatch",value:function(e,t,n,r){var i=this.ws;this.ws++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];var a=new Ls(i,t,n,r);this.mutationQueue.push(a);var o,s=(0,u.Z)(r);try{for(s.s();!(o=s.n()).done;){var c=o.value;this.gs=this.gs.add(new fl(c.key,i)),this.indexManager.addToCollectionParentIndex(e,c.key.path.popLast())}}catch(l){s.e(l)}finally{s.f()}return ki.resolve(a)}},{key:"lookupMutationBatch",value:function(e,t){return ki.resolve(this.ys(t))}},{key:"getNextMutationBatchAfterBatchId",value:function(e,t){var n=t+1,r=this.ps(n),i=r<0?0:r;return ki.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}},{key:"getHighestUnacknowledgedBatchId",value:function(){return ki.resolve(0===this.mutationQueue.length?-1:this.ws-1)}},{key:"getAllMutationBatches",value:function(e){return ki.resolve(this.mutationQueue.slice())}},{key:"getAllMutationBatchesAffectingDocumentKey",value:function(e,t){var n=this,r=new fl(t,0),i=new fl(t,Number.POSITIVE_INFINITY),a=[];return this.gs.forEachInRange([r,i],(function(e){var t=n.ys(e._s);a.push(t)})),ki.resolve(a)}},{key:"getAllMutationBatchesAffectingDocumentKeys",value:function(e,t){var n=this,r=new Ba(Yr);return t.forEach((function(e){var t=new fl(e,0),i=new fl(e,Number.POSITIVE_INFINITY);n.gs.forEachInRange([t,i],(function(e){r=r.add(e._s)}))})),ki.resolve(this.Is(r))}},{key:"getAllMutationBatchesAffectingQuery",value:function(e,t){var n=t.path,r=n.length+1,i=n;ai.isDocumentKey(i)||(i=i.child(""));var a=new fl(new ai(i),0),o=new Ba(Yr);return this.gs.forEachWhile((function(e){var t=e.key.path;return!!n.isPrefixOf(t)&&(t.length===r&&(o=o.add(e._s)),!0)}),a),ki.resolve(this.Is(o))}},{key:"Is",value:function(e){var t=this,n=[];return e.forEach((function(e){var r=t.ys(e);null!==r&&n.push(r)})),n}},{key:"removeMutationBatch",value:function(e,t){var n=this;Pr(0===this.Ts(t.batchId,"removed")),this.mutationQueue.shift();var r=this.gs;return ki.forEach(t.mutations,(function(i){var a=new fl(i.key,t.batchId);return r=r.delete(a),n.referenceDelegate.markPotentiallyOrphaned(e,i.key)})).next((function(){n.gs=r}))}},{key:"An",value:function(e){}},{key:"containsKey",value:function(e,t){var n=new fl(t,0),r=this.gs.firstAfterOrEqual(n);return ki.resolve(t.isEqual(r&&r.key))}},{key:"performConsistencyCheck",value:function(e){return this.mutationQueue.length,ki.resolve()}},{key:"Ts",value:function(e,t){return this.ps(e)}},{key:"ps",value:function(e){return 0===this.mutationQueue.length?0:e-this.mutationQueue[0].batchId}},{key:"ys",value:function(e){var t=this.ps(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}]),e}(),vl=function(){function e(t){(0,s.Z)(this,e),this.Es=t,this.docs=new Va(ai.comparator),this.size=0}return(0,c.Z)(e,[{key:"setIndexManager",value:function(e){this.indexManager=e}},{key:"addEntry",value:function(e,t){var n=t.key,r=this.docs.get(n),i=r?r.size:0,a=this.Es(t);return this.docs=this.docs.insert(n,{document:t.mutableCopy(),size:a}),this.size+=a-i,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}},{key:"removeEntry",value:function(e){var t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}},{key:"getEntry",value:function(e,t){var n=this.docs.get(t);return ki.resolve(n?n.document.mutableCopy():Ha.newInvalidDocument(t))}},{key:"getEntries",value:function(e,t){var n=this,r=uu();return t.forEach((function(e){var t=n.docs.get(e);r=r.insert(e,t?t.document.mutableCopy():Ha.newInvalidDocument(e))})),ki.resolve(r)}},{key:"getDocumentsMatchingQuery",value:function(e,t,n,r){for(var i=uu(),a=t.path,o=new ai(a.child("")),u=this.docs.getIteratorFrom(o);u.hasNext();){var s=u.getNext(),c=s.key,l=s.value.document;if(!a.isPrefixOf(c.path))break;c.path.length>a.length+1||vi(fi(l),n)<=0||(r.has(l.key)||go(t,l))&&(i=i.insert(l.key,l.mutableCopy()))}return ki.resolve(i)}},{key:"getAllFromCollectionGroup",value:function(e,t,n,r){Or()}},{key:"As",value:function(e,t){return ki.forEach(this.docs,(function(e){return t(e)}))}},{key:"newChangeBuffer",value:function(e){return new pl(this)}},{key:"getSize",value:function(e){return ki.resolve(this.size)}}]),e}(),pl=function(e){(0,a.Z)(n,e);var t=(0,o.Z)(n);function n(e){var r;return(0,s.Z)(this,n),(r=t.call(this)).Yn=e,r}return(0,c.Z)(n,[{key:"applyChanges",value:function(e){var t=this,n=[];return this.changes.forEach((function(r,i){i.isValidDocument()?n.push(t.Yn.addEntry(e,i)):t.Yn.removeEntry(r)})),ki.waitFor(n)}},{key:"getFromCache",value:function(e,t){return this.Yn.getEntry(e,t)}},{key:"getAllFromCache",value:function(e,t){return this.Yn.getEntries(e,t)}}]),n}(Xc),yl=function(){function e(t){(0,s.Z)(this,e),this.persistence=t,this.Rs=new au((function(e){return Ja(e)}),Xa),this.lastRemoteSnapshotVersion=ei.min(),this.highestTargetId=0,this.bs=0,this.Ps=new hl,this.targetCount=0,this.vs=qc.Pn()}return(0,c.Z)(e,[{key:"forEachTarget",value:function(e,t){return this.Rs.forEach((function(e,n){return t(n)})),ki.resolve()}},{key:"getLastRemoteSnapshotVersion",value:function(e){return ki.resolve(this.lastRemoteSnapshotVersion)}},{key:"getHighestSequenceNumber",value:function(e){return ki.resolve(this.bs)}},{key:"allocateTargetId",value:function(e){return this.highestTargetId=this.vs.next(),ki.resolve(this.highestTargetId)}},{key:"setTargetsMetadata",value:function(e,t,n){return n&&(this.lastRemoteSnapshotVersion=n),t>this.bs&&(this.bs=t),ki.resolve()}},{key:"Dn",value:function(e){this.Rs.set(e.target,e);var t=e.targetId;t>this.highestTargetId&&(this.vs=new qc(t),this.highestTargetId=t),e.sequenceNumber>this.bs&&(this.bs=e.sequenceNumber)}},{key:"addTargetData",value:function(e,t){return this.Dn(t),this.targetCount+=1,ki.resolve()}},{key:"updateTargetData",value:function(e,t){return this.Dn(t),ki.resolve()}},{key:"removeTargetData",value:function(e,t){return this.Rs.delete(t.target),this.Ps.ls(t.targetId),this.targetCount-=1,ki.resolve()}},{key:"removeTargets",value:function(e,t,n){var r=this,i=0,a=[];return this.Rs.forEach((function(o,u){u.sequenceNumber<=t&&null===n.get(u.targetId)&&(r.Rs.delete(o),a.push(r.removeMatchingKeysForTargetId(e,u.targetId)),i++)})),ki.waitFor(a).next((function(){return i}))}},{key:"getTargetCount",value:function(e){return ki.resolve(this.targetCount)}},{key:"getTargetData",value:function(e,t){var n=this.Rs.get(t)||null;return ki.resolve(n)}},{key:"addMatchingKeys",value:function(e,t,n){return this.Ps.us(t,n),ki.resolve()}},{key:"removeMatchingKeys",value:function(e,t,n){this.Ps.hs(t,n);var r=this.persistence.referenceDelegate,i=[];return r&&t.forEach((function(t){i.push(r.markPotentiallyOrphaned(e,t))})),ki.waitFor(i)}},{key:"removeMatchingKeysForTargetId",value:function(e,t){return this.Ps.ls(t),ki.resolve()}},{key:"getMatchingKeysForTargetId",value:function(e,t){var n=this.Ps.ds(t);return ki.resolve(n)}},{key:"containsKey",value:function(e,t){return ki.resolve(this.Ps.containsKey(t))}}]),e}(),ml=function(){function e(t,n){var r=this;(0,s.Z)(this,e),this.Vs={},this.overlays={},this.Ss=new Ni(0),this.Ds=!1,this.Ds=!0,this.referenceDelegate=t(this),this.Cs=new yl(this),this.indexManager=new Ic,this.remoteDocumentCache=new vl((function(e){return r.referenceDelegate.xs(e)})),this.yt=new Us(n),this.Ns=new cl(this.yt)}return(0,c.Z)(e,[{key:"start",value:function(){return Promise.resolve()}},{key:"shutdown",value:function(){return this.Ds=!1,Promise.resolve()}},{key:"started",get:function(){return this.Ds}},{key:"setDatabaseDeletedListener",value:function(){}},{key:"setNetworkEnabled",value:function(){}},{key:"getIndexManager",value:function(e){return this.indexManager}},{key:"getDocumentOverlayCache",value:function(e){var t=this.overlays[e.toKey()];return t||(t=new ll,this.overlays[e.toKey()]=t),t}},{key:"getMutationQueue",value:function(e,t){var n=this.Vs[e.toKey()];return n||(n=new dl(t,this.referenceDelegate),this.Vs[e.toKey()]=n),n}},{key:"getTargetCache",value:function(){return this.Cs}},{key:"getRemoteDocumentCache",value:function(){return this.remoteDocumentCache}},{key:"getBundleCache",value:function(){return this.Ns}},{key:"runTransaction",value:function(e,t,n){var r=this;Cr("MemoryPersistence","Starting transaction:",e);var i=new gl(this.Ss.next());return this.referenceDelegate.ks(),n(i).next((function(e){return r.referenceDelegate.Os(i).next((function(){return e}))})).toPromise().then((function(e){return i.raiseOnCommittedEvent(),e}))}},{key:"Ms",value:function(e,t){return ki.or(Object.values(this.Vs).map((function(n){return function(){return n.containsKey(e,t)}})))}}]),e}(),gl=function(e){(0,a.Z)(n,e);var t=(0,o.Z)(n);function n(e){var r;return(0,s.Z)(this,n),(r=t.call(this)).currentSequenceNumber=e,r}return(0,c.Z)(n)}(yi),kl=function(){function e(t){(0,s.Z)(this,e),this.persistence=t,this.Fs=new hl,this.$s=null}return(0,c.Z)(e,[{key:"Ls",get:function(){if(this.$s)return this.$s;throw Or()}},{key:"addReference",value:function(e,t,n){return this.Fs.addReference(n,t),this.Ls.delete(n.toString()),ki.resolve()}},{key:"removeReference",value:function(e,t,n){return this.Fs.removeReference(n,t),this.Ls.add(n.toString()),ki.resolve()}},{key:"markPotentiallyOrphaned",value:function(e,t){return this.Ls.add(t.toString()),ki.resolve()}},{key:"removeTarget",value:function(e,t){var n=this;this.Fs.ls(t.targetId).forEach((function(e){return n.Ls.add(e.toString())}));var r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next((function(e){e.forEach((function(e){return n.Ls.add(e.toString())}))})).next((function(){return r.removeTargetData(e,t)}))}},{key:"ks",value:function(){this.$s=new Set}},{key:"Os",value:function(e){var t=this,n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return ki.forEach(this.Ls,(function(r){var i=ai.fromPath(r);return t.qs(e,i).next((function(e){e||n.removeEntry(i,ei.min())}))})).next((function(){return t.$s=null,n.apply(e)}))}},{key:"updateLimboDocument",value:function(e,t){var n=this;return this.qs(e,t).next((function(e){e?n.Ls.delete(t.toString()):n.Ls.add(t.toString())}))}},{key:"xs",value:function(e){return 0}},{key:"qs",value:function(e,t){var n=this;return ki.or([function(){return ki.resolve(n.Fs.containsKey(t))},function(){return n.persistence.getTargetCache().containsKey(e,t)},function(){return n.persistence.Ms(e,t)}])}}],[{key:"Bs",value:function(t){return new e(t)}}]),e}(),wl=function(){function e(t){(0,s.Z)(this,e),this.yt=t}return(0,c.Z)(e,[{key:"$",value:function(e,t,n,r){var i=this,a=new wi("createOrUpgrade",t);n<1&&r>=1&&(function(e){e.createObjectStore("owner")}(e),function(e){e.createObjectStore("mutationQueues",{keyPath:"userId"}),e.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",hs,{unique:!0}),e.createObjectStore("documentMutations")}(e),bl(e),function(e){e.createObjectStore("remoteDocuments")}(e));var o=ki.resolve();return n<3&&r>=3&&(0!==n&&(function(e){e.deleteObjectStore("targetDocuments"),e.deleteObjectStore("targets"),e.deleteObjectStore("targetGlobal")}(e),bl(e)),o=o.next((function(){return function(e){var t=e.store("targetGlobal"),n={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:ei.min().toTimestamp(),targetCount:0};return t.put("targetGlobalKey",n)}(a)}))),n<4&&r>=4&&(0!==n&&(o=o.next((function(){return function(e,t){return t.store("mutations").W().next((function(n){e.deleteObjectStore("mutations"),e.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",hs,{unique:!0});var r=t.store("mutations"),i=n.map((function(e){return r.put(e)}));return ki.waitFor(i)}))}(e,a)}))),o=o.next((function(){!function(e){e.createObjectStore("clientMetadata",{keyPath:"clientId"})}(e)}))),n<5&&r>=5&&(o=o.next((function(){return i.Us(a)}))),n<6&&r>=6&&(o=o.next((function(){return function(e){e.createObjectStore("remoteDocumentGlobal")}(e),i.Ks(a)}))),n<7&&r>=7&&(o=o.next((function(){return i.Gs(a)}))),n<8&&r>=8&&(o=o.next((function(){return i.Qs(e,a)}))),n<9&&r>=9&&(o=o.next((function(){!function(e){e.objectStoreNames.contains("remoteDocumentChanges")&&e.deleteObjectStore("remoteDocumentChanges")}(e)}))),n<10&&r>=10&&(o=o.next((function(){return i.js(a)}))),n<11&&r>=11&&(o=o.next((function(){!function(e){e.createObjectStore("bundles",{keyPath:"bundleId"})}(e),function(e){e.createObjectStore("namedQueries",{keyPath:"name"})}(e)}))),n<12&&r>=12&&(o=o.next((function(){!function(e){var t=e.createObjectStore("documentOverlays",{keyPath:Ts});t.createIndex("collectionPathOverlayIndex",Es,{unique:!1}),t.createIndex("collectionGroupOverlayIndex",Ss,{unique:!1})}(e)}))),n<13&&r>=13&&(o=o.next((function(){return function(e){var t=e.createObjectStore("remoteDocumentsV14",{keyPath:ps});t.createIndex("documentKeyIndex",ys),t.createIndex("collectionGroupIndex",ms)}(e)})).next((function(){return i.Ws(e,a)})).next((function(){return e.deleteObjectStore("remoteDocuments")}))),n<14&&r>=14&&(o=o.next((function(){return i.zs(e,a)}))),n<15&&r>=15&&(o=o.next((function(){return function(e){e.createObjectStore("indexConfiguration",{keyPath:"indexId",autoIncrement:!0}).createIndex("collectionGroupIndex","collectionGroup",{unique:!1}),e.createObjectStore("indexState",{keyPath:Zs}).createIndex("sequenceNumberIndex",Is,{unique:!1}),e.createObjectStore("indexEntries",{keyPath:xs}).createIndex("documentKeyIndex",_s,{unique:!1})}(e)}))),o}},{key:"Ks",value:function(e){var t=0;return e.store("remoteDocuments").Z((function(e,n){t+=Pc(n)})).next((function(){var n={byteSize:t};return e.store("remoteDocumentGlobal").put("remoteDocumentGlobalKey",n)}))}},{key:"Us",value:function(e){var t=this,n=e.store("mutationQueues"),r=e.store("mutations");return n.W().next((function(n){return ki.forEach(n,(function(n){var i=IDBKeyRange.bound([n.userId,-1],[n.userId,n.lastAcknowledgedBatchId]);return r.W("userMutationsIndex",i).next((function(r){return ki.forEach(r,(function(r){Pr(r.userId===n.userId);var i=Ks(t.yt,r);return Oc(e,n.userId,i).next((function(){}))}))}))}))}))}},{key:"Gs",value:function(e){var t=e.store("targetDocuments"),n=e.store("remoteDocuments");return e.store("targetGlobal").get("targetGlobalKey").next((function(e){var r=[];return n.Z((function(n,i){var a=new ni(n),o=function(e){return[0,us(e)]}(a);r.push(t.get(o).next((function(n){return n?ki.resolve():function(n){return t.put({targetId:0,path:us(n),sequenceNumber:e.highestListenSequenceNumber})}(a)})))})).next((function(){return ki.waitFor(r)}))}))}},{key:"Qs",value:function(e,t){e.createObjectStore("collectionParents",{keyPath:bs});var n=t.store("collectionParents"),r=new xc,i=function(e){if(r.add(e)){var t=e.lastSegment(),i=e.popLast();return n.put({collectionId:t,parent:us(i)})}};return t.store("remoteDocuments").Z({X:!0},(function(e,t){var n=new ni(e);return i(n.popLast())})).next((function(){return t.store("documentMutations").Z({X:!0},(function(e,t){var n=(0,d.Z)(e,3),r=(n[0],n[1]),a=(n[2],ls(r));return i(a.popLast())}))}))}},{key:"js",value:function(e){var t=this,n=e.store("targets");return n.Z((function(e,r){var i=zs(r),a=Ws(t.yt,i);return n.put(a)}))}},{key:"Ws",value:function(e,t){var n=t.store("remoteDocuments"),r=[];return n.Z((function(e,n){var i,a=t.store("remoteDocumentsV14"),o=(i=n,i.document?new ai(ni.fromString(i.document.name).popFirst(5)):i.noDocument?ai.fromSegments(i.noDocument.path):i.unknownDocument?ai.fromSegments(i.unknownDocument.path):Or()).path.toArray(),u={prefixPath:o.slice(0,o.length-2),collectionGroup:o[o.length-2],documentId:o[o.length-1],readTime:n.readTime||[0,0],unknownDocument:n.unknownDocument,noDocument:n.noDocument,document:n.document,hasCommittedMutations:!!n.hasCommittedMutations};r.push(a.put(u))})).next((function(){return ki.waitFor(r)}))}},{key:"zs",value:function(e,t){var n=this,r=t.store("mutations"),i=el(this.yt),a=new ml(kl.Bs,this.yt.ie);return r.W().next((function(e){var r=new Map;return e.forEach((function(e){var t,i=null!==(t=r.get(e.userId))&&void 0!==t?t:yu();Ks(n.yt,e).keys().forEach((function(e){return i=i.add(e)})),r.set(e.userId,i)})),ki.forEach(r,(function(e,r){var o=new Tr(r),u=tc.re(n.yt,o),s=a.getIndexManager(o),c=Lc.re(o,n.yt,s,a.referenceDelegate);return new sl(i,c,u,s).recalculateAndSaveOverlaysForDocumentKeys(new Os(t,Ni.at),e).next()}))}))}}]),e}();function bl(e){e.createObjectStore("targetDocuments",{keyPath:ks}).createIndex("documentTargetsIndex",ws,{unique:!0}),e.createObjectStore("targets",{keyPath:"targetId"}).createIndex("queryTargetsIndex",gs,{unique:!0}),e.createObjectStore("targetGlobal")}var Zl="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",Il=function(){function e(t,n,r,i,a,o,u,c,l,h){var f=arguments.length>10&&void 0!==arguments[10]?arguments[10]:15;if((0,s.Z)(this,e),this.allowTabSynchronization=t,this.persistenceKey=n,this.clientId=r,this.Hs=a,this.window=o,this.document=u,this.Js=l,this.Ys=h,this.Xs=f,this.Ss=null,this.Ds=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Zs=null,this.inForeground=!1,this.ti=null,this.ei=null,this.ni=Number.NEGATIVE_INFINITY,this.si=function(e){return Promise.resolve()},!e.C())throw new Fr(Mr.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new Yc(this,i),this.ii=n+"main",this.yt=new Us(c),this.ri=new bi(this.ii,this.Xs,new wl(this.yt)),this.Cs=new Bc(this.referenceDelegate,this.yt),this.remoteDocumentCache=el(this.yt),this.Ns=new Xs,this.window&&this.window.localStorage?this.oi=this.window.localStorage:(this.oi=null,!1===h&&Nr("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}return(0,c.Z)(e,[{key:"start",value:function(){var e=this;return this.ui().then((function(){if(!e.isPrimary&&!e.allowTabSynchronization)throw new Fr(Mr.FAILED_PRECONDITION,Zl);return e.ci(),e.ai(),e.hi(),e.runTransaction("getHighestListenSequenceNumber","readonly",(function(t){return e.Cs.getHighestSequenceNumber(t)}))})).then((function(t){e.Ss=new Ni(t,e.Js)})).then((function(){e.Ds=!0})).catch((function(t){return e.ri&&e.ri.close(),Promise.reject(t)}))}},{key:"li",value:function(e){var t=this;return this.si=function(){var n=(0,p.Z)((0,v.Z)().mark((function n(r){return(0,v.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!t.started){n.next=2;break}return n.abrupt("return",e(r));case 2:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}(),e(this.isPrimary)}},{key:"setDatabaseDeletedListener",value:function(e){this.ri.L(function(){var t=(0,p.Z)((0,v.Z)().mark((function t(n){return(0,v.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.t0=null===n.newVersion,!t.t0){t.next=4;break}return t.next=4,e();case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())}},{key:"setNetworkEnabled",value:function(e){var t=this;this.networkEnabled!==e&&(this.networkEnabled=e,this.Hs.enqueueAndForget((0,p.Z)((0,v.Z)().mark((function e(){return(0,v.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=t.started,!e.t0){e.next=4;break}return e.next=4,t.ui();case 4:case"end":return e.stop()}}),e)})))))}},{key:"ui",value:function(){var e=this;return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",(function(t){return _l(t).put({clientId:e.clientId,updateTimeMs:Date.now(),networkEnabled:e.networkEnabled,inForeground:e.inForeground}).next((function(){if(e.isPrimary)return e.fi(t).next((function(t){t||(e.isPrimary=!1,e.Hs.enqueueRetryable((function(){return e.si(!1)})))}))})).next((function(){return e.di(t)})).next((function(n){return e.isPrimary&&!n?e._i(t).next((function(){return!1})):!!n&&e.wi(t).next((function(){return!0}))}))})).catch((function(t){if(xi(t))return Cr("IndexedDbPersistence","Failed to extend owner lease: ",t),e.isPrimary;if(!e.allowTabSynchronization)throw t;return Cr("IndexedDbPersistence","Releasing owner lease after error during lease refresh",t),!1})).then((function(t){e.isPrimary!==t&&e.Hs.enqueueRetryable((function(){return e.si(t)})),e.isPrimary=t}))}},{key:"fi",value:function(e){var t=this;return xl(e).get("owner").next((function(e){return ki.resolve(t.mi(e))}))}},{key:"gi",value:function(e){return _l(e).delete(this.clientId)}},{key:"yi",value:function(){var e=(0,p.Z)((0,v.Z)().mark((function e(){var t,n,r,i,a=this;return(0,v.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.isPrimary||this.pi(this.ni,18e5)){e.next=6;break}return this.ni=Date.now(),e.next=4,this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",(function(e){var t=Ps(e,"clientMetadata");return t.W().next((function(e){var n=a.Ii(e,18e5),r=e.filter((function(e){return-1===n.indexOf(e)}));return ki.forEach(r,(function(e){return t.delete(e.clientId)})).next((function(){return r}))}))})).catch((function(){return[]}));case 4:if(t=e.sent,this.oi){n=(0,u.Z)(t);try{for(n.s();!(r=n.n()).done;)i=r.value,this.oi.removeItem(this.Ti(i.clientId))}catch(o){n.e(o)}finally{n.f()}}case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"hi",value:function(){var e=this;this.ei=this.Hs.enqueueAfterDelay("client_metadata_refresh",4e3,(function(){return e.ui().then((function(){return e.yi()})).then((function(){return e.hi()}))}))}},{key:"mi",value:function(e){return!!e&&e.ownerId===this.clientId}},{key:"di",value:function(e){var t=this;return this.Ys?ki.resolve(!0):xl(e).get("owner").next((function(n){if(null!==n&&t.pi(n.leaseTimestampMs,5e3)&&!t.Ei(n.ownerId)){if(t.mi(n)&&t.networkEnabled)return!0;if(!t.mi(n)){if(!n.allowTabSynchronization)throw new Fr(Mr.FAILED_PRECONDITION,Zl);return!1}}return!(!t.networkEnabled||!t.inForeground)||_l(e).W().next((function(e){return void 0===t.Ii(e,5e3).find((function(e){if(t.clientId!==e.clientId){var n=!t.networkEnabled&&e.networkEnabled,r=!t.inForeground&&e.inForeground,i=t.networkEnabled===e.networkEnabled;if(n||r&&i)return!0}return!1}))}))})).next((function(e){return t.isPrimary!==e&&Cr("IndexedDbPersistence","Client ".concat(e?"is":"is not"," eligible for a primary lease.")),e}))}},{key:"shutdown",value:function(){var e=(0,p.Z)((0,v.Z)().mark((function e(){var t=this;return(0,v.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.Ds=!1,this.Ai(),this.ei&&(this.ei.cancel(),this.ei=null),this.Ri(),this.bi(),e.next=7,this.ri.runTransaction("shutdown","readwrite",["owner","clientMetadata"],(function(e){var n=new Os(e,Ni.at);return t._i(n).next((function(){return t.gi(n)}))}));case 7:this.ri.close(),this.Pi();case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"Ii",value:function(e,t){var n=this;return e.filter((function(e){return n.pi(e.updateTimeMs,t)&&!n.Ei(e.clientId)}))}},{key:"vi",value:function(){var e=this;return this.runTransaction("getActiveClients","readonly",(function(t){return _l(t).W().next((function(t){return e.Ii(t,18e5).map((function(e){return e.clientId}))}))}))}},{key:"started",get:function(){return this.Ds}},{key:"getMutationQueue",value:function(e,t){return Lc.re(e,this.yt,t,this.referenceDelegate)}},{key:"getTargetCache",value:function(){return this.Cs}},{key:"getRemoteDocumentCache",value:function(){return this.remoteDocumentCache}},{key:"getIndexManager",value:function(e){return new Tc(e,this.yt.ie.databaseId)}},{key:"getDocumentOverlayCache",value:function(e){return tc.re(this.yt,e)}},{key:"getBundleCache",value:function(){return this.Ns}},{key:"runTransaction",value:function(e,t,n){var r=this;Cr("IndexedDbPersistence","Starting transaction:",e);var i,a,o="readonly"===t?"readonly":"readwrite",u=15===(i=this.Xs)?Rs:14===i?Ds:13===i?Ns:12===i?Cs:11===i?As:void Or();return this.ri.runTransaction(e,o,u,(function(i){return a=new Os(i,r.Ss?r.Ss.next():Ni.at),"readwrite-primary"===t?r.fi(a).next((function(e){return!!e||r.di(a)})).next((function(t){if(!t)throw Nr("Failed to obtain primary lease for action '".concat(e,"'.")),r.isPrimary=!1,r.Hs.enqueueRetryable((function(){return r.si(!1)})),new Fr(Mr.FAILED_PRECONDITION,pi);return n(a)})).next((function(e){return r.wi(a).next((function(){return e}))})):r.Vi(a).next((function(){return n(a)}))})).then((function(e){return a.raiseOnCommittedEvent(),e}))}},{key:"Vi",value:function(e){var t=this;return xl(e).get("owner").next((function(e){if(null!==e&&t.pi(e.leaseTimestampMs,5e3)&&!t.Ei(e.ownerId)&&!t.mi(e)&&!(t.Ys||t.allowTabSynchronization&&e.allowTabSynchronization))throw new Fr(Mr.FAILED_PRECONDITION,Zl)}))}},{key:"wi",value:function(e){var t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return xl(e).put("owner",t)}},{key:"_i",value:function(e){var t=this,n=xl(e);return n.get("owner").next((function(e){return t.mi(e)?(Cr("IndexedDbPersistence","Releasing primary lease."),n.delete("owner")):ki.resolve()}))}},{key:"pi",value:function(e,t){var n=Date.now();return!(e<n-t)&&(!(e>n)||(Nr("Detected an update time that is in the future: ".concat(e," > ").concat(n)),!1))}},{key:"ci",value:function(){var e=this;null!==this.document&&"function"==typeof this.document.addEventListener&&(this.ti=function(){e.Hs.enqueueAndForget((function(){return e.inForeground="visible"===e.document.visibilityState,e.ui()}))},this.document.addEventListener("visibilitychange",this.ti),this.inForeground="visible"===this.document.visibilityState)}},{key:"Ri",value:function(){this.ti&&(this.document.removeEventListener("visibilitychange",this.ti),this.ti=null)}},{key:"ai",value:function(){var e,t=this;"function"==typeof(null===(e=this.window)||void 0===e?void 0:e.addEventListener)&&(this.Zs=function(){t.Ai(),(0,w.G6)()&&navigator.appVersion.match(/Version\/1[45]/)&&t.Hs.enterRestrictedMode(!0),t.Hs.enqueueAndForget((function(){return t.shutdown()}))},this.window.addEventListener("pagehide",this.Zs))}},{key:"bi",value:function(){this.Zs&&(this.window.removeEventListener("pagehide",this.Zs),this.Zs=null)}},{key:"Ei",value:function(e){var t;try{var n=null!==(null===(t=this.oi)||void 0===t?void 0:t.getItem(this.Ti(e)));return Cr("IndexedDbPersistence","Client '".concat(e,"' ").concat(n?"is":"is not"," zombied in LocalStorage")),n}catch(e){return Nr("IndexedDbPersistence","Failed to get zombied client id.",e),!1}}},{key:"Ai",value:function(){if(this.oi)try{this.oi.setItem(this.Ti(this.clientId),String(Date.now()))}catch(O){Nr("Failed to set zombie client id.",O)}}},{key:"Pi",value:function(){if(this.oi)try{this.oi.removeItem(this.Ti(this.clientId))}catch(O){}}},{key:"Ti",value:function(e){return"firestore_zombie_".concat(this.persistenceKey,"_").concat(e)}}],[{key:"C",value:function(){return bi.C()}}]),e}();function xl(e){return Ps(e,"owner")}function _l(e){return Ps(e,"clientMetadata")}function Tl(e,t){var n=e.projectId;return e.isDefaultDatabase||(n+="."+e.database),"firestore/"+t+"/"+n+"/"}var El=function(){function e(t,n,r,i){(0,s.Z)(this,e),this.targetId=t,this.fromCache=n,this.Si=r,this.Di=i}return(0,c.Z)(e,null,[{key:"Ci",value:function(t,n){var r,i=yu(),a=yu(),o=(0,u.Z)(n.docChanges);try{for(o.s();!(r=o.n()).done;){var s=r.value;switch(s.type){case 0:i=i.add(s.doc.key);break;case 1:a=a.add(s.doc.key)}}}catch(c){o.e(c)}finally{o.f()}return new e(t,n.fromCache,i,a)}}]),e}(),Sl=function(){function e(){(0,s.Z)(this,e),this.xi=!1}return(0,c.Z)(e,[{key:"initialize",value:function(e,t){this.Ni=e,this.indexManager=t,this.xi=!0}},{key:"getDocumentsMatchingQuery",value:function(e,t,n,r){var i=this;return this.ki(e,t).next((function(a){return a||i.Oi(e,t,r,n)})).next((function(n){return n||i.Mi(e,t)}))}},{key:"ki",value:function(e,t){var n=this;if(oo(t))return ki.resolve(null);var r=ho(t);return this.indexManager.getIndexType(e,r).next((function(i){return 0===i?null:(null!==t.limit&&1===i&&(t=vo(t,null,"F"),r=ho(t)),n.indexManager.getDocumentsMatchingTarget(e,r).next((function(i){var a=yu.apply(void 0,(0,y.Z)(i));return n.Ni.getDocuments(e,a).next((function(i){return n.indexManager.getMinOffset(e,r).next((function(r){var o=n.Fi(t,i);return n.$i(t,o,a,r.readTime)?n.ki(e,vo(t,null,"F")):n.Bi(e,o,t,r)}))}))})))}))}},{key:"Oi",value:function(e,t,n,r){var i=this;return oo(t)||r.isEqual(ei.min())?this.Mi(e,t):this.Ni.getDocuments(e,n).next((function(a){var o=i.Fi(t,a);return i.$i(t,o,n,r)?i.Mi(e,t):(Ar()<=k.in.DEBUG&&Cr("QueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),mo(t)),i.Bi(e,o,t,hi(r,-1)))}))}},{key:"Fi",value:function(e,t){var n=new Ba(wo(e));return t.forEach((function(t,r){go(e,r)&&(n=n.add(r))})),n}},{key:"$i",value:function(e,t,n,r){if(null===e.limit)return!1;if(n.size!==t.size)return!0;var i="F"===e.limitType?t.last():t.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(r)>0)}},{key:"Mi",value:function(e,t){return Ar()<=k.in.DEBUG&&Cr("QueryEngine","Using full collection scan to execute query:",mo(t)),this.Ni.getDocumentsMatchingQuery(e,t,di.min())}},{key:"Bi",value:function(e,t,n,r){return this.Ni.getDocumentsMatchingQuery(e,n,r).next((function(e){return t.forEach((function(t){e=e.insert(t.key,t)})),e}))}}]),e}(),Al=function(){function e(t,n,r,i){(0,s.Z)(this,e),this.persistence=t,this.Li=n,this.yt=i,this.qi=new Va(Yr),this.Ui=new au((function(e){return Ja(e)}),Xa),this.Ki=new Map,this.Gi=t.getRemoteDocumentCache(),this.Cs=t.getTargetCache(),this.Ns=t.getBundleCache(),this.Qi(r)}return(0,c.Z)(e,[{key:"Qi",value:function(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new sl(this.Gi,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Gi.setIndexManager(this.indexManager),this.Li.initialize(this.localDocuments,this.indexManager)}},{key:"collectGarbage",value:function(e){var t=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",(function(n){return e.collect(n,t.qi)}))}}]),e}();function Cl(e,t,n,r){return new Al(e,t,n,r)}function Nl(e,t){return Dl.apply(this,arguments)}function Dl(){return Dl=(0,p.Z)((0,v.Z)().mark((function e(t,n){var r;return(0,v.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=Lr(t),e.next=3,r.persistence.runTransaction("Handle user change","readonly",(function(e){var t;return r.mutationQueue.getAllMutationBatches(e).next((function(i){return t=i,r.Qi(n),r.mutationQueue.getAllMutationBatches(e)})).next((function(n){var i,a=[],o=[],s=yu(),c=(0,u.Z)(t);try{for(c.s();!(i=c.n()).done;){var l=i.value;a.push(l.batchId);var h,f=(0,u.Z)(l.mutations);try{for(f.s();!(h=f.n()).done;){var d=h.value;s=s.add(d.key)}}catch(w){f.e(w)}finally{f.f()}}}catch(w){c.e(w)}finally{c.f()}var v,p=(0,u.Z)(n);try{for(p.s();!(v=p.n()).done;){var y=v.value;o.push(y.batchId);var m,g=(0,u.Z)(y.mutations);try{for(g.s();!(m=g.n()).done;){var k=m.value;s=s.add(k.key)}}catch(w){g.e(w)}finally{g.f()}}}catch(w){p.e(w)}finally{p.f()}return r.localDocuments.getDocuments(e,s).next((function(e){return{ji:e,removedBatchIds:a,addedBatchIds:o}}))}))}));case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)}))),Dl.apply(this,arguments)}function Rl(e,t){var n=Lr(e);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",(function(e){var r=t.batch.keys(),i=n.Gi.newChangeBuffer({trackRemovals:!0});return function(e,t,n,r){var i=n.batch,a=i.keys(),o=ki.resolve();return a.forEach((function(e){o=o.next((function(){return r.getEntry(t,e)})).next((function(t){var a=n.docVersions.get(e);Pr(null!==a),t.version.compareTo(a)<0&&(i.applyToRemoteDocument(t,n),t.isValidDocument()&&(t.setReadTime(n.commitVersion),r.addEntry(t)))}))})),o.next((function(){return e.mutationQueue.removeMutationBatch(t,i)}))}(n,e,t,i).next((function(){return i.apply(e)})).next((function(){return n.mutationQueue.performConsistencyCheck(e)})).next((function(){return n.documentOverlayCache.removeOverlaysForBatchId(e,r,t.batch.batchId)})).next((function(){return n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,function(e){for(var t=yu(),n=0;n<e.mutationResults.length;++n)e.mutationResults[n].transformResults.length>0&&(t=t.add(e.batch.mutations[n].key));return t}(t))})).next((function(){return n.localDocuments.getDocuments(e,r)}))}))}function Ol(e){var t=Lr(e);return t.persistence.runTransaction("Get last remote snapshot version","readonly",(function(e){return t.Cs.getLastRemoteSnapshotVersion(e)}))}function Pl(e,t){var n=Lr(e),r=t.snapshotVersion,i=n.qi;return n.persistence.runTransaction("Apply remote event","readwrite-primary",(function(e){var a=n.Gi.newChangeBuffer({trackRemovals:!0});i=n.qi;var o=[];t.targetChanges.forEach((function(a,u){var s=i.get(u);if(s){o.push(n.Cs.removeMatchingKeys(e,a.removedDocuments,u).next((function(){return n.Cs.addMatchingKeys(e,a.addedDocuments,u)})));var c=s.withSequenceNumber(e.currentSequenceNumber);t.targetMismatches.has(u)?c=c.withResumeToken(Ui.EMPTY_BYTE_STRING,ei.min()).withLastLimboFreeSnapshotVersion(ei.min()):a.resumeToken.approximateByteSize()>0&&(c=c.withResumeToken(a.resumeToken,r)),i=i.insert(u,c),function(e,t,n){return 0===e.resumeToken.approximateByteSize()||(t.snapshotVersion.toMicroseconds()-e.snapshotVersion.toMicroseconds()>=3e8||n.addedDocuments.size+n.modifiedDocuments.size+n.removedDocuments.size>0)}(s,c,a)&&o.push(n.Cs.updateTargetData(e,c))}}));var u=uu(),s=yu();if(t.documentUpdates.forEach((function(r){t.resolvedLimboDocuments.has(r)&&o.push(n.persistence.referenceDelegate.updateLimboDocument(e,r))})),o.push(Ll(e,a,t.documentUpdates).next((function(e){u=e.Wi,s=e.zi}))),!r.isEqual(ei.min())){var c=n.Cs.getLastRemoteSnapshotVersion(e).next((function(t){return n.Cs.setTargetsMetadata(e,e.currentSequenceNumber,r)}));o.push(c)}return ki.waitFor(o).next((function(){return a.apply(e)})).next((function(){return n.localDocuments.getLocalViewOfDocuments(e,u,s)})).next((function(){return u}))})).then((function(e){return n.qi=i,e}))}function Ll(e,t,n){var r=yu(),i=yu();return n.forEach((function(e){return r=r.add(e)})),t.getEntries(e,r).next((function(e){var r=uu();return n.forEach((function(n,a){var o=e.get(n);a.isFoundDocument()!==o.isFoundDocument()&&(i=i.add(n)),a.isNoDocument()&&a.version.isEqual(ei.min())?(t.removeEntry(n,a.readTime),r=r.insert(n,a)):!o.isValidDocument()||a.version.compareTo(o.version)>0||0===a.version.compareTo(o.version)&&o.hasPendingWrites?(t.addEntry(a),r=r.insert(n,a)):Cr("LocalStore","Ignoring outdated watch update for ",n,". Current version:",o.version," Watch version:",a.version)})),{Wi:r,zi:i}}))}function Ml(e,t){var n=Lr(e);return n.persistence.runTransaction("Get next mutation batch","readonly",(function(e){return void 0===t&&(t=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(e,t)}))}function Fl(e,t){var n=Lr(e);return n.persistence.runTransaction("Allocate target","readwrite",(function(e){var r;return n.Cs.getTargetData(e,t).next((function(i){return i?(r=i,ki.resolve(r)):n.Cs.allocateTargetId(e).next((function(i){return r=new Vs(t,i,0,e.currentSequenceNumber),n.Cs.addTargetData(e,r).next((function(){return r}))}))}))})).then((function(e){var r=n.qi.get(e.targetId);return(null===r||e.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(n.qi=n.qi.insert(e.targetId,e),n.Ui.set(t,e.targetId)),e}))}function Vl(e,t,n){return Ul.apply(this,arguments)}function Ul(){return Ul=(0,p.Z)((0,v.Z)().mark((function e(t,n,r){var i,a,o;return(0,v.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=Lr(t),a=i.qi.get(n),o=r?"readwrite":"readwrite-primary",e.prev=1,e.t0=r,e.t0){e.next=6;break}return e.next=6,i.persistence.runTransaction("Release target",o,(function(e){return i.persistence.referenceDelegate.removeTarget(e,a)}));case 6:e.next=13;break;case 8:if(e.prev=8,e.t1=e.catch(1),xi(e.t1)){e.next=12;break}throw e.t1;case 12:Cr("LocalStore","Failed to update sequence numbers for target ".concat(n,": ").concat(e.t1));case 13:i.qi=i.qi.remove(n),i.Ui.delete(a.target);case 14:case"end":return e.stop()}}),e,null,[[1,8]])}))),Ul.apply(this,arguments)}function ql(e,t,n){var r=Lr(e),i=ei.min(),a=yu();return r.persistence.runTransaction("Execute query","readonly",(function(e){return function(e,t,n){var r=Lr(e),i=r.Ui.get(n);return void 0!==i?ki.resolve(r.qi.get(i)):r.Cs.getTargetData(t,n)}(r,e,ho(t)).next((function(t){if(t)return i=t.lastLimboFreeSnapshotVersion,r.Cs.getMatchingKeysForTargetId(e,t.targetId).next((function(e){a=e}))})).next((function(){return r.Li.getDocumentsMatchingQuery(e,t,n?i:ei.min(),n?a:yu())})).next((function(e){return Gl(r,ko(t),e),{documents:e,Hi:a}}))}))}function Bl(e,t){var n=Lr(e),r=Lr(n.Cs),i=n.qi.get(t);return i?Promise.resolve(i.target):n.persistence.runTransaction("Get target data","readonly",(function(e){return r.ne(e,t).next((function(e){return e?e.target:null}))}))}function jl(e,t){var n=Lr(e),r=n.Ki.get(t)||ei.min();return n.persistence.runTransaction("Get new document changes","readonly",(function(e){return n.Gi.getAllFromCollectionGroup(e,t,hi(r,-1),Number.MAX_SAFE_INTEGER)})).then((function(e){return Gl(n,t,e),e}))}function Gl(e,t,n){var r=e.Ki.get(t)||ei.min();n.forEach((function(e,t){t.readTime.compareTo(r)>0&&(r=t.readTime)})),e.Ki.set(t,r)}function Kl(e,t,n,r){return zl.apply(this,arguments)}function zl(){return zl=(0,p.Z)((0,v.Z)().mark((function e(t,n,r,i){var a,o,s,c,l,h,f,d,p,y;return(0,v.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=Lr(t),o=yu(),s=uu(),c=(0,u.Z)(r);try{for(c.s();!(l=c.n()).done;)h=l.value,f=n.Ji(h.metadata.name),h.document&&(o=o.add(f)),(d=n.Yi(h)).setReadTime(n.Xi(h.metadata.readTime)),s=s.insert(f,d)}catch(v){c.e(v)}finally{c.f()}return p=a.Gi.newChangeBuffer({trackRemovals:!0}),e.next=7,Fl(a,function(e){return ho(ao(ni.fromString("__bundle__/docs/".concat(e))))}(i));case 7:return y=e.sent,e.abrupt("return",a.persistence.runTransaction("Apply bundle documents","readwrite",(function(e){return Ll(e,p,s).next((function(t){return p.apply(e),t})).next((function(t){return a.Cs.removeMatchingKeysForTargetId(e,y.targetId).next((function(){return a.Cs.addMatchingKeys(e,o,y.targetId)})).next((function(){return a.localDocuments.getLocalViewOfDocuments(e,t.Wi,t.zi)})).next((function(){return t.Wi}))}))})));case 9:case"end":return e.stop()}}),e)}))),zl.apply(this,arguments)}function Wl(e,t){return Hl.apply(this,arguments)}function Hl(){return Hl=(0,p.Z)((0,v.Z)().mark((function e(t,n){var r,i,a,o=arguments;return(0,v.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=o.length>2&&void 0!==o[2]?o[2]:yu(),e.next=3,Fl(t,ho(Hs(n.bundledQuery)));case 3:return i=e.sent,a=Lr(t),e.abrupt("return",a.persistence.runTransaction("Save named query","readwrite",(function(e){var t=Pu(n.readTime);if(i.snapshotVersion.compareTo(t)>=0)return a.Ns.saveNamedQuery(e,n);var o=i.withResumeToken(Ui.EMPTY_BYTE_STRING,t);return a.qi=a.qi.insert(o.targetId,o),a.Cs.updateTargetData(e,o).next((function(){return a.Cs.removeMatchingKeysForTargetId(e,i.targetId)})).next((function(){return a.Cs.addMatchingKeys(e,r,i.targetId)})).next((function(){return a.Ns.saveNamedQuery(e,n)}))})));case 6:case"end":return e.stop()}}),e)}))),Hl.apply(this,arguments)}function Ql(e,t){return"firestore_clients_".concat(e,"_").concat(t)}function Yl(e,t,n){var r="firestore_mutations_".concat(e,"_").concat(n);return t.isAuthenticated()&&(r+="_".concat(t.uid)),r}function Jl(e,t){return"firestore_targets_".concat(e,"_").concat(t)}var Xl=function(){function e(t,n,r,i){(0,s.Z)(this,e),this.user=t,this.batchId=n,this.state=r,this.error=i}return(0,c.Z)(e,[{key:"tr",value:function(){var e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}],[{key:"Zi",value:function(t,n,r){var i,a=JSON.parse(r),o="object"==typeof a&&-1!==["pending","acknowledged","rejected"].indexOf(a.state)&&(void 0===a.error||"object"==typeof a.error);return o&&a.error&&((o="string"==typeof a.error.message&&"string"==typeof a.error.code)&&(i=new Fr(a.error.code,a.error.message))),o?new e(t,n,a.state,i):(Nr("SharedClientState","Failed to parse mutation state for ID '".concat(n,"': ").concat(r)),null)}}]),e}(),$l=function(){function e(t,n,r){(0,s.Z)(this,e),this.targetId=t,this.state=n,this.error=r}return(0,c.Z)(e,[{key:"tr",value:function(){var e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}],[{key:"Zi",value:function(t,n){var r,i=JSON.parse(n),a="object"==typeof i&&-1!==["not-current","current","rejected"].indexOf(i.state)&&(void 0===i.error||"object"==typeof i.error);return a&&i.error&&((a="string"==typeof i.error.message&&"string"==typeof i.error.code)&&(r=new Fr(i.error.code,i.error.message))),a?new e(t,i.state,r):(Nr("SharedClientState","Failed to parse target state for ID '".concat(t,"': ").concat(n)),null)}}]),e}(),eh=function(){function e(t,n){(0,s.Z)(this,e),this.clientId=t,this.activeTargetIds=n}return(0,c.Z)(e,null,[{key:"Zi",value:function(t,n){for(var r=JSON.parse(n),i="object"==typeof r&&r.activeTargetIds instanceof Array,a=gu(),o=0;i&&o<r.activeTargetIds.length;++o)i=Vi(r.activeTargetIds[o]),a=a.add(r.activeTargetIds[o]);return i?new e(t,a):(Nr("SharedClientState","Failed to parse client data for instance '".concat(t,"': ").concat(n)),null)}}]),e}(),th=function(){function e(t,n){(0,s.Z)(this,e),this.clientId=t,this.onlineState=n}return(0,c.Z)(e,null,[{key:"Zi",value:function(t){var n=JSON.parse(t);return"object"==typeof n&&-1!==["Unknown","Online","Offline"].indexOf(n.onlineState)&&"string"==typeof n.clientId?new e(n.clientId,n.onlineState):(Nr("SharedClientState","Failed to parse online state: ".concat(t)),null)}}]),e}(),nh=function(){function e(){(0,s.Z)(this,e),this.activeTargetIds=gu()}return(0,c.Z)(e,[{key:"er",value:function(e){this.activeTargetIds=this.activeTargetIds.add(e)}},{key:"nr",value:function(e){this.activeTargetIds=this.activeTargetIds.delete(e)}},{key:"tr",value:function(){var e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}]),e}(),rh=function(){function e(t,n,r,i,a){(0,s.Z)(this,e),this.window=t,this.Hs=n,this.persistenceKey=r,this.sr=i,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.ir=this.rr.bind(this),this.ur=new Va(Yr),this.started=!1,this.cr=[];var o=r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=a,this.ar=Ql(this.persistenceKey,this.sr),this.hr=function(e){return"firestore_sequence_number_".concat(e)}(this.persistenceKey),this.ur=this.ur.insert(this.sr,new nh),this.lr=new RegExp("^firestore_clients_".concat(o,"_([^_]*)$")),this.dr=new RegExp("^firestore_mutations_".concat(o,"_(\\d+)(?:_(.*))?$")),this._r=new RegExp("^firestore_targets_".concat(o,"_(\\d+)$")),this.wr=function(e){return"firestore_online_state_".concat(e)}(this.persistenceKey),this.mr=function(e){return"firestore_bundle_loaded_v2_".concat(e)}(this.persistenceKey),this.window.addEventListener("storage",this.ir)}return(0,c.Z)(e,[{key:"start",value:function(){var e=(0,p.Z)((0,v.Z)().mark((function e(){var t,n,r,i,a,o,s,c,l,h,f,d=this;return(0,v.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.syncEngine.vi();case 2:t=e.sent,n=(0,u.Z)(t),e.prev=4,n.s();case 6:if((r=n.n()).done){e.next=14;break}if((i=r.value)!==this.sr){e.next=10;break}return e.abrupt("continue",12);case 10:(a=this.getItem(Ql(this.persistenceKey,i)))&&(o=eh.Zi(i,a))&&(this.ur=this.ur.insert(o.clientId,o));case 12:e.next=6;break;case 14:e.next=19;break;case 16:e.prev=16,e.t0=e.catch(4),n.e(e.t0);case 19:return e.prev=19,n.f(),e.finish(19);case 22:this.gr(),(s=this.storage.getItem(this.wr))&&(c=this.yr(s))&&this.pr(c),l=(0,u.Z)(this.cr);try{for(l.s();!(h=l.n()).done;)f=h.value,this.rr(f)}catch(v){l.e(v)}finally{l.f()}this.cr=[],this.window.addEventListener("pagehide",(function(){return d.shutdown()})),this.started=!0;case 28:case"end":return e.stop()}}),e,this,[[4,16,19,22]])})));return function(){return e.apply(this,arguments)}}()},{key:"writeSequenceNumber",value:function(e){this.setItem(this.hr,JSON.stringify(e))}},{key:"getAllActiveQueryTargets",value:function(){return this.Ir(this.ur)}},{key:"isActiveQueryTarget",value:function(e){var t=!1;return this.ur.forEach((function(n,r){r.activeTargetIds.has(e)&&(t=!0)})),t}},{key:"addPendingMutation",value:function(e){this.Tr(e,"pending")}},{key:"updateMutationState",value:function(e,t,n){this.Tr(e,t,n),this.Er(e)}},{key:"addLocalQueryTarget",value:function(e){var t="not-current";if(this.isActiveQueryTarget(e)){var n=this.storage.getItem(Jl(this.persistenceKey,e));if(n){var r=$l.Zi(e,n);r&&(t=r.state)}}return this.Ar.er(e),this.gr(),t}},{key:"removeLocalQueryTarget",value:function(e){this.Ar.nr(e),this.gr()}},{key:"isLocalQueryTarget",value:function(e){return this.Ar.activeTargetIds.has(e)}},{key:"clearQueryState",value:function(e){this.removeItem(Jl(this.persistenceKey,e))}},{key:"updateQueryState",value:function(e,t,n){this.Rr(e,t,n)}},{key:"handleUserChange",value:function(e,t,n){var r=this;t.forEach((function(e){r.Er(e)})),this.currentUser=e,n.forEach((function(e){r.addPendingMutation(e)}))}},{key:"setOnlineState",value:function(e){this.br(e)}},{key:"notifyBundleLoaded",value:function(e){this.Pr(e)}},{key:"shutdown",value:function(){this.started&&(this.window.removeEventListener("storage",this.ir),this.removeItem(this.ar),this.started=!1)}},{key:"getItem",value:function(e){var t=this.storage.getItem(e);return Cr("SharedClientState","READ",e,t),t}},{key:"setItem",value:function(e,t){Cr("SharedClientState","SET",e,t),this.storage.setItem(e,t)}},{key:"removeItem",value:function(e){Cr("SharedClientState","REMOVE",e),this.storage.removeItem(e)}},{key:"rr",value:function(e){var t=this,n=e;if(n.storageArea===this.storage){if(Cr("SharedClientState","EVENT",n.key,n.newValue),n.key===this.ar)return void Nr("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.Hs.enqueueRetryable((0,p.Z)((0,v.Z)().mark((function e(){var r,i,a,o,u,s,c;return(0,v.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.started){e.next=43;break}if(null===n.key){e.next=41;break}if(!t.lr.test(n.key)){e.next=11;break}if(null!=n.newValue){e.next=6;break}return r=t.vr(n.key),e.abrupt("return",t.Vr(r,null));case 6:if(!(i=t.Sr(n.key,n.newValue))){e.next=9;break}return e.abrupt("return",t.Vr(i.clientId,i));case 9:e.next=41;break;case 11:if(!t.dr.test(n.key)){e.next=18;break}if(null===n.newValue){e.next=16;break}if(!(a=t.Dr(n.key,n.newValue))){e.next=16;break}return e.abrupt("return",t.Cr(a));case 16:e.next=41;break;case 18:if(!t._r.test(n.key)){e.next=25;break}if(null===n.newValue){e.next=23;break}if(!(o=t.Nr(n.key,n.newValue))){e.next=23;break}return e.abrupt("return",t.kr(o));case 23:e.next=41;break;case 25:if(n.key!==t.wr){e.next=32;break}if(null===n.newValue){e.next=30;break}if(!(u=t.yr(n.newValue))){e.next=30;break}return e.abrupt("return",t.pr(u));case 30:e.next=41;break;case 32:if(n.key!==t.hr){e.next=37;break}s=function(e){var t=Ni.at;if(null!=e)try{var n=JSON.parse(e);Pr("number"==typeof n),t=n}catch(e){Nr("SharedClientState","Failed to read sequence number from WebStorage",e)}return t}(n.newValue),s!==Ni.at&&t.sequenceNumberHandler(s),e.next=41;break;case 37:if(n.key!==t.mr){e.next=41;break}return c=t.Or(n.newValue),e.next=41,Promise.all(c.map((function(e){return t.syncEngine.Mr(e)})));case 41:e.next=44;break;case 43:t.cr.push(n);case 44:case"end":return e.stop()}}),e)}))))}}},{key:"Ar",get:function(){return this.ur.get(this.sr)}},{key:"gr",value:function(){this.setItem(this.ar,this.Ar.tr())}},{key:"Tr",value:function(e,t,n){var r=new Xl(this.currentUser,e,t,n),i=Yl(this.persistenceKey,this.currentUser,e);this.setItem(i,r.tr())}},{key:"Er",value:function(e){var t=Yl(this.persistenceKey,this.currentUser,e);this.removeItem(t)}},{key:"br",value:function(e){var t={clientId:this.sr,onlineState:e};this.storage.setItem(this.wr,JSON.stringify(t))}},{key:"Rr",value:function(e,t,n){var r=Jl(this.persistenceKey,e),i=new $l(e,t,n);this.setItem(r,i.tr())}},{key:"Pr",value:function(e){var t=JSON.stringify(Array.from(e));this.setItem(this.mr,t)}},{key:"vr",value:function(e){var t=this.lr.exec(e);return t?t[1]:null}},{key:"Sr",value:function(e,t){var n=this.vr(e);return eh.Zi(n,t)}},{key:"Dr",value:function(e,t){var n=this.dr.exec(e),r=Number(n[1]),i=void 0!==n[2]?n[2]:null;return Xl.Zi(new Tr(i),r,t)}},{key:"Nr",value:function(e,t){var n=this._r.exec(e),r=Number(n[1]);return $l.Zi(r,t)}},{key:"yr",value:function(e){return th.Zi(e)}},{key:"Or",value:function(e){return JSON.parse(e)}},{key:"Cr",value:function(){var e=(0,p.Z)((0,v.Z)().mark((function e(t){return(0,v.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.user.uid!==this.currentUser.uid){e.next=2;break}return e.abrupt("return",this.syncEngine.Fr(t.batchId,t.state,t.error));case 2:Cr("SharedClientState","Ignoring mutation for non-active user ".concat(t.user.uid));case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"kr",value:function(e){return this.syncEngine.$r(e.targetId,e.state,e.error)}},{key:"Vr",value:function(e,t){var n=this,r=t?this.ur.insert(e,t):this.ur.remove(e),i=this.Ir(this.ur),a=this.Ir(r),o=[],u=[];return a.forEach((function(e){i.has(e)||o.push(e)})),i.forEach((function(e){a.has(e)||u.push(e)})),this.syncEngine.Br(o,u).then((function(){n.ur=r}))}},{key:"pr",value:function(e){this.ur.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}},{key:"Ir",value:function(e){var t=gu();return e.forEach((function(e,n){t=t.unionWith(n.activeTargetIds)})),t}}],[{key:"C",value:function(e){return!(!e||!e.localStorage)}}]),e}(),ih=function(){function e(){(0,s.Z)(this,e),this.Lr=new nh,this.qr={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}return(0,c.Z)(e,[{key:"addPendingMutation",value:function(e){}},{key:"updateMutationState",value:function(e,t,n){}},{key:"addLocalQueryTarget",value:function(e){return this.Lr.er(e),this.qr[e]||"not-current"}},{key:"updateQueryState",value:function(e,t,n){this.qr[e]=t}},{key:"removeLocalQueryTarget",value:function(e){this.Lr.nr(e)}},{key:"isLocalQueryTarget",value:function(e){return this.Lr.activeTargetIds.has(e)}},{key:"clearQueryState",value:function(e){delete this.qr[e]}},{key:"getAllActiveQueryTargets",value:function(){return this.Lr.activeTargetIds}},{key:"isActiveQueryTarget",value:function(e){return this.Lr.activeTargetIds.has(e)}},{key:"start",value:function(){return this.Lr=new nh,Promise.resolve()}},{key:"handleUserChange",value:function(e,t,n){}},{key:"setOnlineState",value:function(e){}},{key:"shutdown",value:function(){}},{key:"writeSequenceNumber",value:function(e){}},{key:"notifyBundleLoaded",value:function(e){}}]),e}(),ah=function(){function e(){(0,s.Z)(this,e)}return(0,c.Z)(e,[{key:"Ur",value:function(e){}},{key:"shutdown",value:function(){}}]),e}(),oh=function(){function e(){var t=this;(0,s.Z)(this,e),this.Kr=function(){return t.Gr()},this.Qr=function(){return t.jr()},this.Wr=[],this.zr()}return(0,c.Z)(e,[{key:"Ur",value:function(e){this.Wr.push(e)}},{key:"shutdown",value:function(){window.removeEventListener("online",this.Kr),window.removeEventListener("offline",this.Qr)}},{key:"zr",value:function(){window.addEventListener("online",this.Kr),window.addEventListener("offline",this.Qr)}},{key:"Gr",value:function(){Cr("ConnectivityMonitor","Network connectivity changed: AVAILABLE");var e,t=(0,u.Z)(this.Wr);try{for(t.s();!(e=t.n()).done;){(0,e.value)(0)}}catch(n){t.e(n)}finally{t.f()}}},{key:"jr",value:function(){Cr("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");var e,t=(0,u.Z)(this.Wr);try{for(t.s();!(e=t.n()).done;){(0,e.value)(1)}}catch(n){t.e(n)}finally{t.f()}}}],[{key:"C",value:function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}]),e}(),uh={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"},sh=function(){function e(t){(0,s.Z)(this,e),this.Hr=t.Hr,this.Jr=t.Jr}return(0,c.Z)(e,[{key:"Yr",value:function(e){this.Xr=e}},{key:"Zr",value:function(e){this.eo=e}},{key:"onMessage",value:function(e){this.no=e}},{key:"close",value:function(){this.Jr()}},{key:"send",value:function(e){this.Hr(e)}},{key:"so",value:function(){this.Xr()}},{key:"io",value:function(e){this.eo(e)}},{key:"ro",value:function(e){this.no(e)}}]),e}(),ch=function(e){(0,a.Z)(n,e);var t=(0,o.Z)(n);function n(e){var r;return(0,s.Z)(this,n),(r=t.call(this,e)).forceLongPolling=e.forceLongPolling,r.autoDetectLongPolling=e.autoDetectLongPolling,r.useFetchStreams=e.useFetchStreams,r}return(0,c.Z)(n,[{key:"fo",value:function(e,t,n,r){return new Promise((function(i,a){var o=new xr;o.setWithCredentials(!0),o.listenOnce(kr.COMPLETE,(function(){try{switch(o.getLastErrorCode()){case gr.NO_ERROR:var t=o.getResponseJson();Cr("Connection","XHR received:",JSON.stringify(t)),i(t);break;case gr.TIMEOUT:Cr("Connection",'RPC "'+e+'" timed out'),a(new Fr(Mr.DEADLINE_EXCEEDED,"Request time out"));break;case gr.HTTP_ERROR:var n=o.getStatus();if(Cr("Connection",'RPC "'+e+'" failed with status:',n,"response text:",o.getResponseText()),n>0){var r=o.getResponseJson();Array.isArray(r)&&(r=r[0]);var u=null==r?void 0:r.error;if(u&&u.status&&u.message){var s=function(e){var t=e.toLowerCase().replace(/_/g,"-");return Object.values(Mr).indexOf(t)>=0?t:Mr.UNKNOWN}(u.status);a(new Fr(s,u.message))}else a(new Fr(Mr.UNKNOWN,"Server responded with status "+o.getStatus()))}else a(new Fr(Mr.UNAVAILABLE,"Connection failed."));break;default:Or()}}finally{Cr("Connection",'RPC "'+e+'" completed.')}}));var u=JSON.stringify(r);o.send(t,"POST",u,n,15)}))}},{key:"wo",value:function(e,t,n){var r=[this.oo,"/","google.firestore.v1.Firestore","/",e,"/channel"],i=yr(),a=mr(),o={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/".concat(this.databaseId.projectId,"/databases/").concat(this.databaseId.database)},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling};this.useFetchStreams&&(o.xmlHttpFactory=new Zr({})),this.lo(o.initMessageHeaders,t,n),o.encodeInitMessageHeaders=!0;var u=r.join("");Cr("Connection","Creating WebChannel: "+u,o);var s=i.createWebChannel(u,o),c=!1,l=!1,h=new sh({Hr:function(e){l?Cr("Connection","Not sending because WebChannel is closed:",e):(c||(Cr("Connection","Opening WebChannel transport."),s.open(),c=!0),Cr("Connection","WebChannel sending:",e),s.send(e))},Jr:function(){return s.close()}}),f=function(e,t,n){e.listen(t,(function(e){try{n(e)}catch(e){setTimeout((function(){throw e}),0)}}))};return f(s,Ir.EventType.OPEN,(function(){l||Cr("Connection","WebChannel transport opened.")})),f(s,Ir.EventType.CLOSE,(function(){l||(l=!0,Cr("Connection","WebChannel transport closed"),h.io())})),f(s,Ir.EventType.ERROR,(function(e){l||(l=!0,Dr("Connection","WebChannel transport errored:",e),h.io(new Fr(Mr.UNAVAILABLE,"The operation could not be completed")))})),f(s,Ir.EventType.MESSAGE,(function(e){var t;if(!l){var n=e.data[0];Pr(!!n);var r=n,i=r.error||(null===(t=r[0])||void 0===t?void 0:t.error);if(i){Cr("Connection","WebChannel received error:",i);var a=i.status,o=function(e){var t=Xo[e];if(void 0!==t)return iu(t)}(a),u=i.message;void 0===o&&(o=Mr.INTERNAL,u="Unknown error status: "+a+" with message "+i.message),l=!0,h.io(new Fr(o,u)),s.close()}else Cr("Connection","WebChannel received:",n),h.ro(n)}})),f(a,wr.STAT_EVENT,(function(e){e.stat===br.PROXY?Cr("Connection","Detected buffering proxy"):e.stat===br.NOPROXY&&Cr("Connection","Detected no buffering proxy")})),setTimeout((function(){h.so()}),0),h}}]),n}(function(){function e(t){(0,s.Z)(this,e),this.databaseInfo=t,this.databaseId=t.databaseId;var n=t.ssl?"https":"http";this.oo=n+"://"+t.host,this.uo="projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database+"/documents"}return(0,c.Z)(e,[{key:"co",get:function(){return!1}},{key:"ao",value:function(e,t,n,r,i){var a=this.ho(e,t);Cr("RestConnection","Sending: ",a,n);var o={};return this.lo(o,r,i),this.fo(e,a,o,n).then((function(e){return Cr("RestConnection","Received: ",e),e}),(function(t){throw Dr("RestConnection","".concat(e," failed with error: "),t,"url: ",a,"request:",n),t}))}},{key:"_o",value:function(e,t,n,r,i,a){return this.ao(e,t,n,r,i)}},{key:"lo",value:function(e,t,n){e["X-Goog-Api-Client"]="gl-js/ fire/"+Er,e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach((function(t,n){return e[n]=t})),n&&n.headers.forEach((function(t,n){return e[n]=t}))}},{key:"ho",value:function(e,t){var n=uh[e];return"".concat(this.oo,"/v1/").concat(t,":").concat(n)}}]),e}());function lh(){return"undefined"!=typeof window?window:null}function hh(){return"undefined"!=typeof document?document:null}function fh(e){return new Nu(e,!0)}var dh=function(){function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e3,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1.5,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:6e4;(0,s.Z)(this,e),this.Hs=t,this.timerId=n,this.mo=r,this.yo=i,this.po=a,this.Io=0,this.To=null,this.Eo=Date.now(),this.reset()}return(0,c.Z)(e,[{key:"reset",value:function(){this.Io=0}},{key:"Ao",value:function(){this.Io=this.po}},{key:"Ro",value:function(e){var t=this;this.cancel();var n=Math.floor(this.Io+this.bo()),r=Math.max(0,Date.now()-this.Eo),i=Math.max(0,n-r);i>0&&Cr("ExponentialBackoff","Backing off for ".concat(i," ms (base delay: ").concat(this.Io," ms, delay with jitter: ").concat(n," ms, last attempt: ").concat(r," ms ago)")),this.To=this.Hs.enqueueAfterDelay(this.timerId,i,(function(){return t.Eo=Date.now(),e()})),this.Io*=this.yo,this.Io<this.mo&&(this.Io=this.mo),this.Io>this.po&&(this.Io=this.po)}},{key:"Po",value:function(){null!==this.To&&(this.To.skipDelay(),this.To=null)}},{key:"cancel",value:function(){null!==this.To&&(this.To.cancel(),this.To=null)}},{key:"bo",value:function(){return(Math.random()-.5)*this.Io}}]),e}(),vh=function(){function e(t,n,r,i,a,o,u,c){(0,s.Z)(this,e),this.Hs=t,this.vo=r,this.Vo=i,this.connection=a,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=u,this.listener=c,this.state=0,this.So=0,this.Do=null,this.Co=null,this.stream=null,this.xo=new dh(t,n)}return(0,c.Z)(e,[{key:"No",value:function(){return 1===this.state||5===this.state||this.ko()}},{key:"ko",value:function(){return 2===this.state||3===this.state}},{key:"start",value:function(){4!==this.state?this.auth():this.Oo()}},{key:"stop",value:function(){var e=(0,p.Z)((0,v.Z)().mark((function e(){return(0,v.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=this.No(),!e.t0){e.next=4;break}return e.next=4,this.close(0);case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"Mo",value:function(){this.state=0,this.xo.reset()}},{key:"Fo",value:function(){var e=this;this.ko()&&null===this.Do&&(this.Do=this.Hs.enqueueAfterDelay(this.vo,6e4,(function(){return e.$o()})))}},{key:"Bo",value:function(e){this.Lo(),this.stream.send(e)}},{key:"$o",value:function(){var e=(0,p.Z)((0,v.Z)().mark((function e(){return(0,v.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.ko()){e.next=2;break}return e.abrupt("return",this.close(0));case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"Lo",value:function(){this.Do&&(this.Do.cancel(),this.Do=null)}},{key:"qo",value:function(){this.Co&&(this.Co.cancel(),this.Co=null)}},{key:"close",value:function(){var e=(0,p.Z)((0,v.Z)().mark((function e(t,n){return(0,v.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.Lo(),this.qo(),this.xo.cancel(),this.So++,4!==t?this.xo.reset():n&&n.code===Mr.RESOURCE_EXHAUSTED?(Nr(n.toString()),Nr("Using maximum backoff delay to prevent overloading the backend."),this.xo.Ao()):n&&n.code===Mr.UNAUTHENTICATED&&3!==this.state&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),null!==this.stream&&(this.Uo(),this.stream.close(),this.stream=null),this.state=t,e.next=9,this.listener.Zr(n);case 9:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"Uo",value:function(){}},{key:"auth",value:function(){var e=this;this.state=1;var t=this.Ko(this.So),n=this.So;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((function(t){var r=(0,d.Z)(t,2),i=r[0],a=r[1];e.So===n&&e.Go(i,a)}),(function(n){t((function(){var t=new Fr(Mr.UNKNOWN,"Fetching auth token failed: "+n.message);return e.Qo(t)}))}))}},{key:"Go",value:function(e,t){var n=this,r=this.Ko(this.So);this.stream=this.jo(e,t),this.stream.Yr((function(){r((function(){return n.state=2,n.Co=n.Hs.enqueueAfterDelay(n.Vo,1e4,(function(){return n.ko()&&(n.state=3),Promise.resolve()})),n.listener.Yr()}))})),this.stream.Zr((function(e){r((function(){return n.Qo(e)}))})),this.stream.onMessage((function(e){r((function(){return n.onMessage(e)}))}))}},{key:"Oo",value:function(){var e=this;this.state=5,this.xo.Ro((0,p.Z)((0,v.Z)().mark((function t(){return(0,v.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.state=0,e.start();case 1:case"end":return t.stop()}}),t)}))))}},{key:"Qo",value:function(e){return Cr("PersistentStream","close with error: ".concat(e)),this.stream=null,this.close(4,e)}},{key:"Ko",value:function(e){var t=this;return function(n){t.Hs.enqueueAndForget((function(){return t.So===e?n():(Cr("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())}))}}}]),e}(),ph=function(e){(0,a.Z)(n,e);var t=(0,o.Z)(n);function n(e,r,i,a,o,u){var c;return(0,s.Z)(this,n),(c=t.call(this,e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",r,i,a,u)).yt=o,c}return(0,c.Z)(n,[{key:"jo",value:function(e,t){return this.connection.wo("Listen",e,t)}},{key:"onMessage",value:function(e){this.xo.reset();var t=function(e,t){var n;if("targetChange"in t){t.targetChange;var r=function(e){return"NO_CHANGE"===e?0:"ADD"===e?1:"REMOVE"===e?2:"CURRENT"===e?3:"RESET"===e?4:Or()}(t.targetChange.targetChangeType||"NO_CHANGE"),i=t.targetChange.targetIds||[],a=function(e,t){return e.wt?(Pr(void 0===t||"string"==typeof t),Ui.fromBase64String(t||"")):(Pr(void 0===t||t instanceof Uint8Array),Ui.fromUint8Array(t||new Uint8Array))}(e,t.targetChange.resumeToken),o=t.targetChange.cause,u=o&&function(e){var t=void 0===e.code?Mr.UNKNOWN:iu(e.code);return new Fr(t,e.message||"")}(o);n=new Iu(r,i,a,u||null)}else if("documentChange"in t){t.documentChange;var s=t.documentChange;s.document,s.document.name,s.document.updateTime;var c=Vu(e,s.document.name),l=Pu(s.document.updateTime),h=s.document.createTime?Pu(s.document.createTime):ei.min(),f=new za({mapValue:{fields:s.document.fields}}),d=Ha.newFoundDocument(c,l,h,f),v=s.targetIds||[],p=s.removedTargetIds||[];n=new bu(v,p,d.key,d)}else if("documentDelete"in t){t.documentDelete;var y=t.documentDelete;y.document;var m=Vu(e,y.document),g=y.readTime?Pu(y.readTime):ei.min(),k=Ha.newNoDocument(m,g),w=y.removedTargetIds||[];n=new bu([],w,k.key,k)}else if("documentRemove"in t){t.documentRemove;var b=t.documentRemove;b.document;var Z=Vu(e,b.document),I=b.removedTargetIds||[];n=new bu([],I,Z,null)}else{if(!("filter"in t))return Or();t.filter;var x=t.filter;x.targetId;var _=x.count||0,T=new nu(_),E=x.targetId;n=new Zu(E,T)}return n}(this.yt,e),n=function(e){if(!("targetChange"in e))return ei.min();var t=e.targetChange;return t.targetIds&&t.targetIds.length?ei.min():t.readTime?Pu(t.readTime):ei.min()}(e);return this.listener.Wo(t,n)}},{key:"zo",value:function(e){var t={};t.database=Bu(this.yt),t.addTarget=function(e,t){var n,r=t.target;return(n=$a(r)?{documents:Qu(e,r)}:{query:Yu(e,r)}).targetId=t.targetId,t.resumeToken.approximateByteSize()>0?n.resumeToken=Ru(e,t.resumeToken):t.snapshotVersion.compareTo(ei.min())>0&&(n.readTime=Du(e,t.snapshotVersion.toTimestamp())),n}(this.yt,e);var n=function(e,t){var n=function(e,t){switch(t){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return Or()}}(0,t.purpose);return null==n?null:{"goog-listen-tags":n}}(this.yt,e);n&&(t.labels=n),this.Bo(t)}},{key:"Ho",value:function(e){var t={};t.database=Bu(this.yt),t.removeTarget=e,this.Bo(t)}}]),n}(vh),yh=function(e){(0,a.Z)(n,e);var t=(0,o.Z)(n);function n(e,r,i,a,o,u){var c;return(0,s.Z)(this,n),(c=t.call(this,e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",r,i,a,u)).yt=o,c.Jo=!1,c}return(0,c.Z)(n,[{key:"Yo",get:function(){return this.Jo}},{key:"start",value:function(){this.Jo=!1,this.lastStreamToken=void 0,(0,h.Z)((0,f.Z)(n.prototype),"start",this).call(this)}},{key:"Uo",value:function(){this.Jo&&this.Xo([])}},{key:"jo",value:function(e,t){return this.connection.wo("Write",e,t)}},{key:"onMessage",value:function(e){if(Pr(!!e.streamToken),this.lastStreamToken=e.streamToken,this.Jo){this.xo.reset();var t=function(e,t){return e&&e.length>0?(Pr(void 0!==t),e.map((function(e){return function(e,t){var n=e.updateTime?Pu(e.updateTime):Pu(t);return n.isEqual(ei.min())&&(n=Pu(t)),new Fo(n,e.transformResults||[])}(e,t)}))):[]}(e.writeResults,e.commitTime),n=Pu(e.commitTime);return this.listener.Zo(n,t)}return Pr(!e.writeResults||0===e.writeResults.length),this.Jo=!0,this.listener.tu()}},{key:"eu",value:function(){var e={};e.database=Bu(this.yt),this.Bo(e)}},{key:"Xo",value:function(e){var t=this,n={streamToken:this.lastStreamToken,writes:e.map((function(e){return Wu(t.yt,e)}))};this.Bo(n)}}]),n}(vh),mh=function(e){(0,a.Z)(n,e);var t=(0,o.Z)(n);function n(e,r,i,a){var o;return(0,s.Z)(this,n),(o=t.call(this)).authCredentials=e,o.appCheckCredentials=r,o.connection=i,o.yt=a,o.nu=!1,o}return(0,c.Z)(n,[{key:"su",value:function(){if(this.nu)throw new Fr(Mr.FAILED_PRECONDITION,"The client has already been terminated.")}},{key:"ao",value:function(e,t,n){var r=this;return this.su(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((function(i){var a=(0,d.Z)(i,2),o=a[0],u=a[1];return r.connection.ao(e,t,n,o,u)})).catch((function(e){throw"FirebaseError"===e.name?(e.code===Mr.UNAUTHENTICATED&&(r.authCredentials.invalidateToken(),r.appCheckCredentials.invalidateToken()),e):new Fr(Mr.UNKNOWN,e.toString())}))}},{key:"_o",value:function(e,t,n,r){var i=this;return this.su(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((function(a){var o=(0,d.Z)(a,2),u=o[0],s=o[1];return i.connection._o(e,t,n,u,s,r)})).catch((function(e){throw"FirebaseError"===e.name?(e.code===Mr.UNAUTHENTICATED&&(i.authCredentials.invalidateToken(),i.appCheckCredentials.invalidateToken()),e):new Fr(Mr.UNKNOWN,e.toString())}))}},{key:"terminate",value:function(){this.nu=!0}}]),n}(function(){return(0,c.Z)((function e(){(0,s.Z)(this,e)}))}());var gh=function(){function e(t,n){(0,s.Z)(this,e),this.asyncQueue=t,this.onlineStateHandler=n,this.state="Unknown",this.iu=0,this.ru=null,this.ou=!0}return(0,c.Z)(e,[{key:"uu",value:function(){var e=this;0===this.iu&&(this.cu("Unknown"),this.ru=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(function(){return e.ru=null,e.au("Backend didn't respond within 10 seconds."),e.cu("Offline"),Promise.resolve()})))}},{key:"hu",value:function(e){"Online"===this.state?this.cu("Unknown"):(this.iu++,this.iu>=1&&(this.lu(),this.au("Connection failed 1 times. Most recent error: ".concat(e.toString())),this.cu("Offline")))}},{key:"set",value:function(e){this.lu(),this.iu=0,"Online"===e&&(this.ou=!1),this.cu(e)}},{key:"cu",value:function(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}},{key:"au",value:function(e){var t="Could not reach Cloud Firestore backend. ".concat(e,"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.");this.ou?(Nr(t),this.ou=!1):Cr("OnlineStateTracker",t)}},{key:"lu",value:function(){null!==this.ru&&(this.ru.cancel(),this.ru=null)}}]),e}(),kh=(0,c.Z)((function e(t,n,r,i,a){var o=this;(0,s.Z)(this,e),this.localStore=t,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.fu=[],this.du=new Map,this._u=new Set,this.wu=[],this.mu=a,this.mu.Ur((function(e){r.enqueueAndForget((0,p.Z)((0,v.Z)().mark((function e(){return(0,v.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=Ch(o),!e.t0){e.next=5;break}return Cr("RemoteStore","Restarting streams for network reachability change."),e.next=5,function(){var e=(0,p.Z)((0,v.Z)().mark((function e(t){var n;return(0,v.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(n=Lr(t))._u.add(4),e.next=4,Zh(n);case 4:return n.gu.set("Unknown"),n._u.delete(4),e.next=8,wh(n);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()(o);case 5:case"end":return e.stop()}}),e)}))))})),this.gu=new gh(r,i)}));function wh(e){return bh.apply(this,arguments)}function bh(){return bh=(0,p.Z)((0,v.Z)().mark((function e(t){var n,r,i;return(0,v.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!Ch(t)){e.next=18;break}n=(0,u.Z)(t.wu),e.prev=2,n.s();case 4:if((r=n.n()).done){e.next=10;break}return i=r.value,e.next=8,i(!0);case 8:e.next=4;break;case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(2),n.e(e.t0);case 15:return e.prev=15,n.f(),e.finish(15);case 18:case"end":return e.stop()}}),e,null,[[2,12,15,18]])}))),bh.apply(this,arguments)}function Zh(e){return Ih.apply(this,arguments)}function Ih(){return Ih=(0,p.Z)((0,v.Z)().mark((function e(t){var n,r,i;return(0,v.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=(0,u.Z)(t.wu),e.prev=1,n.s();case 3:if((r=n.n()).done){e.next=9;break}return i=r.value,e.next=7,i(!1);case 7:e.next=3;break;case 9:e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1),n.e(e.t0);case 14:return e.prev=14,n.f(),e.finish(14);case 17:case"end":return e.stop()}}),e,null,[[1,11,14,17]])}))),Ih.apply(this,arguments)}function xh(e,t){var n=Lr(e);n.du.has(t.targetId)||(n.du.set(t.targetId,t),Ah(n)?Sh(n):of(n).ko()&&Th(n,t))}function _h(e,t){var n=Lr(e),r=of(n);n.du.delete(t),r.ko()&&Eh(n,t),0===n.du.size&&(r.ko()?r.Fo():Ch(n)&&n.gu.set("Unknown"))}function Th(e,t){e.yu.Ot(t.targetId),of(e).zo(t)}function Eh(e,t){e.yu.Ot(t),of(e).Ho(t)}function Sh(e){e.yu=new _u({getRemoteKeysForTarget:function(t){return e.remoteSyncer.getRemoteKeysForTarget(t)},ne:function(t){return e.du.get(t)||null}}),of(e).start(),e.gu.uu()}function Ah(e){return Ch(e)&&!of(e).No()&&e.du.size>0}function Ch(e){return 0===Lr(e)._u.size}function Nh(e){e.yu=void 0}function Dh(e){return Rh.apply(this,arguments)}function Rh(){return Rh=(0,p.Z)((0,v.Z)().mark((function e(t){return(0,v.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.du.forEach((function(e,n){Th(t,e)}));case 1:case"end":return e.stop()}}),e)}))),Rh.apply(this,arguments)}function Oh(e,t){return Ph.apply(this,arguments)}function Ph(){return Ph=(0,p.Z)((0,v.Z)().mark((function e(t,n){return(0,v.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:Nh(t),Ah(t)?(t.gu.hu(n),Sh(t)):t.gu.set("Unknown");case 1:case"end":return e.stop()}}),e)}))),Ph.apply(this,arguments)}function Lh(e,t,n){return Mh.apply(this,arguments)}function Mh(){return Mh=(0,p.Z)((0,v.Z)().mark((function e(t,n,r){var i;return(0,v.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.gu.set("Online"),!(n instanceof Iu&&2===n.state&&n.cause)){e.next=13;break}return e.prev=1,e.next=4,function(){var e=(0,p.Z)((0,v.Z)().mark((function e(t,n){var r,i,a,o;return(0,v.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=n.cause,i=(0,u.Z)(n.targetIds),e.prev=2,i.s();case 4:if((a=i.n()).done){e.next=14;break}if(o=a.value,e.t0=t.du.has(o),!e.t0){e.next=12;break}return e.next=10,t.remoteSyncer.rejectListen(o,r);case 10:t.du.delete(o),t.yu.removeTarget(o);case 12:e.next=4;break;case 14:e.next=19;break;case 16:e.prev=16,e.t1=e.catch(2),i.e(e.t1);case 19:return e.prev=19,i.f(),e.finish(19);case 22:case"end":return e.stop()}}),e,null,[[2,16,19,22]])})));return function(t,n){return e.apply(this,arguments)}}()(t,n);case 4:e.next=11;break;case 6:return e.prev=6,e.t0=e.catch(1),Cr("RemoteStore","Failed to remove targets %s: %s ",n.targetIds.join(","),e.t0),e.next=11,Fh(t,e.t0);case 11:case 22:e.next=29;break;case 13:if(n instanceof bu?t.yu.Kt(n):n instanceof Zu?t.yu.Jt(n):t.yu.jt(n),r.isEqual(ei.min())){e.next=29;break}return e.prev=14,e.next=17,Ol(t.localStore);case 17:if(i=e.sent,e.t1=r.compareTo(i)>=0,!e.t1){e.next=22;break}return e.next=22,function(e,t){var n=e.yu.Zt(t);return n.targetChanges.forEach((function(n,r){if(n.resumeToken.approximateByteSize()>0){var i=e.du.get(r);i&&e.du.set(r,i.withResumeToken(n.resumeToken,t))}})),n.targetMismatches.forEach((function(t){var n=e.du.get(t);if(n){e.du.set(t,n.withResumeToken(Ui.EMPTY_BYTE_STRING,n.snapshotVersion)),Eh(e,t);var r=new Vs(n.target,t,1,n.sequenceNumber);Th(e,r)}})),e.remoteSyncer.applyRemoteEvent(n)}(t,r);case 24:return e.prev=24,e.t2=e.catch(14),Cr("RemoteStore","Failed to raise snapshot:",e.t2),e.next=29,Fh(t,e.t2);case 29:case"end":return e.stop()}}),e,null,[[1,6],[14,24]])}))),Mh.apply(this,arguments)}function Fh(e,t,n){return Vh.apply(this,arguments)}function Vh(){return Vh=(0,p.Z)((0,v.Z)().mark((function e(t,n,r){return(0,v.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(xi(n)){e.next=2;break}throw n;case 2:return t._u.add(1),e.next=5,Zh(t);case 5:t.gu.set("Offline"),r||(r=function(){return Ol(t.localStore)}),t.asyncQueue.enqueueRetryable((0,p.Z)((0,v.Z)().mark((function e(){return(0,v.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Cr("RemoteStore","Retrying IndexedDB access"),e.next=3,r();case 3:return t._u.delete(1),e.next=6,wh(t);case 6:case"end":return e.stop()}}),e)}))));case 8:case"end":return e.stop()}}),e)}))),Vh.apply(this,arguments)}function Uh(e,t){return t().catch((function(n){return Fh(e,n,t)}))}function qh(e){return Bh.apply(this,arguments)}function Bh(){return Bh=(0,p.Z)((0,v.Z)().mark((function e(t){var n,r,i,a;return(0,v.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=Lr(t),r=uf(n),i=n.fu.length>0?n.fu[n.fu.length-1].batchId:-1;case 2:if(!jh(n)){e.next=19;break}return e.prev=3,e.next=6,Ml(n.localStore,i);case 6:if(null!==(a=e.sent)){e.next=10;break}return 0===n.fu.length&&r.Fo(),e.abrupt("break",19);case 10:i=a.batchId,Gh(n,a),e.next=17;break;case 13:return e.prev=13,e.t0=e.catch(3),e.next=17,Fh(n,e.t0);case 17:e.next=2;break;case 19:Kh(n)&&zh(n);case 20:case"end":return e.stop()}}),e,null,[[3,13]])}))),Bh.apply(this,arguments)}function jh(e){return Ch(e)&&e.fu.length<10}function Gh(e,t){e.fu.push(t);var n=uf(e);n.ko()&&n.Yo&&n.Xo(t.mutations)}function Kh(e){return Ch(e)&&!uf(e).No()&&e.fu.length>0}function zh(e){uf(e).start()}function Wh(e){return Hh.apply(this,arguments)}function Hh(){return Hh=(0,p.Z)((0,v.Z)().mark((function e(t){return(0,v.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:uf(t).eu();case 1:case"end":return e.stop()}}),e)}))),Hh.apply(this,arguments)}function Qh(e){return Yh.apply(this,arguments)}function Yh(){return Yh=(0,p.Z)((0,v.Z)().mark((function e(t){var n,r,i,a;return(0,v.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=uf(t),r=(0,u.Z)(t.fu);try{for(r.s();!(i=r.n()).done;)a=i.value,n.Xo(a.mutations)}catch(o){r.e(o)}finally{r.f()}case 3:case"end":return e.stop()}}),e)}))),Yh.apply(this,arguments)}function Jh(e,t,n){return Xh.apply(this,arguments)}function Xh(){return Xh=(0,p.Z)((0,v.Z)().mark((function e(t,n,r){var i,a;return(0,v.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=t.fu.shift(),a=Ms.from(i,n,r),e.next=3,Uh(t,(function(){return t.remoteSyncer.applySuccessfulWrite(a)}));case 3:return e.next=5,qh(t);case 5:case"end":return e.stop()}}),e)}))),Xh.apply(this,arguments)}function $h(e,t){return ef.apply(this,arguments)}function ef(){return ef=(0,p.Z)((0,v.Z)().mark((function e(t,n){return(0,v.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=n&&uf(t).Yo,!e.t0){e.next=4;break}return e.next=4,function(){var e=(0,p.Z)((0,v.Z)().mark((function e(t,n){var r,i;return(0,v.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!ru(i=n.code)||i===Mr.ABORTED){e.next=7;break}return r=t.fu.shift(),uf(t).Mo(),e.next=5,Uh(t,(function(){return t.remoteSyncer.rejectFailedWrite(r.batchId,n)}));case 5:return e.next=7,qh(t);case 7:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()(t,n);case 4:Kh(t)&&zh(t);case 5:case"end":return e.stop()}}),e)}))),ef.apply(this,arguments)}function tf(e,t){return nf.apply(this,arguments)}function nf(){return nf=(0,p.Z)((0,v.Z)().mark((function e(t,n){var r,i;return(0,v.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(r=Lr(t)).asyncQueue.verifyOperationInProgress(),Cr("RemoteStore","RemoteStore received new credentials"),i=Ch(r),r._u.add(3),e.next=6,Zh(r);case 6:return i&&r.gu.set("Unknown"),e.next=9,r.remoteSyncer.handleCredentialChange(n);case 9:return r._u.delete(3),e.next=12,wh(r);case 12:case"end":return e.stop()}}),e)}))),nf.apply(this,arguments)}function rf(e,t){return af.apply(this,arguments)}function af(){return af=(0,p.Z)((0,v.Z)().mark((function e(t,n){var r;return(0,v.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=Lr(t),!n){e.next=7;break}return r._u.delete(2),e.next=5,wh(r);case 5:e.next=13;break;case 7:if(e.t0=n,e.t0){e.next=13;break}return r._u.add(2),e.next=12,Zh(r);case 12:r.gu.set("Unknown");case 13:case"end":return e.stop()}}),e)}))),af.apply(this,arguments)}function of(e){return e.pu||(e.pu=function(e,t,n){var r=Lr(e);return r.su(),new ph(t,r.connection,r.authCredentials,r.appCheckCredentials,r.yt,n)}(e.datastore,e.asyncQueue,{Yr:Dh.bind(null,e),Zr:Oh.bind(null,e),Wo:Lh.bind(null,e)}),e.wu.push(function(){var t=(0,p.Z)((0,v.Z)().mark((function t(n){return(0,v.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!n){t.next=4;break}e.pu.Mo(),Ah(e)?Sh(e):e.gu.set("Unknown"),t.next=7;break;case 4:return t.next=6,e.pu.stop();case 6:Nh(e);case 7:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())),e.pu}function uf(e){return e.Iu||(e.Iu=function(e,t,n){var r=Lr(e);return r.su(),new yh(t,r.connection,r.authCredentials,r.appCheckCredentials,r.yt,n)}(e.datastore,e.asyncQueue,{Yr:Wh.bind(null,e),Zr:$h.bind(null,e),tu:Qh.bind(null,e),Zo:Jh.bind(null,e)}),e.wu.push(function(){var t=(0,p.Z)((0,v.Z)().mark((function t(n){return(0,v.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!n){t.next=6;break}return e.Iu.Mo(),t.next=4,qh(e);case 4:t.next=9;break;case 6:return t.next=8,e.Iu.stop();case 8:e.fu.length>0&&(Cr("RemoteStore","Stopping write stream with ".concat(e.fu.length," pending writes")),e.fu=[]);case 9:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())),e.Iu}var sf=function(){function e(t,n,r,i,a){(0,s.Z)(this,e),this.asyncQueue=t,this.timerId=n,this.targetTimeMs=r,this.op=i,this.removalCallback=a,this.deferred=new Vr,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((function(e){}))}return(0,c.Z)(e,[{key:"start",value:function(e){var t=this;this.timerHandle=setTimeout((function(){return t.handleDelayElapsed()}),e)}},{key:"skipDelay",value:function(){return this.handleDelayElapsed()}},{key:"cancel",value:function(e){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new Fr(Mr.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}},{key:"handleDelayElapsed",value:function(){var e=this;this.asyncQueue.enqueueAndForget((function(){return null!==e.timerHandle?(e.clearTimeout(),e.op().then((function(t){return e.deferred.resolve(t)}))):Promise.resolve()}))}},{key:"clearTimeout",value:function(e){function t(){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}))}],[{key:"createAndSchedule",value:function(t,n,r,i,a){var o=new e(t,n,Date.now()+r,i,a);return o.start(r),o}}]),e}();function cf(e,t){if(Nr("AsyncQueue","".concat(t,": ").concat(e)),xi(e))return new Fr(Mr.UNAVAILABLE,"".concat(t,": ").concat(e));throw e}var lf=function(){function e(t){(0,s.Z)(this,e),this.comparator=t?function(e,n){return t(e,n)||ai.comparator(e.key,n.key)}:function(e,t){return ai.comparator(e.key,t.key)},this.keyedMap=cu(),this.sortedSet=new Va(this.comparator)}return(0,c.Z)(e,[{key:"has",value:function(e){return null!=this.keyedMap.get(e)}},{key:"get",value:function(e){return this.keyedMap.get(e)}},{key:"first",value:function(){return this.sortedSet.minKey()}},{key:"last",value:function(){return this.sortedSet.maxKey()}},{key:"isEmpty",value:function(){return this.sortedSet.isEmpty()}},{key:"indexOf",value:function(e){var t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}},{key:"size",get:function(){return this.sortedSet.size}},{key:"forEach",value:function(e){this.sortedSet.inorderTraversal((function(t,n){return e(t),!1}))}},{key:"add",value:function(e){var t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}},{key:"delete",value:function(e){var t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}},{key:"isEqual",value:function(t){if(!(t instanceof e))return!1;if(this.size!==t.size)return!1;for(var n=this.sortedSet.getIterator(),r=t.sortedSet.getIterator();n.hasNext();){var i=n.getNext().key,a=r.getNext().key;if(!i.isEqual(a))return!1}return!0}},{key:"toString",value:function(){var e=[];return this.forEach((function(t){e.push(t.toString())})),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"}},{key:"copy",value:function(t,n){var r=new e;return r.comparator=this.comparator,r.keyedMap=t,r.sortedSet=n,r}}],[{key:"emptySet",value:function(t){return new e(t.comparator)}}]),e}(),hf=function(){function e(){(0,s.Z)(this,e),this.Tu=new Va(ai.comparator)}return(0,c.Z)(e,[{key:"track",value:function(e){var t=e.doc.key,n=this.Tu.get(t);n?0!==e.type&&3===n.type?this.Tu=this.Tu.insert(t,e):3===e.type&&1!==n.type?this.Tu=this.Tu.insert(t,{type:n.type,doc:e.doc}):2===e.type&&2===n.type?this.Tu=this.Tu.insert(t,{type:2,doc:e.doc}):2===e.type&&0===n.type?this.Tu=this.Tu.insert(t,{type:0,doc:e.doc}):1===e.type&&0===n.type?this.Tu=this.Tu.remove(t):1===e.type&&2===n.type?this.Tu=this.Tu.insert(t,{type:1,doc:n.doc}):0===e.type&&1===n.type?this.Tu=this.Tu.insert(t,{type:2,doc:e.doc}):Or():this.Tu=this.Tu.insert(t,e)}},{key:"Eu",value:function(){var e=[];return this.Tu.inorderTraversal((function(t,n){e.push(n)})),e}}]),e}(),ff=function(){function e(t,n,r,i,a,o,u,c,l){(0,s.Z)(this,e),this.query=t,this.docs=n,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=a,this.fromCache=o,this.syncStateChanged=u,this.excludesMetadataChanges=c,this.hasCachedResults=l}return(0,c.Z)(e,[{key:"hasPendingWrites",get:function(){return!this.mutatedKeys.isEmpty()}},{key:"isEqual",value:function(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&po(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;var t=this.docChanges,n=e.docChanges;if(t.length!==n.length)return!1;for(var r=0;r<t.length;r++)if(t[r].type!==n[r].type||!t[r].doc.isEqual(n[r].doc))return!1;return!0}}],[{key:"fromInitialDocuments",value:function(t,n,r,i,a){var o=[];return n.forEach((function(e){o.push({type:0,doc:e})})),new e(t,n,lf.emptySet(n),o,r,i,!0,!1,a)}}]),e}(),df=(0,c.Z)((function e(){(0,s.Z)(this,e),this.Au=void 0,this.listeners=[]})),vf=(0,c.Z)((function e(){(0,s.Z)(this,e),this.queries=new au((function(e){return yo(e)}),po),this.onlineState="Unknown",this.Ru=new Set}));function pf(e,t){return yf.apply(this,arguments)}function yf(){return yf=(0,p.Z)((0,v.Z)().mark((function e(t,n){var r,i,a,o,u;return(0,v.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=Lr(t),i=n.query,a=!1,(o=r.queries.get(i))||(a=!0,o=new df),!a){e.next=13;break}return e.prev=3,e.next=6,r.onListen(i);case 6:o.Au=e.sent,e.next=13;break;case 9:return e.prev=9,e.t0=e.catch(3),u=cf(e.t0,"Initialization of query '".concat(mo(n.query),"' failed")),e.abrupt("return",void n.onError(u));case 13:r.queries.set(i,o),o.listeners.push(n),n.bu(r.onlineState),o.Au&&n.Pu(o.Au)&&bf(r);case 14:case"end":return e.stop()}}),e,null,[[3,9]])}))),yf.apply(this,arguments)}function mf(e,t){return gf.apply(this,arguments)}function gf(){return gf=(0,p.Z)((0,v.Z)().mark((function e(t,n){var r,i,a,o,u;return(0,v.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=Lr(t),i=n.query,a=!1,(o=r.queries.get(i))&&(u=o.listeners.indexOf(n))>=0&&(o.listeners.splice(u,1),a=0===o.listeners.length),!a){e.next=6;break}return e.abrupt("return",(r.queries.delete(i),r.onUnlisten(i)));case 6:case"end":return e.stop()}}),e)}))),gf.apply(this,arguments)}function kf(e,t){var n,r=Lr(e),i=!1,a=(0,u.Z)(t);try{for(a.s();!(n=a.n()).done;){var o=n.value,s=o.query,c=r.queries.get(s);if(c){var l,h=(0,u.Z)(c.listeners);try{for(h.s();!(l=h.n()).done;){l.value.Pu(o)&&(i=!0)}}catch(f){h.e(f)}finally{h.f()}c.Au=o}}}catch(f){a.e(f)}finally{a.f()}i&&bf(r)}function wf(e,t,n){var r=Lr(e),i=r.queries.get(t);if(i){var a,o=(0,u.Z)(i.listeners);try{for(o.s();!(a=o.n()).done;){a.value.onError(n)}}catch(s){o.e(s)}finally{o.f()}}r.queries.delete(t)}function bf(e){e.Ru.forEach((function(e){e.next()}))}var Zf=function(){function e(t,n,r){(0,s.Z)(this,e),this.query=t,this.vu=n,this.Vu=!1,this.Su=null,this.onlineState="Unknown",this.options=r||{}}return(0,c.Z)(e,[{key:"Pu",value:function(e){if(!this.options.includeMetadataChanges){var t,n=[],r=(0,u.Z)(e.docChanges);try{for(r.s();!(t=r.n()).done;){var i=t.value;3!==i.type&&n.push(i)}}catch(o){r.e(o)}finally{r.f()}e=new ff(e.query,e.docs,e.oldDocs,n,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}var a=!1;return this.Vu?this.Du(e)&&(this.vu.next(e),a=!0):this.Cu(e,this.onlineState)&&(this.xu(e),a=!0),this.Su=e,a}},{key:"onError",value:function(e){this.vu.error(e)}},{key:"bu",value:function(e){this.onlineState=e;var t=!1;return this.Su&&!this.Vu&&this.Cu(this.Su,e)&&(this.xu(this.Su),t=!0),t}},{key:"Cu",value:function(e,t){if(!e.fromCache)return!0;var n="Offline"!==t;return(!this.options.Nu||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||"Offline"===t)}},{key:"Du",value:function(e){if(e.docChanges.length>0)return!0;var t=this.Su&&this.Su.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&!0===this.options.includeMetadataChanges}},{key:"xu",value:function(e){e=ff.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Vu=!0,this.vu.next(e)}}]),e}(),If=function(){function e(t,n){(0,s.Z)(this,e),this.ku=t,this.byteLength=n}return(0,c.Z)(e,[{key:"Ou",value:function(){return"metadata"in this.ku}}]),e}(),xf=function(){function e(t){(0,s.Z)(this,e),this.yt=t}return(0,c.Z)(e,[{key:"Ji",value:function(e){return Vu(this.yt,e)}},{key:"Yi",value:function(e){return e.metadata.exists?Ku(this.yt,e.document,!1):Ha.newNoDocument(this.Ji(e.metadata.name),this.Xi(e.metadata.readTime))}},{key:"Xi",value:function(e){return Pu(e)}}]),e}(),_f=function(){function e(t,n,r){(0,s.Z)(this,e),this.Mu=t,this.localStore=n,this.yt=r,this.queries=[],this.documents=[],this.collectionGroups=new Set,this.progress=Tf(t)}return(0,c.Z)(e,[{key:"Fu",value:function(e){this.progress.bytesLoaded+=e.byteLength;var t=this.progress.documentsLoaded;if(e.ku.namedQuery)this.queries.push(e.ku.namedQuery);else if(e.ku.documentMetadata){this.documents.push({metadata:e.ku.documentMetadata}),e.ku.documentMetadata.exists||++t;var n=ni.fromString(e.ku.documentMetadata.name);this.collectionGroups.add(n.get(n.length-2))}else e.ku.document&&(this.documents[this.documents.length-1].document=e.ku.document,++t);return t!==this.progress.documentsLoaded?(this.progress.documentsLoaded=t,Object.assign({},this.progress)):null}},{key:"$u",value:function(e){var t,n=new Map,r=new xf(this.yt),i=(0,u.Z)(e);try{for(i.s();!(t=i.n()).done;){var a=t.value;if(a.metadata.queries){var o,s=r.Ji(a.metadata.name),c=(0,u.Z)(a.metadata.queries);try{for(c.s();!(o=c.n()).done;){var l=o.value,h=(n.get(l)||yu()).add(s);n.set(l,h)}}catch(f){c.e(f)}finally{c.f()}}}}catch(f){i.e(f)}finally{i.f()}return n}},{key:"complete",value:function(){var e=(0,p.Z)((0,v.Z)().mark((function e(){var t,n,r,i,a;return(0,v.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Kl(this.localStore,new xf(this.yt),this.documents,this.Mu.id);case 2:t=e.sent,n=this.$u(this.documents),r=(0,u.Z)(this.queries),e.prev=5,r.s();case 7:if((i=r.n()).done){e.next=13;break}return a=i.value,e.next=11,Wl(this.localStore,a,n.get(a.name));case 11:e.next=7;break;case 13:e.next=18;break;case 15:e.prev=15,e.t0=e.catch(5),r.e(e.t0);case 18:return e.prev=18,r.f(),e.finish(18);case 21:return e.abrupt("return",(this.progress.taskState="Success",{progress:this.progress,Bu:this.collectionGroups,Lu:t}));case 22:case"end":return e.stop()}}),e,this,[[5,15,18,21]])})));return function(){return e.apply(this,arguments)}}()}]),e}();function Tf(e){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:e.totalDocuments,totalBytes:e.totalBytes}}var Ef=(0,c.Z)((function e(t){(0,s.Z)(this,e),this.key=t})),Sf=(0,c.Z)((function e(t){(0,s.Z)(this,e),this.key=t})),Af=function(){function e(t,n){(0,s.Z)(this,e),this.query=t,this.qu=n,this.Uu=null,this.hasCachedResults=!1,this.current=!1,this.Ku=yu(),this.mutatedKeys=yu(),this.Gu=wo(t),this.Qu=new lf(this.Gu)}return(0,c.Z)(e,[{key:"ju",get:function(){return this.qu}},{key:"Wu",value:function(e,t){var n=this,r=t?t.zu:new hf,i=t?t.Qu:this.Qu,a=t?t.mutatedKeys:this.mutatedKeys,o=i,u=!1,s="F"===this.query.limitType&&i.size===this.query.limit?i.last():null,c="L"===this.query.limitType&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((function(e,t){var l=i.get(e),h=go(n.query,t)?t:null,f=!!l&&n.mutatedKeys.has(l.key),d=!!h&&(h.hasLocalMutations||n.mutatedKeys.has(h.key)&&h.hasCommittedMutations),v=!1;l&&h?l.data.isEqual(h.data)?f!==d&&(r.track({type:3,doc:h}),v=!0):n.Hu(l,h)||(r.track({type:2,doc:h}),v=!0,(s&&n.Gu(h,s)>0||c&&n.Gu(h,c)<0)&&(u=!0)):!l&&h?(r.track({type:0,doc:h}),v=!0):l&&!h&&(r.track({type:1,doc:l}),v=!0,(s||c)&&(u=!0)),v&&(h?(o=o.add(h),a=d?a.add(e):a.delete(e)):(o=o.delete(e),a=a.delete(e)))})),null!==this.query.limit)for(;o.size>this.query.limit;){var l="F"===this.query.limitType?o.last():o.first();o=o.delete(l.key),a=a.delete(l.key),r.track({type:1,doc:l})}return{Qu:o,zu:r,$i:u,mutatedKeys:a}}},{key:"Hu",value:function(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}},{key:"applyChanges",value:function(e,t,n){var r=this,i=this.Qu;this.Qu=e.Qu,this.mutatedKeys=e.mutatedKeys;var a=e.zu.Eu();a.sort((function(e,t){return function(e,t){var n=function(e){switch(e){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Or()}};return n(e)-n(t)}(e.type,t.type)||r.Gu(e.doc,t.doc)})),this.Ju(n);var o=t?this.Yu():[],u=0===this.Ku.size&&this.current?1:0,s=u!==this.Uu;return this.Uu=u,0!==a.length||s?{snapshot:new ff(this.query,e.Qu,i,a,e.mutatedKeys,0===u,s,!1,!!n&&n.resumeToken.approximateByteSize()>0),Xu:o}:{Xu:o}}},{key:"bu",value:function(e){return this.current&&"Offline"===e?(this.current=!1,this.applyChanges({Qu:this.Qu,zu:new hf,mutatedKeys:this.mutatedKeys,$i:!1},!1)):{Xu:[]}}},{key:"Zu",value:function(e){return!this.qu.has(e)&&!!this.Qu.has(e)&&!this.Qu.get(e).hasLocalMutations}},{key:"Ju",value:function(e){var t=this;e&&(e.addedDocuments.forEach((function(e){return t.qu=t.qu.add(e)})),e.modifiedDocuments.forEach((function(e){})),e.removedDocuments.forEach((function(e){return t.qu=t.qu.delete(e)})),this.current=e.current)}},{key:"Yu",value:function(){var e=this;if(!this.current)return[];var t=this.Ku;this.Ku=yu(),this.Qu.forEach((function(t){e.Zu(t.key)&&(e.Ku=e.Ku.add(t.key))}));var n=[];return t.forEach((function(t){e.Ku.has(t)||n.push(new Sf(t))})),this.Ku.forEach((function(e){t.has(e)||n.push(new Ef(e))})),n}},{key:"tc",value:function(e){this.qu=e.Hi,this.Ku=yu();var t=this.Wu(e.documents);return this.applyChanges(t,!0)}},{key:"ec",value:function(){return ff.fromInitialDocuments(this.query,this.Qu,this.mutatedKeys,0===this.Uu,this.hasCachedResults)}}]),e}(),Cf=(0,c.Z)((function e(t,n,r){(0,s.Z)(this,e),this.query=t,this.targetId=n,this.view=r})),Nf=(0,c.Z)((function e(t){(0,s.Z)(this,e),this.key=t,this.nc=!1})),Df=function(){function e(t,n,r,i,a,o){(0,s.Z)(this,e),this.localStore=t,this.remoteStore=n,this.eventManager=r,this.sharedClientState=i,this.currentUser=a,this.maxConcurrentLimboResolutions=o,this.sc={},this.ic=new au((function(e){return yo(e)}),po),this.rc=new Map,this.oc=new Set,this.uc=new Va(ai.comparator),this.cc=new Map,this.ac=new hl,this.hc={},this.lc=new Map,this.fc=qc.vn(),this.onlineState="Unknown",this.dc=void 0}return(0,c.Z)(e,[{key:"isPrimaryClient",get:function(){return!0===this.dc}}]),e}();function Rf(e,t){return Of.apply(this,arguments)}function Of(){return Of=(0,p.Z)((0,v.Z)().mark((function e(t,n){var r,i,a,o,u,s;return(0,v.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=Td(t),!(o=r.ic.get(n))){e.next=6;break}i=o.targetId,r.sharedClientState.addLocalQueryTarget(i),a=o.view.ec(),e.next=15;break;case 6:return e.next=8,Fl(r.localStore,ho(n));case 8:return u=e.sent,r.isPrimaryClient&&xh(r.remoteStore,u),s=r.sharedClientState.addLocalQueryTarget(u.targetId),i=u.targetId,e.next=14,Pf(r,n,i,"current"===s,u.resumeToken);case 14:a=e.sent;case 15:return e.abrupt("return",a);case 16:case"end":return e.stop()}}),e)}))),Of.apply(this,arguments)}function Pf(e,t,n,r,i){return Lf.apply(this,arguments)}function Lf(){return Lf=(0,p.Z)((0,v.Z)().mark((function e(t,n,r,i,a){var o,u,s,c,l,h;return(0,v.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t._c=function(e,n,r){return function(){var e=(0,p.Z)((0,v.Z)().mark((function e(t,n,r,i){var a,o,u;return(0,v.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=n.view.Wu(r),e.t0=a.$i,!e.t0){e.next=6;break}return e.next=5,ql(t.localStore,n.query,!1).then((function(e){var t=e.documents;return n.view.Wu(t,a)}));case 5:a=e.sent;case 6:return o=i&&i.targetChanges.get(n.targetId),u=n.view.applyChanges(a,t.isPrimaryClient,o),e.abrupt("return",(nd(t,n.targetId,u.Xu),u.snapshot));case 8:case"end":return e.stop()}}),e)})));return function(t,n,r,i){return e.apply(this,arguments)}}()(t,e,n,r)},e.next=3,ql(t.localStore,n,!0);case 3:return o=e.sent,u=new Af(n,o.Hi),s=u.Wu(o.documents),c=wu.createSynthesizedTargetChangeForCurrentChange(r,i&&"Offline"!==t.onlineState,a),l=u.applyChanges(s,t.isPrimaryClient,c),nd(t,r,l.Xu),h=new Cf(n,r,u),e.abrupt("return",(t.ic.set(n,h),t.rc.has(r)?t.rc.get(r).push(n):t.rc.set(r,[n]),l.snapshot));case 11:case"end":return e.stop()}}),e)}))),Lf.apply(this,arguments)}function Mf(e,t){return Ff.apply(this,arguments)}function Ff(){return Ff=(0,p.Z)((0,v.Z)().mark((function e(t,n){var r,i,a;return(0,v.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=Lr(t),i=r.ic.get(n),!((a=r.rc.get(i.targetId)).length>1)){e.next=3;break}return e.abrupt("return",(r.rc.set(i.targetId,a.filter((function(e){return!po(e,n)}))),void r.ic.delete(n)));case 3:if(!r.isPrimaryClient){e.next=11;break}if(r.sharedClientState.removeLocalQueryTarget(i.targetId),e.t0=r.sharedClientState.isActiveQueryTarget(i.targetId),e.t0){e.next=9;break}return e.next=9,Vl(r.localStore,i.targetId,!1).then((function(){r.sharedClientState.clearQueryState(i.targetId),_h(r.remoteStore,i.targetId),ed(r,i.targetId)})).catch(mi);case 9:e.next=14;break;case 11:return ed(r,i.targetId),e.next=14,Vl(r.localStore,i.targetId,!0);case 14:case"end":return e.stop()}}),e)}))),Ff.apply(this,arguments)}function Vf(e,t,n){return Uf.apply(this,arguments)}function Uf(){return Uf=(0,p.Z)((0,v.Z)().mark((function e(t,n,r){var i,a,o;return(0,v.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=Ed(t),e.prev=1,e.next=4,function(e,t){var n,r,i=Lr(e),a=$r.now(),o=t.reduce((function(e,t){return e.add(t.key)}),yu());return i.persistence.runTransaction("Locally write mutations","readwrite",(function(e){var s=uu(),c=yu();return i.Gi.getEntries(e,o).next((function(e){(s=e).forEach((function(e,t){t.isValidDocument()||(c=c.add(e))}))})).next((function(){return i.localDocuments.getOverlayedDocuments(e,s)})).next((function(r){n=r;var o,s=[],c=(0,u.Z)(t);try{for(c.s();!(o=c.n()).done;){var l=o.value,h=Ko(l,n.get(l.key).overlayedDocument);null!=h&&s.push(new Ho(l.key,h,Wa(h.value.mapValue),Vo.exists(!0)))}}catch(f){c.e(f)}finally{c.f()}return i.mutationQueue.addMutationBatch(e,a,s,t)})).next((function(t){r=t;var a=t.applyToLocalDocumentSet(n,c);return i.documentOverlayCache.saveOverlays(e,t.batchId,a)}))})).then((function(){return{batchId:r.batchId,changes:lu(n)}}))}(i.localStore,n);case 4:return a=e.sent,i.sharedClientState.addPendingMutation(a.batchId),function(e,t,n){var r=e.hc[e.currentUser.toKey()];r||(r=new Va(Yr)),r=r.insert(t,n),e.hc[e.currentUser.toKey()]=r}(i,a.batchId,r),e.next=9,ad(i,a.changes);case 9:return e.next=11,qh(i.remoteStore);case 11:e.next=17;break;case 13:e.prev=13,e.t0=e.catch(1),o=cf(e.t0,"Failed to persist write"),r.reject(o);case 17:case"end":return e.stop()}}),e,null,[[1,13]])}))),Uf.apply(this,arguments)}function qf(e,t){return Bf.apply(this,arguments)}function Bf(){return Bf=(0,p.Z)((0,v.Z)().mark((function e(t,n){var r,i;return(0,v.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=Lr(t),e.prev=1,e.next=4,Pl(r.localStore,n);case 4:return i=e.sent,n.targetChanges.forEach((function(e,t){var n=r.cc.get(t);n&&(Pr(e.addedDocuments.size+e.modifiedDocuments.size+e.removedDocuments.size<=1),e.addedDocuments.size>0?n.nc=!0:e.modifiedDocuments.size>0?Pr(n.nc):e.removedDocuments.size>0&&(Pr(n.nc),n.nc=!1))})),e.next=8,ad(r,i,n);case 8:e.next=14;break;case 10:return e.prev=10,e.t0=e.catch(1),e.next=14,mi(e.t0);case 14:case"end":return e.stop()}}),e,null,[[1,10]])}))),Bf.apply(this,arguments)}function jf(e,t,n){var r=Lr(e);if(r.isPrimaryClient&&0===n||!r.isPrimaryClient&&1===n){var i=[];r.ic.forEach((function(e,n){var r=n.view.bu(t);r.snapshot&&i.push(r.snapshot)})),function(e,t){var n=Lr(e);n.onlineState=t;var r=!1;n.queries.forEach((function(e,n){var i,a=(0,u.Z)(n.listeners);try{for(a.s();!(i=a.n()).done;){i.value.bu(t)&&(r=!0)}}catch(o){a.e(o)}finally{a.f()}})),r&&bf(n)}(r.eventManager,t),i.length&&r.sc.Wo(i),r.onlineState=t,r.isPrimaryClient&&r.sharedClientState.setOnlineState(t)}}function Gf(e,t,n){return Kf.apply(this,arguments)}function Kf(){return Kf=(0,p.Z)((0,v.Z)().mark((function e(t,n,r){var i,a,o,u,s,c;return(0,v.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((i=Lr(t)).sharedClientState.updateQueryState(n,"rejected",r),a=i.cc.get(n),!(o=a&&a.key)){e.next=14;break}return u=(u=new Va(ai.comparator)).insert(o,Ha.newNoDocument(o,ei.min())),s=yu().add(o),c=new ku(ei.min(),new Map,new Ba(Yr),u,s),e.next=9,qf(i,c);case 9:i.uc=i.uc.remove(o),i.cc.delete(n),id(i),e.next=16;break;case 14:return e.next=16,Vl(i.localStore,n,!1).then((function(){return ed(i,n,r)})).catch(mi);case 16:case"end":return e.stop()}}),e)}))),Kf.apply(this,arguments)}function zf(e,t){return Wf.apply(this,arguments)}function Wf(){return Wf=(0,p.Z)((0,v.Z)().mark((function e(t,n){var r,i,a;return(0,v.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=Lr(t),i=n.batch.batchId,e.prev=1,e.next=4,Rl(r.localStore,n);case 4:return a=e.sent,$f(r,i,null),Xf(r,i),r.sharedClientState.updateMutationState(i,"acknowledged"),e.next=10,ad(r,a);case 10:e.next=16;break;case 12:return e.prev=12,e.t0=e.catch(1),e.next=16,mi(e.t0);case 16:case"end":return e.stop()}}),e,null,[[1,12]])}))),Wf.apply(this,arguments)}function Hf(e,t,n){return Qf.apply(this,arguments)}function Qf(){return Qf=(0,p.Z)((0,v.Z)().mark((function e(t,n,r){var i,a;return(0,v.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=Lr(t),e.prev=1,e.next=4,function(e,t){var n=Lr(e);return n.persistence.runTransaction("Reject batch","readwrite-primary",(function(e){var r;return n.mutationQueue.lookupMutationBatch(e,t).next((function(t){return Pr(null!==t),r=t.keys(),n.mutationQueue.removeMutationBatch(e,t)})).next((function(){return n.mutationQueue.performConsistencyCheck(e)})).next((function(){return n.documentOverlayCache.removeOverlaysForBatchId(e,r,t)})).next((function(){return n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,r)})).next((function(){return n.localDocuments.getDocuments(e,r)}))}))}(i.localStore,n);case 4:return a=e.sent,$f(i,n,r),Xf(i,n),i.sharedClientState.updateMutationState(n,"rejected",r),e.next=10,ad(i,a);case 10:e.next=16;break;case 12:return e.prev=12,e.t0=e.catch(1),e.next=16,mi(e.t0);case 16:case"end":return e.stop()}}),e,null,[[1,12]])}))),Qf.apply(this,arguments)}function Yf(e,t){return Jf.apply(this,arguments)}function Jf(){return Jf=(0,p.Z)((0,v.Z)().mark((function e(t,n){var r,i,a,o;return(0,v.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Ch((r=Lr(t)).remoteStore)||Cr("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),e.prev=2,e.next=5,function(e){var t=Lr(e);return t.persistence.runTransaction("Get highest unacknowledged batch id","readonly",(function(e){return t.mutationQueue.getHighestUnacknowledgedBatchId(e)}))}(r.localStore);case 5:if(-1!==(i=e.sent)){e.next=8;break}return e.abrupt("return",void n.resolve());case 8:(a=r.lc.get(i)||[]).push(n),r.lc.set(i,a),e.next=16;break;case 12:e.prev=12,e.t0=e.catch(2),o=cf(e.t0,"Initialization of waitForPendingWrites() operation failed"),n.reject(o);case 16:case"end":return e.stop()}}),e,null,[[2,12]])}))),Jf.apply(this,arguments)}function Xf(e,t){(e.lc.get(t)||[]).forEach((function(e){e.resolve()})),e.lc.delete(t)}function $f(e,t,n){var r=Lr(e),i=r.hc[r.currentUser.toKey()];if(i){var a=i.get(t);a&&(n?a.reject(n):a.resolve(),i=i.remove(t)),r.hc[r.currentUser.toKey()]=i}}function ed(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;e.sharedClientState.removeLocalQueryTarget(t);var r,i=(0,u.Z)(e.rc.get(t));try{for(i.s();!(r=i.n()).done;){var a=r.value;e.ic.delete(a),n&&e.sc.wc(a,n)}}catch(o){i.e(o)}finally{i.f()}e.rc.delete(t),e.isPrimaryClient&&e.ac.ls(t).forEach((function(t){e.ac.containsKey(t)||td(e,t)}))}function td(e,t){e.oc.delete(t.path.canonicalString());var n=e.uc.get(t);null!==n&&(_h(e.remoteStore,n),e.uc=e.uc.remove(t),e.cc.delete(n),id(e))}function nd(e,t,n){var r,i=(0,u.Z)(n);try{for(i.s();!(r=i.n()).done;){var a=r.value;a instanceof Ef?(e.ac.addReference(a.key,t),rd(e,a)):a instanceof Sf?(Cr("SyncEngine","Document no longer in limbo: "+a.key),e.ac.removeReference(a.key,t),e.ac.containsKey(a.key)||td(e,a.key)):Or()}}catch(o){i.e(o)}finally{i.f()}}function rd(e,t){var n=t.key,r=n.path.canonicalString();e.uc.get(n)||e.oc.has(r)||(Cr("SyncEngine","New document in limbo: "+n),e.oc.add(r),id(e))}function id(e){for(;e.oc.size>0&&e.uc.size<e.maxConcurrentLimboResolutions;){var t=e.oc.values().next().value;e.oc.delete(t);var n=new ai(ni.fromString(t)),r=e.fc.next();e.cc.set(r,new Nf(n)),e.uc=e.uc.insert(n,r),xh(e.remoteStore,new Vs(ho(ao(n.path)),r,2,Ni.at))}}function ad(e,t,n){return od.apply(this,arguments)}function od(){return od=(0,p.Z)((0,v.Z)().mark((function e(t,n,r){var i,a,o,s;return(0,v.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=Lr(t),a=[],o=[],s=[],e.t0=i.ic.isEmpty(),e.t0){e.next=9;break}return i.ic.forEach((function(e,t){s.push(i._c(t,n,r).then((function(e){if((e||r)&&i.isPrimaryClient&&i.sharedClientState.updateQueryState(t.targetId,(null==e?void 0:e.fromCache)?"not-current":"current"),e){a.push(e);var n=El.Ci(t.targetId,e);o.push(n)}})))})),e.next=6,Promise.all(s);case 6:return i.sc.Wo(a),e.next=9,function(){var e=(0,p.Z)((0,v.Z)().mark((function e(t,n){var r,i,a,o,s,c,l,h;return(0,v.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=Lr(t),e.prev=1,e.next=4,r.persistence.runTransaction("notifyLocalViewChanges","readwrite",(function(e){return ki.forEach(n,(function(t){return ki.forEach(t.Si,(function(n){return r.persistence.referenceDelegate.addReference(e,t.targetId,n)})).next((function(){return ki.forEach(t.Di,(function(n){return r.persistence.referenceDelegate.removeReference(e,t.targetId,n)}))}))}))}));case 4:e.next=11;break;case 6:if(e.prev=6,e.t0=e.catch(1),xi(e.t0)){e.next=10;break}throw e.t0;case 10:Cr("LocalStore","Failed to update sequence numbers: "+e.t0);case 11:i=(0,u.Z)(n);try{for(i.s();!(a=i.n()).done;)o=a.value,s=o.targetId,o.fromCache||(c=r.qi.get(s),l=c.snapshotVersion,h=c.withLastLimboFreeSnapshotVersion(l),r.qi=r.qi.insert(s,h))}catch(f){i.e(f)}finally{i.f()}case 13:case"end":return e.stop()}}),e,null,[[1,6]])})));return function(t,n){return e.apply(this,arguments)}}()(i.localStore,o);case 9:case"end":return e.stop()}}),e)}))),od.apply(this,arguments)}function ud(e,t){return sd.apply(this,arguments)}function sd(){return sd=(0,p.Z)((0,v.Z)().mark((function e(t,n){var r,i;return(0,v.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((r=Lr(t)).currentUser.isEqual(n)){e.next=11;break}return Cr("SyncEngine","User change. New user:",n.toKey()),e.next=5,Nl(r.localStore,n);case 5:return i=e.sent,r.currentUser=n,function(e,t){e.lc.forEach((function(e){e.forEach((function(e){e.reject(new Fr(Mr.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))}))})),e.lc.clear()}(r),r.sharedClientState.handleUserChange(n,i.removedBatchIds,i.addedBatchIds),e.next=11,ad(r,i.ji);case 11:case"end":return e.stop()}}),e)}))),sd.apply(this,arguments)}function cd(e,t){var n=Lr(e),r=n.cc.get(t);if(r&&r.nc)return yu().add(r.key);var i=yu(),a=n.rc.get(t);if(!a)return i;var o,s=(0,u.Z)(a);try{for(s.s();!(o=s.n()).done;){var c=o.value,l=n.ic.get(c);i=i.unionWith(l.view.ju)}}catch(h){s.e(h)}finally{s.f()}return i}function ld(e,t){return hd.apply(this,arguments)}function hd(){return hd=(0,p.Z)((0,v.Z)().mark((function e(t,n){var r,i,a;return(0,v.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=Lr(t),e.next=3,ql(r.localStore,n.query,!0);case 3:return i=e.sent,a=n.view.tc(i),e.abrupt("return",(r.isPrimaryClient&&nd(r,n.targetId,a.Xu),a));case 6:case"end":return e.stop()}}),e)}))),hd.apply(this,arguments)}function fd(e,t){return dd.apply(this,arguments)}function dd(){return dd=(0,p.Z)((0,v.Z)().mark((function e(t,n){var r;return(0,v.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=Lr(t),e.abrupt("return",jl(r.localStore,n).then((function(e){return ad(r,e)})));case 2:case"end":return e.stop()}}),e)}))),dd.apply(this,arguments)}function vd(e,t,n,r){return pd.apply(this,arguments)}function pd(){return pd=(0,p.Z)((0,v.Z)().mark((function e(t,n,r,i){var a,o;return(0,v.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=Lr(t),e.next=3,function(e,t){var n=Lr(e),r=Lr(n.mutationQueue);return n.persistence.runTransaction("Lookup mutation documents","readonly",(function(e){return r.Tn(e,t).next((function(t){return t?n.localDocuments.getDocuments(e,t):ki.resolve(null)}))}))}(a.localStore,n);case 3:if(null===(o=e.sent)){e.next=15;break}if("pending"!==r){e.next=10;break}return e.next=8,qh(a.remoteStore);case 8:e.next=11;break;case 10:"acknowledged"===r||"rejected"===r?($f(a,n,i||null),Xf(a,n),function(e,t){Lr(Lr(e).mutationQueue).An(t)}(a.localStore,n)):Or();case 11:return e.next=13,ad(a,o);case 13:e.next=16;break;case 15:Cr("SyncEngine","Cannot apply mutation batch with id: "+n);case 16:case"end":return e.stop()}}),e)}))),pd.apply(this,arguments)}function yd(e,t){return md.apply(this,arguments)}function md(){return md=(0,p.Z)((0,v.Z)().mark((function e(t,n){var r,i,a,o,s,c,l,h;return(0,v.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Td(r=Lr(t)),Ed(r),!0!==n||!0===r.dc){e.next=13;break}return i=r.sharedClientState.getAllActiveQueryTargets(),e.next=5,gd(r,i.toArray());case 5:return a=e.sent,r.dc=!0,e.next=9,rf(r.remoteStore,!0);case 9:o=(0,u.Z)(a);try{for(o.s();!(s=o.n()).done;)c=s.value,xh(r.remoteStore,c)}catch(f){o.e(f)}finally{o.f()}e.next=25;break;case 13:if(!1!==n||!1===r.dc){e.next=25;break}return l=[],h=Promise.resolve(),r.rc.forEach((function(e,t){r.sharedClientState.isLocalQueryTarget(t)?l.push(t):h=h.then((function(){return ed(r,t),Vl(r.localStore,t,!0)})),_h(r.remoteStore,t)})),e.next=19,h;case 19:return e.next=21,gd(r,l);case 21:return function(e){var t=Lr(e);t.cc.forEach((function(e,n){_h(t.remoteStore,n)})),t.ac.fs(),t.cc=new Map,t.uc=new Va(ai.comparator)}(r),r.dc=!1,e.next=25,rf(r.remoteStore,!1);case 25:case"end":return e.stop()}}),e)}))),md.apply(this,arguments)}function gd(e,t,n){return kd.apply(this,arguments)}function kd(){return kd=(0,p.Z)((0,v.Z)().mark((function e(t,n,r){var i,a,o,s,c,l,h,f,d,p,y,m,g,k;return(0,v.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i=Lr(t),a=[],o=[],s=(0,u.Z)(n),e.prev=2,s.s();case 4:if((c=s.n()).done){e.next=45;break}if(l=c.value,h=void 0,!(f=i.rc.get(l))||0===f.length){e.next=34;break}return e.next=11,Fl(i.localStore,ho(f[0]));case 11:h=e.sent,d=(0,u.Z)(f),e.prev=13,d.s();case 15:if((p=d.n()).done){e.next=24;break}return y=p.value,m=i.ic.get(y),e.next=20,ld(i,m);case 20:(g=e.sent).snapshot&&o.push(g.snapshot);case 22:e.next=15;break;case 24:e.next=29;break;case 26:e.prev=26,e.t0=e.catch(13),d.e(e.t0);case 29:return e.prev=29,d.f(),e.finish(29);case 32:e.next=42;break;case 34:return e.next=36,Bl(i.localStore,l);case 36:return k=e.sent,e.next=39,Fl(i.localStore,k);case 39:return h=e.sent,e.next=42,Pf(i,wd(k),l,!1,h.resumeToken);case 42:a.push(h);case 43:e.next=4;break;case 45:e.next=50;break;case 47:e.prev=47,e.t1=e.catch(2),s.e(e.t1);case 50:return e.prev=50,s.f(),e.finish(50);case 53:return e.abrupt("return",(i.sc.Wo(o),a));case 54:case"end":return e.stop()}}),e,null,[[2,47,50,53],[13,26,29,32]])}))),kd.apply(this,arguments)}function wd(e){return io(e.path,e.collectionGroup,e.orderBy,e.filters,e.limit,"F",e.startAt,e.endAt)}function bd(e){var t=Lr(e);return Lr(Lr(t.localStore).persistence).vi()}function Zd(e,t,n,r){return Id.apply(this,arguments)}function Id(){return Id=(0,p.Z)((0,v.Z)().mark((function e(t,n,r,i){var a,o,u,s;return(0,v.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(a=Lr(t)).dc){e.next=3;break}return e.abrupt("return",void Cr("SyncEngine","Ignoring unexpected query state notification."));case 3:if(!((o=a.rc.get(n))&&o.length>0)){e.next=20;break}e.t0=r,e.next="current"===e.t0||"not-current"===e.t0?8:"rejected"===e.t0?15:19;break;case 8:return e.next=10,jl(a.localStore,ko(o[0]));case 10:return u=e.sent,s=ku.createSynthesizedRemoteEventForCurrentChange(n,"current"===r,Ui.EMPTY_BYTE_STRING),e.next=14,ad(a,u,s);case 14:return e.abrupt("break",20);case 15:return e.next=17,Vl(a.localStore,n,!0);case 17:return ed(a,n,i),e.abrupt("break",20);case 19:Or();case 20:case"end":return e.stop()}}),e)}))),Id.apply(this,arguments)}function xd(e,t,n){return _d.apply(this,arguments)}function _d(){return _d=(0,p.Z)((0,v.Z)().mark((function e(t,n,r){var i,a,o,s,c,l,h,f,d;return(0,v.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(i=Td(t)).dc){e.next=45;break}a=(0,u.Z)(n),e.prev=3,a.s();case 5:if((o=a.n()).done){e.next=21;break}if(s=o.value,!i.rc.has(s)){e.next=10;break}return Cr("SyncEngine","Adding an already active target "+s),e.abrupt("continue",19);case 10:return e.next=12,Bl(i.localStore,s);case 12:return c=e.sent,e.next=15,Fl(i.localStore,c);case 15:return l=e.sent,e.next=18,Pf(i,wd(c),l.targetId,!1,l.resumeToken);case 18:xh(i.remoteStore,l);case 19:e.next=5;break;case 21:e.next=26;break;case 23:e.prev=23,e.t0=e.catch(3),a.e(e.t0);case 26:return e.prev=26,a.f(),e.finish(26);case 29:h=(0,u.Z)(r),e.prev=30,d=(0,v.Z)().mark((function e(){var t;return(0,v.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=f.value,e.t0=i.rc.has(t),!e.t0){e.next=5;break}return e.next=5,Vl(i.localStore,t,!1).then((function(){_h(i.remoteStore,t),ed(i,t)})).catch(mi);case 5:case"end":return e.stop()}}),e)})),h.s();case 33:if((f=h.n()).done){e.next=37;break}return e.delegateYield(d(),"t1",35);case 35:e.next=33;break;case 37:e.next=42;break;case 39:e.prev=39,e.t2=e.catch(30),h.e(e.t2);case 42:return e.prev=42,h.f(),e.finish(42);case 45:case"end":return e.stop()}}),e,null,[[3,23,26,29],[30,39,42,45]])}))),_d.apply(this,arguments)}function Td(e){var t=Lr(e);return t.remoteStore.remoteSyncer.applyRemoteEvent=qf.bind(null,t),t.remoteStore.remoteSyncer.getRemoteKeysForTarget=cd.bind(null,t),t.remoteStore.remoteSyncer.rejectListen=Gf.bind(null,t),t.sc.Wo=kf.bind(null,t.eventManager),t.sc.wc=wf.bind(null,t.eventManager),t}function Ed(e){var t=Lr(e);return t.remoteStore.remoteSyncer.applySuccessfulWrite=zf.bind(null,t),t.remoteStore.remoteSyncer.rejectFailedWrite=Hf.bind(null,t),t}function Sd(e,t,n){var r=Lr(e);(function(){var e=(0,p.Z)((0,v.Z)().mark((function e(t,n,r){var i,a,o,u,s;return(0,v.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,n.getMetadata();case 3:return i=e.sent,e.next=6,function(e,t){var n=Lr(e),r=Pu(t.createTime);return n.persistence.runTransaction("hasNewerBundle","readonly",(function(e){return n.Ns.getBundleMetadata(e,t.id)})).then((function(e){return!!e&&e.createTime.compareTo(r)>=0}))}(t.localStore,i);case 6:if(!e.sent){e.next=11;break}return e.next=9,n.close();case 9:return r._completeWith(function(e){return{taskState:"Success",documentsLoaded:e.totalDocuments,bytesLoaded:e.totalBytes,totalDocuments:e.totalDocuments,totalBytes:e.totalBytes}}(i)),e.abrupt("return",Promise.resolve(new Set));case 11:return r._updateProgress(Tf(i)),a=new _f(i,t.localStore,n.yt),e.next=15,n.mc();case 15:o=e.sent;case 16:if(!o){e.next=26;break}return e.next=19,a.Fu(o);case 19:return(u=e.sent)&&r._updateProgress(u),e.next=23,n.mc();case 23:o=e.sent;case 24:e.next=16;break;case 26:return e.next=28,a.complete();case 28:return s=e.sent,e.next=31,ad(t,s.Lu,void 0);case 31:return e.next=33,function(e,t){var n=Lr(e);return n.persistence.runTransaction("Save bundle","readwrite",(function(e){return n.Ns.saveBundleMetadata(e,t)}))}(t.localStore,i);case 33:return r._completeWith(s.progress),e.abrupt("return",Promise.resolve(s.Bu));case 37:return e.prev=37,e.t0=e.catch(0),e.abrupt("return",(Dr("SyncEngine","Loading bundle failed with ".concat(e.t0)),r._failWith(e.t0),Promise.resolve(new Set)));case 40:case"end":return e.stop()}}),e,null,[[0,37]])})));return function(t,n,r){return e.apply(this,arguments)}})()(r,t,n).then((function(e){r.sharedClientState.notifyBundleLoaded(e)}))}var Ad=function(){function e(){(0,s.Z)(this,e),this.synchronizeTabs=!1}return(0,c.Z)(e,[{key:"initialize",value:function(){var e=(0,p.Z)((0,v.Z)().mark((function e(t){return(0,v.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.yt=fh(t.databaseInfo.databaseId),this.sharedClientState=this.gc(t),this.persistence=this.yc(t),e.next=5,this.persistence.start();case 5:this.localStore=this.Ic(t),this.gcScheduler=this.Tc(t,this.localStore),this.indexBackfillerScheduler=this.Ec(t,this.localStore);case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"Tc",value:function(e,t){return null}},{key:"Ec",value:function(e,t){return null}},{key:"Ic",value:function(e){return Cl(this.persistence,new Sl,e.initialUser,this.yt)}},{key:"yc",value:function(e){return new ml(kl.Bs,this.yt)}},{key:"gc",value:function(e){return new ih}},{key:"terminate",value:function(){var e=(0,p.Z)((0,v.Z)().mark((function e(){return(0,v.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.gcScheduler&&this.gcScheduler.stop(),e.next=3,this.sharedClientState.shutdown();case 3:return e.next=5,this.persistence.shutdown();case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),e}(),Cd=function(e){(0,a.Z)(n,e);var t=(0,o.Z)(n);function n(e,r,i){var a;return(0,s.Z)(this,n),(a=t.call(this)).Ac=e,a.cacheSizeBytes=r,a.forceOwnership=i,a.synchronizeTabs=!1,a}return(0,c.Z)(n,[{key:"initialize",value:function(){var e=(0,p.Z)((0,v.Z)().mark((function e(t){var r=this;return(0,v.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,h.Z)((0,f.Z)(n.prototype),"initialize",this).call(this,t);case 2:return e.next=4,this.Ac.initialize(this,t);case 4:return e.next=6,Ed(this.Ac.syncEngine);case 6:return e.next=8,qh(this.Ac.remoteStore);case 8:return e.next=10,this.persistence.li((function(){return r.gcScheduler&&!r.gcScheduler.started&&r.gcScheduler.start(),r.indexBackfillerScheduler&&!r.indexBackfillerScheduler.started&&r.indexBackfillerScheduler.start(),Promise.resolve()}));case 10:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"Ic",value:function(e){return Cl(this.persistence,new Sl,e.initialUser,this.yt)}},{key:"Tc",value:function(e,t){var n=this.persistence.referenceDelegate.garbageCollector;return new Hc(n,e.asyncQueue,t)}},{key:"Ec",value:function(e,t){var n=new Ci(t,this.persistence);return new Ai(e.asyncQueue,n)}},{key:"yc",value:function(e){var t=Tl(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),n=void 0!==this.cacheSizeBytes?Rc.withCacheSize(this.cacheSizeBytes):Rc.DEFAULT;return new Il(this.synchronizeTabs,t,e.clientId,n,e.asyncQueue,lh(),hh(),this.yt,this.sharedClientState,!!this.forceOwnership)}},{key:"gc",value:function(e){return new ih}}]),n}(Ad),Nd=function(e){(0,a.Z)(n,e);var t=(0,o.Z)(n);function n(e,r){var i;return(0,s.Z)(this,n),(i=t.call(this,e,r,!1)).Ac=e,i.cacheSizeBytes=r,i.synchronizeTabs=!0,i}return(0,c.Z)(n,[{key:"initialize",value:function(){var e=(0,p.Z)((0,v.Z)().mark((function e(t){var r,i=this;return(0,v.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,h.Z)((0,f.Z)(n.prototype),"initialize",this).call(this,t);case 2:if(r=this.Ac.syncEngine,e.t0=this.sharedClientState instanceof rh,!e.t0){e.next=8;break}return this.sharedClientState.syncEngine={Fr:vd.bind(null,r),$r:Zd.bind(null,r),Br:xd.bind(null,r),vi:bd.bind(null,r),Mr:fd.bind(null,r)},e.next=8,this.sharedClientState.start();case 8:return e.next=10,this.persistence.li(function(){var e=(0,p.Z)((0,v.Z)().mark((function e(t){return(0,v.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,yd(i.Ac.syncEngine,t);case 2:i.gcScheduler&&(t&&!i.gcScheduler.started?i.gcScheduler.start():t||i.gcScheduler.stop()),i.indexBackfillerScheduler&&(t&&!i.indexBackfillerScheduler.started?i.indexBackfillerScheduler.start():t||i.indexBackfillerScheduler.stop());case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 10:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"gc",value:function(e){var t=lh();if(!rh.C(t))throw new Fr(Mr.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");var n=Tl(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new rh(t,e.asyncQueue,n,e.clientId,e.initialUser)}}]),n}(Cd),Dd=function(){function e(){(0,s.Z)(this,e)}return(0,c.Z)(e,[{key:"initialize",value:function(){var e=(0,p.Z)((0,v.Z)().mark((function e(t,n){var r=this;return(0,v.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=this.localStore,e.t0){e.next=12;break}return this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=function(e){return jf(r.syncEngine,e,1)},this.remoteStore.remoteSyncer.handleCredentialChange=ud.bind(null,this.syncEngine),e.next=12,rf(this.remoteStore,this.syncEngine.isPrimaryClient);case 12:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"createEventManager",value:function(e){return new vf}},{key:"createDatastore",value:function(e){var t,n=fh(e.databaseInfo.databaseId),r=(t=e.databaseInfo,new ch(t));return function(e,t,n,r){return new mh(e,t,n,r)}(e.authCredentials,e.appCheckCredentials,r,n)}},{key:"createRemoteStore",value:function(e){var t,n,r,i,a,o=this;return t=this.localStore,n=this.datastore,r=e.asyncQueue,i=function(e){return jf(o.syncEngine,e,0)},a=oh.C()?new oh:new ah,new kh(t,n,r,i,a)}},{key:"createSyncEngine",value:function(e,t){return function(e,t,n,r,i,a,o){var u=new Df(e,t,n,r,i,a);return o&&(u.dc=!0),u}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}},{key:"terminate",value:function(){return function(){var e=(0,p.Z)((0,v.Z)().mark((function e(t){var n;return(0,v.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=Lr(t),Cr("RemoteStore","RemoteStore shutting down."),n._u.add(5),e.next=5,Zh(n);case 5:n.mu.shutdown(),n.gu.set("Unknown");case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()(this.remoteStore)}}]),e}();function Rd(e,t,n){if(!n)throw new Fr(Mr.INVALID_ARGUMENT,"Function ".concat(e,"() cannot be called with an empty ").concat(t,"."))}function Od(e,t,n,r){if(!0===t&&!0===r)throw new Fr(Mr.INVALID_ARGUMENT,"".concat(e," and ").concat(n," cannot be used together."))}function Pd(e){if(!ai.isDocumentKey(e))throw new Fr(Mr.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but ".concat(e," has ").concat(e.length,"."))}function Ld(e){if(ai.isDocumentKey(e))throw new Fr(Mr.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but ".concat(e," has ").concat(e.length,"."))}function Md(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return e.length>20&&(e="".concat(e.substring(0,20),"...")),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"==typeof e){if(e instanceof Array)return"an array";var t=function(e){return e.constructor?e.constructor.name:null}(e);return t?"a custom ".concat(t," object"):"an object"}return"function"==typeof e?"a function":Or()}function Fd(e,t){if("_delegate"in e&&(e=e._delegate),!(e instanceof t)){if(t.name===e.constructor.name)throw new Fr(Mr.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");var n=Md(e);throw new Fr(Mr.INVALID_ARGUMENT,"Expected type '".concat(t.name,"', but it was: ").concat(n))}return e}function Vd(e,t){if(t<=0)throw new Fr(Mr.INVALID_ARGUMENT,"Function ".concat(e,"() requires a positive number, but it was: ").concat(t,"."))}var Ud=new Map,qd=function(){function e(t){var n;if((0,s.Z)(this,e),void 0===t.host){if(void 0!==t.ssl)throw new Fr(Mr.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=t.host,this.ssl=null===(n=t.ssl)||void 0===n||n;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,void 0===t.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==t.cacheSizeBytes&&t.cacheSizeBytes<1048576)throw new Fr(Mr.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,this.useFetchStreams=!!t.useFetchStreams,Od("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling)}return(0,c.Z)(e,[{key:"isEqual",value:function(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}]),e}(),Bd=function(){function e(t,n,r,i){(0,s.Z)(this,e),this._authCredentials=t,this._appCheckCredentials=n,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new qd({}),this._settingsFrozen=!1}return(0,c.Z)(e,[{key:"app",get:function(){if(!this._app)throw new Fr(Mr.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}},{key:"_initialized",get:function(){return this._settingsFrozen}},{key:"_terminated",get:function(){return void 0!==this._terminateTask}},{key:"_setSettings",value:function(e){if(this._settingsFrozen)throw new Fr(Mr.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new qd(e),void 0!==e.credentials&&(this._authCredentials=function(e){if(!e)return new qr;switch(e.type){case"gapi":var t=e.client;return new Kr(t,e.sessionIndex||"0",e.iamToken||null,e.authTokenFactory||null);case"provider":return e.client;default:throw new Fr(Mr.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}},{key:"_getSettings",value:function(){return this._settings}},{key:"_freezeSettings",value:function(){return this._settingsFrozen=!0,this._settings}},{key:"_delete",value:function(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}},{key:"toJSON",value:function(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}},{key:"_terminate",value:function(){return function(e){var t=Ud.get(e);t&&(Cr("ComponentProvider","Removing Datastore"),Ud.delete(e),t.terminate())}(this),Promise.resolve()}}]),e}();function jd(e,t,n){var r,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},a=(e=Fd(e,Bd))._getSettings();if("firestore.googleapis.com"!==a.host&&a.host!==t&&Dr("Host has been set in both settings() and useEmulator(), emulator host will be used"),e._setSettings(Object.assign(Object.assign({},a),{host:"".concat(t,":").concat(n),ssl:!1})),i.mockUserToken){var o,u;if("string"==typeof i.mockUserToken)o=i.mockUserToken,u=Tr.MOCK_USER;else{o=(0,w.Sg)(i.mockUserToken,null===(r=e._app)||void 0===r?void 0:r.options.projectId);var s=i.mockUserToken.sub||i.mockUserToken.user_id;if(!s)throw new Fr(Mr.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");u=new Tr(s)}e._authCredentials=new Br(new Ur(o,u))}}var Gd=function(){function e(t,n,r){(0,s.Z)(this,e),this.converter=n,this._key=r,this.type="document",this.firestore=t}return(0,c.Z)(e,[{key:"_path",get:function(){return this._key.path}},{key:"id",get:function(){return this._key.path.lastSegment()}},{key:"path",get:function(){return this._key.path.canonicalString()}},{key:"parent",get:function(){return new zd(this.firestore,this.converter,this._key.path.popLast())}},{key:"withConverter",value:function(t){return new e(this.firestore,t,this._key)}}]),e}(),Kd=function(){function e(t,n,r){(0,s.Z)(this,e),this.converter=n,this._query=r,this.type="query",this.firestore=t}return(0,c.Z)(e,[{key:"withConverter",value:function(t){return new e(this.firestore,t,this._query)}}]),e}(),zd=function(e){(0,a.Z)(n,e);var t=(0,o.Z)(n);function n(e,r,i){var a;return(0,s.Z)(this,n),(a=t.call(this,e,r,ao(i)))._path=i,a.type="collection",a}return(0,c.Z)(n,[{key:"id",get:function(){return this._query.path.lastSegment()}},{key:"path",get:function(){return this._query.path.canonicalString()}},{key:"parent",get:function(){var e=this._path.popLast();return e.isEmpty()?null:new Gd(this.firestore,null,new ai(e))}},{key:"withConverter",value:function(e){return new n(this.firestore,e,this._path)}}]),n}(Kd);function Wd(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];if(e=(0,w.m9)(e),Rd("collection","path",t),e instanceof Bd){var a=ni.fromString.apply(ni,[t].concat(r));return Ld(a),new zd(e,null,a)}if(!(e instanceof Gd||e instanceof zd))throw new Fr(Mr.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");var o=e._path.child(ni.fromString.apply(ni,[t].concat(r)));return Ld(o),new zd(e.firestore,null,o)}function Hd(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];if(e=(0,w.m9)(e),1===arguments.length&&(t=Qr.R()),Rd("doc","path",t),e instanceof Bd){var a=ni.fromString.apply(ni,[t].concat(r));return Pd(a),new Gd(e,null,new ai(a))}if(!(e instanceof Gd||e instanceof zd))throw new Fr(Mr.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");var o=e._path.child(ni.fromString.apply(ni,[t].concat(r)));return Pd(o),new Gd(e.firestore,e instanceof zd?e.converter:null,new ai(o))}function Qd(e,t){return e=(0,w.m9)(e),t=(0,w.m9)(t),(e instanceof Gd||e instanceof zd)&&(t instanceof Gd||t instanceof zd)&&e.firestore===t.firestore&&e.path===t.path&&e.converter===t.converter}function Yd(e,t){return e=(0,w.m9)(e),t=(0,w.m9)(t),e instanceof Kd&&t instanceof Kd&&e.firestore===t.firestore&&po(e._query,t._query)&&e.converter===t.converter}function Jd(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10240,n=0;return{read:function(){return(0,p.Z)((0,v.Z)().mark((function r(){var i;return(0,v.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(!(n<e.byteLength)){r.next=3;break}return i={value:e.slice(n,n+t),done:!1},r.abrupt("return",(n+=t,i));case 3:return r.abrupt("return",{done:!0});case 4:case"end":return r.stop()}}),r)})))()},cancel:function(){return(0,p.Z)((0,v.Z)().mark((function e(){return(0,v.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})))()},releaseLock:function(){},closed:Promise.reject("unimplemented")}}var Xd=function(){function e(t){(0,s.Z)(this,e),this.observer=t,this.muted=!1}return(0,c.Z)(e,[{key:"next",value:function(e){this.observer.next&&this.Rc(this.observer.next,e)}},{key:"error",value:function(e){this.observer.error?this.Rc(this.observer.error,e):Nr("Uncaught Error in snapshot listener:",e.toString())}},{key:"bc",value:function(){this.muted=!0}},{key:"Rc",value:function(e,t){var n=this;this.muted||setTimeout((function(){n.muted||e(t)}),0)}}]),e}(),$d=function(){function e(t,n){var r=this;(0,s.Z)(this,e),this.Pc=t,this.yt=n,this.metadata=new Vr,this.buffer=new Uint8Array,this.vc=new TextDecoder("utf-8"),this.Vc().then((function(e){e&&e.Ou()?r.metadata.resolve(e.ku.metadata):r.metadata.reject(new Error("The first element of the bundle is not a metadata, it is\n             ".concat(JSON.stringify(null==e?void 0:e.ku))))}),(function(e){return r.metadata.reject(e)}))}return(0,c.Z)(e,[{key:"close",value:function(){return this.Pc.cancel()}},{key:"getMetadata",value:function(){var e=(0,p.Z)((0,v.Z)().mark((function e(){return(0,v.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.metadata.promise);case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"mc",value:function(){var e=(0,p.Z)((0,v.Z)().mark((function e(){return(0,v.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getMetadata();case 2:return e.abrupt("return",this.Vc());case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"Vc",value:function(){var e=(0,p.Z)((0,v.Z)().mark((function e(){var t,n,r,i;return(0,v.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.Sc();case 2:if(null!==(t=e.sent)){e.next=5;break}return e.abrupt("return",null);case 5:return n=this.vc.decode(t),r=Number(n),isNaN(r)&&this.Dc("length string (".concat(n,") is not valid number")),e.next=9,this.Cc(r);case 9:return i=e.sent,e.abrupt("return",new If(JSON.parse(i),t.length+r));case 11:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"xc",value:function(){return this.buffer.findIndex((function(e){return e==="{".charCodeAt(0)}))}},{key:"Sc",value:function(){var e=(0,p.Z)((0,v.Z)().mark((function e(){var t,n;return(0,v.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(this.xc()<0)){e.next=7;break}return e.next=3,this.Nc();case 3:if(!e.sent){e.next=5;break}return e.abrupt("break",7);case 5:e.next=0;break;case 7:if(0!==this.buffer.length){e.next=9;break}return e.abrupt("return",null);case 9:return(t=this.xc())<0&&this.Dc("Reached the end of bundle when a length string is expected."),n=this.buffer.slice(0,t),e.abrupt("return",(this.buffer=this.buffer.slice(t),n));case 13:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"Cc",value:function(){var e=(0,p.Z)((0,v.Z)().mark((function e(t){var n;return(0,v.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(this.buffer.length<t)){e.next=8;break}return e.next=3,this.Nc();case 3:if(e.t0=e.sent,!e.t0){e.next=6;break}this.Dc("Reached the end of bundle when more is expected.");case 6:e.next=0;break;case 8:return n=this.vc.decode(this.buffer.slice(0,t)),e.abrupt("return",(this.buffer=this.buffer.slice(t),n));case 10:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"Dc",value:function(e){throw this.Pc.cancel(),new Error("Invalid bundle format: ".concat(e))}},{key:"Nc",value:function(){var e=(0,p.Z)((0,v.Z)().mark((function e(){var t,n;return(0,v.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.Pc.read();case 2:return(t=e.sent).done||((n=new Uint8Array(this.buffer.length+t.value.length)).set(this.buffer),n.set(t.value,this.buffer.length),this.buffer=n),e.abrupt("return",t.done);case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),e}(),ev=function(){function e(t){(0,s.Z)(this,e),this.datastore=t,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastWriteError=null,this.writtenDocs=new Set}return(0,c.Z)(e,[{key:"lookup",value:function(){var e=(0,p.Z)((0,v.Z)().mark((function e(t){var n,r=this;return(0,v.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.ensureCommitNotCalled(),!(this.mutations.length>0)){e.next=2;break}throw new Fr(Mr.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");case 2:return e.next=4,function(){var e=(0,p.Z)((0,v.Z)().mark((function e(t,n){var r,i,a,o,u,s;return(0,v.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=Lr(t),i=Bu(r.yt)+"/documents",a={documents:n.map((function(e){return Fu(r.yt,e)}))},e.next=5,r._o("BatchGetDocuments",i,a,n.length);case 5:return o=e.sent,u=new Map,o.forEach((function(e){var t=zu(r.yt,e);u.set(t.key.toString(),t)})),s=[],e.abrupt("return",(n.forEach((function(e){var t=u.get(e.toString());Pr(!!t),s.push(t)})),s));case 10:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()(this.datastore,t);case 4:return n=e.sent,e.abrupt("return",(n.forEach((function(e){return r.recordVersion(e)})),n));case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"set",value:function(e,t){this.write(t.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}},{key:"update",value:function(e,t){try{this.write(t.toMutation(e,this.preconditionForUpdate(e)))}catch(e){this.lastWriteError=e}this.writtenDocs.add(e.toString())}},{key:"delete",value:function(e){this.write(new eu(e,this.precondition(e))),this.writtenDocs.add(e.toString())}},{key:"commit",value:function(){var e=(0,p.Z)((0,v.Z)().mark((function e(){var t,n=this;return(0,v.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.ensureCommitNotCalled(),!this.lastWriteError){e.next=2;break}throw this.lastWriteError;case 2:return t=this.readVersions,this.mutations.forEach((function(e){t.delete(e.key.toString())})),t.forEach((function(e,t){var r=ai.fromPath(t);n.mutations.push(new tu(r,n.precondition(r)))})),e.next=7,function(){var e=(0,p.Z)((0,v.Z)().mark((function e(t,n){var r,i,a;return(0,v.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=Lr(t),i=Bu(r.yt)+"/documents",a={writes:n.map((function(e){return Wu(r.yt,e)}))},e.next=3,r.ao("Commit",i,a);case 3:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()(this.datastore,this.mutations);case 7:this.committed=!0;case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"recordVersion",value:function(e){var t;if(e.isFoundDocument())t=e.version;else{if(!e.isNoDocument())throw Or();t=ei.min()}var n=this.readVersions.get(e.key.toString());if(n){if(!t.isEqual(n))throw new Fr(Mr.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),t)}},{key:"precondition",value:function(e){var t=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&t?t.isEqual(ei.min())?Vo.exists(!1):Vo.updateTime(t):Vo.none()}},{key:"preconditionForUpdate",value:function(e){var t=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&t){if(t.isEqual(ei.min()))throw new Fr(Mr.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Vo.updateTime(t)}return Vo.exists(!0)}},{key:"write",value:function(e){this.ensureCommitNotCalled(),this.mutations.push(e)}},{key:"ensureCommitNotCalled",value:function(){}}]),e}(),tv=function(){function e(t,n,r,i,a){(0,s.Z)(this,e),this.asyncQueue=t,this.datastore=n,this.options=r,this.updateFunction=i,this.deferred=a,this.kc=r.maxAttempts,this.xo=new dh(this.asyncQueue,"transaction_retry")}return(0,c.Z)(e,[{key:"run",value:function(){this.kc-=1,this.Oc()}},{key:"Oc",value:function(){var e=this;this.xo.Ro((0,p.Z)((0,v.Z)().mark((function t(){var n,r;return(0,v.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=new ev(e.datastore),(r=e.Mc(n))&&r.then((function(t){e.asyncQueue.enqueueAndForget((function(){return n.commit().then((function(){e.deferred.resolve(t)})).catch((function(t){e.Fc(t)}))}))})).catch((function(t){e.Fc(t)}));case 2:case"end":return t.stop()}}),t)}))))}},{key:"Mc",value:function(e){try{var t=this.updateFunction(e);return!Mi(t)&&t.catch&&t.then?t:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(e){return this.deferred.reject(e),null}}},{key:"Fc",value:function(e){var t=this;this.kc>0&&this.$c(e)?(this.kc-=1,this.asyncQueue.enqueueAndForget((function(){return t.Oc(),Promise.resolve()}))):this.deferred.reject(e)}},{key:"$c",value:function(e){if("FirebaseError"===e.name){var t=e.code;return"aborted"===t||"failed-precondition"===t||"already-exists"===t||!ru(t)}return!1}}]),e}(),nv=function(){function e(t,n,r,i){var a=this;(0,s.Z)(this,e),this.authCredentials=t,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=i,this.user=Tr.UNAUTHENTICATED,this.clientId=Qr.R(),this.authCredentialListener=function(){return Promise.resolve()},this.appCheckCredentialListener=function(){return Promise.resolve()},this.authCredentials.start(r,function(){var e=(0,p.Z)((0,v.Z)().mark((function e(t){return(0,v.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Cr("FirestoreClient","Received user=",t.uid),e.next=3,a.authCredentialListener(t);case 3:a.user=t;case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),this.appCheckCredentials.start(r,(function(e){return Cr("FirestoreClient","Received new app check token=",e),a.appCheckCredentialListener(e,a.user)}))}return(0,c.Z)(e,[{key:"getConfiguration",value:function(){var e=(0,p.Z)((0,v.Z)().mark((function e(){return(0,v.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100});case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"setCredentialChangeListener",value:function(e){this.authCredentialListener=e}},{key:"setAppCheckTokenChangeListener",value:function(e){this.appCheckCredentialListener=e}},{key:"verifyNotTerminated",value:function(){if(this.asyncQueue.isShuttingDown)throw new Fr(Mr.FAILED_PRECONDITION,"The client has already been terminated.")}},{key:"terminate",value:function(){var e=this;this.asyncQueue.enterRestrictedMode();var t=new Vr;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((0,p.Z)((0,v.Z)().mark((function n(){var r;return(0,v.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(n.prev=0,n.t0=e.onlineComponents,!n.t0){n.next=5;break}return n.next=5,e.onlineComponents.terminate();case 5:if(n.t1=e.offlineComponents,!n.t1){n.next=9;break}return n.next=9,e.offlineComponents.terminate();case 9:e.authCredentials.shutdown(),e.appCheckCredentials.shutdown(),t.resolve(),n.next=18;break;case 14:n.prev=14,n.t2=n.catch(0),r=cf(n.t2,"Failed to shutdown persistence"),t.reject(r);case 18:case"end":return n.stop()}}),n,null,[[0,14]])})))),t.promise}}]),e}();function rv(e,t){return iv.apply(this,arguments)}function iv(){return iv=(0,p.Z)((0,v.Z)().mark((function e(t,n){var r,i;return(0,v.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.asyncQueue.verifyOperationInProgress(),Cr("FirestoreClient","Initializing OfflineComponentProvider"),e.next=3,t.getConfiguration();case 3:return r=e.sent,e.next=6,n.initialize(r);case 6:i=r.initialUser,t.setCredentialChangeListener(function(){var e=(0,p.Z)((0,v.Z)().mark((function e(t){return(0,v.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=i.isEqual(t),e.t0){e.next=5;break}return e.next=4,Nl(n.localStore,t);case 4:i=t;case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),n.persistence.setDatabaseDeletedListener((function(){return t.terminate()})),t.offlineComponents=n;case 8:case"end":return e.stop()}}),e)}))),iv.apply(this,arguments)}function av(e,t){return ov.apply(this,arguments)}function ov(){return ov=(0,p.Z)((0,v.Z)().mark((function e(t,n){var r,i;return(0,v.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.asyncQueue.verifyOperationInProgress(),e.next=3,uv(t);case 3:return r=e.sent,Cr("FirestoreClient","Initializing OnlineComponentProvider"),e.next=7,t.getConfiguration();case 7:return i=e.sent,e.next=10,n.initialize(r,i);case 10:t.setCredentialChangeListener((function(e){return tf(n.remoteStore,e)})),t.setAppCheckTokenChangeListener((function(e,t){return tf(n.remoteStore,t)})),t.onlineComponents=n;case 13:case"end":return e.stop()}}),e)}))),ov.apply(this,arguments)}function uv(e){return sv.apply(this,arguments)}function sv(){return sv=(0,p.Z)((0,v.Z)().mark((function e(t){return(0,v.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=t.offlineComponents,e.t0){e.next=5;break}return Cr("FirestoreClient","Using default OfflineComponentProvider"),e.next=5,rv(t,new Ad);case 5:return e.abrupt("return",t.offlineComponents);case 6:case"end":return e.stop()}}),e)}))),sv.apply(this,arguments)}function cv(e){return lv.apply(this,arguments)}function lv(){return lv=(0,p.Z)((0,v.Z)().mark((function e(t){return(0,v.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=t.onlineComponents,e.t0){e.next=5;break}return Cr("FirestoreClient","Using default OnlineComponentProvider"),e.next=5,av(t,new Dd);case 5:return e.abrupt("return",t.onlineComponents);case 6:case"end":return e.stop()}}),e)}))),lv.apply(this,arguments)}function hv(e){return uv(e).then((function(e){return e.persistence}))}function fv(e){return uv(e).then((function(e){return e.localStore}))}function dv(e){return cv(e).then((function(e){return e.remoteStore}))}function vv(e){return cv(e).then((function(e){return e.syncEngine}))}function pv(e){return cv(e).then((function(e){return e.datastore}))}function yv(e){return mv.apply(this,arguments)}function mv(){return mv=(0,p.Z)((0,v.Z)().mark((function e(t){var n,r;return(0,v.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,cv(t);case 2:return n=e.sent,r=n.eventManager,e.abrupt("return",(r.onListen=Rf.bind(null,n.syncEngine),r.onUnlisten=Mf.bind(null,n.syncEngine),r));case 5:case"end":return e.stop()}}),e)}))),mv.apply(this,arguments)}function gv(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=new Vr;return e.asyncQueue.enqueueAndForget((0,p.Z)((0,v.Z)().mark((function i(){return(0,v.Z)().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.t0=function(e,t,n,r,i){var a=new Xd({next:function(a){t.enqueueAndForget((function(){return mf(e,o)}));var u=a.docs.has(n);!u&&a.fromCache?i.reject(new Fr(Mr.UNAVAILABLE,"Failed to get document because the client is offline.")):u&&a.fromCache&&r&&"server"===r.source?i.reject(new Fr(Mr.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):i.resolve(a)},error:function(e){return i.reject(e)}}),o=new Zf(ao(n.path),a,{includeMetadataChanges:!0,Nu:!0});return pf(e,o)},i.next=3,yv(e);case 3:return i.t1=i.sent,i.t2=e.asyncQueue,i.t3=t,i.t4=n,i.t5=r,i.abrupt("return",(0,i.t0)(i.t1,i.t2,i.t3,i.t4,i.t5));case 9:case"end":return i.stop()}}),i)})))),r.promise}function kv(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=new Vr;return e.asyncQueue.enqueueAndForget((0,p.Z)((0,v.Z)().mark((function i(){return(0,v.Z)().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.t0=function(e,t,n,r,i){var a=new Xd({next:function(n){t.enqueueAndForget((function(){return mf(e,o)})),n.fromCache&&"server"===r.source?i.reject(new Fr(Mr.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(n)},error:function(e){return i.reject(e)}}),o=new Zf(n,a,{includeMetadataChanges:!0,Nu:!0});return pf(e,o)},i.next=3,yv(e);case 3:return i.t1=i.sent,i.t2=e.asyncQueue,i.t3=t,i.t4=n,i.t5=r,i.abrupt("return",(0,i.t0)(i.t1,i.t2,i.t3,i.t4,i.t5));case 9:case"end":return i.stop()}}),i)})))),r.promise}var wv=function(){function e(){var t=this;(0,s.Z)(this,e),this.Bc=Promise.resolve(),this.Lc=[],this.qc=!1,this.Uc=[],this.Kc=null,this.Gc=!1,this.Qc=!1,this.jc=[],this.xo=new dh(this,"async_queue_retry"),this.Wc=function(){var e=hh();e&&Cr("AsyncQueue","Visibility state changed to "+e.visibilityState),t.xo.Po()};var n=hh();n&&"function"==typeof n.addEventListener&&n.addEventListener("visibilitychange",this.Wc)}return(0,c.Z)(e,[{key:"isShuttingDown",get:function(){return this.qc}},{key:"enqueueAndForget",value:function(e){this.enqueue(e)}},{key:"enqueueAndForgetEvenWhileRestricted",value:function(e){this.zc(),this.Hc(e)}},{key:"enterRestrictedMode",value:function(e){if(!this.qc){this.qc=!0,this.Qc=e||!1;var t=hh();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.Wc)}}},{key:"enqueue",value:function(e){var t=this;if(this.zc(),this.qc)return new Promise((function(){}));var n=new Vr;return this.Hc((function(){return t.qc&&t.Qc?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)})).then((function(){return n.promise}))}},{key:"enqueueRetryable",value:function(e){var t=this;this.enqueueAndForget((function(){return t.Lc.push(e),t.Jc()}))}},{key:"Jc",value:function(){var e=(0,p.Z)((0,v.Z)().mark((function e(){var t=this;return(0,v.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0===this.Lc.length){e.next=14;break}return e.prev=1,e.next=4,this.Lc[0]();case 4:this.Lc.shift(),this.xo.reset(),e.next=13;break;case 8:if(e.prev=8,e.t0=e.catch(1),xi(e.t0)){e.next=12;break}throw e.t0;case 12:Cr("AsyncQueue","Operation failed with retryable error: "+e.t0);case 13:this.Lc.length>0&&this.xo.Ro((function(){return t.Jc()}));case 14:case"end":return e.stop()}}),e,this,[[1,8]])})));return function(){return e.apply(this,arguments)}}()},{key:"Hc",value:function(e){var t=this,n=this.Bc.then((function(){return t.Gc=!0,e().catch((function(e){t.Kc=e,t.Gc=!1;var n=function(e){var t=e.message||"";return e.stack&&(t=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),t}(e);throw Nr("INTERNAL UNHANDLED ERROR: ",n),e})).then((function(e){return t.Gc=!1,e}))}));return this.Bc=n,n}},{key:"enqueueAfterDelay",value:function(e,t,n){var r=this;this.zc(),this.jc.indexOf(e)>-1&&(t=0);var i=sf.createAndSchedule(this,e,t,n,(function(e){return r.Yc(e)}));return this.Uc.push(i),i}},{key:"zc",value:function(){this.Kc&&Or()}},{key:"verifyOperationInProgress",value:function(){}},{key:"Xc",value:function(){var e=(0,p.Z)((0,v.Z)().mark((function e(){var t;return(0,v.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.Bc,e.next=3,t;case 3:if(t!==this.Bc){e.next=0;break}case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"Zc",value:function(e){var t,n=(0,u.Z)(this.Uc);try{for(n.s();!(t=n.n()).done;){if(t.value.timerId===e)return!0}}catch(r){n.e(r)}finally{n.f()}return!1}},{key:"ta",value:function(e){var t=this;return this.Xc().then((function(){t.Uc.sort((function(e,t){return e.targetTimeMs-t.targetTimeMs}));var n,r=(0,u.Z)(t.Uc);try{for(r.s();!(n=r.n()).done;){var i=n.value;if(i.skipDelay(),"all"!==e&&i.timerId===e)break}}catch(a){r.e(a)}finally{r.f()}return t.Xc()}))}},{key:"ea",value:function(e){this.jc.push(e)}},{key:"Yc",value:function(e){var t=this.Uc.indexOf(e);this.Uc.splice(t,1)}}]),e}();function bv(e){return function(e,t){if("object"!=typeof e||null===e)return!1;var n,r=e,i=(0,u.Z)(["next","error","complete"]);try{for(i.s();!(n=i.n()).done;){var a=n.value;if(a in r&&"function"==typeof r[a])return!0}}catch(o){i.e(o)}finally{i.f()}return!1}(e)}var Zv=function(){function e(){(0,s.Z)(this,e),this._progressObserver={},this._taskCompletionResolver=new Vr,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}return(0,c.Z)(e,[{key:"onProgress",value:function(e,t,n){this._progressObserver={next:e,error:t,complete:n}}},{key:"catch",value:function(e){return this._taskCompletionResolver.promise.catch(e)}},{key:"then",value:function(e,t){return this._taskCompletionResolver.promise.then(e,t)}},{key:"_completeWith",value:function(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}},{key:"_failWith",value:function(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}},{key:"_updateProgress",value:function(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}}]),e}(),Iv=function(e){(0,a.Z)(n,e);var t=(0,o.Z)(n);function n(e,r,i,a){var o;return(0,s.Z)(this,n),(o=t.call(this,e,r,i,a)).type="firestore",o._queue=new wv,o._persistenceKey=(null==a?void 0:a.name)||"[DEFAULT]",o}return(0,c.Z)(n,[{key:"_terminate",value:function(){return this._firestoreClient||_v(this),this._firestoreClient.terminate()}}]),n}(Bd);function xv(e){return e._firestoreClient||_v(e),e._firestoreClient.verifyNotTerminated(),e._firestoreClient}function _v(e){var t,n=e._freezeSettings(),r=function(e,t,n,r){return new Di(e,t,n,r.host,r.ssl,r.experimentalForceLongPolling,r.experimentalAutoDetectLongPolling,r.useFetchStreams)}(e._databaseId,(null===(t=e._app)||void 0===t?void 0:t.options.appId)||"",e._persistenceKey,n);e._firestoreClient=new nv(e._authCredentials,e._appCheckCredentials,e._queue,r)}function Tv(e,t,n){var r=new Vr;return e.asyncQueue.enqueue((0,p.Z)((0,v.Z)().mark((function i(){var a;return(0,v.Z)().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.prev=0,i.next=3,rv(e,n);case 3:return i.next=5,av(e,t);case 5:r.resolve(),i.next=14;break;case 8:if(i.prev=8,i.t0=i.catch(0),function(e){return"FirebaseError"===e.name?e.code===Mr.FAILED_PRECONDITION||e.code===Mr.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&e instanceof DOMException)||(22===e.code||20===e.code||11===e.code)}(a=i.t0)){i.next=13;break}throw a;case 13:Dr("Error enabling offline persistence. Falling back to persistence disabled: "+a),r.reject(a);case 14:case"end":return i.stop()}}),i,null,[[0,8]])})))).then((function(){return r.promise}))}function Ev(e){return function(e){return e.asyncQueue.enqueue((0,p.Z)((0,v.Z)().mark((function t(){var n,r;return(0,v.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,hv(e);case 2:return n=t.sent,t.next=5,dv(e);case 5:return r=t.sent,t.abrupt("return",(n.setNetworkEnabled(!0),function(e){var t=Lr(e);return t._u.delete(0),wh(t)}(r)));case 7:case"end":return t.stop()}}),t)}))))}(xv(e=Fd(e,Iv)))}function Sv(e){return function(e){return e.asyncQueue.enqueue((0,p.Z)((0,v.Z)().mark((function t(){var n,r;return(0,v.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,hv(e);case 2:return n=t.sent,t.next=5,dv(e);case 5:return r=t.sent,t.abrupt("return",(n.setNetworkEnabled(!1),function(){var e=(0,p.Z)((0,v.Z)().mark((function e(t){var n;return(0,v.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(n=Lr(t))._u.add(0),e.next=4,Zh(n);case 4:n.gu.set("Offline");case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()(r)));case 7:case"end":return t.stop()}}),t)}))))}(xv(e=Fd(e,Iv)))}function Av(e,t){var n=xv(e=Fd(e,Iv)),r=new Zv;return function(e,t,n,r){var i=function(e,t){return function(e,t){return new $d(e,t)}(function(e,t){if(e instanceof Uint8Array)return Jd(e,t);if(e instanceof ArrayBuffer)return Jd(new Uint8Array(e),t);if(e instanceof ReadableStream)return e.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}("string"==typeof e?(new TextEncoder).encode(e):e),t)}(n,fh(t));e.asyncQueue.enqueueAndForget((0,p.Z)((0,v.Z)().mark((function t(){return(0,v.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=Sd,t.next=3,vv(e);case 3:t.t1=t.sent,t.t2=i,t.t3=r,(0,t.t0)(t.t1,t.t2,t.t3);case 7:case"end":return t.stop()}}),t)}))))}(n,e._databaseId,t,r),r}function Cv(e,t){return function(e,t){return e.asyncQueue.enqueue((0,p.Z)((0,v.Z)().mark((function n(){return(0,v.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.t0=function(e,t){var n=Lr(e);return n.persistence.runTransaction("Get named query","readonly",(function(e){return n.Ns.getNamedQuery(e,t)}))},n.next=3,fv(e);case 3:return n.t1=n.sent,n.t2=t,n.abrupt("return",(0,n.t0)(n.t1,n.t2));case 6:case"end":return n.stop()}}),n)}))))}(xv(e=Fd(e,Iv)),t).then((function(t){return t?new Kd(e,null,t.query):null}))}function Nv(e){if(e._initialized||e._terminated)throw new Fr(Mr.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}var Dv=function(){function e(t){(0,s.Z)(this,e),this._byteString=t}return(0,c.Z)(e,[{key:"toBase64",value:function(){return this._byteString.toBase64()}},{key:"toUint8Array",value:function(){return this._byteString.toUint8Array()}},{key:"toString",value:function(){return"Bytes(base64: "+this.toBase64()+")"}},{key:"isEqual",value:function(e){return this._byteString.isEqual(e._byteString)}}],[{key:"fromBase64String",value:function(t){try{return new e(Ui.fromBase64String(t))}catch(t){throw new Fr(Mr.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}},{key:"fromUint8Array",value:function(t){return new e(Ui.fromUint8Array(t))}}]),e}(),Rv=function(){function e(){(0,s.Z)(this,e);for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(var i=0;i<n.length;++i)if(0===n[i].length)throw new Fr(Mr.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new ii(n)}return(0,c.Z)(e,[{key:"isEqual",value:function(e){return this._internalPath.isEqual(e._internalPath)}}]),e}();var Ov=(0,c.Z)((function e(t){(0,s.Z)(this,e),this._methodName=t})),Pv=function(){function e(t,n){if((0,s.Z)(this,e),!isFinite(t)||t<-90||t>90)throw new Fr(Mr.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(n)||n<-180||n>180)throw new Fr(Mr.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=t,this._long=n}return(0,c.Z)(e,[{key:"latitude",get:function(){return this._lat}},{key:"longitude",get:function(){return this._long}},{key:"isEqual",value:function(e){return this._lat===e._lat&&this._long===e._long}},{key:"toJSON",value:function(){return{latitude:this._lat,longitude:this._long}}},{key:"_compareTo",value:function(e){return Yr(this._lat,e._lat)||Yr(this._long,e._long)}}]),e}(),Lv=/^__.*__$/,Mv=function(){function e(t,n,r){(0,s.Z)(this,e),this.data=t,this.fieldMask=n,this.fieldTransforms=r}return(0,c.Z)(e,[{key:"toMutation",value:function(e,t){return null!==this.fieldMask?new Ho(e,this.data,this.fieldMask,t,this.fieldTransforms):new Wo(e,this.data,t,this.fieldTransforms)}}]),e}(),Fv=function(){function e(t,n,r){(0,s.Z)(this,e),this.data=t,this.fieldMask=n,this.fieldTransforms=r}return(0,c.Z)(e,[{key:"toMutation",value:function(e,t){return new Ho(e,this.data,this.fieldMask,t,this.fieldTransforms)}}]),e}();function Vv(e){switch(e){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Or()}}var Uv=function(){function e(t,n,r,i,a,o){(0,s.Z)(this,e),this.settings=t,this.databaseId=n,this.yt=r,this.ignoreUndefinedProperties=i,void 0===a&&this.na(),this.fieldTransforms=a||[],this.fieldMask=o||[]}return(0,c.Z)(e,[{key:"path",get:function(){return this.settings.path}},{key:"sa",get:function(){return this.settings.sa}},{key:"ia",value:function(t){return new e(Object.assign(Object.assign({},this.settings),t),this.databaseId,this.yt,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}},{key:"ra",value:function(e){var t,n=null===(t=this.path)||void 0===t?void 0:t.child(e),r=this.ia({path:n,oa:!1});return r.ua(e),r}},{key:"ca",value:function(e){var t,n=null===(t=this.path)||void 0===t?void 0:t.child(e),r=this.ia({path:n,oa:!1});return r.na(),r}},{key:"aa",value:function(e){return this.ia({path:void 0,oa:!0})}},{key:"ha",value:function(e){return op(e,this.settings.methodName,this.settings.la||!1,this.path,this.settings.fa)}},{key:"contains",value:function(e){return void 0!==this.fieldMask.find((function(t){return e.isPrefixOf(t)}))||void 0!==this.fieldTransforms.find((function(t){return e.isPrefixOf(t.field)}))}},{key:"na",value:function(){if(this.path)for(var e=0;e<this.path.length;e++)this.ua(this.path.get(e))}},{key:"ua",value:function(e){if(0===e.length)throw this.ha("Document fields must not be empty");if(Vv(this.sa)&&Lv.test(e))throw this.ha('Document fields cannot begin and end with "__"')}}]),e}(),qv=function(){function e(t,n,r){(0,s.Z)(this,e),this.databaseId=t,this.ignoreUndefinedProperties=n,this.yt=r||fh(t)}return(0,c.Z)(e,[{key:"da",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return new Uv({sa:e,methodName:t,fa:n,path:ii.emptyPath(),oa:!1,la:r},this.databaseId,this.yt,this.ignoreUndefinedProperties)}}]),e}();function Bv(e){var t=e._freezeSettings(),n=fh(e._databaseId);return new qv(e._databaseId,!!t.ignoreUndefinedProperties,n)}function jv(e,t,n,r,i){var a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{},o=e.da(a.merge||a.mergeFields?2:0,t,n,i);np("Data must be an object, but it was:",o,r);var s,c,l=ep(r,o);if(a.merge)s=new Ka(o.fieldMask),c=o.fieldTransforms;else if(a.mergeFields){var h,f=[],d=(0,u.Z)(a.mergeFields);try{for(d.s();!(h=d.n()).done;){var v=rp(t,h.value,n);if(!o.contains(v))throw new Fr(Mr.INVALID_ARGUMENT,"Field '".concat(v,"' is specified in your field mask but missing from your input data."));up(f,v)||f.push(v)}}catch(p){d.e(p)}finally{d.f()}s=new Ka(f),c=o.fieldTransforms.filter((function(e){return s.covers(e.field)}))}else s=null,c=o.fieldTransforms;return new Mv(new za(l),s,c)}var Gv=function(e){(0,a.Z)(n,e);var t=(0,o.Z)(n);function n(){return(0,s.Z)(this,n),t.apply(this,arguments)}return(0,c.Z)(n,[{key:"_toFieldTransform",value:function(e){if(2!==e.sa)throw 1===e.sa?e.ha("".concat(this._methodName,"() can only appear at the top level of your update data")):e.ha("".concat(this._methodName,"() cannot be used with set() unless you pass {merge:true}"));return e.fieldMask.push(e.path),null}},{key:"isEqual",value:function(e){return e instanceof n}}]),n}(Ov);function Kv(e,t,n){return new Uv({sa:3,fa:t.settings.fa,methodName:e._methodName,oa:n},t.databaseId,t.yt,t.ignoreUndefinedProperties)}var zv=function(e){(0,a.Z)(n,e);var t=(0,o.Z)(n);function n(){return(0,s.Z)(this,n),t.apply(this,arguments)}return(0,c.Z)(n,[{key:"_toFieldTransform",value:function(e){return new Mo(e.path,new Ao)}},{key:"isEqual",value:function(e){return e instanceof n}}]),n}(Ov),Wv=function(e){(0,a.Z)(n,e);var t=(0,o.Z)(n);function n(e,r){var i;return(0,s.Z)(this,n),(i=t.call(this,e))._a=r,i}return(0,c.Z)(n,[{key:"_toFieldTransform",value:function(e){var t=Kv(this,e,!0),n=this._a.map((function(e){return $v(e,t)})),r=new Co(n);return new Mo(e.path,r)}},{key:"isEqual",value:function(e){return this===e}}]),n}(Ov),Hv=function(e){(0,a.Z)(n,e);var t=(0,o.Z)(n);function n(e,r){var i;return(0,s.Z)(this,n),(i=t.call(this,e))._a=r,i}return(0,c.Z)(n,[{key:"_toFieldTransform",value:function(e){var t=Kv(this,e,!0),n=this._a.map((function(e){return $v(e,t)})),r=new Do(n);return new Mo(e.path,r)}},{key:"isEqual",value:function(e){return this===e}}]),n}(Ov),Qv=function(e){(0,a.Z)(n,e);var t=(0,o.Z)(n);function n(e,r){var i;return(0,s.Z)(this,n),(i=t.call(this,e)).wa=r,i}return(0,c.Z)(n,[{key:"_toFieldTransform",value:function(e){var t=new Oo(e.yt,xo(e.yt,this.wa));return new Mo(e.path,t)}},{key:"isEqual",value:function(e){return this===e}}]),n}(Ov);function Yv(e,t,n,r){var i=e.da(1,t,n);np("Data must be an object, but it was:",i,r);var a=[],o=za.empty();Pi(r,(function(e,r){var u=ap(t,e,n);r=(0,w.m9)(r);var s=i.ca(u);if(r instanceof Gv)a.push(u);else{var c=$v(r,s);null!=c&&(a.push(u),o.set(u,c))}}));var u=new Ka(a);return new Fv(o,u,i.fieldTransforms)}function Jv(e,t,n,r,i,a){var o=e.da(1,t,n),u=[rp(t,r,n)],s=[i];if(a.length%2!=0)throw new Fr(Mr.INVALID_ARGUMENT,"Function ".concat(t,"() needs to be called with an even number of arguments that alternate between field names and values."));for(var c=0;c<a.length;c+=2)u.push(rp(t,a[c])),s.push(a[c+1]);for(var l=[],h=za.empty(),f=u.length-1;f>=0;--f)if(!up(l,u[f])){var d=u[f],v=s[f];v=(0,w.m9)(v);var p=o.ca(d);if(v instanceof Gv)l.push(d);else{var y=$v(v,p);null!=y&&(l.push(d),h.set(d,y))}}var m=new Ka(l);return new Fv(h,m,o.fieldTransforms)}function Xv(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return $v(n,e.da(r?4:3,t))}function $v(e,t){if(tp(e=(0,w.m9)(e)))return np("Unsupported field value:",t,e),ep(e,t);if(e instanceof Ov)return function(e,t){if(!Vv(t.sa))throw t.ha("".concat(e._methodName,"() can only be used with update() and set()"));if(!t.path)throw t.ha("".concat(e._methodName,"() is not currently supported inside arrays"));var n=e._toFieldTransform(t);n&&t.fieldTransforms.push(n)}(e,t),null;if(void 0===e&&t.ignoreUndefinedProperties)return null;if(t.path&&t.fieldMask.push(t.path),e instanceof Array){if(t.settings.oa&&4!==t.sa)throw t.ha("Nested arrays are not supported");return function(e,t){var n,r=[],i=0,a=(0,u.Z)(e);try{for(a.s();!(n=a.n()).done;){var o=$v(n.value,t.aa(i));null==o&&(o={nullValue:"NULL_VALUE"}),r.push(o),i++}}catch(s){a.e(s)}finally{a.f()}return{arrayValue:{values:r}}}(e,t)}return function(e,t){if(null===(e=(0,w.m9)(e)))return{nullValue:"NULL_VALUE"};if("number"==typeof e)return xo(t.yt,e);if("boolean"==typeof e)return{booleanValue:e};if("string"==typeof e)return{stringValue:e};if(e instanceof Date){var n=$r.fromDate(e);return{timestampValue:Du(t.yt,n)}}if(e instanceof $r){var r=new $r(e.seconds,1e3*Math.floor(e.nanoseconds/1e3));return{timestampValue:Du(t.yt,r)}}if(e instanceof Pv)return{geoPointValue:{latitude:e.latitude,longitude:e.longitude}};if(e instanceof Dv)return{bytesValue:Ru(t.yt,e._byteString)};if(e instanceof Gd){var i=t.databaseId,a=e.firestore._databaseId;if(!a.isEqual(i))throw t.ha("Document reference is for database ".concat(a.projectId,"/").concat(a.database," but should be for database ").concat(i.projectId,"/").concat(i.database));return{referenceValue:Lu(e.firestore._databaseId||t.databaseId,e._key.path)}}throw t.ha("Unsupported field value: ".concat(Md(e)))}(e,t)}function ep(e,t){var n={};return Li(e)?t.path&&t.path.length>0&&t.fieldMask.push(t.path):Pi(e,(function(e,r){var i=$v(r,t.ra(e));null!=i&&(n[e]=i)})),{mapValue:{fields:n}}}function tp(e){return!("object"!=typeof e||null===e||e instanceof Array||e instanceof Date||e instanceof $r||e instanceof Pv||e instanceof Dv||e instanceof Gd||e instanceof Ov)}function np(e,t,n){if(!tp(n)||!function(e){return"object"==typeof e&&null!==e&&(Object.getPrototypeOf(e)===Object.prototype||null===Object.getPrototypeOf(e))}(n)){var r=Md(n);throw"an object"===r?t.ha(e+" a custom object"):t.ha(e+" "+r)}}function rp(e,t,n){if((t=(0,w.m9)(t))instanceof Rv)return t._internalPath;if("string"==typeof t)return ap(e,t);throw op("Field path arguments must be of type string or ",e,!1,void 0,n)}var ip=new RegExp("[~\\*/\\[\\]]");function ap(e,t,n){if(t.search(ip)>=0)throw op("Invalid field path (".concat(t,"). Paths must not contain '~', '*', '/', '[', or ']'"),e,!1,void 0,n);try{return(0,i.Z)(Rv,(0,y.Z)(t.split(".")))._internalPath}catch(r){throw op("Invalid field path (".concat(t,"). Paths must not be empty, begin with '.', end with '.', or contain '..'"),e,!1,void 0,n)}}function op(e,t,n,r,i){var a=r&&!r.isEmpty(),o=void 0!==i,u="Function ".concat(t,"() called with invalid data");n&&(u+=" (via `toFirestore()`)"),u+=". ";var s="";return(a||o)&&(s+=" (found",a&&(s+=" in field ".concat(r)),o&&(s+=" in document ".concat(i)),s+=")"),new Fr(Mr.INVALID_ARGUMENT,u+e+s)}function up(e,t){return e.some((function(e){return e.isEqual(t)}))}var sp=function(){function e(t,n,r,i,a){(0,s.Z)(this,e),this._firestore=t,this._userDataWriter=n,this._key=r,this._document=i,this._converter=a}return(0,c.Z)(e,[{key:"id",get:function(){return this._key.path.lastSegment()}},{key:"ref",get:function(){return new Gd(this._firestore,this._converter,this._key)}},{key:"exists",value:function(){return null!==this._document}},{key:"data",value:function(){if(this._document){if(this._converter){var e=new cp(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}},{key:"get",value:function(e){if(this._document){var t=this._document.data.field(lp("DocumentSnapshot.get",e));if(null!==t)return this._userDataWriter.convertValue(t)}}}]),e}(),cp=function(e){(0,a.Z)(n,e);var t=(0,o.Z)(n);function n(){return(0,s.Z)(this,n),t.apply(this,arguments)}return(0,c.Z)(n,[{key:"data",value:function(){return(0,h.Z)((0,f.Z)(n.prototype),"data",this).call(this)}}]),n}(sp);function lp(e,t){return"string"==typeof t?ap(e,t):t instanceof Rv?t._internalPath:t._delegate._internalPath}function hp(e){if("L"===e.limitType&&0===e.explicitOrderBy.length)throw new Fr(Mr.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var fp=(0,c.Z)((function e(){(0,s.Z)(this,e)})),dp=function(e){(0,a.Z)(n,e);var t=(0,o.Z)(n);function n(){return(0,s.Z)(this,n),t.apply(this,arguments)}return(0,c.Z)(n)}(fp);function vp(e,t){for(var n=[],r=arguments.length,i=new Array(r>2?r-2:0),a=2;a<r;a++)i[a-2]=arguments[a];t instanceof fp&&n.push(t),function(e){var t=e.filter((function(e){return e instanceof yp})).length,n=e.filter((function(e){return e instanceof pp})).length;if(t>1||t>0&&n>0)throw new Fr(Mr.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(n=n.concat(i));var o,s=(0,u.Z)(n);try{for(s.s();!(o=s.n()).done;){e=o.value._apply(e)}}catch(c){s.e(c)}finally{s.f()}return e}var pp=function(e){(0,a.Z)(n,e);var t=(0,o.Z)(n);function n(e,r,i){var a;return(0,s.Z)(this,n),(a=t.call(this))._field=e,a._op=r,a._value=i,a.type="where",a}return(0,c.Z)(n,[{key:"_apply",value:function(e){var t=this._parse(e);return Sp(e._query,t),new Kd(e.firestore,e.converter,fo(e._query,t))}},{key:"_parse",value:function(e){var t=Bv(e.firestore),n=function(e,t,n,r,i,a,o){var s;if(i.isKeyField()){if("array-contains"===a||"array-contains-any"===a)throw new Fr(Mr.INVALID_ARGUMENT,"Invalid Query. You can't perform '".concat(a,"' queries on documentId()."));if("in"===a||"not-in"===a){Ep(o,a);var c,l=[],h=(0,u.Z)(o);try{for(h.s();!(c=h.n()).done;){var f=c.value;l.push(Tp(r,e,f))}}catch(d){h.e(d)}finally{h.f()}s={arrayValue:{values:l}}}else s=Tp(r,e,o)}else"in"!==a&&"not-in"!==a&&"array-contains-any"!==a||Ep(o,a),s=Xv(n,"where",o,"in"===a||"not-in"===a);return ka.create(i,a,s)}(e._query,0,t,e.firestore._databaseId,this._field,this._op,this._value);return n}}],[{key:"_create",value:function(e,t,r){return new n(e,t,r)}}]),n}(dp);var yp=function(e){(0,a.Z)(n,e);var t=(0,o.Z)(n);function n(e,r){var i;return(0,s.Z)(this,n),(i=t.call(this)).type=e,i._queryConstraints=r,i}return(0,c.Z)(n,[{key:"_parse",value:function(e){var t=this._queryConstraints.map((function(t){return t._parse(e)})).filter((function(e){return e.getFilters().length>0}));return 1===t.length?t[0]:wa.create(t,this._getOperator())}},{key:"_apply",value:function(e){var t=this._parse(e);return 0===t.getFilters().length?e:(function(e,t){var n,r=e,i=t.getFlattenedFilters(),a=(0,u.Z)(i);try{for(a.s();!(n=a.n()).done;){var o=n.value;Sp(r,o),r=fo(r,o)}}catch(s){a.e(s)}finally{a.f()}}(e._query,t),new Kd(e.firestore,e.converter,fo(e._query,t)))}},{key:"_getQueryConstraints",value:function(){return this._queryConstraints}},{key:"_getOperator",value:function(){return"and"===this.type?"and":"or"}}],[{key:"_create",value:function(e,t){return new n(e,t)}}]),n}(fp);var mp=function(e){(0,a.Z)(n,e);var t=(0,o.Z)(n);function n(e,r){var i;return(0,s.Z)(this,n),(i=t.call(this))._field=e,i._direction=r,i.type="orderBy",i}return(0,c.Z)(n,[{key:"_apply",value:function(e){var t=function(e,t,n){if(null!==e.startAt)throw new Fr(Mr.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==e.endAt)throw new Fr(Mr.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");var r=new Ma(t,n);return function(e,t){if(null===uo(e)){var n=so(e);null!==n&&Ap(e,n,t.field)}}(e,r),r}(e._query,this._field,this._direction);return new Kd(e.firestore,e.converter,function(e,t){var n=e.explicitOrderBy.concat([t]);return new ro(e.path,e.collectionGroup,n,e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt)}(e._query,t))}}],[{key:"_create",value:function(e,t){return new n(e,t)}}]),n}(dp);var gp=function(e){(0,a.Z)(n,e);var t=(0,o.Z)(n);function n(e,r,i){var a;return(0,s.Z)(this,n),(a=t.call(this)).type=e,a._limit=r,a._limitType=i,a}return(0,c.Z)(n,[{key:"_apply",value:function(e){return new Kd(e.firestore,e.converter,vo(e._query,this._limit,this._limitType))}}],[{key:"_create",value:function(e,t,r){return new n(e,t,r)}}]),n}(dp);var kp=function(e){(0,a.Z)(n,e);var t=(0,o.Z)(n);function n(e,r,i){var a;return(0,s.Z)(this,n),(a=t.call(this)).type=e,a._docOrFields=r,a._inclusive=i,a}return(0,c.Z)(n,[{key:"_apply",value:function(e){var t=_p(e,this.type,this._docOrFields,this._inclusive);return new Kd(e.firestore,e.converter,function(e,t){return new ro(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),e.limit,e.limitType,t,e.endAt)}(e._query,t))}}],[{key:"_create",value:function(e,t,r){return new n(e,t,r)}}]),n}(dp);function wp(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return kp._create("startAt",t,!0)}function bp(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return kp._create("startAfter",t,!1)}var Zp=function(e){(0,a.Z)(n,e);var t=(0,o.Z)(n);function n(e,r,i){var a;return(0,s.Z)(this,n),(a=t.call(this)).type=e,a._docOrFields=r,a._inclusive=i,a}return(0,c.Z)(n,[{key:"_apply",value:function(e){var t=_p(e,this.type,this._docOrFields,this._inclusive);return new Kd(e.firestore,e.converter,function(e,t){return new ro(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),e.limit,e.limitType,e.startAt,t)}(e._query,t))}}],[{key:"_create",value:function(e,t,r){return new n(e,t,r)}}]),n}(dp);function Ip(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return Zp._create("endBefore",t,!1)}function xp(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return Zp._create("endAt",t,!0)}function _p(e,t,n,r){if(n[0]=(0,w.m9)(n[0]),n[0]instanceof sp)return function(e,t,n,r,i){if(!r)throw new Fr(Mr.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for ".concat(n,"()."));var a,o=[],s=(0,u.Z)(lo(e));try{for(s.s();!(a=s.n()).done;){var c=a.value;if(c.field.isKeyField())o.push(ra(t,r.key));else{var l=r.data.field(c.field);if(Ki(l))throw new Fr(Mr.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+c.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===l){var h=c.field.canonicalString();throw new Fr(Mr.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '".concat(h,"' (used as the orderBy) does not exist."))}o.push(l)}}}catch(f){s.e(f)}finally{s.f()}return new pa(o,i)}(e._query,e.firestore._databaseId,t,n[0]._document,r);var i=Bv(e.firestore);return function(e,t,n,r,i,a){var o=e.explicitOrderBy;if(i.length>o.length)throw new Fr(Mr.INVALID_ARGUMENT,"Too many arguments provided to ".concat(r,"(). The number of arguments must be less than or equal to the number of orderBy() clauses"));for(var u=[],s=0;s<i.length;s++){var c=i[s];if(o[s].field.isKeyField()){if("string"!=typeof c)throw new Fr(Mr.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in ".concat(r,"(), but got a ").concat(typeof c));if(!co(e)&&-1!==c.indexOf("/"))throw new Fr(Mr.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by documentId(), the value passed to ".concat(r,"() must be a plain document ID, but '").concat(c,"' contains a slash."));var l=e.path.child(ni.fromString(c));if(!ai.isDocumentKey(l))throw new Fr(Mr.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by documentId(), the value passed to ".concat(r,"() must result in a valid document path, but '").concat(l,"' is not because it contains an odd number of segments."));var h=new ai(l);u.push(ra(t,h))}else{var f=Xv(n,r,c);u.push(f)}}return new pa(u,a)}(e._query,e.firestore._databaseId,i,t,n,r)}function Tp(e,t,n){if("string"==typeof(n=(0,w.m9)(n))){if(""===n)throw new Fr(Mr.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!co(t)&&-1!==n.indexOf("/"))throw new Fr(Mr.INVALID_ARGUMENT,"Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '".concat(n,"' contains a '/' character."));var r=t.path.child(ni.fromString(n));if(!ai.isDocumentKey(r))throw new Fr(Mr.INVALID_ARGUMENT,"Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '".concat(r,"' is not because it has an odd number of segments (").concat(r.length,")."));return ra(e,new ai(r))}if(n instanceof Gd)return ra(e,n._key);throw new Fr(Mr.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ".concat(Md(n),"."))}function Ep(e,t){if(!Array.isArray(e)||0===e.length)throw new Fr(Mr.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '".concat(t.toString(),"' filters."));if(e.length>10)throw new Fr(Mr.INVALID_ARGUMENT,"Invalid Query. '".concat(t.toString(),"' filters support a maximum of 10 elements in the value array."))}function Sp(e,t){if(t.isInequality()){var n=so(e),r=t.field;if(null!==n&&!n.isEqual(r))throw new Fr(Mr.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, !=, not-in, >, or >=) must be on the same field. But you have inequality filters on '".concat(n.toString(),"' and '").concat(r.toString(),"'"));var i=uo(e);null!==i&&Ap(e,r,i)}var a=function(e,t){var n,r=(0,u.Z)(e);try{for(r.s();!(n=r.n()).done;){var i,a=n.value,o=(0,u.Z)(a.getFlattenedFilters());try{for(o.s();!(i=o.n()).done;){var s=i.value;if(t.indexOf(s.op)>=0)return s.op}}catch(c){o.e(c)}finally{o.f()}}}catch(c){r.e(c)}finally{r.f()}return null}(e.filters,function(e){switch(e){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}(t.op));if(null!==a)throw a===t.op?new Fr(Mr.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '".concat(t.op.toString(),"' filter.")):new Fr(Mr.INVALID_ARGUMENT,"Invalid query. You cannot use '".concat(t.op.toString(),"' filters with '").concat(a.toString(),"' filters."))}function Ap(e,t,n){if(!n.isEqual(t))throw new Fr(Mr.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, !=, not-in, >, or >=) on field '".concat(t.toString(),"' and so you must also use '").concat(t.toString(),"' as your first argument to orderBy(), but your first orderBy() is on field '").concat(n.toString(),"' instead."))}var Cp=function(){function e(){(0,s.Z)(this,e)}return(0,c.Z)(e,[{key:"convertValue",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"none";switch(Yi(e)){case 0:return null;case 1:return e.booleanValue;case 2:return ji(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Gi(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 10:return this.convertObject(e.mapValue,t);default:throw Or()}}},{key:"convertObject",value:function(e,t){var n=this,r={};return Pi(e.fields,(function(e,i){r[e]=n.convertValue(i,t)})),r}},{key:"convertGeoPoint",value:function(e){return new Pv(ji(e.latitude),ji(e.longitude))}},{key:"convertArray",value:function(e,t){var n=this;return(e.values||[]).map((function(e){return n.convertValue(e,t)}))}},{key:"convertServerTimestamp",value:function(e,t){switch(t){case"previous":var n=zi(e);return null==n?null:this.convertValue(n,t);case"estimate":return this.convertTimestamp(Wi(e));default:return null}}},{key:"convertTimestamp",value:function(e){var t=Bi(e);return new $r(t.seconds,t.nanos)}},{key:"convertDocumentKey",value:function(e,t){var n=ni.fromString(e);Pr(os(n));var r=new Ri(n.get(1),n.get(3)),i=new ai(n.popFirst(5));return r.isEqual(t)||Nr("Document ".concat(i," contains a document reference within a different database (").concat(r.projectId,"/").concat(r.database,") which is not supported. It will be treated as a reference in the current database (").concat(t.projectId,"/").concat(t.database,") instead.")),i}}]),e}();function Np(e,t,n){return e?n&&(n.merge||n.mergeFields)?e.toFirestore(t,n):e.toFirestore(t):t}var Dp=function(e){(0,a.Z)(n,e);var t=(0,o.Z)(n);function n(e){var r;return(0,s.Z)(this,n),(r=t.call(this)).firestore=e,r}return(0,c.Z)(n,[{key:"convertBytes",value:function(e){return new Dv(e)}},{key:"convertReference",value:function(e){var t=this.convertDocumentKey(e,this.firestore._databaseId);return new Gd(this.firestore,null,t)}}]),n}(Cp),Rp=function(){function e(t,n){(0,s.Z)(this,e),this.hasPendingWrites=t,this.fromCache=n}return(0,c.Z)(e,[{key:"isEqual",value:function(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}]),e}(),Op=function(e){(0,a.Z)(n,e);var t=(0,o.Z)(n);function n(e,r,i,a,o,u){var c;return(0,s.Z)(this,n),(c=t.call(this,e,r,i,a,u))._firestore=e,c._firestoreImpl=e,c.metadata=o,c}return(0,c.Z)(n,[{key:"exists",value:function(){return(0,h.Z)((0,f.Z)(n.prototype),"exists",this).call(this)}},{key:"data",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this._document){if(this._converter){var t=new Pp(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}},{key:"get",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(this._document){var n=this._document.data.field(lp("DocumentSnapshot.get",e));if(null!==n)return this._userDataWriter.convertValue(n,t.serverTimestamps)}}}]),n}(sp),Pp=function(e){(0,a.Z)(n,e);var t=(0,o.Z)(n);function n(){return(0,s.Z)(this,n),t.apply(this,arguments)}return(0,c.Z)(n,[{key:"data",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,h.Z)((0,f.Z)(n.prototype),"data",this).call(this,e)}}]),n}(Op),Lp=function(){function e(t,n,r,i){(0,s.Z)(this,e),this._firestore=t,this._userDataWriter=n,this._snapshot=i,this.metadata=new Rp(i.hasPendingWrites,i.fromCache),this.query=r}return(0,c.Z)(e,[{key:"docs",get:function(){var e=[];return this.forEach((function(t){return e.push(t)})),e}},{key:"size",get:function(){return this._snapshot.docs.size}},{key:"empty",get:function(){return 0===this.size}},{key:"forEach",value:function(e,t){var n=this;this._snapshot.docs.forEach((function(r){e.call(t,new Pp(n._firestore,n._userDataWriter,r.key,r,new Rp(n._snapshot.mutatedKeys.has(r.key),n._snapshot.fromCache),n.query.converter))}))}},{key:"docChanges",value:function(){var e=!!(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).includeMetadataChanges;if(e&&this._snapshot.excludesMetadataChanges)throw new Fr(Mr.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===e||(this._cachedChanges=function(e,t){if(e._snapshot.oldDocs.isEmpty()){var n=0;return e._snapshot.docChanges.map((function(t){var r=new Pp(e._firestore,e._userDataWriter,t.doc.key,t.doc,new Rp(e._snapshot.mutatedKeys.has(t.doc.key),e._snapshot.fromCache),e.query.converter);return t.doc,{type:"added",doc:r,oldIndex:-1,newIndex:n++}}))}var r=e._snapshot.oldDocs;return e._snapshot.docChanges.filter((function(e){return t||3!==e.type})).map((function(t){var n=new Pp(e._firestore,e._userDataWriter,t.doc.key,t.doc,new Rp(e._snapshot.mutatedKeys.has(t.doc.key),e._snapshot.fromCache),e.query.converter),i=-1,a=-1;return 0!==t.type&&(i=r.indexOf(t.doc.key),r=r.delete(t.doc.key)),1!==t.type&&(a=(r=r.add(t.doc)).indexOf(t.doc.key)),{type:Mp(t.type),doc:n,oldIndex:i,newIndex:a}}))}(this,e),this._cachedChangesIncludeMetadataChanges=e),this._cachedChanges}}]),e}();function Mp(e){switch(e){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Or()}}function Fp(e,t){return e instanceof Op&&t instanceof Op?e._firestore===t._firestore&&e._key.isEqual(t._key)&&(null===e._document?null===t._document:e._document.isEqual(t._document))&&e._converter===t._converter:e instanceof Lp&&t instanceof Lp&&e._firestore===t._firestore&&Yd(e.query,t.query)&&e.metadata.isEqual(t.metadata)&&e._snapshot.isEqual(t._snapshot)}var Vp=function(e){(0,a.Z)(n,e);var t=(0,o.Z)(n);function n(e){var r;return(0,s.Z)(this,n),(r=t.call(this)).firestore=e,r}return(0,c.Z)(n,[{key:"convertBytes",value:function(e){return new Dv(e)}},{key:"convertReference",value:function(e){var t=this.convertDocumentKey(e,this.firestore._databaseId);return new Gd(this.firestore,null,t)}}]),n}(Cp);function Up(e){e=Fd(e,Gd);var t=Fd(e.firestore,Iv),n=xv(t),r=new Vp(t);return function(e,t){var n=new Vr;return e.asyncQueue.enqueueAndForget((0,p.Z)((0,v.Z)().mark((function r(){return(0,v.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.t0=function(){var e=(0,p.Z)((0,v.Z)().mark((function e(t,n,r){var i,a;return(0,v.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,function(e,t){var n=Lr(e);return n.persistence.runTransaction("read document","readonly",(function(e){return n.localDocuments.getDocument(e,t)}))}(t,n);case 3:(i=e.sent).isFoundDocument()?r.resolve(i):i.isNoDocument()?r.resolve(null):r.reject(new Fr(Mr.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")),e.next=11;break;case 7:e.prev=7,e.t0=e.catch(0),a=cf(e.t0,"Failed to get document '".concat(n," from cache")),r.reject(a);case 11:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t,n,r){return e.apply(this,arguments)}}(),r.next=3,fv(e);case 3:return r.t1=r.sent,r.t2=t,r.t3=n,r.abrupt("return",(0,r.t0)(r.t1,r.t2,r.t3));case 7:case"end":return r.stop()}}),r)})))),n.promise}(n,e._key).then((function(n){return new Op(t,r,e._key,n,new Rp(null!==n&&n.hasLocalMutations,!0),e.converter)}))}function qp(e){e=Fd(e,Kd);var t=Fd(e.firestore,Iv),n=xv(t),r=new Vp(t);return function(e,t){var n=new Vr;return e.asyncQueue.enqueueAndForget((0,p.Z)((0,v.Z)().mark((function r(){return(0,v.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.t0=function(){var e=(0,p.Z)((0,v.Z)().mark((function e(t,n,r){var i,a,o,u,s;return(0,v.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,ql(t,n,!0);case 3:i=e.sent,a=new Af(n,i.Hi),o=a.Wu(i.documents),u=a.applyChanges(o,!1),r.resolve(u.snapshot),e.next=14;break;case 10:e.prev=10,e.t0=e.catch(0),s=cf(e.t0,"Failed to execute query '".concat(n," against cache")),r.reject(s);case 14:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(t,n,r){return e.apply(this,arguments)}}(),r.next=3,fv(e);case 3:return r.t1=r.sent,r.t2=t,r.t3=n,r.abrupt("return",(0,r.t0)(r.t1,r.t2,r.t3));case 7:case"end":return r.stop()}}),r)})))),n.promise}(n,e._query).then((function(n){return new Lp(t,r,e,n)}))}function Bp(e,t,n){e=Fd(e,Gd);var r=Fd(e.firestore,Iv),i=Np(e.converter,t,n);return zp(r,[jv(Bv(r),"setDoc",e._key,i,null!==e.converter,n).toMutation(e._key,Vo.none())])}function jp(e,t,n){e=Fd(e,Gd);for(var r=Fd(e.firestore,Iv),i=Bv(r),a=arguments.length,o=new Array(a>3?a-3:0),u=3;u<a;u++)o[u-3]=arguments[u];return zp(r,[("string"==typeof(t=(0,w.m9)(t))||t instanceof Rv?Jv(i,"updateDoc",e._key,t,n,o):Yv(i,"updateDoc",e._key,t)).toMutation(e._key,Vo.exists(!0))])}function Gp(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var i,a,o;e=(0,w.m9)(e);var u={includeMetadataChanges:!1},s=0;"object"!=typeof n[s]||bv(n[s])||(u=n[s],s++);var c,l,h,f={includeMetadataChanges:u.includeMetadataChanges};if(bv(n[s])){var d=n[s];n[s]=null===(i=d.next)||void 0===i?void 0:i.bind(d),n[s+1]=null===(a=d.error)||void 0===a?void 0:a.bind(d),n[s+2]=null===(o=d.complete)||void 0===o?void 0:o.bind(d)}if(e instanceof Gd)l=Fd(e.firestore,Iv),h=ao(e._key.path),c={next:function(t){n[s]&&n[s](Wp(l,e,t))},error:n[s+1],complete:n[s+2]};else{var y=Fd(e,Kd);l=Fd(y.firestore,Iv),h=y._query;var m=new Vp(l);c={next:function(e){n[s]&&n[s](new Lp(l,m,y,e))},error:n[s+1],complete:n[s+2]},hp(e._query)}return function(e,t,n,r){var i=new Xd(r),a=new Zf(t,i,n);return e.asyncQueue.enqueueAndForget((0,p.Z)((0,v.Z)().mark((function t(){return(0,v.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=pf,t.next=3,yv(e);case 3:return t.t1=t.sent,t.t2=a,t.abrupt("return",(0,t.t0)(t.t1,t.t2));case 6:case"end":return t.stop()}}),t)})))),function(){i.bc(),e.asyncQueue.enqueueAndForget((0,p.Z)((0,v.Z)().mark((function t(){return(0,v.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=mf,t.next=3,yv(e);case 3:return t.t1=t.sent,t.t2=a,t.abrupt("return",(0,t.t0)(t.t1,t.t2));case 6:case"end":return t.stop()}}),t)}))))}}(xv(l),h,f,c)}function Kp(e,t){return function(e,t){var n=new Xd(t);return e.asyncQueue.enqueueAndForget((0,p.Z)((0,v.Z)().mark((function t(){return(0,v.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=function(e,t){Lr(e).Ru.add(t),t.next()},t.next=3,yv(e);case 3:return t.t1=t.sent,t.t2=n,t.abrupt("return",(0,t.t0)(t.t1,t.t2));case 6:case"end":return t.stop()}}),t)})))),function(){n.bc(),e.asyncQueue.enqueueAndForget((0,p.Z)((0,v.Z)().mark((function t(){return(0,v.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=function(e,t){Lr(e).Ru.delete(t)},t.next=3,yv(e);case 3:return t.t1=t.sent,t.t2=n,t.abrupt("return",(0,t.t0)(t.t1,t.t2));case 6:case"end":return t.stop()}}),t)}))))}}(xv(e=Fd(e,Iv)),bv(t)?t:{next:t})}function zp(e,t){return function(e,t){var n=new Vr;return e.asyncQueue.enqueueAndForget((0,p.Z)((0,v.Z)().mark((function r(){return(0,v.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.t0=Vf,r.next=3,vv(e);case 3:return r.t1=r.sent,r.t2=t,r.t3=n,r.abrupt("return",(0,r.t0)(r.t1,r.t2,r.t3));case 7:case"end":return r.stop()}}),r)})))),n.promise}(xv(e),t)}function Wp(e,t,n){var r=n.docs.get(t._key),i=new Vp(e);return new Op(e,i,t._key,r,new Rp(n.hasPendingWrites,n.fromCache),t.converter)}var Hp={maxAttempts:5},Qp=function(){function e(t,n){(0,s.Z)(this,e),this._firestore=t,this._commitHandler=n,this._mutations=[],this._committed=!1,this._dataReader=Bv(t)}return(0,c.Z)(e,[{key:"set",value:function(e,t,n){this._verifyNotCommitted();var r=Yp(e,this._firestore),i=Np(r.converter,t,n),a=jv(this._dataReader,"WriteBatch.set",r._key,i,null!==r.converter,n);return this._mutations.push(a.toMutation(r._key,Vo.none())),this}},{key:"update",value:function(e,t,n){this._verifyNotCommitted();for(var r,i=Yp(e,this._firestore),a=arguments.length,o=new Array(a>3?a-3:0),u=3;u<a;u++)o[u-3]=arguments[u];return r="string"==typeof(t=(0,w.m9)(t))||t instanceof Rv?Jv(this._dataReader,"WriteBatch.update",i._key,t,n,o):Yv(this._dataReader,"WriteBatch.update",i._key,t),this._mutations.push(r.toMutation(i._key,Vo.exists(!0))),this}},{key:"delete",value:function(e){this._verifyNotCommitted();var t=Yp(e,this._firestore);return this._mutations=this._mutations.concat(new eu(t._key,Vo.none())),this}},{key:"commit",value:function(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}},{key:"_verifyNotCommitted",value:function(){if(this._committed)throw new Fr(Mr.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}]),e}();function Yp(e,t){if((e=(0,w.m9)(e)).firestore!==t)throw new Fr(Mr.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return e}var Jp=function(e){(0,a.Z)(n,e);var t=(0,o.Z)(n);function n(e,r){var i;return(0,s.Z)(this,n),(i=t.call(this,e,r))._firestore=e,i}return(0,c.Z)(n,[{key:"get",value:function(e){var t=this,r=Yp(e,this._firestore),i=new Vp(this._firestore);return(0,h.Z)((0,f.Z)(n.prototype),"get",this).call(this,e).then((function(e){return new Op(t._firestore,i,r._key,e._document,new Rp(!1,!1),r.converter)}))}}]),n}(function(){function e(t,n){(0,s.Z)(this,e),this._firestore=t,this._transaction=n,this._dataReader=Bv(t)}return(0,c.Z)(e,[{key:"get",value:function(e){var t=this,n=Yp(e,this._firestore),r=new Dp(this._firestore);return this._transaction.lookup([n._key]).then((function(e){if(!e||1!==e.length)return Or();var i=e[0];if(i.isFoundDocument())return new sp(t._firestore,r,i.key,i,n.converter);if(i.isNoDocument())return new sp(t._firestore,r,n._key,null,n.converter);throw Or()}))}},{key:"set",value:function(e,t,n){var r=Yp(e,this._firestore),i=Np(r.converter,t,n),a=jv(this._dataReader,"Transaction.set",r._key,i,null!==r.converter,n);return this._transaction.set(r._key,a),this}},{key:"update",value:function(e,t,n){for(var r,i=Yp(e,this._firestore),a=arguments.length,o=new Array(a>3?a-3:0),u=3;u<a;u++)o[u-3]=arguments[u];return r="string"==typeof(t=(0,w.m9)(t))||t instanceof Rv?Jv(this._dataReader,"Transaction.update",i._key,t,n,o):Yv(this._dataReader,"Transaction.update",i._key,t),this._transaction.update(i._key,r),this}},{key:"delete",value:function(e){var t=Yp(e,this._firestore);return this._transaction.delete(t._key),this}}]),e}());function Xp(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return new Wv("arrayUnion",t)}function $p(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return new Hv("arrayRemove",t)}!function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];!function(e){Er=e}(m.SDK_VERSION),(0,m._registerComponent)(new g.wA("firestore",(function(e,n){var r=n.instanceIdentifier,i=n.options,a=e.getProvider("app").getImmediate(),o=new Iv(new jr(e.getProvider("auth-internal")),new Wr(e.getProvider("app-check-internal")),function(e,t){if(!Object.prototype.hasOwnProperty.apply(e.options,["projectId"]))throw new Fr(Mr.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Ri(e.options.projectId,t)}(a,r),a);return i=Object.assign({useFetchStreams:t},i),o._setSettings(i),o}),"PUBLIC").setMultipleInstances(!0)),(0,m.registerVersion)(_r,"3.8.3",e),(0,m.registerVersion)(_r,"3.8.3","esm2017")}();var ey="@firebase/firestore-compat",ty="0.3.3";function ny(e,t){if(void 0===t)return{merge:!1};if(void 0!==t.mergeFields&&void 0!==t.merge)throw new Fr("invalid-argument","Invalid options passed to function ".concat(e,"(): You cannot ")+'specify both "merge" and "mergeFields".');return t}function ry(){if("undefined"===typeof Uint8Array)throw new Fr("unimplemented","Uint8Arrays are not available in this environment.")}function iy(){if("undefined"==typeof atob)throw new Fr("unimplemented","Blobs are unavailable in Firestore in this environment.")}var ay=function(){function e(t){(0,s.Z)(this,e),this._delegate=t}return(0,c.Z)(e,[{key:"toBase64",value:function(){return iy(),this._delegate.toBase64()}},{key:"toUint8Array",value:function(){return ry(),this._delegate.toUint8Array()}},{key:"isEqual",value:function(e){return this._delegate.isEqual(e._delegate)}},{key:"toString",value:function(){return"Blob(base64: "+this.toBase64()+")"}}],[{key:"fromBase64String",value:function(t){return iy(),new e(Dv.fromBase64String(t))}},{key:"fromUint8Array",value:function(t){return ry(),new e(Dv.fromUint8Array(t))}}]),e}();function oy(e){return function(e,t){if("object"!==typeof e||null===e)return!1;var n,r=e,i=(0,u.Z)(t);try{for(i.s();!(n=i.n()).done;){var a=n.value;if(a in r&&"function"===typeof r[a])return!0}}catch(o){i.e(o)}finally{i.f()}return!1}(e,["next","error","complete"])}var uy=function(){function e(){(0,s.Z)(this,e)}return(0,c.Z)(e,[{key:"enableIndexedDbPersistence",value:function(e,t){return function(e,t){Nv(e=Fd(e,Iv));var n=xv(e),r=e._freezeSettings(),i=new Dd;return Tv(n,i,new Cd(i,r.cacheSizeBytes,null==t?void 0:t.forceOwnership))}(e._delegate,{forceOwnership:t})}},{key:"enableMultiTabIndexedDbPersistence",value:function(e){return function(e){Nv(e=Fd(e,Iv));var t=xv(e),n=e._freezeSettings(),r=new Dd;return Tv(t,r,new Nd(r,n.cacheSizeBytes))}(e._delegate)}},{key:"clearIndexedDbPersistence",value:function(e){return function(e){if(e._initialized&&!e._terminated)throw new Fr(Mr.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");var t=new Vr;return e._queue.enqueueAndForgetEvenWhileRestricted((0,p.Z)((0,v.Z)().mark((function n(){return(0,v.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,function(){var e=(0,p.Z)((0,v.Z)().mark((function e(t){var n;return(0,v.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(bi.C()){e.next=2;break}return e.abrupt("return",Promise.resolve());case 2:return n=t+"main",e.next=5,bi.delete(n);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()(Tl(e._databaseId,e._persistenceKey));case 3:t.resolve(),n.next=9;break;case 6:n.prev=6,n.t0=n.catch(0),t.reject(n.t0);case 9:case"end":return n.stop()}}),n,null,[[0,6]])})))),t.promise}(e._delegate)}}]),e}(),sy=function(){function e(t,n,r){var i=this;(0,s.Z)(this,e),this._delegate=n,this._persistenceProvider=r,this.INTERNAL={delete:function(){return i.terminate()}},t instanceof Ri||(this._appCompat=t)}return(0,c.Z)(e,[{key:"_databaseId",get:function(){return this._delegate._databaseId}},{key:"settings",value:function(e){var t=this._delegate._getSettings();e.merge||t.host===e.host||Dr("You are overriding the original host. If you did not intend to override your settings, use {merge: true}."),e.merge&&delete(e=Object.assign(Object.assign({},t),e)).merge,this._delegate._setSettings(e)}},{key:"useEmulator",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};jd(this._delegate,e,t,n)}},{key:"enableNetwork",value:function(){return Ev(this._delegate)}},{key:"disableNetwork",value:function(){return Sv(this._delegate)}},{key:"enablePersistence",value:function(e){var t=!1,n=!1;return e&&Od("synchronizeTabs",t=!!e.synchronizeTabs,"experimentalForceOwningTab",n=!!e.experimentalForceOwningTab),t?this._persistenceProvider.enableMultiTabIndexedDbPersistence(this):this._persistenceProvider.enableIndexedDbPersistence(this,n)}},{key:"clearPersistence",value:function(){return this._persistenceProvider.clearIndexedDbPersistence(this)}},{key:"terminate",value:function(){return this._appCompat&&(this._appCompat._removeServiceInstance("firestore-compat"),this._appCompat._removeServiceInstance("firestore")),this._delegate._delete()}},{key:"waitForPendingWrites",value:function(){return function(e){return function(e){var t=new Vr;return e.asyncQueue.enqueueAndForget((0,p.Z)((0,v.Z)().mark((function n(){return(0,v.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.t0=Yf,n.next=3,vv(e);case 3:return n.t1=n.sent,n.t2=t,n.abrupt("return",(0,n.t0)(n.t1,n.t2));case 6:case"end":return n.stop()}}),n)})))),t.promise}(xv(e=Fd(e,Iv)))}(this._delegate)}},{key:"onSnapshotsInSync",value:function(e){return Kp(this._delegate,e)}},{key:"app",get:function(){if(!this._appCompat)throw new Fr("failed-precondition","Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._appCompat}},{key:"collection",value:function(e){try{return new Zy(this,Wd(this._delegate,e))}catch(t){throw vy(t,"collection()","Firestore.collection()")}}},{key:"doc",value:function(e){try{return new dy(this,Hd(this._delegate,e))}catch(t){throw vy(t,"doc()","Firestore.doc()")}}},{key:"collectionGroup",value:function(e){try{return new ky(this,function(e,t){if(e=Fd(e,Bd),Rd("collectionGroup","collection id",t),t.indexOf("/")>=0)throw new Fr(Mr.INVALID_ARGUMENT,"Invalid collection ID '".concat(t,"' passed to function collectionGroup(). Collection IDs must not contain '/'."));return new Kd(e,null,function(e){return new ro(ni.emptyPath(),e)}(t))}(this._delegate,e))}catch(t){throw vy(t,"collectionGroup()","Firestore.collectionGroup()")}}},{key:"runTransaction",value:function(e){var t=this;return function(e,t,n){e=Fd(e,Iv);var r=Object.assign(Object.assign({},Hp),n);return function(e){if(e.maxAttempts<1)throw new Fr(Mr.INVALID_ARGUMENT,"Max attempts must be at least 1")}(r),function(e,t,n){var r=new Vr;return e.asyncQueue.enqueueAndForget((0,p.Z)((0,v.Z)().mark((function i(){var a;return(0,v.Z)().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,pv(e);case 2:a=i.sent,new tv(e.asyncQueue,a,n,t,r).run();case 4:case"end":return i.stop()}}),i)})))),r.promise}(xv(e),(function(n){return t(new Jp(e,n))}),r)}(this._delegate,(function(n){return e(new ly(t,n))}))}},{key:"batch",value:function(){var e=this;return xv(this._delegate),new hy(new Qp(this._delegate,(function(t){return zp(e._delegate,t)})))}},{key:"loadBundle",value:function(e){return Av(this._delegate,e)}},{key:"namedQuery",value:function(e){var t=this;return Cv(this._delegate,e).then((function(e){return e?new ky(t,e):null}))}}]),e}(),cy=function(e){(0,a.Z)(n,e);var t=(0,o.Z)(n);function n(e){var r;return(0,s.Z)(this,n),(r=t.call(this)).firestore=e,r}return(0,c.Z)(n,[{key:"convertBytes",value:function(e){return new ay(new Dv(e))}},{key:"convertReference",value:function(e){var t=this.convertDocumentKey(e,this.firestore._databaseId);return dy.forKey(t,this.firestore,null)}}]),n}(Cp);var ly=function(){function e(t,n){(0,s.Z)(this,e),this._firestore=t,this._delegate=n,this._userDataWriter=new cy(t)}return(0,c.Z)(e,[{key:"get",value:function(e){var t=this,n=Iy(e);return this._delegate.get(n).then((function(e){return new my(t._firestore,new Op(t._firestore._delegate,t._userDataWriter,e._key,e._document,e.metadata,n.converter))}))}},{key:"set",value:function(e,t,n){var r=Iy(e);return n?(ny("Transaction.set",n),this._delegate.set(r,t,n)):this._delegate.set(r,t),this}},{key:"update",value:function(e,t,n){for(var r=arguments.length,i=new Array(r>3?r-3:0),a=3;a<r;a++)i[a-3]=arguments[a];var o,u=Iy(e);2===arguments.length?this._delegate.update(u,t):(o=this._delegate).update.apply(o,[u,t,n].concat(i));return this}},{key:"delete",value:function(e){var t=Iy(e);return this._delegate.delete(t),this}}]),e}(),hy=function(){function e(t){(0,s.Z)(this,e),this._delegate=t}return(0,c.Z)(e,[{key:"set",value:function(e,t,n){var r=Iy(e);return n?(ny("WriteBatch.set",n),this._delegate.set(r,t,n)):this._delegate.set(r,t),this}},{key:"update",value:function(e,t,n){for(var r=arguments.length,i=new Array(r>3?r-3:0),a=3;a<r;a++)i[a-3]=arguments[a];var o,u=Iy(e);2===arguments.length?this._delegate.update(u,t):(o=this._delegate).update.apply(o,[u,t,n].concat(i));return this}},{key:"delete",value:function(e){var t=Iy(e);return this._delegate.delete(t),this}},{key:"commit",value:function(){return this._delegate.commit()}}]),e}(),fy=function(){function e(t,n,r){(0,s.Z)(this,e),this._firestore=t,this._userDataWriter=n,this._delegate=r}return(0,c.Z)(e,[{key:"fromFirestore",value:function(e,t){var n=new Pp(this._firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,null);return this._delegate.fromFirestore(new gy(this._firestore,n),null!==t&&void 0!==t?t:{})}},{key:"toFirestore",value:function(e,t){return t?this._delegate.toFirestore(e,t):this._delegate.toFirestore(e)}}],[{key:"getInstance",value:function(t,n){var r=e.INSTANCES,i=r.get(t);i||(i=new WeakMap,r.set(t,i));var a=i.get(n);return a||(a=new e(t,new cy(t),n),i.set(n,a)),a}}]),e}();fy.INSTANCES=new WeakMap;var dy=function(){function e(t,n){(0,s.Z)(this,e),this.firestore=t,this._delegate=n,this._userDataWriter=new cy(t)}return(0,c.Z)(e,[{key:"id",get:function(){return this._delegate.id}},{key:"parent",get:function(){return new Zy(this.firestore,this._delegate.parent)}},{key:"path",get:function(){return this._delegate.path}},{key:"collection",value:function(e){try{return new Zy(this.firestore,Wd(this._delegate,e))}catch(t){throw vy(t,"collection()","DocumentReference.collection()")}}},{key:"isEqual",value:function(e){return(e=(0,w.m9)(e))instanceof Gd&&Qd(this._delegate,e)}},{key:"set",value:function(e,t){t=ny("DocumentReference.set",t);try{return t?Bp(this._delegate,e,t):Bp(this._delegate,e)}catch(n){throw vy(n,"setDoc()","DocumentReference.set()")}}},{key:"update",value:function(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];try{return 1===arguments.length?jp(this._delegate,e):jp.apply(void 0,[this._delegate,e,t].concat(r))}catch(a){throw vy(a,"updateDoc()","DocumentReference.update()")}}},{key:"delete",value:function(){return function(e){return zp(Fd(e.firestore,Iv),[new eu(e._key,Vo.none())])}(this._delegate)}},{key:"onSnapshot",value:function(){for(var e=this,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];var i=py(n),a=yy(n,(function(t){return new my(e.firestore,new Op(e.firestore._delegate,e._userDataWriter,t._key,t._document,t.metadata,e._delegate.converter))}));return Gp(this._delegate,i,a)}},{key:"get",value:function(e){var t,n=this;return t="cache"===(null===e||void 0===e?void 0:e.source)?Up(this._delegate):"server"===(null===e||void 0===e?void 0:e.source)?function(e){e=Fd(e,Gd);var t=Fd(e.firestore,Iv);return gv(xv(t),e._key,{source:"server"}).then((function(n){return Wp(t,e,n)}))}(this._delegate):function(e){e=Fd(e,Gd);var t=Fd(e.firestore,Iv);return gv(xv(t),e._key).then((function(n){return Wp(t,e,n)}))}(this._delegate),t.then((function(e){return new my(n.firestore,new Op(n.firestore._delegate,n._userDataWriter,e._key,e._document,e.metadata,n._delegate.converter))}))}},{key:"withConverter",value:function(t){return new e(this.firestore,t?this._delegate.withConverter(fy.getInstance(this.firestore,t)):this._delegate.withConverter(null))}}],[{key:"forPath",value:function(t,n,r){if(t.length%2!==0)throw new Fr("invalid-argument","Invalid document reference. Document references must have an even number of segments, but "+"".concat(t.canonicalString()," has ").concat(t.length));return new e(n,new Gd(n._delegate,r,new ai(t)))}},{key:"forKey",value:function(t,n,r){return new e(n,new Gd(n._delegate,r,t))}}]),e}();function vy(e,t,n){return e.message=e.message.replace(t,n),e}function py(e){var t,n=(0,u.Z)(e);try{for(n.s();!(t=n.n()).done;){var r=t.value;if("object"===typeof r&&!oy(r))return r}}catch(i){n.e(i)}finally{n.f()}return{}}function yy(e,t){var n,r,i;return{next:function(e){i.next&&i.next(t(e))},error:null===(n=(i=oy(e[0])?e[0]:oy(e[1])?e[1]:"function"===typeof e[0]?{next:e[0],error:e[1],complete:e[2]}:{next:e[1],error:e[2],complete:e[3]}).error)||void 0===n?void 0:n.bind(i),complete:null===(r=i.complete)||void 0===r?void 0:r.bind(i)}}var my=function(){function e(t,n){(0,s.Z)(this,e),this._firestore=t,this._delegate=n}return(0,c.Z)(e,[{key:"ref",get:function(){return new dy(this._firestore,this._delegate.ref)}},{key:"id",get:function(){return this._delegate.id}},{key:"metadata",get:function(){return this._delegate.metadata}},{key:"exists",get:function(){return this._delegate.exists()}},{key:"data",value:function(e){return this._delegate.data(e)}},{key:"get",value:function(e,t){return this._delegate.get(e,t)}},{key:"isEqual",value:function(e){return Fp(this._delegate,e._delegate)}}]),e}(),gy=function(e){(0,a.Z)(n,e);var t=(0,o.Z)(n);function n(){return(0,s.Z)(this,n),t.apply(this,arguments)}return(0,c.Z)(n,[{key:"data",value:function(e){var t=this._delegate.data(e);return function(e,t){e||Or()}(void 0!==t),t}}]),n}(my),ky=function(){function e(t,n){(0,s.Z)(this,e),this.firestore=t,this._delegate=n,this._userDataWriter=new cy(t)}return(0,c.Z)(e,[{key:"where",value:function(t,n,r){try{return new e(this.firestore,vp(this._delegate,function(e,t,n){var r=t,i=lp("where",e);return pp._create(i,r,n)}(t,n,r)))}catch(i){throw vy(i,/(orderBy|where)\(\)/,"Query.$1()")}}},{key:"orderBy",value:function(t,n){try{return new e(this.firestore,vp(this._delegate,function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"asc",n=lp("orderBy",e);return mp._create(n,t)}(t,n)))}catch(r){throw vy(r,/(orderBy|where)\(\)/,"Query.$1()")}}},{key:"limit",value:function(t){try{return new e(this.firestore,vp(this._delegate,function(e){return Vd("limit",e),gp._create("limit",e,"F")}(t)))}catch(n){throw vy(n,"limit()","Query.limit()")}}},{key:"limitToLast",value:function(t){try{return new e(this.firestore,vp(this._delegate,function(e){return Vd("limitToLast",e),gp._create("limitToLast",e,"L")}(t)))}catch(n){throw vy(n,"limitToLast()","Query.limitToLast()")}}},{key:"startAt",value:function(){try{return new e(this.firestore,vp(this._delegate,wp.apply(void 0,arguments)))}catch(t){throw vy(t,"startAt()","Query.startAt()")}}},{key:"startAfter",value:function(){try{return new e(this.firestore,vp(this._delegate,bp.apply(void 0,arguments)))}catch(t){throw vy(t,"startAfter()","Query.startAfter()")}}},{key:"endBefore",value:function(){try{return new e(this.firestore,vp(this._delegate,Ip.apply(void 0,arguments)))}catch(t){throw vy(t,"endBefore()","Query.endBefore()")}}},{key:"endAt",value:function(){try{return new e(this.firestore,vp(this._delegate,xp.apply(void 0,arguments)))}catch(t){throw vy(t,"endAt()","Query.endAt()")}}},{key:"isEqual",value:function(e){return Yd(this._delegate,e._delegate)}},{key:"get",value:function(e){var t,n=this;return t="cache"===(null===e||void 0===e?void 0:e.source)?qp(this._delegate):"server"===(null===e||void 0===e?void 0:e.source)?function(e){e=Fd(e,Kd);var t=Fd(e.firestore,Iv),n=xv(t),r=new Vp(t);return kv(n,e._query,{source:"server"}).then((function(n){return new Lp(t,r,e,n)}))}(this._delegate):function(e){e=Fd(e,Kd);var t=Fd(e.firestore,Iv),n=xv(t),r=new Vp(t);return hp(e._query),kv(n,e._query).then((function(n){return new Lp(t,r,e,n)}))}(this._delegate),t.then((function(e){return new by(n.firestore,new Lp(n.firestore._delegate,n._userDataWriter,n._delegate,e._snapshot))}))}},{key:"onSnapshot",value:function(){for(var e=this,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];var i=py(n),a=yy(n,(function(t){return new by(e.firestore,new Lp(e.firestore._delegate,e._userDataWriter,e._delegate,t._snapshot))}));return Gp(this._delegate,i,a)}},{key:"withConverter",value:function(t){return new e(this.firestore,t?this._delegate.withConverter(fy.getInstance(this.firestore,t)):this._delegate.withConverter(null))}}]),e}(),wy=function(){function e(t,n){(0,s.Z)(this,e),this._firestore=t,this._delegate=n}return(0,c.Z)(e,[{key:"type",get:function(){return this._delegate.type}},{key:"doc",get:function(){return new gy(this._firestore,this._delegate.doc)}},{key:"oldIndex",get:function(){return this._delegate.oldIndex}},{key:"newIndex",get:function(){return this._delegate.newIndex}}]),e}(),by=function(){function e(t,n){(0,s.Z)(this,e),this._firestore=t,this._delegate=n}return(0,c.Z)(e,[{key:"query",get:function(){return new ky(this._firestore,this._delegate.query)}},{key:"metadata",get:function(){return this._delegate.metadata}},{key:"size",get:function(){return this._delegate.size}},{key:"empty",get:function(){return this._delegate.empty}},{key:"docs",get:function(){var e=this;return this._delegate.docs.map((function(t){return new gy(e._firestore,t)}))}},{key:"docChanges",value:function(e){var t=this;return this._delegate.docChanges(e).map((function(e){return new wy(t._firestore,e)}))}},{key:"forEach",value:function(e,t){var n=this;this._delegate.forEach((function(r){e.call(t,new gy(n._firestore,r))}))}},{key:"isEqual",value:function(e){return Fp(this._delegate,e._delegate)}}]),e}(),Zy=function(e){(0,a.Z)(n,e);var t=(0,o.Z)(n);function n(e,r){var i;return(0,s.Z)(this,n),(i=t.call(this,e,r)).firestore=e,i._delegate=r,i}return(0,c.Z)(n,[{key:"id",get:function(){return this._delegate.id}},{key:"path",get:function(){return this._delegate.path}},{key:"parent",get:function(){var e=this._delegate.parent;return e?new dy(this.firestore,e):null}},{key:"doc",value:function(e){try{return new dy(this.firestore,void 0===e?Hd(this._delegate):Hd(this._delegate,e))}catch(t){throw vy(t,"doc()","CollectionReference.doc()")}}},{key:"add",value:function(e){var t=this;return function(e,t){var n=Fd(e.firestore,Iv),r=Hd(e),i=Np(e.converter,t);return zp(n,[jv(Bv(e.firestore),"addDoc",r._key,i,null!==e.converter,{}).toMutation(r._key,Vo.exists(!1))]).then((function(){return r}))}(this._delegate,e).then((function(e){return new dy(t.firestore,e)}))}},{key:"isEqual",value:function(e){return Qd(this._delegate,e._delegate)}},{key:"withConverter",value:function(e){return new n(this.firestore,e?this._delegate.withConverter(fy.getInstance(this.firestore,e)):this._delegate.withConverter(null))}}]),n}(ky);function Iy(e){return Fd(e,Gd)}var xy=function(){function e(){(0,s.Z)(this,e);for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];this._delegate=(0,i.Z)(Rv,n)}return(0,c.Z)(e,[{key:"isEqual",value:function(e){return(e=(0,w.m9)(e))instanceof Rv&&this._delegate._internalPath.isEqual(e._internalPath)}}],[{key:"documentId",value:function(){return new e(ii.keyField().canonicalString())}}]),e}(),_y=function(){function e(t){(0,s.Z)(this,e),this._delegate=t}return(0,c.Z)(e,[{key:"isEqual",value:function(e){return this._delegate.isEqual(e._delegate)}}],[{key:"serverTimestamp",value:function(){var t=new zv("serverTimestamp");return t._methodName="FieldValue.serverTimestamp",new e(t)}},{key:"delete",value:function(){var t=new Gv("deleteField");return t._methodName="FieldValue.delete",new e(t)}},{key:"arrayUnion",value:function(){var t=Xp.apply(void 0,arguments);return t._methodName="FieldValue.arrayUnion",new e(t)}},{key:"arrayRemove",value:function(){var t=$p.apply(void 0,arguments);return t._methodName="FieldValue.arrayRemove",new e(t)}},{key:"increment",value:function(t){var n=function(e){return new Qv("increment",e)}(t);return n._methodName="FieldValue.increment",new e(n)}}]),e}(),Ty={Firestore:sy,GeoPoint:Pv,Timestamp:$r,Blob:ay,Transaction:ly,WriteBatch:hy,DocumentReference:dy,DocumentSnapshot:my,Query:ky,QueryDocumentSnapshot:gy,QuerySnapshot:by,CollectionReference:Zy,FieldPath:xy,FieldValue:_y,setLogLevel:function(e){!function(e){Sr.setLogLevel(e)}(e)},CACHE_SIZE_UNLIMITED:-1};!function(e){var t;t=function(e,t){return new sy(e,t,new uy)},e.INTERNAL.registerComponent(new g.wA("firestore-compat",(function(e){var n=e.getProvider("app-compat").getImmediate(),r=e.getProvider("firestore").getImmediate();return t(n,r)}),"PUBLIC").setServiceProps(Object.assign({},Ty))),e.registerVersion(ey,ty)}(l.Z)}}]);
//# sourceMappingURL=4070.3f5e1146.chunk.js.map